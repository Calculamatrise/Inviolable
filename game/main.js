/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/game/class/ContextMenu.js":
/*!***************************************!*\
  !*** ./src/game/class/ContextMenu.js ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ContextMenu)\n/* harmony export */ });\nclass ContextMenu extends HTMLElement {\r\n\t#pointerdownListener = null;\r\n\toptions = [];\r\n\tconstructor() {\r\n\t\tsuper(),\r\n\t\tthis.constructor.contextMenu = this,\r\n\t\tthis.addEventListener('contextmenu', event => event.preventDefault()),\r\n\t\tObject.defineProperty(this, '_removeListener', { value: this.remove.bind(this), writable: true });\r\n\t\tif (!this.constructor.debug) {\r\n\t\t\tthis.addEventListener('click', this.remove, { once: true, passive: true }),\r\n\t\t\tthis.addEventListener('mousewheel', event => this.clientHeight >= this.scrollHeight && event.preventDefault()),\r\n\t\t\twindow.addEventListener('blur', this._removeListener, { once: true, passive: true }),\r\n\t\t\twindow.addEventListener('scroll', this._removeListener, { once: true, passive: true }),\r\n\t\t\twindow.addEventListener('pointerdown', this.#pointerdownListener = event => {\r\n\t\t\t\tif (null !== event.target.closest('context-menu')) return window.addEventListener('pointerdown', this.#pointerdownListener, { passive: true, once: true });\r\n\t\t\t\tthis.remove()\r\n\t\t\t}, { passive: true, once: true });\r\n\t\t}\r\n\t\twindow.navigation && navigation.addEventListener('navigatesuccess', this._removeListener, { once: true, passive: true })\r\n\t}\r\n\r\n\t_updateSubMenuPositions({ clientX, clientY } = {}) {\r\n\t\tfor (let subMenu of this.querySelectorAll('.sub-menu')) {\r\n\t\t\tsubMenu.removeAttribute('style'),\r\n\t\t\tsubMenu.style.setProperty(clientX + subMenu.parentElement.offsetLeft + subMenu.parentElement.clientWidth + subMenu.clientWidth > window.innerWidth ? 'right' : 'left', '100%'),\r\n\t\t\tsubMenu.style.setProperty(clientY + subMenu.parentElement.offsetTop + subMenu.clientHeight > window.innerHeight ? 'bottom' : 'top', 0)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Add options\r\n\t * @param {object} data\r\n\t * @param {string} data.name\r\n\t * @param {Array} [data.styles]\r\n\t * @param {string} [data.type]\r\n\t */\r\n\taddOption(data) {\r\n\t\t// add sub-menu type option\r\n\t\tlet type = typeof data.type == 'string' && data.type.toLowerCase() || 'button';\r\n\t\tlet element = this.appendChild(document.createElement(type));\r\n\t\tthis.options && this.options.push(data);\r\n\t\tif (/^(b|h)r$/i.test(type)) return element;\r\n\t\telement.innerText = data.name;\r\n\t\tfor (let key in data) {\r\n\t\t\tif (typeof data[key] == 'undefined') continue;\r\n\t\t\tif (typeof data[key] == 'function' && element['on' + key] !== undefined) {\r\n\t\t\t\telement.addEventListener(key, data[key], { passive: !/\\.preventDefault\\(\\)/g.test(data[key].toString()) });\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tswitch(key) {\r\n\t\t\tcase 'disabled':\r\n\t\t\t\telement[key] = data[key];\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'options':\r\n\t\t\t\telement.dataset.type = 'sub-menu';\r\n\t\t\t\tlet container = document.createElement('div');\r\n\t\t\t\tcontainer.classList.add(element.dataset.type);\r\n\t\t\t\tfor (let option of data[key]) {\r\n\t\t\t\t\tthis.addOption.call(container, option);\r\n\t\t\t\t}\r\n\t\t\t\telement.appendChild(container);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'styles':\r\n\t\t\t\tif (typeof data[key][Symbol.iterator] != 'function') continue;\r\n\t\t\t\telement.classList.add(...Array.from(data[key].values()))\r\n\t\t\t}\r\n\t\t}\r\n\t\ttypeof data.callback == 'function' && data.callback(element);\r\n\t\treturn element\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.options.splice(0),\r\n\t\tthis.replaceChildren()\r\n\t}\r\n\r\n\tsetPosition({ clientX, clientY, pageX, pageY } = {}) {\r\n\t\tthis._updateSubMenuPositions(...arguments),\r\n\t\tclientX + this.clientWidth > window.innerWidth && (pageX -= this.clientWidth),\r\n\t\tclientY + this.clientHeight > window.innerHeight && (pageY -= this.clientHeight),\r\n\t\tthis.style.setProperty('left', pageX + 'px'),\r\n\t\tthis.style.setProperty('top', pageY + 'px');\r\n\t\treturn { pageX, pageY }\r\n\t}\r\n\r\n\tremove(event) {\r\n\t\tif (null === this.constructor.contextMenu) return;\r\n\t\twindow.removeEventListener('blur', this._removeListener),\r\n\t\twindow.removeEventListener('scroll', this._removeListener),\r\n\t\twindow.removeEventListener('pointerdown', this.#pointerdownListener),\r\n\t\twindow.navigation && navigation.removeEventListener('navigatesuccess', this._removeListener),\r\n\t\tsuper.remove(),\r\n\t\tthis.constructor.contextMenu = null,\r\n\t\tthis.dispatchEvent(new CustomEvent('close', {\r\n\t\t\tdetail: event && event.target.innerText && event.target.innerText.toLowerCase()\r\n\t\t}))\r\n\t}\r\n\r\n\tstatic contextMenu = null;\r\n\tstatic debug = false;\r\n\tstatic create(options, event) {\r\n\t\tif (!this.contextMenu) {\r\n\t\t\tthis.contextMenu = new this();\r\n\t\t} else {\r\n\t\t\tthis.contextMenu.clear();\r\n\t\t}\r\n\r\n\t\tfor (let option of options.filter(option => option instanceof Object)) {\r\n\t\t\tthis.contextMenu.addOption(option);\r\n\t\t}\r\n\r\n\t\tdocument.body.appendChild(this.contextMenu),\r\n\t\tthis.contextMenu.setPosition(event);\r\n\t\treturn this.contextMenu\r\n\t}\r\n}\r\n\r\ncustomElements.define('context-menu', ContextMenu);\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/ContextMenu.js?");

/***/ }),

/***/ "./src/game/class/EventEmitter.js":
/*!****************************************!*\
  !*** ./src/game/class/EventEmitter.js ***!
  \****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\t#events = null;\r\n\t#maxListeners = -1;\r\n\tdefaultMaxListeners = 10;\r\n\tsetMaxListeners(t) {\r\n\t\tif (typeof t != 'number' || 0 > t)\r\n\t\t\tthrow TypeError(\"n must be a positive number\");\r\n\t\treturn this.#maxListeners = t,\r\n\t\t\tthis\r\n\t}\r\n\temit(t) {\r\n\t\tvar e, i;\r\n\t\tif (this.#events && t === 'error' && (!this.#events.error || typeof this.#events.error == 'object' && this.#events.error !== null)) {\r\n\t\t\tif (e = arguments[1], e instanceof Error)\r\n\t\t\t\tthrow e;\r\n\t\t\tthrow TypeError('Unspecified \"error\" event.')\r\n\t\t}\r\n\t\tif (i = this.#events && this.#events[t], i === void 0)\r\n\t\t\treturn !1;\r\n\t\tif (typeof i == 'function')\r\n\t\t\ti.apply(this, Array.prototype.slice.call(arguments, 1));\r\n\t\telse if (typeof i == 'object' && i !== null) {\r\n\t\t\tfor (let s of i.values())\r\n\t\t\t\ts.apply(this, Array.prototype.slice.call(arguments, 1))\r\n\t\t}\r\n\t\treturn !0\r\n\t}\r\n\taddListener(t, e) {\r\n\t\tif (typeof e != \"function\")\r\n\t\t\tthrow TypeError(\"listener must be a function\");\r\n\t\tif (this.#events || (this.#events = {}),\r\n\t\t\tthis.#events.newListener && this.emit(\"newListener\", t, typeof e.listener == \"function\" ? e.listener : e),\r\n\t\t\tthis.#events[t] ? typeof this.#events[t] == 'object' && this.#events[t] !== null ? this.#events[t].add(e) : this.#events[t] = new Set([this.#events[t], e]) : this.#events[t] = e,\r\n\t\t\tthis.#events[t] == 'object' && this.#events[t] !== null && !this.#events[t].warned) {\r\n\t\t\tvar n = this.#maxListeners < 0 ? this.defaultMaxListeners : this.#maxListeners;\r\n\t\t\tn && n > 0 && this.#events[t].size > n && (this.#events[t].warned = !0,\r\n\t\t\tconsole.error(\"(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.\", this.#events[t].size))\r\n\t\t}\r\n\t\treturn this\r\n\t}\r\n\ton = this.addListener;\r\n\tonce(t, e) {\r\n\t\tif (typeof e != 'function')\r\n\t\t\tthrow TypeError(\"listener must be a function\");\r\n\t\tvar i = (...args) => {\r\n\t\t\tthis.removeListener(t, i),\r\n\t\t\te.apply(this, args)\r\n\t\t}\r\n\t\treturn i.listener = e,\r\n\t\tthis.on(t, i)\r\n\t}\r\n\tremoveListener(t, e) {\r\n\t\tif (typeof e != 'function')\r\n\t\t\tthrow TypeError(\"listener must be a function\");\r\n\t\tif (!this.#events || !this.#events[t])\r\n\t\t\treturn this;\r\n\t\tvar i = this.#events[t];\r\n\t\tif (i === e || typeof i.listener == 'function' && i.listener === e)\r\n\t\t\tdelete this.#events[t],\r\n\t\t\tthis.#events.removeListener && this.emit('removeListener', t, e);\r\n\t\telse if (typeof i == 'object' && i !== null) {\r\n\t\t\tfor (let s of i.values())\r\n\t\t\t\tif (s === e || typeof s.listener == 'function' && s.listener === e) {\r\n\t\t\t\t\ti.delete(s),\r\n\t\t\t\t\ti.size < 2 && (i.size === 0 ? delete this.#events[t] : this.#events[t] = this.#events[t].values().next().value),\r\n\t\t\t\t\tthis.#events.removeListener && this.emit('removeListener', t, e);\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t}\r\n\t\treturn Object.keys(this.#events).length < 1 && (this.#events = null),\r\n\t\t\tthis\r\n\t}\r\n\tremoveAllListeners(t) {\r\n\t\tif (!this.#events)\r\n\t\t\treturn this;\r\n\t\tif (!this.#events.removeListener)\r\n\t\t\treturn arguments.length === 0 ? this.#events = null : this.#events[t] && delete this.#events[t],\r\n\t\t\t\tObject.keys(this.#events).length < 1 && (this.#events = null),\r\n\t\t\t\tthis;\r\n\t\tvar e;\r\n\t\tif (arguments.length === 0) {\r\n\t\t\tfor (e in this.#events)\r\n\t\t\t\t'removeListener' !== e && this.removeAllListeners(e);\r\n\t\t\treturn this.removeAllListeners('removeListener')\r\n\t\t}\r\n\t\tif (e = this.#events[t], typeof e == 'function')\r\n\t\t\tthis.removeListener(t, e);\r\n\t\telse\r\n\t\t\tfor (let i of e.values())\r\n\t\t\t\tthis.removeListener(t, i);\r\n\t\treturn delete this.#events[t],\r\n\t\t\tObject.keys(this.#events).length < 1 && (this.#events = null),\r\n\t\t\tthis\r\n\t}\r\n\tlisteners(t) {\r\n\t\treturn this.#events && this.#events[t] ? typeof this.#events[t] == 'function' ? [this.#events[t]] : Array.from(this.#events[t]) : []\r\n\t}\r\n\tlistenerCount(t) {\r\n\t\treturn this.#events && this.#events[t] ? typeof this.#events[t] == 'function' ? 1 : this.#events[t].size : 0\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/EventEmitter.js?");

/***/ }),

/***/ "./src/game/class/Game.js":
/*!********************************!*\
  !*** ./src/game/class/Game.js ***!
  \********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ThirdPartyManager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ThirdPartyManager.js */ \"./src/game/class/ThirdPartyManager.js\");\n/* harmony import */ var _Lite_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Lite.js */ \"./src/game/class/Lite.js\");\n/* harmony import */ var _EventEmitter_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./EventEmitter.js */ \"./src/game/class/EventEmitter.js\");\n/* harmony import */ var _scenes_Editor_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./scenes/Editor.js */ \"./src/game/class/scenes/Editor.js\");\n/* harmony import */ var _scenes_Main_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./scenes/Main.js */ \"./src/game/class/scenes/Main.js\");\n// Changes on line 78 onwards\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nwindow.Game = class extends _EventEmitter_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"] {\r\n\tgameContainer = null;\r\n\t_frames = 0;\r\n\tframes = 0;\r\n\tlastTime = -1;\r\n\ttimer = performance.now();\r\n\t_updates = 0;\r\n\tupdates = 0;\r\n\tups = 30; // 60;\r\n\ttickCount = 0;\r\n\tcurrentScene = null;\r\n\tassets = null;\r\n\tcanvas = null;\r\n\tstats = null;\r\n\twidth = 0;\r\n\theight = 0;\r\n\tfullscreen = !1;\r\n\tonStateChange = null;\r\n\tconstructor(t, e, i) {\r\n\t\tsuper();\r\n\t\tthis.assets = e,\r\n\t\tthis.settings = i,\r\n\t\tthis.initCanvas(),\r\n\t\tthis.setSize(),\r\n\t\tthis.switchScene(t),\r\n\t\tthis.setSize(),\r\n\t\t(window.createjs ||= {}).Ticker ||= this,\r\n\t\tObject.defineProperty(this, 'updateCallback', { value: requestAnimationFrame(this.update.bind(this)), writable: true }),\r\n\t\tthis.emit('ready', this)\r\n\t}\r\n\tinitCanvas() {\r\n\t\tthis.canvas = document.createElement(\"canvas\");\r\n\t\tthis.canvas.addEventListener(\"dblclick\", () => this.currentScene instanceof _scenes_Main_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"] && this.currentScene.toggleFullscreen(), { passive: true });\r\n\t\tthis.ctx = this.canvas.getContext(\"2d\");\r\n\t\tthis.gameContainer = document.getElementById(this.settings.defaultContainerID);\r\n\t\tthis.gameContainer !== null && this.gameContainer.appendChild(this.canvas);\r\n\t}\r\n\tsetSize() {\r\n\t\tlet t = window.innerHeight\r\n\t\t  , e = window.innerWidth;\r\n\t\tif (!this.settings.fullscreen && !this.settings.isStandalone) {\r\n\t\t\tt = this.gameContainer.clientHeight,\r\n\t\t\te = this.gameContainer.clientWidth\r\n\t\t}\r\n\t\tthis.currentScene && (t -= this.currentScene.getCanvasOffset().height)\r\n\t\tlet n = 1;\r\n\t\twindow.devicePixelRatio && (n = window.devicePixelRatio),\r\n\t\tthis.settings.lowQualityMode && (n = 1);\r\n\t\tlet r = e * n\r\n\t\t  , o = t * n;\r\n\t\t(r !== this.width || o !== this.height) && (this.width = r,\r\n\t\tthis.height = o,\r\n\t\tthis.canvas.width = r,\r\n\t\tthis.canvas.height = o),\r\n\t\tthis.pixelRatio = n,\r\n\t\tthis.canvas.style.width = e + \"px\",\r\n\t\tthis.canvas.style.height = t + \"px\",\r\n\t\tthis.ctx.imageSmoothingEnabled = !1,\r\n\t\tthis.ctx.lineCap = \"round\",\r\n\t\tthis.ctx.lineJoin = \"round\",\r\n\t\tthis.ctx.strokeStyle = this.settings.physicsLineColor,\r\n\t\tthis.currentScene && this.currentScene.command(\"resize\")\r\n\t}\r\n\r\n\tprogress = 0\r\n\tupdate(time) {\r\n\t\tthis.updateCallback = requestAnimationFrame(this.update.bind(this));\r\n\t\tlet delta = time - this.lastTime\r\n\t\t  , max = 1e3 / this.ups;\r\n\t\t// if (delta >= max) {\r\n\t\t// \tconsole.log(this.updates, this.lastTime, time, time + max)\r\n\t\t// \tthis.lastTime = time + max;\r\n\t\t// \tthis.currentScene.fixedUpdate();\r\n\t\t// \tthis._updates++;\r\n\t\t// }\r\n\r\n\t\tif (delta > 1e3) {\r\n\t\t\tdelta = max;\r\n\t\t}\r\n\r\n\t\tthis.progress += delta / max,\r\n\t\tthis.lastTime = time;\r\n\t\twhile (this.progress >= 1) {\r\n\t\t\tthis.currentScene.fixedUpdate(),\r\n\t\t\tthis.emit('tick', ++this._updates),\r\n\t\t\tthis.progress--\r\n\t\t}\r\n\r\n\t\tthis.currentScene.draw(this.ctx),\r\n\t\tthis.emit('draw', this.ctx),\r\n\t\tthis._frames++;\r\n\t\tif (time - this.timer > 1e3) {\r\n\t\t\tthis.timer = time,\r\n\t\t\tthis.updates = this._updates,\r\n\t\t\tthis._updates = 0,\r\n\t\t\tthis.frames = this._frames,\r\n\t\t\tthis._frames = 0\r\n\t\t}\r\n\t}\r\n\r\n\tswitchScene(t) {\r\n\t\tthis.currentScene !== null && this.currentScene.close(),\r\n\t\tthis.currentScene = new { Editor: _scenes_Editor_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"], Main: _scenes_Main_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"] }[t](this)\r\n\t}\r\n\r\n\tcommand() {\r\n\t\tthis.currentScene.command.apply(this.currentScene, arguments)\r\n\t}\r\n\r\n\tclose() {\r\n\t\tcancelAnimationFrame(this.updateCallback),\r\n\t\tthis.updateCallback = null,\r\n\t\tthis.currentScene.close(),\r\n\t\tthis.currentScene = null,\r\n\t\tthis.assets = null,\r\n\t\tthis.settings = null,\r\n\t\tthis.canvas.remove(),\r\n\t\tthis.canvas = null,\r\n\t\tthis.ctx = null,\r\n\t\tthis.tickCount = null,\r\n\t\tthis.height = null,\r\n\t\tthis.width = null\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/Game.js?");

/***/ }),

/***/ "./src/game/class/Lite.js":
/*!********************************!*\
  !*** ./src/game/class/Lite.js ***!
  \********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ContextMenu.js */ \"./src/game/class/ContextMenu.js\");\n\r\n\r\nwindow.lite = new class Lite {\r\n\tdialogs = new Map();\r\n\tnativeEvents = new Map();\r\n\tplaylists = new Map();\r\n\tsnapshots = new class extends Array {\r\n\t\tpush(...args) {\r\n\t\t\tif (this.length >= parseInt(lite.storage.get('snapshots')))\r\n\t\t\t\tthis.splice(0, this.length - parseInt(lite.storage.get('snapshots')));\r\n\t\t\treturn super.push(...args)\r\n\t\t}\r\n\t}\r\n\tstorage = new Map();\r\n\ttrackData = null;\r\n\tconstructor() {\r\n\t\tlet searchParams = new URLSearchParams(location.search);\r\n\t\tif (searchParams.has('ajax')) return;\r\n\t\twindow.Application && Application.events.subscribe('mainview.loaded', this._childLoad.bind(this)),\r\n\t\twindow.ModManager && (ModManager.hook(this, { name: 'lite' }),\r\n\t\tModManager.on('ready', this._load.bind(this)),\r\n\t\tModManager.on('stateChange', this.refresh.bind(this)));\r\n\t\taddEventListener('message', ({ data }) => {\r\n\t\t\tif (!data) return console.warn('data is missing');\r\n\t\t\tswitch (data.action) {\r\n\t\t\tcase 'setStorage':\r\n\t\t\t\tthis.storage = new Map(Object.entries(data.storage)),\r\n\t\t\t\tthis._childLoad();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'updateStorage':\r\n\t\t\t\tlet oldStorage = new Map(this.storage);\r\n\t\t\t\tthis.storage = new Map(Object.entries(data.storage));\r\n\t\t\t\tlet changes = new Map();\r\n\t\t\t\tfor (const [key, value] of this.storage.entries()) {\r\n\t\t\t\t\tif (JSON.stringify(value) == JSON.stringify(oldStorage.get(key))) continue;\r\n\t\t\t\t\tchanges.set(key, value);\r\n\t\t\t\t}\r\n\t\t\t\tthis._updateFromSettings(changes)\r\n\t\t\t}\r\n\t\t}, { passive: true });\r\n\t\tObject.defineProperty(this, 'trackData', { enumerable: false }),\r\n\t\tObject.defineProperty(this, 'dialogs', { enumerable: false }),\r\n\t\tObject.defineProperty(this, 'nativeEvents', { enumerable: false })\r\n\t}\r\n\r\n\tget scene() {\r\n\t\treturn GameManager.game && GameManager.game.currentScene\r\n\t}\r\n\r\n\t_appendRecords() {\r\n\t\tlet record = []\r\n\t\t  , bikeFrameColor = this.storage.get('bikeFrameColor')\r\n\t\t  , bikeTireColor = this.storage.get('bikeTireColor');\r\n\t\tnull !== bikeFrameColor && record.push(['frameColor', bikeFrameColor]);\r\n\t\tnull !== bikeTireColor && record.push(['tireColor', bikeTireColor]);\r\n\t\treturn record.length > 0 && { 'bike_options': record.map(t => t.join(': ')) } || null\r\n\t}\r\n\r\n\t_childLoad() {\r\n\t\t// if pathname === /create discard all track related variables (this.replayGui)\r\n\t\tnavigator.onLine && this._uploadOfflineRaces(),\r\n\t\tthis.attachContextMenu(),\r\n\t\tlocation.pathname.match(/^\\/notifications\\/?/i) && this.modifyCommentNotifications();\r\n\t\tthis.storage.get('accountManager') && this.initAccountManager();\r\n\t\tlocation.pathname.match(/^\\/t\\//i) && GameSettings.track && (Application.events.publish(\"game.prerollAdStopped\"),\r\n\t\tlocation.pathname.match(/\\/r\\/.+$/i) && this._updateChallengeLeaderboard(GameSettings.raceData),\r\n\t\tthis.cacheTrackData(),\r\n\t\tthis.storage.get('achievementMonitor') && this.initAchievementsDisplay(),\r\n\t\tthis.initBestDate(),\r\n\t\tthis.initDownloadGhosts(),\r\n\t\tthis.initGhostMetadata(),\r\n\t\tthis.initReportTracks(),\r\n\t\tlocation.search.includes('c_id=') && this.initJumpToComment(),\r\n\t\tApplication.settings.user.u_id === GameSettings.track.u_id && this.initDownloadTracks(),\r\n\t\tthis.storage.get('featuredGhostsDisplay') && this.initFeaturedGhosts(),\r\n\t\tthis.initGhostPlayer());\r\n\t\tlocation.pathname.match(/^\\/u\\//i) && (Application.router.current_view.username === Application.settings.user.u_name ? (this.storage.get('playlists') && this.initPlayLater(),\r\n\t\tthis.initUserTrackAnalytics()) : this.initFriendsLastPlayed(),\r\n\t\tApplication.settings.user.moderator && (this.initUserModeration(),\r\n\t\tthis.initUserTrackModeration()));\r\n\t\tlocation.pathname.match(/^\\/account\\/settings\\/?/i) && this.initRequestTrackData()\r\n\t}\r\n\r\n\t_load(game) {\r\n\t\tthis.replayGui && game.currentScene.races && game.currentScene.races.length > 0 && (this.replayGui.progress.max = game.currentScene.races[0].race.run_ticks),\r\n\t\tgame.on('baseVehicleCreate', baseVehicle => this._updateBaseVehicle(baseVehicle)),\r\n\t\tgame.on('cameraFocus', playerFocus => {\r\n\t\t\tthis.replayGui && (this.replayGui.style.setProperty('display', this.scene.camera.focusIndex !== 0 ? 'block' : 'none'),\r\n\t\t\t(this.scene.camera.focusIndex !== 0 || this.scene.playerManager._players.length > 1) && (playerFocus = this.scene.races.find(({ user }) => user.u_id == playerFocus._user.u_id) || this.scene.races[this.scene.races.length - 1]) && (this.replayGui.progress.max = playerFocus.race.run_ticks ?? 100))\r\n\t\t}),\r\n\t\tgame.on('draw', this.draw.bind(this)),\r\n\t\tgame.on('replayTick', ticks => this.replayGui && (this.replayGui.progress.value = ticks)),\r\n\t\tgame.on('trackChallengeUpdate', races => {\r\n\t\t\tthis.replayGui && races.length > 0 && this.replayGui.show();\r\n\t\t\tthis._updateChallengeLeaderboard(races);\r\n\t\t\tlet tasRaces = races.filter(({ race }) => race.code.tas);\r\n\t\t\ttasRaces.length > 0 && this.updateTASLeaderboard(tasRaces)\r\n\t\t}),\r\n\t\tgame.on('trackRaceCreate', data => {\r\n\t\t\tGameSettings.raceData ||= [],\r\n\t\t\tGameSettings.raceData.push(data),\r\n\t\t\tGameSettings.raceUids.push(data.user.u_id),\r\n\t\t\tthis._updateRaceURL(GameSettings.raceData)\r\n\t\t}),\r\n\t\tgame.on('trackRaceDelete', data => {\r\n\t\t\tGameSettings.raceData && (GameSettings.raceData.splice(GameSettings.raceData.indexOf(data), 1),\r\n\t\t\tthis._updateRaceURL(GameSettings.raceData),\r\n\t\t\tGameSettings.raceData.length < 1 && (GameSettings.raceData = !1)),\r\n\t\t\tGameSettings.raceUids.splice(GameSettings.raceUids.indexOf(data.user.u_id), 1)\r\n\t\t}),\r\n\t\tgame.on('trackRaceUpload', () => this._updateChallengeLeaderboard(GameManager.game.currentScene.races)),\r\n\t\tgame.on('trackRaceUploadError', error => {\r\n\t\t\tconst OFFLINE_RACES_KEY = this.constructor.keyify('offline.races');\r\n\t\t\tlet offlineRaces = this.constructor.getStorageEntry(OFFLINE_RACES_KEY);\r\n\t\t\tofflineRaces instanceof Array || (offlineRaces = []);\r\n\t\t\tlet existingEntry = offlineRaces.find(({ postData: t }) => t.t_id === error.data.postData.t_id);\r\n\t\t\texistingEntry && existingEntry.postData.run_ticks >= error.data.postData.run_ticks ? offlineRaces.splice(offlineRaces.indexOf(existingEntry), 1, error.data) : offlineRaces.push(error.data);\r\n\t\t\tthis.constructor.setStorageEntry(OFFLINE_RACES_KEY, offlineRaces.reduce((t, e) => -1 !== t.findIndex(i => i.postData.t_id === e.postData.t_id) ? t : t.concat(e), [])),\r\n\t\t\talert('Your connection is offline! Free Rider Lite saved your ghost, and it will be published when your connection is back online!'),\r\n\t\t\t!this._connectionEvent && (Object.defineProperty(this, '_connectionEvent', {\r\n\t\t\t\tvalue: () => {\r\n\t\t\t\t\tif (!navigator.onLine) return;\r\n\t\t\t\t\tthis._uploadOfflineRaces(),\r\n\t\t\t\t\tnavigator.connection.removeEventListener('change', this._connectionEvent),\r\n\t\t\t\t\tthis._connectionEvent = null\r\n\t\t\t\t},\r\n\t\t\t\twritable: true\r\n\t\t\t}),\r\n\t\t\tnavigator.connection.addEventListener('change', this._connectionEvent))\r\n\t\t}),\r\n\t\tthis.snapshots.splice(0, this.snapshots.length),\r\n\t\tthis._updateFromSettings(this.storage);\r\n\t\tfor (let player of game.currentScene.playerManager._players.filter(t => t._baseVehicle))\r\n\t\t\tthis._updateBaseVehicle(player._baseVehicle)\r\n\t}\r\n\r\n\t_updateChallengeLeaderboard(races) {\r\n\t\tlet challengeLeaderboard = this.fetchChallengeLeaderboard({ createIfNotExists: true });\r\n\t\tchallengeLeaderboard.replaceChildren(...races.map((data, index) => {\r\n\t\t\tlet row = this.constructor.fetchRaceRow(data, { parent: challengeLeaderboard, placement: 1 + index });\r\n\t\t\tlet num = row.querySelector('.num');\r\n\t\t\tnum.innerText = (1 + index) + '.';\r\n\t\t\tlet actionRow = row.querySelector('.track-leaderboard-action');\r\n\t\t\tactionRow.querySelector('span.btn.new-button.button-type-1') || actionRow.appendChild(this.constructor.createElement('span.btn.new-button.button-type-1', {\r\n\t\t\t\tinnerText: 'X',\r\n\t\t\t\ttitle: 'Remove Race',\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\taspectRatio: 1,\r\n\t\t\t\t\tbackgroundImage: 'linear-gradient(#ee5f5b,#c43c35)',\r\n\t\t\t\t\tfontSize: '12px',\r\n\t\t\t\t\theight: '24px',\r\n\t\t\t\t\tlineHeight: '2em',\r\n\t\t\t\t\tmarginRight: '6px',\r\n\t\t\t\t\ttextAlign: 'center'\r\n\t\t\t\t},\r\n\t\t\t\tclick() {\r\n\t\t\t\t\tlet row = this.closest('.track-leaderboard-race-row');\r\n\t\t\t\t\tlite.scene.removeRaces([row.dataset.u_id]);\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t\treturn row\r\n\t\t}));\r\n\t\tchallengeLeaderboard.children.length < 1 && challengeLeaderboard.closest('.track-leaderboard').style.setProperty('display', 'none')\r\n\t}\r\n\r\n\t_uploadOfflineRaces() {\r\n\t\tif (!navigator.onLine) return;\r\n\t\tlet offlineRaces = this.constructor.getStorageEntry('offline.races');\r\n\t\tif (!offlineRaces || offlineRaces.length < 1) return;\r\n\t\tfor (let data of offlineRaces) {\r\n\t\t\tif (!confirm('Would you like to upload a race you made while offline on ' + data.postData.t_id + '?')) continue;\r\n\t\t\tif (this.trackData && this.trackData.id === data.postData.t_id) {\r\n\t\t\t\tthis.scene.state.showDialog = !1,\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.scene.state.dialogOptions = data,\r\n\t\t\t\t\tthis.scene.command('dialog', 'track_complete')\r\n\t\t\t\t}, 1e3 / this.scene.game.ups);\r\n\t\t\t} else\r\n\t\t\t\tApplication.Helpers.AjaxHelper.post('track_api/track_run_complete', data.postData, { track: !1 });\r\n\t\t}\r\n\t\tofflineRaces.delete()\r\n\t}\r\n\r\n\t_updateRaceURL(raceData) {\r\n\t\tif (!raceData) return;\r\n\t\tlet parsedTrackURL = location.pathname.replace(/\\/r(\\/[^\\/]*)+\\/?$/i, '');\r\n\t\tlet raceURL = raceData.filter(t => t.user.u_id != Application.settings.user.u_id).map(t => t.user.u_name).join('/');\r\n\t\thistory.replaceState(null, null, location.pathname.replace(/(\\/r(\\/[^\\/]*)+\\/?)?$/i, raceURL.length > 0 ? '/r/' + raceURL : '') + location.search)\r\n\t}\r\n\r\n\t_getColorScheme(theme) {\r\n\t\tif (/^(?:auto|device|system)$/i.test(theme)) {\r\n\t\t\tthis._csPreference || Object.defineProperty(this, '_csPreference', {\r\n\t\t\t\tvalue: matchMedia('(prefers-color-scheme: dark)'),\r\n\t\t\t\twritable: true\r\n\t\t\t});\r\n\t\t\tthis._csPreference.onchange = event => this._updateFromSettings(new Map([['theme', event.target.matches ? 'dark' : 'light']]));\r\n\t\t\ttheme = this._csPreference.matches ? 'dark' : 'light';\r\n\t\t} else if (this._csPreference) {\r\n\t\t\tthis._csPreference = null;\r\n\t\t}\r\n\t\treturn theme\r\n\t\t// return object with accentColor, etc.\r\n\t}\r\n\r\n\t_updateFromSettings(changes = this.storage) {\r\n\t\tif (!this.scene) return;\r\n\t\tlet childLoad = !1\r\n\t\t  , redraw = !1;\r\n\t\tfor (const [key, value] of changes.entries()) {\r\n\t\t\tswitch (key) {\r\n\t\t\tcase 'accountManager':\r\n\t\t\tcase 'achievementMonitor':\r\n\t\t\tcase 'featuredGhosts':\r\n\t\t\tcase 'playlists':\r\n\t\t\t\tchildLoad = true;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'bikeFrameColor':\r\n\t\t\t\tvar firstPlayer = this.scene.playerManager.firstPlayer;\r\n\t\t\t\tfirstPlayer && (firstPlayer._baseVehicle.color = value,\r\n\t\t\t\tfirstPlayer._tempVehicle && (firstPlayer._tempVehicle.color = value));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'bikeTireColor':\r\n\t\t\t\tvar baseVehicle = this.scene.playerManager.firstPlayer._baseVehicle;\r\n\t\t\t\tbaseVehicle && (baseVehicle.frontWheel.color = value,\r\n\t\t\t\tbaseVehicle.rearWheel.color = value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'brightness':\r\n\t\t\t\tthis.constructor.styleSheet.set('#game-container', Object.assign({}, this.constructor.styleSheet.get('#game-container'), {\r\n\t\t\t\t\tfilter: 'brightness(' + value / 100 + ')'\r\n\t\t\t\t}));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'curveBreakLength':\r\n\t\t\t\tthis.scene.toolHandler.tools.hasOwnProperty('curve') && (this.scene.toolHandler.tools.curve.options.breakLength = value / 100);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'curvePoints':\r\n\t\t\t\tthis.scene.toolHandler.tools.hasOwnProperty('curve') && (this.scene.toolHandler.tools.curve.options.controlPoints = value - 2);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'disableAnalytics':\r\n\t\t\t\tGameSettings.analyticsEnabled = !value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'keymap':\r\n\t\t\t\tthis.scene.playerManager.firstPlayer._gamepad.setKeyMap(GameManager.scene !== 'Editor' ? GameSettings.playHotkeys : GameSettings.editorHotkeys);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'theme':\r\n\t\t\t\tconst theme = this._getColorScheme(value);\r\n\t\t\t\tlet backgroundColor = '#'.padEnd(7, theme == 'midnight' ? '1d2328' : theme == 'darker' ? '0' : theme == 'dark' ? '1b' : 'f');\r\n\t\t\t\tthis.constructor.styleSheet.set('#game-container > canvas', Object.assign({}, this.constructor.styleSheet.get('#game-container > canvas'), { backgroundColor }));\r\n\t\t\t\tthis.constructor.styleSheet.set('.gameFocusOverlay', {\r\n\t\t\t\t\tbackgroundColor: getComputedStyle(GameManager.game.canvas).backgroundColor.replace(/[,]/g, '').replace(/(?=\\))/, '/90%'),\r\n\t\t\t\t\tcolor: '#'.padEnd(7, theme == 'midnight' ? 'd' : theme == 'dark' ? 'f' : theme == 'dark' ? 'eb' : '2d')\r\n\t\t\t\t});\r\n\t\t\t\tthis.scene.message.color = '#'.padEnd(7, /^(dark(er)?|midnight)$/i.test(theme) ? 'c' : '3');\r\n\t\t\t\tthis.scene.message.outline = backgroundColor;\r\n\t\t\t\tlet gray = '#'.padEnd(7, /^(dark(er)?|midnight)$/i.test(theme) ? '6' : '9');\r\n\t\t\t\tthis.scene.score.best_time.color = gray;\r\n\t\t\t\tthis.scene.score.best_time_title.color = gray;\r\n\t\t\t\tlet color = '#'.padEnd(7, theme == 'midnight' ? 'd' : /^dark(er)?$/i.test(theme) ? 'f' : '0');\r\n\t\t\t\tthis.scene.score.goals.color = color;\r\n\t\t\t\tthis.scene.score.time.color = color;\r\n\t\t\t\tthis.scene.score.time_title.color = gray;\r\n\t\t\t\tif (this.scene.hasOwnProperty('campaignScore')) {\r\n\t\t\t\t\tthis.scene.campaignScore.container.children.forEach(medal => {\r\n\t\t\t\t\t\tmedal.children.forEach(element => {\r\n\t\t\t\t\t\t\telement.color = color\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.scene.hasOwnProperty('raceTimes')) {\r\n\t\t\t\t\tthis.scene.raceTimes.container.color = color;\r\n\t\t\t\t\tthis.scene.raceTimes.raceList.forEach(race => {\r\n\t\t\t\t\t\trace.children.forEach(element => {\r\n\t\t\t\t\t\t\telement.color = color\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tGameSettings.physicsLineColor = '#'.padEnd(7, theme == 'midnight' ? 'c' : /^dark(er)?$/.test(theme) ? 'fd' : '0');\r\n\t\t\t\tGameSettings.sceneryLineColor = '#'.padEnd(7, theme == 'midnight' ? '5' : theme == 'darker' ? '121319' : theme == 'dark' ? '6' : 'a');\r\n\t\t\t\tthis.scene.toolHandler.options.gridMinorLineColor = '#'.padEnd(7, theme == 'midnight' ? '20282e' : /^dark(er)?$/.test(theme) ? '25' : 'e');\r\n\t\t\t\tthis.scene.toolHandler.options.gridMajorLineColor = '#'.padEnd(7, theme == 'midnight' ? '161b20' : /^dark(er)?$/.test(theme) ? '3e' : 'c');\r\n\t\t\t\tthis.scene.track.powerups.forEach(p => p.outline = GameSettings.physicsLineColor);\r\n\t\t\t\tvar firstPlayer = this.scene.playerManager.firstPlayer;\r\n\t\t\t\tfirstPlayer && (firstPlayer._baseVehicle.color = GameSettings.physicsLineColor,\r\n\t\t\t\tfirstPlayer._tempVehicle && (firstPlayer._tempVehicle.color = GameSettings.physicsLineColor));\r\n\t\t\tcase 'isometricGrid':\r\n\t\t\t\tredraw = true\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tchildLoad && this._childLoad(),\r\n\t\tredraw && this.scene.redraw(),\r\n\t\tthis.refresh()\r\n\t}\r\n\r\n\t_updateBaseVehicle(baseVehicle) {\r\n\t\tif (!baseVehicle) return;\r\n\t\tlet frameColor, tireColor;\r\n\t\tif (baseVehicle.player !== this.scene.playerManager.firstPlayer) {\r\n\t\t\tlet playback = baseVehicle.player._gamepad.playback;\r\n\t\t\tif (!playback || !playback.hasOwnProperty('bike_options')) return;\r\n\t\t\tplayback.bike_options.has('frameColor') && (frameColor = playback.bike_options.get('frameColor')),\r\n\t\t\tplayback.bike_options.has('tireColor') && (tireColor = playback.bike_options.get('tireColor'));\r\n\t\t} else\r\n\t\t\tframeColor = this.storage.get('bikeFrameColor'),\r\n\t\t\ttireColor = this.storage.get('bikeTireColor');\r\n\t\tlet colorMatch = /^#([a-f0-9]{3}){1,2}$/i;\r\n\t\tcolorMatch.test(frameColor) && (baseVehicle.color = frameColor),\r\n\t\tcolorMatch.test(tireColor) && (baseVehicle.frontWheel.color = tireColor,\r\n\t\tbaseVehicle.rearWheel.color = tireColor)\r\n\t}\r\n\r\n\t_updateMediaSessionMetadata() {\r\n\t\tif ('mediaSession' in navigator) {\r\n\t\t\tnavigator.mediaSession.metadata = new MediaMetadata({\r\n\t\t\t\ttitle: this.trackData.title,\r\n\t\t\t\tartist: this.trackData.author.d_name,\r\n\t\t\t\talbum: '',\r\n\t\t\t\tartwork: [{\r\n\t\t\t\t\tsrc: this.trackData.img,\r\n\t\t\t\t\tsizes: \"250x150\",\r\n\t\t\t\t\ttype: \"image/png\",\r\n\t\t\t\t}]\r\n\t\t\t});\r\n\t\t\tnavigator.mediaSession.setActionHandler('play', () => {\r\n\t\t\t\tthis.scene.state.inFocus = true,\r\n\t\t\t\tthis.scene.state.paused = false,\r\n\t\t\t\tthis.scene.state.playing = true\r\n\t\t\t});\r\n\t\t\tnavigator.mediaSession.setActionHandler('pause', () => {\r\n\t\t\t\tthis.scene.state.paused = true,\r\n\t\t\t\tthis.scene.state.playing = false\r\n\t\t\t});\r\n\t\t\tnavigator.mediaSession.setActionHandler('seekbackward', () => {\r\n\t\t\t\tlet player = GameManager.game.currentScene.playerManager.getPlayerByIndex(GameManager.game.currentScene.camera.focusIndex);\r\n\t\t\t\tplayer.isGhost() && player._replayIterator.next((player._gamepad.playbackTicks ?? GameManager.game.currentScene.ticks) - 5)\r\n\t\t\t});\r\n\t\t\tnavigator.mediaSession.setActionHandler('seekto', event => {\r\n\t\t\t\tlet player = GameManager.game.currentScene.playerManager.getPlayerByIndex(GameManager.game.currentScene.camera.focusIndex);\r\n\t\t\t\tplayer.isGhost() && player._replayIterator.next(event.seekTime)\r\n\t\t\t});\r\n\t\t\tnavigator.mediaSession.setActionHandler('seekforward', () => {\r\n\t\t\t\tlet player = GameManager.game.currentScene.playerManager.getPlayerByIndex(GameManager.game.currentScene.camera.focusIndex);\r\n\t\t\t\tplayer.isGhost() && player._replayIterator.next((player._gamepad.playbackTicks ?? GameManager.game.currentScene.ticks) + 5)\r\n\t\t\t});\r\n\t\t\tnavigator.mediaSession.setActionHandler('nexttrack', () => {\r\n\t\t\t\tApplication.router.do_route(\"t/\" + (this.trackData.id + 1), {\r\n\t\t\t\t\ttrigger: !0,\r\n\t\t\t\t\treplace: !1\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t\tnavigator.mediaSession.setActionHandler('previoustrack', () => {\r\n\t\t\t\tApplication.router.do_route(\"t/\" + (this.trackData.id - 1), {\r\n\t\t\t\t\ttrigger: !0,\r\n\t\t\t\t\treplace: !1\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t_updateMediaSessionPosition() {\r\n\t\tif ('mediaSession' in navigator && 'setPositionState' in navigator.mediaSession) {\r\n\t\t\tthis.replayGui && navigator.mediaSession.setPositionState({\r\n\t\t\t\tduration: this.replayGui.progress.max,\r\n\t\t\t\tplaybackRate: 1, // this.replayGui.progress.step?\r\n\t\t\t\tposition: this.replayGui.progress.value\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tattachContextMenu() {\r\n\t\tif (!this._oncontextmenu) {\r\n\t\t\tObject.defineProperty(this, '_oncontextmenu', {\r\n\t\t\t\tvalue: async event => {\r\n\t\t\t\t\tlet currentUser = event.target.closest('.left-nav-profile-top');\r\n\t\t\t\t\tif (null !== currentUser) {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tconst options = await this.buildUserContextMenu(Application.settings.user);\r\n\t\t\t\t\t\tconst accounts = this.constructor.getStorageEntry('account-manager') ?? [];\r\n\t\t\t\t\t\tconst subOptions = accounts.map(account => ({\r\n\t\t\t\t\t\t\tname: account.login,\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post(\"/auth/standard_login\", account).done(r => {\r\n\t\t\t\t\t\t\t\tr.result && Application.events.publish(\"auth.login\", r.data.user, r.data.user_stats)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\taccounts.length > 0 && subOptions.push({ type: 'hr' }) || subOptions.push({\r\n\t\t\t\t\t\t\tname: 'Add Account',\r\n\t\t\t\t\t\t\t// click: () => this.constructor.getAccountManager({ createIfNotExists: true, showLogin: true }).showModal('login')\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.TemplateHelper.getTemplates([\"auth/signup_login\"], function(t) {\r\n\t\t\t\t\t\t\t\tApplication.router.auth_dialog_view.template = t[\"auth/signup_login\"],\r\n\t\t\t\t\t\t\t\tApplication.router.auth_dialog_view.options = Object.assign({}, Application.settings, { login: true }),\r\n\t\t\t\t\t\t\t\tApplication.router.auth_dialog_view.setup()\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tsubOptions.push({\r\n\t\t\t\t\t\t\tname: 'Manage Accounts',\r\n\t\t\t\t\t\t\tclick: () => this.constructor.getAccountManager({ createIfNotExists: true }).showModal()\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\toptions.splice(3, 0, {\r\n\t\t\t\t\t\t\tname: 'Switch Accounts',\r\n\t\t\t\t\t\t\toptions: subOptions\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Logout',\r\n\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.User.logout()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(options, event);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// let gameContiner = event.target.closest('#game-container');\r\n\t\t\t\t\t// if (null !== gameContiner) {\r\n\t\t\t\t\t// \tevent.preventDefault();\r\n\t\t\t\t\t// \tconst options = [{\r\n\t\t\t\t\t// \t\tname: 'Input Display',\r\n\t\t\t\t\t// \t\ttype: 'checkbox'\r\n\t\t\t\t\t// \t}];\r\n\t\t\t\t\t// \tContextMenu.create(options, event);\r\n\t\t\t\t\t// \treturn;\r\n\t\t\t\t\t// }\r\n\r\n\t\t\t\t\tthis.trackData === null && this.cacheTrackData();\r\n\t\t\t\t\t// track-list-tile\r\n\t\t\t\t\tlet race = event.target.closest('.track-leaderboard-race-row');\r\n\t\t\t\t\tif (null !== race) {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tif (event.target.closest('.name')) {\r\n\t\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(await this.buildUserContextMenu(race.dataset), event);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst reports = this.constructor.fetchReports('\\'{data-u_id}\\' by @{data-d_name}', race.dataset, { type: 'race' });\r\n\t\t\t\t\t\tconst options = [{\r\n\t\t\t\t\t\t\tname: 'Race',\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('track_api/load_races', {\r\n\t\t\t\t\t\t\t\tt_id: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\tu_ids: race.dataset.u_id\r\n\t\t\t\t\t\t\t}).then(r => r.result && this.scene.addRaces(r.data))\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Copy Race Data', // 'Request Race Data',\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('track_api/load_races', {\r\n\t\t\t\t\t\t\t\tt_id: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\tu_ids: race.dataset.u_id\r\n\t\t\t\t\t\t\t}).then(r => r.result && navigator.clipboard.writeText(JSON.stringify(r.data, '\\t', 4)).catch(err => alert(err.message)))\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: race.dataset.legitimacy || 'Test Legitimacy',\r\n\t\t\t\t\t\t\tstyles: race.dataset.legitimacy && ['disabled'],\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('track_api/load_races', {\r\n\t\t\t\t\t\t\t\tt_id: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\tu_ids: race.dataset.u_id\r\n\t\t\t\t\t\t\t}).then(({ data, result: r }) => {\r\n\t\t\t\t\t\t\t\tif (!r) return alert('Race not found.');\r\n\t\t\t\t\t\t\t\tlet [entry] = this.scene.formatRaces(data);\r\n\t\t\t\t\t\t\t\tlet isTas = !this.constructor.verifyRaceData(entry);\r\n\t\t\t\t\t\t\t\trace.dataset.legitimacy = isTas ? 'Illegitimate (TAS)' : 'Legit';\r\n\t\t\t\t\t\t\t\tisTas && this.updateTASLeaderboard([entry]);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, this.constructor.isUserModerator(Application.settings.user) || (Application.settings.user.u_id == race.dataset.u_id ? {\r\n\t\t\t\t\t\t\tname: 'Request Deletion',\r\n\t\t\t\t\t\t\tstyles: ['danger', race.dataset.requested && 'disabled'],\r\n\t\t\t\t\t\t\tclick: () => this.constructor.report('Race \\'{data-u_id}\\' by @{data-d_name}', race.dataset, { type: 'request' }).then(() => {\r\n\t\t\t\t\t\t\t\trace.dataset.requested = true\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} : {\r\n\t\t\t\t\t\t\tname: 'Report',\r\n\t\t\t\t\t\t\tstyles: ['danger', (race.dataset.reported || reports.length > 0) && 'disabled'],\r\n\t\t\t\t\t\t\tclick: () => this.constructor.report('Race \\'{data-u_id}\\' by @{data-d_name}', race.dataset, { type: 'race' }).then(() => {\r\n\t\t\t\t\t\t\t\trace.dataset.reported = true\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})];\r\n\t\t\t\t\t\tif (Application.settings.user.u_id != race.dataset.u_id) {\r\n\t\t\t\t\t\t\tconst raceData = GameManager.game.currentScene.races.find(({ user: u }) => u.u_id == race.dataset.u_id);\r\n\t\t\t\t\t\t\tif (raceData) {\r\n\t\t\t\t\t\t\t\tconst cosmetics = await this.constructor.fetchCurrentUserCosmetics();\r\n\t\t\t\t\t\t\t\tconst item = raceData.user.cosmetics.head;\r\n\t\t\t\t\t\t\t\tconst hasItem = cosmetics.gear.head_gear.length > 0 && cosmetics.gear.head_gear.find(({ id }) => id == item.id);\r\n\t\t\t\t\t\t\t\toptions.splice(options.length - 2, 0, {\r\n\t\t\t\t\t\t\t\t\tname: (hasItem ? 'Equip' : 'Preview') + ' Head',\r\n\t\t\t\t\t\t\t\t\tstyles: GameManager.game.currentScene.playerManager.firstPlayer._user.cosmetics.head.id == item.id && ['disabled'],\r\n\t\t\t\t\t\t\t\t\tclick: () => {\r\n\t\t\t\t\t\t\t\t\t\tfor (let player of GameManager.game.currentScene.playerManager._players.filter(({ _user: u }) => u.u_id == Application.settings.user.u_id)) {\r\n\t\t\t\t\t\t\t\t\t\t\tplayer._user.cosmetics.head = item\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn hasItem && Application.Helpers.AjaxHelper.post('store/equip', { item_id: item.id })\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tApplication.settings.user.u_id == race.dataset.u_id && options.splice(options.length - 1, 0, {\r\n\t\t\t\t\t\t\tname: race.title || 'Check Date',\r\n\t\t\t\t\t\t\tstyles: race.title && ['disabled'],\r\n\t\t\t\t\t\t\tclick: () => this.constructor.fetchRaceBestDate().then(date => race.setAttribute('title', date))\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Download',\r\n\t\t\t\t\t\t\tclick: () => this.constructor.downloadRace(this.trackData.t_id, race.dataset.u_id)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (Application.settings.user.moderator) {\r\n\t\t\t\t\t\t\tlet targetUser = await this.constructor.fetchUser(race.dataset.d_name);\r\n\t\t\t\t\t\t\toptions.splice(options.length - 1, 0, {\r\n\t\t\t\t\t\t\t\tname: 'Feature',\r\n\t\t\t\t\t\t\t\tclick: () =>  navigator.clipboard.writeText('\"frhd.co/t/' + this.trackData.t_id + '/r/' + race.dataset.d_name.toLowerCase() + '\": \"\"').then(() => {\r\n\t\t\t\t\t\t\t\t\twindow.open('https://github.com/Calculamatrise/frhd-featured-ghosts/edit/master/data.json', 'blank')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\t\tname: 'Delete',\r\n\t\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('moderator/remove_race', {\r\n\t\t\t\t\t\t\t\t\tt_id: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\t\tu_id: race.dataset.u_id\r\n\t\t\t\t\t\t\t\t}).then(r => r.result && (race.remove(),\r\n\t\t\t\t\t\t\t\tApplication.router.current_view.refresh_leaderboard())).fail(err => alert('Something went wrong! ' + err.message))\r\n\t\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\t\tname: 'Delete & Ban', // only show if mod\r\n\t\t\t\t\t\t\t\tstyles: ['danger', targetUser.user.banned && 'disabled'],\r\n\t\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('moderator/remove_race', {\r\n\t\t\t\t\t\t\t\t\tt_id: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\t\tu_id: race.dataset.u_id\r\n\t\t\t\t\t\t\t\t}).then(r => r.result && (race.remove(),\r\n\t\t\t\t\t\t\t\tApplication.router.current_view.refresh_leaderboard(),\r\n\t\t\t\t\t\t\t\tApplication.Helpers.AjaxHelper.post('moderator/ban_user', {\r\n\t\t\t\t\t\t\t\t\tu_id: race.dataset.u_id\r\n\t\t\t\t\t\t\t\t}))).fail(err => alert('Something went wrong! ' + err.message))\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.storage.get('developerMode') && options.push({ type: 'hr' }, {\r\n\t\t\t\t\t\t\tname: 'Copy Racer Id',\r\n\t\t\t\t\t\t\tclick: () => navigator.clipboard.writeText(race.dataset.u_id)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(options, event);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet leaderboard = event.target.closest('.track-leaderboard');\r\n\t\t\t\t\tif (null !== leaderboard) {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tconst options = [{\r\n\t\t\t\t\t\t\tname: 'Race All',\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('track_api/load_races', {\r\n\t\t\t\t\t\t\t\tt_id: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\tu_ids: Array.from(leaderboard.querySelectorAll('.track-leaderboard-race-row')).map(row => row.dataset.u_id).join(',')\r\n\t\t\t\t\t\t\t}).then(r => r.result && this.scene.addRaces(r.data))\r\n\t\t\t\t\t\t}, { type: 'hr' }, this.constructor.isUserModerator(Application.settings.user) || {\r\n\t\t\t\t\t\t\tname: 'Report',\r\n\t\t\t\t\t\t\tstyles: ['danger'], // check session storage and disable button\r\n\t\t\t\t\t\t\tclick: () => this.constructor.report('Leaderboard', {}, { type: 'leaderboard' })\r\n\t\t\t\t\t\t}];\r\n\t\t\t\t\t\tApplication.settings.user.moderator && options.splice(options.length - 2, 0, {\r\n\t\t\t\t\t\t\tname: 'Delete All',\r\n\t\t\t\t\t\t\tstyles: ['danger', 'disabled'],\r\n\t\t\t\t\t\t\tclick: () => confirm('Are you sure you want to delete ALL races on this leaderboard? This cannot be undone.') && Promise.all(Array.from(leaderboard.querySelectorAll('.track-leaderboard-race-row')).map(row => {\r\n\t\t\t\t\t\t\t\treturn Application.Helpers.AjaxHelper.post('moderator/remove_race', {\r\n\t\t\t\t\t\t\t\t\tt_id: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\t\tu_id: row.dataset.u_id\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(options, event);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet comment = event.target.closest('.track-comment');\r\n\t\t\t\t\tif (null !== comment) {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tif (event.target.closest('.track-comment-img, a.bold')) {\r\n\t\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(await this.buildUserContextMenu(comment.dataset), event);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t} else if (event.target.tagName === 'A') {\r\n\t\t\t\t\t\t\tlet href = event.target.href;\r\n\t\t\t\t\t\t\tlet user = await this.constructor.fetchUser(href.replace(/.+\\//, '')).then(r => r.user);\r\n\t\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(await this.buildUserContextMenu(user), event);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet confirmFlag = comment.querySelector('.track-comment-confirm-flag > .yes');\r\n\t\t\t\t\t\tconst options = [{\r\n\t\t\t\t\t\t\tname: 'Reply',\r\n\t\t\t\t\t\t\tclick: () => {\r\n\t\t\t\t\t\t\t\tlet input = document.querySelector('#track-comment');\r\n\t\t\t\t\t\t\t\tinput.focus();\r\n\t\t\t\t\t\t\t\tinput.value = '@' + comment.dataset.d_name + ' ';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Copy Text',\r\n\t\t\t\t\t\t\tclick: () => navigator.clipboard.writeText(comment.querySelector('.track-comment-msg').innerText)\r\n\t\t\t\t\t\t}, Application.settings.user.d_name == comment.dataset.d_name ? {\r\n\t\t\t\t\t\t\tname: 'Delete',\r\n\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.router.current_view._delete_comment(this.trackData.t_id, comment.dataset.c_id, r => r.result && comment.remove())\r\n\t\t\t\t\t\t} : this.constructor.isUserModerator(Application.settings.user) || {\r\n\t\t\t\t\t\t\tname: 'Report',\r\n\t\t\t\t\t\t\tstyles: ['danger', confirmFlag || 'disabled'],\r\n\t\t\t\t\t\t\tclick: () => confirmFlag.click()\r\n\t\t\t\t\t\t}];\r\n\t\t\t\t\t\tApplication.settings.user.admin && options.push({ type: 'hr' }, {\r\n\t\t\t\t\t\t\tname: 'Set Messaging Ban',\r\n\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/user_ban_messaging', {\r\n\t\t\t\t\t\t\t\tmessaging_ban_uname: comment.dataset.d_name.toLowerCase()\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.storage.get('developerMode') && options.push({ type: 'hr' }, {\r\n\t\t\t\t\t\t\tname: 'Copy Comment Id',\r\n\t\t\t\t\t\t\tclick: () => navigator.clipboard.writeText(comment.dataset.c_id)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(options, event);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet track = event.target.closest('.track-about-panel > .panel-padding');\r\n\t\t\t\t\tif (null !== track) {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tif (event.target.closest('.track-about-author-img, a.bold')) {\r\n\t\t\t\t\t\t\tconst options = await this.buildUserContextMenu(this.trackData.author);\r\n\t\t\t\t\t\t\tlet subscribe = document.querySelector('#subscribe_to_author');\r\n\t\t\t\t\t\t\tApplication.settings.user.u_id != this.trackData.author_id && options.splice(3, 0, {\r\n\t\t\t\t\t\t\t\tname: subscribe.innerText,\r\n\t\t\t\t\t\t\t\tstyles: /^un/i.test(subscribe.innerText) && ['danger'],\r\n\t\t\t\t\t\t\t\tclick: () => subscribe.click()\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(options, event);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet confirmFlag = document.querySelector('.track-flag ~ .track-confirm-flag > .yes');\r\n\t\t\t\t\t\tconst options = [{\r\n\t\t\t\t\t\t\tname: 'Copy Title',\r\n\t\t\t\t\t\t\tclick: () => navigator.clipboard.writeText(track.querySelector('h1.bold').innerText)\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Copy Description',\r\n\t\t\t\t\t\t\tclick: () => navigator.clipboard.writeText(track.querySelector('.description').innerText)\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: track.dataset.last_played_date || 'Check Last Played',\r\n\t\t\t\t\t\t\tstyles: track.dataset.last_played_date && ['disabled'],\r\n\t\t\t\t\t\t\tclick: () => this.constructor.fetchTrackLastPlayedDate().then(date => track.dataset.last_played_date = date)\r\n\t\t\t\t\t\t}];\r\n\t\t\t\t\t\tlet playlist = this.fetchAndCachePlaylists('playlater');\r\n\t\t\t\t\t\tlet savedToPlaylater = playlist && playlist.has(this.trackData.t_id);\r\n\t\t\t\t\t\tlet showPlaylistButton = savedToPlaylater || this.storage.get('playlists');\r\n\t\t\t\t\t\tif (showPlaylistButton) {\r\n\t\t\t\t\t\t// if (this.storage.get('playlists')) {\r\n\t\t\t\t\t\t\t// let playlist = this.fetchAndCachePlaylists('playlater');\r\n\t\t\t\t\t\t\t// let savedToPlaylater = playlist && playlist.has(this.trackData.t_id);\r\n\t\t\t\t\t\t\t// let showPlaylistButton = savedToPlaylater || this.storage.get('playlists');\r\n\t\t\t\t\t\t\tshowPlaylistButton && options.splice(2, 0, {\r\n\t\t\t\t\t\t\t\tname: (savedToPlaylater ? 'Remove from' : 'Add to') + ' Playlist',\r\n\t\t\t\t\t\t\t\tstyles: [savedToPlaylater && 'danger', savedToPlaylater && !this.storage.get('playlists') && 'disabled'],\r\n\t\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.get('t/' + this.trackData.t_id).then(({ track, user_track_stats }) => {\r\n\t\t\t\t\t\t\t\t\tconst playlist = this.fetchAndCachePlaylists('playlater');\r\n\t\t\t\t\t\t\t\t\tplaylist[savedToPlaylater ? 'delete' : 'set'](this.trackData.t_id, {\r\n\t\t\t\t\t\t\t\t\t\tauthor: track.author,\r\n\t\t\t\t\t\t\t\t\t\taverageTime: user_track_stats.avg_time,\r\n\t\t\t\t\t\t\t\t\t\tfeatured: track.featured,\r\n\t\t\t\t\t\t\t\t\t\tid: this.trackData.t_id,\r\n\t\t\t\t\t\t\t\t\t\timg: track.img,\r\n\t\t\t\t\t\t\t\t\t\tslug: track.slug,\r\n\t\t\t\t\t\t\t\t\t\ttitle: track.title\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tplaylist.size > 0 ? this.constructor.setStorageEntry('playlists.playlater', Array.from(playlist.values())) : this.constructor.removeStorageEntry('playlists.playlater')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tApplication.settings.user.u_id == this.trackData.author_id ? (options.push({\r\n\t\t\t\t\t\t\tname: 'Download',\r\n\t\t\t\t\t\t\tclick: () => this.constructor.downloadTrack(this.trackData.t_id)\r\n\t\t\t\t\t\t}, this.constructor.isUserModerator(Application.settings.user) || {\r\n\t\t\t\t\t\t\tname: 'Request Deletion',\r\n\t\t\t\t\t\t\tstyles: ['danger', 'disabled']\r\n\t\t\t\t\t\t}, { type: 'hr' }, {\r\n\t\t\t\t\t\t\tname: 'Download All',\r\n\t\t\t\t\t\t\tclick: () => this.constructor.downloadAllTracks(Application.settings.user.u_name)\r\n\t\t\t\t\t\t})) : this.constructor.isUserModerator(Application.settings.user) || options.push({\r\n\t\t\t\t\t\t\tname: 'Report',\r\n\t\t\t\t\t\t\tstyles: ['danger', confirmFlag || 'disabled'],\r\n\t\t\t\t\t\t\tclick: () => (confirmFlag.click(),\r\n\t\t\t\t\t\t\tconfirmFlag.parentElement.remove(),\r\n\t\t\t\t\t\t\tdocument.querySelector('.track-flag')?.remove())\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tApplication.settings.user.moderator && options.push({ type: 'hr' }, {\r\n\t\t\t\t\t\t\tname: 'Add to Track of the Day',\r\n\t\t\t\t\t\t\tstyles: ['disabled']\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: (GameSettings.track.featured ? 'Unf' : 'F') + 'eature',\r\n\t\t\t\t\t\t\tstyles: GameSettings.track.featured && ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('track_api/feature_track/' + this.trackData.t_id + '/' + (1 - GameSettings.track.featured)).then(r => {\r\n\t\t\t\t\t\t\t\tr.result && (this.trackData.featured = !this.trackData.featured,\r\n\t\t\t\t\t\t\t\tGameSettings.track.featured = this.trackData.featured)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: (this.trackData.hide ? 'Unh' : 'H') + 'ide', // unhide if hidden\r\n\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.get('moderator/hide_track/' + this.trackData.t_id).then(r => {\r\n\t\t\t\t\t\t\t\tr.result && (this.trackData.hide = 1 - this.trackData.hide,\r\n\t\t\t\t\t\t\t\tGameSettings.track.hide = this.trackData.hide)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tApplication.settings.user.admin && options.push({ type: 'hr' }, {\r\n\t\t\t\t\t\t\tname: 'Remove Track of the Day',\r\n\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/removeTrackOfTheDay', {\r\n\t\t\t\t\t\t\t\tt_id: this.trackData.t_id\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: (this.trackData.hide ? 'Unh' : 'H') + 'ide', // unhide if hidden\r\n\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/' + (this.trackData.hide ? 'un' : '') + 'hide_track', { track_id: this.trackData.t_id }).then(r => {\r\n\t\t\t\t\t\t\t\tr.result && (this.trackData.hide = 1 - this.trackData.hide,\r\n\t\t\t\t\t\t\t\tGameSettings.track.hide = this.trackData.hide)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tname: 'Set Uploading Ban',\r\n\t\t\t\t\t\t\tstyles: ['danger'],\r\n\t\t\t\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/user_ban_uploading', {\r\n\t\t\t\t\t\t\t\tuploading_ban_uname: this.trackData.author.u_name\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.storage.get('developerMode') && options.push({ type: 'hr' }, {\r\n\t\t\t\t\t\t\tname: 'Copy Track Id',\r\n\t\t\t\t\t\t\tclick: () => navigator.clipboard.writeText(this.trackData.t_id)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t_ContextMenu_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].create(options, event);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\twritable: true\r\n\t\t\t});\r\n\t\t\tthis.constructor.styleSheet.set('context-menu', {\r\n\t\t\t\tfontSize: 'clamp(9px, .75rem, 13px)',\r\n\t\t\t\tzIndex: 1002\r\n\t\t\t})\r\n\t\t\t.set('context-menu, context-menu > :not(br, div, hr) > *', {\r\n\t\t\t\tbackgroundColor: 'hsl(200deg 15% 15%)',\r\n\t\t\t\tborder: '1px solid hsl(200deg 25% 25% / 50%)',\r\n\t\t\t\tborderRadius: '.25rem',\r\n\t\t\t\tboxShadow: '2px 2px 4px -1px hsl(0deg 0% 10% / 75%)',\r\n\t\t\t\tdisplay: 'flex',\r\n\t\t\t\tflexDirection: 'column',\r\n\t\t\t\tmaxHeight: '50vh',\r\n\t\t\t\t// overflow: 'hidden auto',\r\n\t\t\t\tpadding: '.275em',\r\n\t\t\t\tposition: 'absolute'\r\n\t\t\t})\r\n\t\t\t.set('context-menu > :not(br, div, hr):has(> *)', { position: 'relative' })\r\n\t\t\t.set('context-menu > :not(br, div, hr):has(> *)::after', {\r\n\t\t\t\tcolor: 'hsl(0deg 0% 50% / 75%)',\r\n\t\t\t\tcontent: '\"❯\"',\r\n\t\t\t\tdisplay: 'inline-block',\r\n\t\t\t\tfontSize: '.75em',\r\n\t\t\t\theight: '1rem',\r\n\t\t\t\tmarginLeft: '2.25em',\r\n\t\t\t\tverticalAlign: 'middle'\r\n\t\t\t})\r\n\t\t\t.set('context-menu > :not(br, div, hr):has(> :not(:hover)):not(:hover) > *', { /* display: 'none' */ visibility: 'hidden' })\r\n\t\t\t.set('context-menu > :not(br, div, hr) > *', {\r\n\t\t\t\t// left: '100%',\r\n\t\t\t\t// top: 0,\r\n\t\t\t\twidth: 'max-content'\r\n\t\t\t})\r\n\t\t\t.set('context-menu > :not(br, div, hr), context-menu button', {\r\n\t\t\t\tbackgroundColor: 'transparent',\r\n\t\t\t\tborder: 'none',\r\n\t\t\t\tborderRadius: '0.25em',\r\n\t\t\t\tcolor: 'white',\r\n\t\t\t\tpadding: '0.5em 1em',\r\n\t\t\t\ttextAlign: 'left'\r\n\t\t\t})\r\n\t\t\t.set('context-menu > :not(br, div, hr):hover, context-menu button:hover', { backdropFilter: 'brightness(0.725)' })\r\n\t\t\t.set('context-menu hr', {\r\n\t\t\t\tbackgroundColor: 'hsl(200deg 20% 25% / 60%)',\r\n\t\t\t\tborder: 'none',\r\n\t\t\t\theight: '1px',\r\n\t\t\t\twidth: '90%'\r\n\t\t\t})\r\n\t\t\t.set('button.danger', { color: 'hsl(0deg, 75%, 55%)' })\r\n\t\t\t.set('button.danger:disabled', { color: 'hsl(0deg 75% 55% / 50%)' })\r\n\t\t\t.set('context-menu::-webkit-scrollbar', { width: '.5em' })\r\n\t\t\t.set('context-menu::-webkit-scrollbar, context-menu::-webkit-scrollbar-track', { backgroundColor: 'hsl(0deg 0% 0% / 4%)' })\r\n\t\t\t.set('context-menu::-webkit-scrollbar-thumb', { backgroundColor: 'hsl(200deg 25% 20% / 50%)' });\r\n\t\t}\r\n\t\tdocument.removeEventListener('contextmenu', this._oncontextmenu),\r\n\t\tdocument.addEventListener('contextmenu', this._oncontextmenu)\r\n\t}\r\n\r\n\tasync buildUserContextMenu(data) {\r\n\t\tdata = Object.assign({}, data);\r\n\t\t!data.u_name && data.d_name && (data.u_name = data.d_name.toLowerCase());\r\n\t\tlet isCurrentUser = Application.settings.user.u_id == data.u_id || Application.settings.user.u_name == data.u_name;\r\n\t\tconst options = [{\r\n\t\t\tname: 'Profile',\r\n\t\t\tclick: () => Application.router.do_route('u/' + (data.u_name || data.d_name.toLowerCase()))\r\n\t\t}, {\r\n\t\t\tname: 'Copy Username',\r\n\t\t\tclick: () => navigator.clipboard.writeText(data.d_name)\r\n\t\t}];\r\n\t\tif (!isCurrentUser) {\r\n\t\t\tlet currentUser = await this.constructor.fetchCurrentUser();\r\n\t\t\tlet isFriend = currentUser.friends.friends_data.find(this.constructor.compareUsers.bind(this, data));\r\n\t\t\tlet request = currentUser.friend_requests.request_data.find(this.constructor.compareUsers.bind(this, data));\r\n\t\t\tconst reports = this.constructor.fetchReports('@{data-d_name} ({data-u_id})', data, { type: 'user' });\r\n\t\t\tconst cachedReports = this.constructor.getStorageEntry('reports.users');\r\n\t\t\tconst reported = cachedReports && cachedReports.includes(data.u_id);\r\n\t\t\toptions.splice(2, 0, {\r\n\t\t\t\tname: (isFriend ? 'Remove' : 'Add') + ' Friend',\r\n\t\t\t\tstyles: [isFriend && 'danger', !isFriend && currentUser.friends.friend_cnt >= 30 && 'disabled'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('friends/' + (isFriend ? 'remove_friend' : 'send_friend_request'), { u_name: data.d_name })\r\n\t\t\t}, this.constructor.isUserModerator(Application.settings.user) || {\r\n\t\t\t\tname: 'Report',\r\n\t\t\t\tstyles: ['danger', (reported || reports.length > 0) && 'disabled'], // check session storage and disable button\r\n\t\t\t\t// if more than one ghost is reported, report the leaderboard instead and disable all ghost reports on track\r\n\t\t\t\tclick: () => this.constructor.report('User @{data-d_name} ({data-u_id})', data, { type: 'user' }).then(() => {\r\n\t\t\t\t\tthis.constructor.updateStorageEntry('reports.users', [data.u_id])\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t\trequest && options.splice(3, 0, {\r\n\t\t\t\tname: 'Accept Friend Request',\r\n\t\t\t\tstyles: !data.u_id && ['disabled'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('friends/respond_to_friend_request', {\r\n\t\t\t\t\tu_id: data.u_id,\r\n\t\t\t\t\taction: 'accept'\r\n\t\t\t\t})\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Reject Friend Request',\r\n\t\t\t\tstyles: ['danger', !data.u_id && 'disabled'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('friends/respond_to_friend_request', {\r\n\t\t\t\t\tu_id: data.u_id,\r\n\t\t\t\t\taction: 'decline'\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\toptions.splice(2, 0, {\r\n\t\t\t\tname: 'Edit Profile',\r\n\t\t\t\tclick: () => Application.router.do_route('account/settings')\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (Application.settings.user.moderator) {\r\n\t\t\tlet targetUser = await this.constructor.fetchUser(data.d_name || data.u_name || data.u_id);\r\n\t\t\toptions.push({ type: 'hr' }, {\r\n\t\t\t\tname: 'Change Email',\r\n\t\t\t\tclick: () => (email => email && email.includes('@') && Application.Helpers.AjaxHelper.post('moderator/change_email', {\r\n\t\t\t\t\tu_id: data.u_id,\r\n\t\t\t\t\temail\r\n\t\t\t\t}))(prompt('Enter the new email address:'))\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Change Username',\r\n\t\t\t\tclick: () => (username => username && Application.Helpers.AjaxHelper.post('moderator/change_username', {\r\n\t\t\t\t\tu_id: data.u_id,\r\n\t\t\t\t\tusername\r\n\t\t\t\t}))(prompt('Enter the new username:'))\r\n\t\t\t}, {\r\n\t\t\t\tname: (targetUser.user.classic ? 'Remove' : 'Set') + ' Official Author',\r\n\t\t\t\tstyles: targetUser.user.classic && ['danger'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('moderator/toggle_official_author/' + data.u_id)\r\n\t\t\t}, {\r\n\t\t\t\tname: (targetUser.user.banned ? 'Unb' : 'B') + 'an',\r\n\t\t\t\tstyles: ['danger'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('moderator/ban_user', {\r\n\t\t\t\t\tu_id: data.u_id\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (Application.settings.user.admin) {\r\n\t\t\tconst username = data.u_name || data.d_name.toLowerCase();\r\n\t\t\toptions.push({ type: 'hr' }, {\r\n\t\t\t\tname: 'Change Email',\r\n\t\t\t\tclick: () => (email => email && Application.Helpers.AjaxHelper.post('admin/change_user_email', {\r\n\t\t\t\t\tusername,\r\n\t\t\t\t\temail\r\n\t\t\t\t}))(prompt('Enter the new email address:'))\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Change Username',\r\n\t\t\t\tclick: () => (uname => uname && Application.Helpers.AjaxHelper.post('admin/change_username', {\r\n\t\t\t\t\tchange_username_current: username,\r\n\t\t\t\t\tchange_username_new: uname\r\n\t\t\t\t}))(prompt('Enter the new username:'))\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Toggle Classic User',\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/toggle_classic_user', {\r\n\t\t\t\t\ttoggle_classic_uname: username\r\n\t\t\t\t})\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Set Admin Ban',\r\n\t\t\t\tstyles: ['danger'],\r\n\t\t\t\tclick: () => ((ban_secs, delete_race_stats) => ban_secs !== null && delete_race_stats !== null && Application.Helpers.AjaxHelper.post('admin/user_ban_messaging', {\r\n\t\t\t\t\tban_secs,\r\n\t\t\t\t\tusername,\r\n\t\t\t\t\tdelete_race_stats\r\n\t\t\t\t}))(prompt('How long should this ban last? (in seconds)'), confirm('Would you like to delete race stats?'))\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Set Messaging Ban',\r\n\t\t\t\tstyles: ['danger'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/user_ban_messaging', {\r\n\t\t\t\t\tmessaging_ban_uname: username\r\n\t\t\t\t})\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Set Uploading Ban',\r\n\t\t\t\tstyles: ['danger'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/user_ban_uploading', {\r\n\t\t\t\t\tuploading_ban_uname: username\r\n\t\t\t\t})\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Deactivate User',\r\n\t\t\t\tstyles: ['danger'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/deactivate_user', { username })\r\n\t\t\t}, {\r\n\t\t\t\tname: 'Delete User Account',\r\n\t\t\t\tstyles: ['danger'],\r\n\t\t\t\tclick: () => Application.Helpers.AjaxHelper.post('admin/delete_user_account', { username })\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.storage.get('developerMode') && options.push({ type: 'hr' }, {\r\n\t\t\tname: 'Copy User Id',\r\n\t\t\tclick: () => navigator.clipboard.writeText(data.u_id)\r\n\t\t});\r\n\t\treturn options\r\n\t}\r\n\r\n\tcacheTrackData() {\r\n\t\tlet trackData = document.querySelector('#track-data');\r\n\t\tlet combined = Object.assign({}, trackData && trackData.dataset, window.hasOwnProperty('GameSettings') && GameSettings.track);\r\n\t\tthis.trackData = Object.keys(combined).length > 0 ? Object.assign(combined, {\r\n\t\t\tauthor: {\r\n\t\t\t\td_name: combined.author,\r\n\t\t\t\tu_id: parseInt(combined.author_id || combined.u_id),\r\n\t\t\t\tu_name: combined.u_url || combined.author?.toLowerCase()\r\n\t\t\t}\r\n\t\t}) : null\r\n\t}\r\n\r\n\tfetchChallengeLeaderboard({ createIfNotExists } = {}) {\r\n\t\tlet leaderboard = document.querySelector('#race_leaderboard');\r\n\t\tif (!leaderboard && createIfNotExists) {\r\n\t\t\tlet container = document.querySelector('#track_best_times');\r\n\t\t\tif (!container) return;\r\n\t\t\tlet fragmentFromString = str => new DOMParser().parseFromString(str, 'text/html').body.childNodes[0];\r\n\t\t\tleaderboard = fragmentFromString(Application.Helpers.TemplateHelper.render(Application.router.current_view.templates['track/track_race_leaderboard'], {}, {\r\n\t\t\t\trace_leaderboard: [] // GameManager.game.currentScene.races\r\n\t\t\t}));\r\n\t\t\tcontainer.prepend(leaderboard);\r\n\t\t}\r\n\r\n\t\tlet tbody = leaderboard.querySelector('table > tbody');\r\n\t\tif (!tbody && createIfNotExists) {\r\n\t\t\tlet table = leaderboard.querySelector('table');\r\n\t\t\ttbody = table.appendChild(document.createElement('tbody'));\r\n\t\t}\r\n\t\tleaderboard.style.removeProperty('display');\r\n\t\treturn tbody || null\r\n\t}\r\n\r\n\tfetchTASLeaderboard({ createIfNotExists } = {}) {\r\n\t\tlet leaderboard = document.querySelector('#frhd-lite\\\\.tas-leaderboard > table > tbody');\r\n\t\tif (!leaderboard && createIfNotExists) {\r\n\t\t\tlet globalLeaderboard = document.querySelector('#track_leaderboard');\r\n\t\t\tif (!globalLeaderboard) return;\r\n\t\t\tleaderboard = globalLeaderboard.cloneNode(true);\r\n\t\t\tleaderboard.setAttribute('id', this.constructor.keyify('tas-leaderboard'));\r\n\t\t\tlet title = leaderboard.querySelector('h3:first-child');\r\n\t\t\ttitle.setAttribute('title', 'Tool-assisted speedruns');\r\n\t\t\ttitle.innerText = 'TAS BEST TIMES';\r\n\t\t\tglobalLeaderboard.after(leaderboard);\r\n\t\t\tleaderboard = leaderboard.querySelector('table > tbody');\r\n\t\t\tleaderboard.replaceChildren();\r\n\t\t}\r\n\t\treturn leaderboard || null\r\n\t}\r\n\r\n\tfetchAndCachePlaylists(name) {\r\n\t\ttypeof name == 'string' && !this.playlists.has(name) && this.playlists.set(name, new Map());\r\n\t\tfor (let key of this.playlists.keys()) {\r\n\t\t\tif (typeof name == 'string' && key !== name) continue;\r\n\t\t\tconst entries = this.constructor.getStorageEntry('playlists.' + key);\r\n\t\t\tif (null === entries) continue;\r\n\t\t\tconst playlist = this.playlists.get(key);\r\n\t\t\tfor (const entry of entries) {\r\n\t\t\t\tplaylist.set(String(parseInt(entry.id)), entry);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn name ? this.playlists.get(name) || null : this.playlists\r\n\t}\r\n\r\n\trefresh() {\r\n\t\tlet keymap = this.storage.get('keymap');\r\n\t\tfor (let key in keymap)\r\n\t\t\tthis.scene.playerManager.firstPlayer._gamepad.keymap[key.charCodeAt()] = keymap[key];\r\n\t}\r\n\r\n\tupdateTASLeaderboard(races) {\r\n\t\tlet leaderboard = this.fetchTASLeaderboard({ createIfNotExists: true });\r\n\t\tfor (let data of races) {\r\n\t\t\tlet row = leaderboard.appendChild(this.constructor.fetchRaceRow(data, { parent: leaderboard, placement: 1 + races.indexOf(data) }))\r\n\t\t\tlet num = row.querySelector('.num');\r\n\t\t\tnum.innerText = (1 + races.indexOf(data)) + '.';\r\n\t\t\tlet stats = Object.fromEntries(Object.keys(data.race.code.tas).slice(1).map(value => value.split(/:\\s*/).map(value => isFinite(value) ? parseFloat(value) : value.replace(/\\s+/g, '_'))));\r\n\t\t\tlet time = row.querySelector(':nth-child(4)');\r\n\t\t\ttime.innerText = this.constructor.formatRaceTime(stats.run_ticks / GameSettings.drawFPS * 1e3);\r\n\t\t\tlet actionRow = row.querySelector('.track-leaderboard-action');\r\n\t\t\tactionRow.querySelector('span.core_icons.core_icons-btn_add_race.track-leaderboard-race') || actionRow.appendChild(this.constructor.createElement('span.core_icons.core_icons-btn_add_race.track-leaderboard-race', {\r\n\t\t\t\ttitle: 'Race ' + data.user.d_name,\r\n\t\t\t\tclick() {\r\n\t\t\t\t\tlet row = this.closest('.track-leaderboard-race-row');\r\n\t\t\t\t\tlite.scene.removeRaces([row.dataset.u_id])\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}\r\n\t}\r\n\r\n\tdraw(ctx) {\r\n\t\tthis.storage.get('inputDisplay') && this.drawInputDisplay(ctx)\r\n\t}\r\n\r\n\tdrawInputDisplay(ctx) {\r\n\t\tlet { downButtons } = this.scene.playerManager.getPlayerByIndex(this.scene.camera.focusIndex)._gamepad;\r\n\t\tlet size = parseInt(this.storage.get('inputDisplaySize')) + 3;\r\n\t\tlet offset = {\r\n\t\t\tx: size,\r\n\t\t\ty: ctx.canvas.height - size * 10\r\n\t\t}\r\n\r\n\t\tctx.save();\r\n\t\tctx.fillStyle = GameSettings.physicsLineColor;\r\n\t\tctx.globalAlpha = this.storage.get('inputDisplayOpacity');\r\n\t\t// ctx.globalCompositeOperation = 'xor'; // rect stroke/fill overlap\r\n\t\tctx.lineWidth = size / 2;\r\n\t\tctx.strokeStyle = GameSettings.physicsLineColor;\r\n\r\n\t\tlet borderRadius = size / 2;\r\n\t\tlet buttonSize = size * 4;\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.roundRect(offset.x, offset.y, buttonSize, buttonSize, borderRadius);\r\n\t\tdownButtons.z && ctx.fill();\r\n\t\tctx.stroke();\r\n\t\tctx.beginPath();\r\n\t\tctx.roundRect(offset.x + 5 * size, offset.y, buttonSize, buttonSize, borderRadius);\r\n\t\tdownButtons.up && ctx.fill();\r\n\t\tctx.stroke();\r\n\t\tctx.beginPath();\r\n\t\tctx.roundRect(offset.x, offset.y + 5 * size, buttonSize, buttonSize, borderRadius);\r\n\t\tdownButtons.left && ctx.fill();\r\n\t\tctx.stroke();\r\n\t\tctx.beginPath();\r\n\t\tctx.roundRect(offset.x + 5 * size, offset.y + 5 * size, buttonSize, buttonSize, borderRadius);\r\n\t\tdownButtons.down && ctx.fill();\r\n\t\tctx.stroke();\r\n\t\tctx.beginPath();\r\n\t\tctx.roundRect(offset.x + 10 * size, offset.y + 5 * size, buttonSize, buttonSize, borderRadius);\r\n\t\tdownButtons.right && ctx.fill();\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.globalCompositeOperation = 'xor'; // destination-out\r\n\t\tctx.lineWidth = size / 3;\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(offset.x + 2.7 * size, offset.y + 3 * size);\r\n\t\tctx.lineTo(offset.x + 1.2 * size, offset.y + 3 * size);\r\n\t\tctx.lineTo(offset.x + 2.7 * size, offset.y + 1 * size);\r\n\t\tctx.lineTo(offset.x + 1.2 * size, offset.y + 1 * size);\r\n\t\tctx.moveTo(offset.x + 6.2 * size, offset.y + 2.7 * size);\r\n\t\tctx.lineTo(offset.x + 7 * size, offset.y + 1.2 * size);\r\n\t\tctx.lineTo(offset.x + 7.8 * size, offset.y + 2.7 * size);\r\n\t\tctx.moveTo(offset.x + 2.5 * size, offset.y + 7.8 * size);\r\n\t\tctx.lineTo(offset.x + 1.2 * size, offset.y + 7 * size);\r\n\t\tctx.lineTo(offset.x + 2.5 * size, offset.y + 6.2 * size);\r\n\t\tctx.moveTo(offset.x + 6.2 * size, offset.y + 6.2 * size);\r\n\t\tctx.lineTo(offset.x + 7 * size, offset.y + 7.8 * size);\r\n\t\tctx.lineTo(offset.x + 7.8 * size, offset.y + 6.2 * size);\r\n\t\tctx.moveTo(offset.x + 11.5 * size, offset.y + 7.8 * size);\r\n\t\tctx.lineTo(offset.x + 12.8 * size, offset.y + 7 * size);\r\n\t\tctx.lineTo(offset.x + 11.5 * size, offset.y + 6.2 * size);\r\n\t\tctx.stroke();\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\tinitAccountManager() {\r\n\t\tif (!Application.User.logged_in) return;\r\n\t\tlet logout = Application.router.left_navigation_view.el.querySelector('a.logout');\r\n\t\tif (!logout.hasAttribute('id')) return;\r\n\t\tlogout.removeAttribute('id'),\r\n\t\tlogout.innerText = \"Switch\",\r\n\t\tlogout.addEventListener('click', event => {\r\n\t\t\tevent.stopPropagation(),\r\n\t\t\tevent.stopImmediatePropagation(),\r\n\t\t\tthis.constructor.getAccountManager({ createIfNotExists: true }).showModal()\r\n\t\t}, { passive: true })\r\n\t}\r\n\r\n\tinitAchievementsDisplay() {\r\n\t\tthis.nativeEvents.has('notificationEvent') || this.initNotificationEvent();\r\n\t\t!this.achievementMonitor && (Application.events.subscribe('notification.received', ({ data }) => {\r\n\t\t\tif ('undefined' != typeof data && ('undefined' != typeof data.achievements_earned)) {\r\n\t\t\t\t'undefined' != typeof data.achievements_earned && Application.events.publish('achievementsEarned', data.achievements_earned);\r\n\t\t\t\tthis.refreshAchievements({ force: true }) // only update percentages // this.updateAchievements?\r\n\t\t\t}\r\n\t\t}),\r\n\t\tObject.defineProperty(this, 'achievementMonitor', { value: {\r\n\t\t\tcontainer: this.constructor.createElement('div#achievements-container', {\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\tflexDirection: 'column',\r\n\t\t\t\t\tfontFamily: 'riffic',\r\n\t\t\t\t\tgap: '0.4rem'\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}, writable: true }),\r\n\t\tthis.achievementMonitor.wrapper = this.constructor.createElement('div#frhd-lite\\\\.achievement-monitor', {\r\n\t\t\tchildren: [\r\n\t\t\t\tthis.constructor.createElement('a', {\r\n\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\tthis.constructor.createElement('span', {\r\n\t\t\t\t\t\t\tinnerText: 'Daily Achievements',\r\n\t\t\t\t\t\t\tstyle: { float: 'left' }\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tthis.achievementMonitor.countdown = this.constructor.createElement('span.time-remaining', {\r\n\t\t\t\t\t\t\tinnerText: '00:00:00',\r\n\t\t\t\t\t\t\tstyle: { float: 'right' }\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t],\r\n\t\t\t\t\thref: '/achievements',\r\n\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\tborderBottom: '1px solid hsl(190deg 25% 60%)',\r\n\t\t\t\t\t\tcolor: 'black',\r\n\t\t\t\t\t\tfontFamily: 'helsinki',\r\n\t\t\t\t\t\tpaddingBottom: '5px'\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tthis.achievementMonitor.container\r\n\t\t\t],\r\n\t\t\tstyle: {\r\n\t\t\t\tbackgroundColor: 'hsl(190 25% 95% / 1)',\r\n\t\t\t\t// backgroundImage: 'linear-gradient(transparent, hsl(191 25% 90% / 1))',\r\n\t\t\t\tborder: '1px solid hsl(190deg 25% 60%)',\r\n\t\t\t\tborderRadius: '1rem',\r\n\t\t\t\tdisplay: 'flex',\r\n\t\t\t\tflexDirection: 'column',\r\n\t\t\t\tgap: '0.6rem',\r\n\t\t\t\tmargin: '0 0.6rem',\r\n\t\t\t\tpadding: '1.5rem',\r\n\t\t\t\twidth: '-webkit-fill-available'\r\n\t\t\t}\r\n\t\t}));\r\n\t\tthis.refreshAchievements().then(r => {\r\n\t\t\tthis.achievementMonitor.countdown.innerText = [String(Math.floor(r.time_left / 3600)).padStart(2, '0'), String(Math.floor((r.time_left % 3600) / 60)).padStart(2, '0'), String(Math.floor(r.time_left % 60)).padStart(2, '0')].join(':');\r\n\t\t\tthis.achievementMonitor.countdownTimer ||= setInterval(() => {\r\n\t\t\t\tlet lastTime = this.achievementMonitor.countdown.innerText.split(':').map(e => parseInt(e));\r\n\t\t\t\tlastTime[2] === 0 && (lastTime[1] === 0 && (lastTime[0]--,\r\n\t\t\t\tlastTime[1] = 59),\r\n\t\t\t\tlastTime[1]--,\r\n\t\t\t\tlastTime[2] = 59);\r\n\t\t\t\tlastTime[2]--;\r\n\t\t\t\tlastTime.reduce((sum, remainingTime) => sum += remainingTime, 0) === 0 && clearInterval(this.achievementMonitor.countdownTimer);\r\n\t\t\t\tthis.achievementMonitor.countdown.innerText = lastTime.map(e => String(e).padStart(2, '0')).join(':');\r\n\t\t\t\tr.time_left -= 1,\r\n\t\t\t\twindow.navigation && navigation.addEventListener('navigate', e => e.navigationType != 'replace' && this.constructor.updateAchievements({ time_left: r.time_left }), { once: true, passive: true })\r\n\t\t\t}, 1e3);\r\n\t\t\tconst rightContent = document.querySelector('#right_content');\r\n\t\t\trightContent.prepend(this.achievementMonitor.wrapper)\r\n\t\t})\r\n\t}\r\n\r\n\tinitBestDate() {\r\n\t\tthis.nativeEvents.has('leaderboardEvent') || this.initLeaderboardEvent();\r\n\t\tApplication.router.current_view.on('leaderboard.rendered', () => {\r\n\t\t\tdocument.querySelectorAll(`.track-leaderboard-race-row[data-u_id=\"${Application.settings.user.u_id}\"]`).forEach(race => {\r\n\t\t\t\trace.setAttribute('title', 'Loading...'),\r\n\t\t\t\trace.addEventListener('pointerover', () => this.constructor.fetchRaceBestDate().then(date => race.setAttribute('title', date)), { once: true, passive: true })\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tinitDownloadGhosts() {\r\n\t\tthis.nativeEvents.has('leaderboardEvent') || this.initLeaderboardEvent(),\r\n\t\tthis.constructor.styleSheet\r\n\t\t\t.set('.track-page .track-leaderboard .track-leaderboard-action', { textAlign: 'right' })\r\n\t\t\t.set('.track-page .track-leaderboard .track-leaderboard-action > :is(span.core_icons, div.moderator-remove-race)', { right: '6px' })\r\n\t\t\t.set('#frhd-lite\\\\.download-race', {\r\n\t\t\t\taspectRatio: 1,\r\n\t\t\t\tfontSize: '15px',\r\n\t\t\t\theight: '22px',\r\n\t\t\t\tlineHeight: '1.5em',\r\n\t\t\t\tmarginRight: '8px',\r\n\t\t\t\ttextAlign: 'center'\r\n\t\t\t}),\r\n\t\tApplication.router.current_view.on('leaderboard.rendered', () => {\r\n\t\t\tfor (let actionRow of document.querySelectorAll('.track-leaderboard-race-row[data-u_id=\"' + Application.settings.user.u_id + '\"] > .track-leaderboard-action:not(:has(> #frhd-lite\\\\.download-race))')) {\r\n\t\t\t\t// let download = actionRow.querySelector('.track-leaderboard-race');\r\n\t\t\t\t// download.removeAttribute('class'),\r\n\t\t\t\t// download.setAttribute('id', 'frhd-lite.download-race'),\r\n\t\t\t\t// download.classList.add('btn', 'new-button', 'button-type-1'),\r\n\t\t\t\t// download.innerText = '⭳';\r\n\t\t\t\tlet download = this.constructor.createElement('span.btn.new-button.button-type-1#frhd-lite\\\\.download-race', {\r\n\t\t\t\t\tinnerText: '⭳',\r\n\t\t\t\t\ttitle: 'Download Race'\r\n\t\t\t\t});\r\n\t\t\t\tdownload.addEventListener('click', () => this.constructor.downloadRace(GameSettings.track.id, download.parentElement.parentElement.dataset.u_id), { passive: true });\r\n\t\t\t\tactionRow.style.setProperty('width', '20%'),\r\n\t\t\t\tactionRow.prepend(download),\r\n\t\t\t\tactionRow.textContent.length > 0 && actionRow.replaceChildren(...actionRow.children)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tinitDownloadTracks() {\r\n\t\tlet subscribeToAuthor = document.querySelector('.subscribe-to-author-button');\r\n\t\tlet downloadTrack = document.querySelector('#frhd-lite\\\\.download-track');\r\n\t\tif (!downloadTrack) {\r\n\t\t\tsubscribeToAuthor.addEventListener('click', () => this.constructor.downloadTrack(GameSettings.track.id), { passive: true }),\r\n\t\t\tsubscribeToAuthor.setAttribute('id', 'frhd-lite.download-track'),\r\n\t\t\tsubscribeToAuthor.innerText = 'Download'\r\n\t\t}\r\n\t}\r\n\r\n\tinitFeaturedGhosts() {\r\n\t\tthis.nativeEvents.has('leaderboardEvent') || this.initLeaderboardEvent();\r\n\t\tApplication.router.current_view.on('leaderboard.rendered', async () => {\r\n\t\t\tconst matches = Object.fromEntries(Object.entries(await this.constructor.fetchFeaturedGhosts()).filter(e => Object.keys(e[1] = Object.fromEntries(Object.entries(e[1]).filter(([t]) => parseInt(t.split('/t/')[1]) == Application.router.current_view._get_track_id()))).length));\r\n\t\t\tfor (const player in matches) {\r\n\t\t\t\tfor (const ghost in matches[player]) {\r\n\t\t\t\t\tlet name = ghost.split('/r/')[1];\r\n\t\t\t\t\tfor (const row of document.querySelectorAll('.track-page .track-leaderboard .track-leaderboard-race-row[data-d_name=\"' + name + '\" i]')) {\r\n\t\t\t\t\t\tlet hue = 10;\r\n\t\t\t\t\t\tswitch(matches[player][ghost]) {\r\n\t\t\t\t\t\t\tcase 'fast': hue = 180; break;\r\n\t\t\t\t\t\t\tcase 'vehicle': hue = 40; break;\r\n\t\t\t\t\t\t\tcase 'trick': hue = 120;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet num = row.querySelector('.num');\r\n\t\t\t\t\t\tnum.classList.add('core_icons', 'core_icons-icon_featured_badge'),\r\n\t\t\t\t\t\tnum.classList.remove('num'),\r\n\t\t\t\t\t\tnum.innerText = null,\r\n\t\t\t\t\t\tnum.setAttribute('title', 'Featured'),\r\n\t\t\t\t\t\trow.style.setProperty('background-color', `hsl(${hue}deg 60% 50% / 40%)`)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tasync initFriendsLastPlayed() {\r\n\t\tconst { friends, is_profile_owner } = Application.router.current_view.ajax && Application.router.current_view.username === Application.router.current_view.ajax.header_title.toLowerCase() ? Application.router.current_view.ajax : await fetch(location.pathname + '?ajax').then(r => r.json());\r\n\t\tis_profile_owner || document.querySelectorAll('.friend-list-item-name').forEach(item => {\r\n\t\t\titem.after(this.constructor.createElement('div.friend-list-item-date', {\r\n\t\t\t\tinnerText: \"Last Played \" + friends.friends_data.find(({ d_name }) => d_name == item.innerText).activity_time_ago\r\n\t\t\t}))\r\n\t\t})\r\n\t}\r\n\r\n\tinitGhostMetadata() {\r\n\t\tthis.nativeEvents.has('leaderboardEvent') || this.initLeaderboardEvent();\r\n\t\tconst parseTicks = time => {\r\n\t\t\tif (!time) return 0;\r\n\t\t\tlet parts = time.split(':').map(value => parseFloat(value));\r\n\t\t\treturn Math.round((parts[1] * 1e3 + parts[0] * 6e4) * (GameSettings.drawFPS / 1e3))\r\n\t\t}\r\n\t\tApplication.router.current_view.on('leaderboard.rendered', ({ track_leaderboard: trackLeaderboard }) => {\r\n\t\t\ttrackLeaderboard = trackLeaderboard.filter(({ user_no_race_data }) => !user_no_race_data);\r\n\t\t\tconst averageTicks = trackLeaderboard.reduce((total, { run_time }) => total += parseTicks(run_time), 0) / trackLeaderboard.length;\r\n\t\t\tfor (let player of trackLeaderboard.filter(({ run_time: runTime, u_id: userId }, index) => {\r\n\t\t\t\tif (!runTime) return true;\r\n\t\t\t\tconst filteredAverageTicks = trackLeaderboard.filter(({ u_id }) => u_id !== userId).reduce((total, { run_time }) => total += parseTicks(run_time), 0) / trackLeaderboard.length;\r\n\t\t\t\tconst max = parseTicks(trackLeaderboard.at(-1).run_time);\r\n\t\t\t\tconst calculatedMargin = max - parseTicks(trackLeaderboard[Math.min(trackLeaderboard.length - 1, index + 1)].run_time);\r\n\t\t\t\tthis.constructor.debug && console.log(averageTicks, parseTicks(runTime), 'diff', averageTicks - parseTicks(runTime), 'max diff', max - averageTicks, max - filteredAverageTicks, filteredAverageTicks, calculatedMargin, 'max', max, 'max divided by 100', max / 100, calculatedMargin / max, calculatedMargin * (max / 100), max / calculatedMargin)\r\n\t\t\t\tif (averageTicks - parseTicks(runTime) > max - filteredAverageTicks) return true;\r\n\t\t\t\treturn false\r\n\t\t\t})) {\r\n\t\t\t\tfor (let flag of document.querySelectorAll('.track-leaderboard-race-row[data-u_id=\"' + player.u_id + '\"] > .num:not(:has(> #frhd-lite\\\\.flagged))')) {\r\n\t\t\t\t\tflag.setAttribute('id', 'frhd-lite.flagged');\r\n\t\t\t\t\tflag.setAttribute('title', 'This race has been flagged by frhd-lite under suspicion of misconduct.');\r\n\t\t\t\t\tflag.innerText = '⚠️';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tinitGhostPlayer() {\r\n\t\tthis.replayGui || (Object.defineProperty(this, 'replayGui', {\r\n\t\t\tvalue: Object.defineProperties(this.constructor.createElement('div', {\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tdisplay: 'none',\r\n\t\t\t\t\tinset: 0,\r\n\t\t\t\t\tpointerEvents: 'none',\r\n\t\t\t\t\tposition: 'absolute'\r\n\t\t\t\t}\r\n\t\t\t}), {\r\n\t\t\t\tfade: {\r\n\t\t\t\t\tvalue(ms) {\r\n\t\t\t\t\t\tthis._fadeTimeout && clearTimeout(this._fadeTimeout),\r\n\t\t\t\t\t\tthis._fadeTimeout = setTimeout(() => !GameManager.game.currentScene.state.paused && GameManager.game.currentScene.state.playing && this.hide(), ms)\r\n\t\t\t\t\t},\r\n\t\t\t\t\twritable: true\r\n\t\t\t\t},\r\n\t\t\t\thide: {\r\n\t\t\t\t\tvalue() {\r\n\t\t\t\t\t\tthis._fadeTimeout && clearTimeout(this._fadeTimeout),\r\n\t\t\t\t\t\tthis.style.setProperty('display', 'none')\r\n\t\t\t\t\t},\r\n\t\t\t\t\twritable: true\r\n\t\t\t\t},\r\n\t\t\t\tshow: {\r\n\t\t\t\t\tvalue() {\r\n\t\t\t\t\t\tthis._fadeTimeout && clearTimeout(this._fadeTimeout),\r\n\t\t\t\t\t\tthis.style.removeProperty('display')\r\n\t\t\t\t\t},\r\n\t\t\t\t\twritable: true\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\twritable: true\r\n\t\t}),\r\n\t\tthis.replayGui.progress || Object.defineProperty(this.replayGui, 'progress', {\r\n\t\t\tvalue: this.replayGui.appendChild(this.constructor.createElement('progress.frhd-lite\\\\.race-player-progress#replay-seeker', {\r\n\t\t\t\tmax: 100,\r\n\t\t\t\tmin: 0,\r\n\t\t\t\tvalue: 0,\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tborder: 'none',\r\n\t\t\t\t\tbottom: 0,\r\n\t\t\t\t\theight: '4px',\r\n\t\t\t\t\tpointerEvents: 'all',\r\n\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\ttransition: 'height 100ms',\r\n\t\t\t\t\twidth: '100%'\r\n\t\t\t\t},\r\n\t\t\t\ttype: 'range',\r\n\t\t\t\tchange(event) {\r\n\t\t\t\t\tGameManager.game.currentScene.state.playing = false;\r\n\t\t\t\t\tlet player = GameManager.game.currentScene.playerManager.getPlayerByIndex(GameManager.game.currentScene.camera.focusIndex);\r\n\t\t\t\t\tplayer.isGhost() && player._replayIterator.next(this.value)\r\n\t\t\t\t},\r\n\t\t\t\tpointerdown(event) {\r\n\t\t\t\t\tthis.setPointerCapture(event.pointerId);\r\n\t\t\t\t\tthis.value = Math.round(event.offsetX / parseInt(getComputedStyle(this).getPropertyValue('width')) * this.max);\r\n\t\t\t\t\tthis.dispatchEvent(new InputEvent('change'));\r\n\t\t\t\t\tthis.wasPlaying = GameManager.game.currentScene.state.playing\r\n\t\t\t\t},\r\n\t\t\t\tpointermove(event) {\r\n\t\t\t\t\tevent.buttons & 1 == 1 && (this.value = Math.round(event.offsetX / parseInt(getComputedStyle(this).getPropertyValue('width')) * this.max),\r\n\t\t\t\t\tthis.dispatchEvent(new InputEvent('change')));\r\n\t\t\t\t},\r\n\t\t\t\tpointerup(event) {\r\n\t\t\t\t\tthis.releasePointerCapture(event.pointerId);\r\n\t\t\t\t\tGameManager.game.currentScene.state.playing = this.wasPlaying\r\n\t\t\t\t}\r\n\t\t\t})),\r\n\t\t\twritable: true\r\n\t\t}),\r\n\t\tthis._updateMediaSessionMetadata(),\r\n\t\tthis.constructor.styleSheet.set('.frhd-lite\\\\.race-player-progress::-webkit-progress-value', {\r\n\t\t\tbackgroundColor: 'hsl(195deg 57% 25%)'\r\n\t\t}).set('.frhd-lite\\\\.race-player-progress:hover', {\r\n\t\t\tcursor: 'pointer',\r\n\t\t\tfilter: 'brightness(1.25)',\r\n\t\t\theight: '6px !important'\r\n\t\t}));\r\n\t\tthis.constructor.waitForElm('#game-container').then(container => {\r\n\t\t\tcontainer.appendChild(this.replayGui);\r\n\t\t\tcontainer.addEventListener('pointerenter', () => this.replayGui.show(), { passive: true }),\r\n\t\t\tcontainer.addEventListener('pointermove', () => {\r\n\t\t\t\tthis.replayGui.show(),\r\n\t\t\t\tthis.replayGui.fade(3e3)\r\n\t\t\t}, { passive: true }),\r\n\t\t\tcontainer.addEventListener('pointerexit', () => this.replayGui.fade(3e3), { passive: true })\r\n\t\t})\r\n\t}\r\n\r\n\tinitJumpToComment() {\r\n\t\tlet searchParams = new URLSearchParams(location.search);\r\n\t\tlet commentId = searchParams.get('c_id');\r\n\t\tif (!commentId || this.lastLoadedComment == commentId || document.querySelector('.track-comment[data-c_id=\"' + commentId + '\"]')) return;\r\n\t\tObject.defineProperty(this, 'lastLoadedComment', { value: commentId, writable: true });\r\n\t\tif (typeof Application.router.current_view.load_comments_until != 'function') {\r\n\t\t\tconst prototype = Object.getPrototypeOf(Application.router.current_view);\r\n\t\t\tprototype.load_comments_until = function(cid, callback) {\r\n\t\t\t\tlet o = document.querySelector(\".track-comments-list div.track-comment:last-child\").dataset.c_id\r\n\t\t\t\t  , r = this._get_track_id()\r\n\t\t\t\t  , i = document.querySelector('.track-prev-comments');\r\n\t\t\t\ti.style.setProperty('display', 'none');\r\n\t\t\t\tlet s = document.querySelector('.track-comments-loading');\r\n\t\t\t\ts.style.setProperty('display', 'block');\r\n\t\t\t\tthis._get_comment_template(() => {\r\n\t\t\t\t\tApplication.Helpers.AjaxHelper.post(\"track_comments/load_more/\" + r + \"/\" + o).then(e => {\r\n\t\t\t\t\t\tif (e.result === !0 && e.data.track_comments.length > 0) {\r\n\t\t\t\t\t\t\tvar a = Application.Helpers.TemplateHelper.render(this.templates[\"track/track_comment\"], {}, e.data)\r\n\t\t\t\t\t\t\t  , o = this.$el.find(\".track-comments-list\")\r\n\t\t\t\t\t\t\t  , n = e.data.track_comments.findIndex(({ comment }) => comment.id == cid) > 0;\r\n\t\t\t\t\t\t\to.append(a),\r\n\t\t\t\t\t\t\te.data.track_comments_load_more === !0 && (n ? i.style.removeProperty('display') : this.load_comments_until(...arguments)),\r\n\t\t\t\t\t\t\tn && typeof callback == 'function' && callback(document.querySelector('.track-comment[data-c_id=\"' + cid + '\"]'))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ts.style.setProperty('display', 'none'),\r\n\t\t\t\t\t\tApplication.events.publish('resize')\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tObject.setPrototypeOf(Application.router.current_view, prototype);\r\n\t\t}\r\n\t\tApplication.router.current_view.load_comments_until(commentId, comment => {\r\n\t\t\tcomment.scrollIntoView({ behavior: 'smooth' });\r\n\t\t\twindow.addEventListener('scrollend', () => {\r\n\t\t\t\tcomment.classList.add('animated', 'flash');\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tcomment.classList.remove('animated', 'flash');\r\n\t\t\t\t}, 2e3)\r\n\t\t\t}, { once: true, passive: true });\r\n\t\t})\r\n\t}\r\n\r\n\tinitLeaderboardEvent() {\r\n\t\tconst renderLeaderboards = Application.Views.TrackView.prototype._render_leaderboards;\r\n\t\tthis.nativeEvents.set('leaderboardEvent', renderLeaderboards);\r\n\t\tApplication.Views.TrackView.prototype._render_leaderboards = function(e) {\r\n\t\t\trenderLeaderboards.apply(this, arguments);\r\n\t\t\te.result && (this.trigger('leaderboard.rendered', ...arguments),\r\n\t\t\tApplication.events.publish('leaderboard.rendered', ...arguments))\r\n\t\t}\r\n\t}\r\n\r\n\tinitNotificationEvent() {\r\n\t\tconst prototype = Object.getPrototypeOf(Application.Helpers.AjaxHelper);\r\n\t\tconst checkNotificationEvent = prototype._check_event_notification;\r\n\t\tthis.nativeEvents.set('notificationEvent', checkNotificationEvent);\r\n\t\tprototype._check_event_notification = function(e) {\r\n\t\t\tcheckNotificationEvent.apply(this, arguments);\r\n\t\t\te.result && Application.events.publish('notification.received', ...arguments);\r\n\t\t}\r\n\t\tObject.setPrototypeOf(Application.Helpers.AjaxHelper, prototype);\r\n\t}\r\n\r\n\tinitPlayLater() {\r\n\t\tlet recentlyPlayedTab = document.querySelector('.tab-entry.recently-played-tab');\r\n\t\tif (!recentlyPlayedTab || document.querySelector('.tab-entry.frhd-lite\\\\.play-later-tab')) return;\r\n\t\tlet playlist = this.fetchAndCachePlaylists('playlater');\r\n\t\tif (playlist.size < 1) return;\r\n\t\tlet tab = recentlyPlayedTab.parentElement.appendChild(recentlyPlayedTab.cloneNode(true));\r\n\t\ttab.classList.add('frhd-lite.play-later-tab');\r\n\t\ttab.dataset.panel = '#frhd-lite\\\\.play-later';\r\n\t\ttab.firstElementChild.lastChild.data = 'Play Later';\r\n\t\tlet recentlyPlayedPanel = document.querySelector('#profile_recently_played');\r\n\t\tif (!recentlyPlayedPanel) return;\r\n\t\tlet panel = recentlyPlayedPanel.parentElement.appendChild(recentlyPlayedPanel.cloneNode(true));\r\n\t\tpanel.setAttribute('id', 'frhd-lite.play-later');\r\n\t\tlet list = panel.querySelector('.track-list');\r\n\t\tlist.replaceChildren(...Array.from(playlist && playlist.values()).map(entry => {\r\n\t\t\tconst authorUrl = 'https://' + location.host + '/u/' + entry.author;\r\n\t\t\tconst trackUrl = 'https://' + location.host + '/t/' + entry.slug;\r\n\t\t\treturn this.constructor.createElement('li', {\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\tthis.constructor.createElement('div.track-list-tile.trackTile', {\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\tthis.constructor.createElement('a.top', {\r\n\t\t\t\t\t\t\t\thref: trackUrl,\r\n\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\tthis.constructor.createElement('img.track-list-tile-thumb.top-image', {\r\n\t\t\t\t\t\t\t\t\t\tsrc: entry.img\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tthis.constructor.createElement('img.track-list-tile-thumb', {\r\n\t\t\t\t\t\t\t\t\t\talt: 'Track Preview',\r\n\t\t\t\t\t\t\t\t\t\tsrc: 'https://cdn.' + location.host.split('.').slice(-2).join('.') + '/free_rider_hd/sprites/track_preview_250x150.png'\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tthis.constructor.createElement('span.bestTime', {\r\n\t\t\t\t\t\t\t\t\t\tinnerText: ' ' + entry.averageTime + ' ',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Average Time'\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\tthis.constructor.createElement('div.bottom', {\r\n\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\tthis.constructor.createElement('a.name', {\r\n\t\t\t\t\t\t\t\t\t\thref: trackUrl,\r\n\t\t\t\t\t\t\t\t\t\tinnerText: entry.title\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tthis.constructor.createElement('div.profileGravatarIcon', {\r\n\t\t\t\t\t\t\t\t\t\tstyle: { backgroundImage: 'url(' + authorUrl + '/pic?size=50)' }\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tthis.constructor.createElement('a.author', {\r\n\t\t\t\t\t\t\t\t\t\thref: authorUrl + '/created',\r\n\t\t\t\t\t\t\t\t\t\tinnerHTML: '&ensp;' + entry.author\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t})\r\n\t\t\t\t]\r\n\t\t\t})\r\n\t\t}))\r\n\t}\r\n\r\n\tinitReportTracks() {\r\n\t\tlet confirm = document.querySelector('.track-flag ~ .track-confirm-flag > .yes');\r\n\t\tif (!confirm || confirm.classList.contains('frhd-lite.track-report')) return;\r\n\t\tconfirm.classList.add('frhd-lite.track-report');\r\n\t\tconfirm.addEventListener('click', () => {\r\n\t\t\tthis.constructor.report('This track', {}, { type: 'track' }).then(r => alert(r.result ? \"You have successfully reported this track.\" : r.msg))\r\n\t\t}, { passive: true })\r\n\t}\r\n\r\n\tinitRequestTrackData() {\r\n\t\tlet deleteALlPersonalData = document.querySelector('#delete-all-personal-data');\r\n\t\tif (deleteALlPersonalData) {\r\n\t\t\tlet requestTrackData = deleteALlPersonalData.parentElement.appendChild(this.constructor.createElement('button.blue-button.settings-header.new-button', {\r\n\t\t\t\tinnerText: 'Request All Data',\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tfloat: 'right',\r\n\t\t\t\t\tfontSize: '13px',\r\n\t\t\t\t\theight: 'auto',\r\n\t\t\t\t\tlineHeight: '23px',\r\n\t\t\t\t\tmarginTop: '6px',\r\n\t\t\t\t\tmarginRight: '14px',\r\n\t\t\t\t\tpadding: '0 1rem'\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t\trequestTrackData.addEventListener('click', () => this.constructor.downloadAllTracks(Application.settings.user.u_name), { passive: true });\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"Request track data failed to load! Personal data is not present.\")\r\n\t\t}\r\n\t}\r\n\r\n\tinitUserModeration() {\r\n\t\tlet profileUserData = document.querySelector('#profile-user-data');\r\n\t\tif (!profileUserData) return;\r\n\t\tlet onclick = event => {\r\n\t\t\tself = event.target;\r\n\t\t\tlet input = self.previousElementSibling;\r\n\t\t\tif (self.innerText.toLowerCase() == 'save') {\r\n\t\t\t\tself.dispatchEvent(new CustomEvent('save', {\r\n\t\t\t\t\tdetail: input.value\r\n\t\t\t\t}));\r\n\t\t\t\tinput.setAttribute('readonly', '');\r\n\t\t\t\tself.classList.add('button-type-1');\r\n\t\t\t\tself.classList.remove('button-type-2');\r\n\t\t\t\tself.innerText = 'Edit';\r\n\t\t\t} else {\r\n\t\t\t\tinput.removeAttribute('readonly');\r\n\t\t\t\tself.classList.add('button-type-2');\r\n\t\t\t\tself.classList.remove('button-type-1');\r\n\t\t\t\tself.innerText = 'Save';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet data = profileUserData.dataset;\r\n\t\tdata.u_name = document.querySelector('.profile-username').innerText;\r\n\t\tlet pm = document.querySelector('.pm > .pm-user-properties');\r\n\t\tlet email = pm.appendChild(pm.querySelector('.pm-user-property.pm-user-id').cloneNode(true));\r\n\t\temail.classList.remove('pm-user-id');\r\n\t\tlet property = email.querySelector('.pm-property');\r\n\t\tproperty.innerText = \"Email: \";\r\n\t\tlet input = this.constructor.createElement('input', {\r\n\t\t\tplaceholder: 'New email',\r\n\t\t\treadonly: '',\r\n\t\t\ttype: 'text' // email\r\n\t\t});\r\n\t\tproperty.nextElementSibling.replaceWith(input);\r\n\t\tlet edit = email.querySelector('#pm-ban-user');\r\n\t\tedit.classList.remove('ban-user-button');\r\n\t\tedit.innerText = \"Edit\";\r\n\t\tedit.removeAttribute('id');\r\n\t\tedit.addEventListener('click', onclick, { passive: true });\r\n\t\tedit.addEventListener('save', event => {\r\n\t\t\treturn Application.Helpers.AjaxHelper.post(\"moderator/change_email\", {\r\n\t\t\t\tu_id: data.u_id,\r\n\t\t\t\temail: event.detail\r\n\t\t\t}).then(r => (alert(r.msg), r));\r\n\t\t});\r\n\t\temail.querySelector('#pm-unban-user').remove();\r\n\t\tlet username = pm.appendChild(email.cloneNode(true));\r\n\t\tproperty = username.querySelector('.pm-property');\r\n\t\tproperty.innerText = \"Username: \";\r\n\t\tinput = username.querySelector('input');\r\n\t\tinput.setAttribute('placeholder', \"New username\");\r\n\t\tinput.setAttribute('type', 'text');\r\n\t\tinput.setAttribute('value', data.u_name);\r\n\t\tedit = username.querySelector('a');\r\n\t\tedit.addEventListener('click', onclick, { passive: true });\r\n\t\tedit.addEventListener('save', event => {\r\n\t\t\treturn Application.Helpers.AjaxHelper.post(\"moderator/change_username\", {\r\n\t\t\t\tu_id: data.u_id,\r\n\t\t\t\tusername: event.detail\r\n\t\t\t}).then(r => (alert(r.msg), r));\r\n\t\t});\r\n\t\tlet password = pm.appendChild(email.cloneNode());\r\n\t\tproperty = password.appendChild(property.cloneNode());\r\n\t\tproperty.innerText = \"Password: \";\r\n\t\tedit = password.appendChild(this.constructor.createElement('button.new-button.ban-user-button', {\r\n\t\t\tinnerText: 'Reset Password'\r\n\t\t}));\r\n\t\tedit.addEventListener('click', () => {\r\n\t\t\treturn Application.Helpers.AjaxHelper.post(\"auth/forgot_password\", {\r\n\t\t\t\temail: data.u_name\r\n\t\t\t}).then(r => (alert(r.msg), r));\r\n\t\t}, { passive: true })\r\n\t}\r\n\r\n\tinitUserTrackAnalytics() {\r\n\t\tdocument.querySelectorAll(\"#created_tracks .bottom\").forEach(metadata => {\r\n\t\t\tmetadata.innerHTML = metadata.innerHTML.replace(/<!--|-->/g, '')\r\n\t\t})\r\n\t}\r\n\r\n\tinitUserTrackModeration() {\r\n\t\tfor (let metadata of document.querySelectorAll(\"#created_tracks .bottom\")) {\r\n\t\t\tlet label = metadata.appendChild(this.constructor.createElement('label', {\r\n\t\t\t\tstyle: { display: 'block' }\r\n\t\t\t}));\r\n\t\t\tlet avatar = metadata.querySelector('.profileGravatarIcon');\r\n\t\t\tavatar && avatar.style.setProperty('margin-right', '4px');\r\n\t\t\tlabel.appendChild(metadata.querySelector('.profileGravatarIcon'));\r\n\t\t\tlabel.appendChild(metadata.querySelector('.author'));\r\n\t\t\tlabel.appendChild(this.constructor.createElement('input', {\r\n\t\t\t\ttype: 'checkbox',\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tfloat: 'right',\r\n\t\t\t\t\theight: '1.5rem'\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t\tlet nav = document.querySelector(\"#content > div > div.profile-tabs > section > div.tab_buttons > div\");\r\n\t\tlet action = nav.appendChild(this.constructor.createElement('select', {\r\n\t\t\tstyle: {\r\n\t\t\t\tborderRadius: '4px',\r\n\t\t\t\tfloat: 'right',\r\n\t\t\t\tfontFamily: 'system-ui,roboto_medium,Arial,Helvetica,sans-serif',\r\n\t\t\t\tletterSpacing: '-.02em',\r\n\t\t\t\tmarginRight: '10px',\r\n\t\t\t\tmarginTop: '8px'\r\n\t\t\t}\r\n\t\t}));\r\n\t\taction.appendChild(this.constructor.createElement('option', {\r\n\t\t\tdisabled: true,\r\n\t\t\tinnerText: 'Select an action',\r\n\t\t\tvalue: 'default'\r\n\t\t}));\r\n\t\taction.appendChild(this.constructor.createElement('option', {\r\n\t\t\tinnerText: 'Delete selected',\r\n\t\t\tvalue: 'hide'\r\n\t\t}));\r\n\t\taction.appendChild(this.constructor.createElement('option', {\r\n\t\t\tinnerText: 'Deselect all',\r\n\t\t\tvalue: 'deselect'\r\n\t\t}));\r\n\t\taction.appendChild(this.constructor.createElement('option', {\r\n\t\t\tinnerText: 'Select all',\r\n\t\t\tvalue: 'select'\r\n\t\t}));\r\n\t\taction.addEventListener('change', async event => {\r\n\t\t\tevent.target.disabled = true;\r\n\t\t\tswitch (event.target.value) {\r\n\t\t\tcase 'hide':\r\n\t\t\t\tlet tracks = document.querySelectorAll(\"#created_tracks li:has(.bottom > label > input[type='checkbox']:checked)\");\r\n\t\t\t\tif (tracks.length > 0) {\r\n\t\t\t\t\tlet dialog = document.body.appendChild(this.constructor.createElement('dialog', {\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tborder: 'none',\r\n\t\t\t\t\t\t\tboxShadow: '0 0 4px 0px hsl(190deg 25% 60%)',\r\n\t\t\t\t\t\t\tmaxHeight: '75vh',\r\n\t\t\t\t\t\t\tmaxWidth: '50vw',\r\n\t\t\t\t\t\t\tpadding: 0,\r\n\t\t\t\t\t\t\twidth: '120vmin'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tlet title = dialog.appendChild(this.constructor.createElement('p', {\r\n\t\t\t\t\t\tinnerText: 'Are you sure you would like to delete the following tracks?',\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tbackgroundColor: 'inherit',\r\n\t\t\t\t\t\t\tboxShadow: '0 0 4px 0 black',\r\n\t\t\t\t\t\t\tpadding: '1rem',\r\n\t\t\t\t\t\t\tposition: 'sticky',\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tzIndex: 3\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tlet close = title.appendChild(this.constructor.createElement('span.core_icons.core_icons-icon_close', {\r\n\t\t\t\t\t\tstyle: { float: 'right' }\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tclose.addEventListener('click', () => dialog.remove(), { passive: true });\r\n\t\t\t\t\tlet list = dialog.appendChild(this.constructor.createElement('ul.track-list.clearfix', {\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tmaxHeight: '50cqh',\r\n\t\t\t\t\t\t\toverflowY: 'auto',\r\n\t\t\t\t\t\t\tpadding: '1rem',\r\n\t\t\t\t\t\t\ttextAlign: 'center'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tlist.append(...Array.from(tracks).map(track => {\r\n\t\t\t\t\t\tlet clone = track.cloneNode(true);\r\n\t\t\t\t\t\tclone.style.setProperty('width', 'min-content');\r\n\t\t\t\t\t\treturn clone;\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tlet form = dialog.appendChild(this.constructor.createElement('form', {\r\n\t\t\t\t\t\tmethod: 'dialog',\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tbackgroundColor: 'inherit',\r\n\t\t\t\t\t\t\tbottom: 0,\r\n\t\t\t\t\t\t\tboxShadow: '0 0 4px 0 black',\r\n\t\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\t\tgap: '.25em',\r\n\t\t\t\t\t\t\tpadding: '1rem',\r\n\t\t\t\t\t\t\tposition: 'sticky',\r\n\t\t\t\t\t\t\tzIndex: 2\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tform.appendChild(this.constructor.createElement('button.new-button.button-type-1', {\r\n\t\t\t\t\t\tinnerText: 'Cancel',\r\n\t\t\t\t\t\tvalue: 'cancel'\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tlet confirm = form.appendChild(this.constructor.createElement('button.new-button.button-type-2', {\r\n\t\t\t\t\t\tinnerText: 'Confirm',\r\n\t\t\t\t\t\tvalue: 'default'\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tconfirm.addEventListener('click', async event => {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tfor (let button of form.querySelectorAll('button')) {\r\n\t\t\t\t\t\t\tbutton.disabled = true;\r\n\t\t\t\t\t\t\tbutton.style.setProperty('opacity', .5);\r\n\t\t\t\t\t\t\tbutton.style.setProperty('pointer-events', 'none');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tform.appendChild(this.constructor.createElement('span.loading-hourglass'));\r\n\t\t\t\t\t\tlet cache = [];\r\n\t\t\t\t\t\tlet tracks = list.querySelectorAll(\".bottom:has(> label > input[type='checkbox']:checked)\");\r\n\t\t\t\t\t\tfor (let metadata of tracks) {\r\n\t\t\t\t\t\t\tlet name = metadata.querySelector('.name');\r\n\t\t\t\t\t\t\tlet url = name.href;\r\n\t\t\t\t\t\t\tlet [tid] = url.match(/(?<=\\/t\\/)\\d+/);\r\n\t\t\t\t\t\t\tawait fetch('/moderator/hide_track/' + tid);\r\n\t\t\t\t\t\t\tcache.push(tid);\r\n\t\t\t\t\t\t\tlet container = metadata.closest('li');\r\n\t\t\t\t\t\t\tcontainer.remove();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// post message to extension?\r\n\t\t\t\t\t\tlet key = 'frhd-lite_recently-hidden-tracks';\r\n\t\t\t\t\t\tlet storage = Object.assign({}, JSON.parse(sessionStorage.getItem(key)));\r\n\t\t\t\t\t\tstorage[Date.now()] = cache;\r\n\t\t\t\t\t\tsessionStorage.setItem(key, JSON.stringify(storage));\r\n\t\t\t\t\t\tdialog.close(event.target.value);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdialog.addEventListener('close', event => {\r\n\t\t\t\t\t\taction.disabled = false;\r\n\t\t\t\t\t\tdialog.remove();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdialog.showModal();\r\n\t\t\t\t}\r\n\t\t\tcase 'deselect':\r\n\t\t\t\tfor (let checkbox of document.querySelectorAll(\"#created_tracks .bottom > label > input[type='checkbox']:checked\")) {\r\n\t\t\t\t\tcheckbox.checked = false;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'select':\r\n\t\t\t\tfor (let checkbox of document.querySelectorAll(\"#created_tracks .bottom > label > input[type='checkbox']:not(:checked)\")) {\r\n\t\t\t\t\tcheckbox.checked = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tevent.target.value = 'default';\r\n\t\t\tevent.target.disabled = false;\r\n\t\t}, { passive: true });\r\n\t}\r\n\r\n\tasync modifyCommentNotifications() {\r\n\t\t// console.log(await this.constructor.fetchRequestData({ attributeFilter: ['notification_days'] }));\r\n\t\tlet { notification_days: d } = Application.router.current_view.ajax && /^notifications$/i.test(Application.router.current_view.ajax.header_title) ? Application.router.current_view.ajax : await Application.Helpers.AjaxHelper.get('notifications');\r\n\t\tlet notifications = d && d.length > 0 && d.flatMap(({ notifications: n }) => n);\r\n\t\tlet commentNotifications = notifications.filter(({ t_uname_mention: t }) => t);\r\n\t\tfor (let { comment, track, ts } of commentNotifications) {\r\n\t\t\tlet notification = document.querySelector('.notification[data-ts=\"' + ts + '\"] p > a[href$=\"' + track.url + '\"]')\r\n\t\t\tnotification.href += '?c_id=' + comment.id\r\n\t\t}\r\n\t}\r\n\r\n\trefreshAchievements() {\r\n\t\treturn this.constructor.fetchAchievements(...arguments).then(async res => {\r\n\t\t\tlet children = await Promise.all(res.achievements.filter(a => !a.complete).sort((a, b) => b.tot_num - a.tot_num).slice(0, 3).map(this.constructor.createProgressElement.bind(this.constructor)));\r\n\t\t\tthis.achievementMonitor.container.replaceChildren(...children);\r\n\t\t\treturn res\r\n\t\t})\r\n\t}\r\n\r\n\tstatic fetchRequestData({ attributeFilter, timeout = 10, typedFilter } = {}) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tvar event = 'ajax.request';\r\n\t\t\tvar listener = data => {\r\n\t\t\t\tdata = typeof data == 'object' && typeof data.data == 'object' ? data.data : data;\r\n\t\t\t\tif (typeof attributeFilter == 'object' && attributeFilter instanceof Array) {\r\n\t\t\t\t\tconst attributes = Object.keys(data);\r\n\t\t\t\t\tif (attributeFilter.find(attribute => !attributes.includes(attribute))) return;\r\n\t\t\t\t} else if (typeof typedFilter == 'object') {\r\n\t\t\t\t\tfor (let attribute of typedFilter) {\r\n\t\t\t\t\t\tif (typeof data[attribute] !== typedFilter[attribute]) return;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tApplication.events.unsubscribe(event, listener),\r\n\t\t\t\tApplication.events.unsubscribe(timeoutEvent, listener),\r\n\t\t\t\tresolve(data)\r\n\t\t\t};\r\n\t\t\tApplication.events.subscribe(event, listener);\r\n\t\t\tvar timeoutEvent = 'mainview.loaded';\r\n\t\t\tvar timeoutListener = () => {\r\n\t\t\t\tApplication.events.unsubscribe(event, listener),\r\n\t\t\t\tApplication.events.unsubscribe(timeoutEvent, listener),\r\n\t\t\t\treject('Request timed out.')\r\n\t\t\t};\r\n\t\t\tApplication.events.subscribe(timeoutEvent, timeoutListener),\r\n\t\t\ttypeof timeout == 'number' && setTimeout(timeoutListener, timeout * 1e3)\r\n\t\t})\r\n\t}\r\n\r\n\tstatic #customStyleSheet = document.head.appendChild(this.createElement('style', { id: 'frhd-lite.style' }));\r\n\tstatic ajaxResponse = null;\r\n\tstatic debug = false;\r\n\tstatic styleSheet = new Proxy(Object.defineProperty(new Map(), 'update', {\r\n\t\tvalue(key, value) {\r\n\t\t\tlet newValue = Object.assign(this.get(key) || {}, value);\r\n\t\t\tthis.set(key, newValue);\r\n\t\t\treturn newValue\r\n\t\t},\r\n\t\twritable: true\r\n\t}), {\r\n\t\tget: (...args) => {\r\n\t\t\tlet [target, property, receiver] = args;\r\n\t\t\tlet returnValue = Reflect.get(...args);\r\n\t\t\tif (typeof returnValue == 'function') {\r\n\t\t\t\tswitch (property) {\r\n\t\t\t\tcase 'delete':\r\n\t\t\t\t\treturn (...args) => {\r\n\t\t\t\t\t\treturnValue = returnValue.apply(target, args);\r\n\t\t\t\t\t\tthis._updateCustomStyleSheet(this.styleSheet.entries());\r\n\t\t\t\t\t\treturn returnValue\r\n\t\t\t\t\t}\r\n\t\t\t\tcase 'set':\r\n\t\t\t\tcase 'update':\r\n\t\t\t\t\treturn (...args) => {\r\n\t\t\t\t\t\tlet [key, value] = args;\r\n\t\t\t\t\t\treturnValue.call(target, key, new Proxy(value, {\r\n\t\t\t\t\t\t\tset: (...args) => {\r\n\t\t\t\t\t\t\t\tlet returnValue = Reflect.set(...args);\r\n\t\t\t\t\t\t\t\tthis._updateCustomStyleSheet(this.styleSheet.entries());\r\n\t\t\t\t\t\t\t\treturn returnValue\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\tthis._updateCustomStyleSheet(this.styleSheet.entries());\r\n\t\t\t\t\t\treturn receiver\r\n\t\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturnValue = returnValue.bind(target)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn returnValue\r\n\t\t}\r\n\t});\r\n\r\n\tstatic _updateCustomStyleSheet(data) {\r\n\t\tconst entries = Array.from(data);\r\n\t\tconst filteredEntries = entries.filter(([_,value]) => Object.values(value).length);\r\n\t\tlet textContent = '';\r\n\t\tfor (let [key, properties] of filteredEntries) {\r\n\t\t\tproperties = Object.entries(properties);\r\n\t\t\tfor (let property of properties)\r\n\t\t\t\tproperty[0] = property[0].replace(/([A-Z])/g, c => '-' + c.toLowerCase());\r\n\t\t\ttextContent += key + '{' + properties.map(property => property.join(':')).join(';') + '}'; // JSON.stringify().replace(/(?<=\"),/, ';')\r\n\t\t}\r\n\t\tthis.#customStyleSheet.textContent = textContent\r\n\t}\r\n\r\n\tstatic compareUsers(a, b) {\r\n\t\treturn a.u_id == b.u_id || a.u_name == b.u_name || a.d_name == b.d_name\r\n\t}\r\n\r\n\tstatic createAccountContainer({ login, password }) {\r\n\t\tlet container = this.createElement(\"div\", {\r\n\t\t\tchildren: [\r\n\t\t\t\tthis.createElement(\"button.new-button.button-type-1\", {\r\n\t\t\t\t\tinnerText: login,\r\n\t\t\t\t\tstyle: { width: '-webkit-fill-available' },\r\n\t\t\t\t\tclick: event => {\r\n\t\t\t\t\t\tevent.target.closest(\"#frhd-lite\\\\.account-manager\").close();\r\n\t\t\t\t\t\tApplication.Helpers.AjaxHelper.post(\"/auth/standard_login\", { login, password }).done(r => {\r\n\t\t\t\t\t\t\tr.result && Application.events.publish(\"auth.login\", r.data.user, r.data.user_stats)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tthis.createElement(\"button.new-button.button-type-3\", {\r\n\t\t\t\t\tinnerText: \"X\",\r\n\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\taspectRatio: 1,\r\n\t\t\t\t\t\tmarginRight: 0\r\n\t\t\t\t\t},\r\n\t\t\t\t\tclick: () => {\r\n\t\t\t\t\t\tlet accounts = this.getStorageEntry('account-manager') ?? [];\r\n\t\t\t\t\t\taccounts.length > 0 && (accounts.splice(accounts.indexOf(accounts.find((account) => account.login === login)), 1),\r\n\t\t\t\t\t\tthis.setStorageEntry('account-manager', accounts)),\r\n\t\t\t\t\t\tcontainer.remove()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t],\r\n\t\t\tstyle: {\r\n\t\t\t\tdisplay: 'flex',\r\n            \tgap: '0.25rem'\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn container\r\n\t}\r\n\r\n\tstatic getAccountManager({ createIfNotExists, showLogin } = {}) {\r\n\t\t(this.accountManager || createIfNotExists) && (Object.defineProperty(this, 'accountManager', {\r\n\t\t\tvalue: document.body.appendChild(this.createElement(\"dialog#frhd-lite\\\\.account-manager\", {\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\tthis.createElement(\"span.core_icons.core_icons-icon_close.signup-login-modal-close\", {\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\t\tright: '.5em',\r\n\t\t\t\t\t\t\ttop: '.5em'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tclick: () => this.accountManager.close()\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tthis.createElement(\"div.accounts-container\", {\r\n\t\t\t\t\t\tchildren: (this.getStorageEntry('account-manager') ?? []).map(account => this.constructor.createAccountContainer(account)),\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\t\tflexDirection: 'column',\r\n\t\t\t\t\t\t\tgap: '0.4rem'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tthis.createElement(\"button.new-button.button-type-2\", {\r\n\t\t\t\t\t\tid: 'add-account',\r\n\t\t\t\t\t\tinnerText: \"Add account\",\r\n\t\t\t\t\t\tclick: event => {\r\n\t\t\t\t\t\t\tlet loginContainer = document.querySelector(\"div#login-container\");\r\n\t\t\t\t\t\t\tif (loginContainer) {\r\n\t\t\t\t\t\t\t\tevent.target.innerText = \"Add account\";\r\n\t\t\t\t\t\t\t\tevent.target.classList.replace('button-type-3', 'button-type-2');\r\n\t\t\t\t\t\t\t\tloginContainer.remove();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet submit = event.target;\r\n\t\t\t\t\t\t\tevent.target.before(this.createElement(\"div#login-container\", {\r\n\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\tthis.createElement(\"input.field.auth-field#save-account-login\", {\r\n\t\t\t\t\t\t\t\t\t\tplaceholder: \"Username or Email\",\r\n\t\t\t\t\t\t\t\t\t\tstyle: { borderRadius: \"2rem\" },\r\n\t\t\t\t\t\t\t\t\t\ttype: \"text\",\r\n\t\t\t\t\t\t\t\t\t\tkeyup(event) {\r\n\t\t\t\t\t\t\t\t\t\t\tevent.key === 'Enter' && this.nextElementSibling.focus()\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tthis.createElement(\"input.field.auth-field#save-account-password\", {\r\n\t\t\t\t\t\t\t\t\t\tplaceholder: \"Password\",\r\n\t\t\t\t\t\t\t\t\t\tstyle: { borderRadius: \"2rem\" },\r\n\t\t\t\t\t\t\t\t\t\ttype: \"password\",\r\n\t\t\t\t\t\t\t\t\t\tkeyup(event) {\r\n\t\t\t\t\t\t\t\t\t\t\tevent.key === 'Enter' && this.nextElementSibling.click()\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tthis.createElement(\"button.new-button.button-type-1\", {\r\n\t\t\t\t\t\t\t\t\t\tinnerText: \"Save account\",\r\n\t\t\t\t\t\t\t\t\t\tclick: event => {\r\n\t\t\t\t\t\t\t\t\t\t\tApplication.Helpers.AjaxHelper.post(\"/auth/standard_login\", {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlogin: document.querySelector(\"#save-account-login\")?.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\tpassword: document.querySelector(\"#save-account-password\")?.value\r\n\t\t\t\t\t\t\t\t\t\t\t}).done(res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!res.result) return;\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet accounts = this.getStorageEntry('account-manager') || [];\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (accounts.find(({ login }) => login === res.data.user.d_name)) return;\r\n\t\t\t\t\t\t\t\t\t\t\t\taccounts.push({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlogin: res.data.user.d_name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpassword: document.querySelector(\"#save-account-password\")?.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.accountManager.querySelector(\".accounts-container\").append(this.createAccountContainer(accounts[accounts.length - 1])),\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setStorageEntry('account-manager', accounts),\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmit.classList.replace('button-type-3', 'button-type-2'),\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmit.innerText = \"Add account\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tevent.target.parentElement.remove()\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\t\t\t\tflexDirection: 'column',\r\n\t\t\t\t\t\t\t\t\tgap: '0.4rem',\r\n\t\t\t\t\t\t\t\t\tmarginTop: '1rem'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\tevent.target.classList.replace('button-type-2', 'button-type-3'),\r\n\t\t\t\t\t\t\tevent.target.innerText = \"Cancel\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tthis.createElement(\"button.new-button.button-type-3\", {\r\n\t\t\t\t\t\tinnerText: \"Logout\",\r\n\t\t\t\t\t\tclick: () => this.accountManager.close('logout')\r\n\t\t\t\t\t})\r\n\t\t\t\t],\r\n\t\t\t\tclick: event => {\r\n\t\t\t\t\tif (this.accountManager !== event.target) return;\r\n\t\t\t\t\tlet rect = event.target.getBoundingClientRect()\r\n\t\t\t\t\t  , isInDialog = (rect.top <= event.clientY && event.clientY <= rect.top + rect.height &&\r\n\t\t\t\t\t\trect.left <= event.clientX && event.clientX <= rect.left + rect.width);\r\n\t\t\t\t\t!isInDialog && event.target.close()\r\n\t\t\t\t},\r\n\t\t\t\tclose: event => {\r\n\t\t\t\t\tswitch (event.target.returnValue) {\r\n\t\t\t\t\tcase 'logout':\r\n\t\t\t\t\t\tApplication.User.logout()\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tshowModal(target) {\r\n\t\t\t\t\tswitch (target) {\r\n\t\t\t\t\tcase 'login':\r\n\t\t\t\t\t\tlet addAccount = this.querySelector('#add-account');\r\n\t\t\t\t\t\taddAccount && !/^cancel$/i.test(addAccount.innerText) && addAccount.click()\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn HTMLDialogElement.prototype.showModal.call(this)\r\n\t\t\t\t}\r\n\t\t\t})),\r\n\t\t\twritable: true\r\n\t\t}), this.styleSheet.set('dialog#frhd-lite\\\\.account-manager[open]', {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tflexDirection: 'column',\r\n\t\t\tgap: '0.4em',\r\n\t\t\theight: 'fit-content',\r\n\t\t\tinset: 0,\r\n\t\t\tmargin: 'auto',\r\n\t\t\tmaxHeight: '50vmin',\r\n\t\t\tmaxWidth: '25vw',\r\n\t\t\tminWidth: '230px',\r\n\t\t\toverflow: 'hidden auto',\r\n\t\t\tpadding: '2.5em',\r\n\t\t\tposition: 'fixed',\r\n\t\t\twidth: '40vmin',\r\n\t\t\tzIndex: 1002\r\n\t\t}).set('dialog#frhd-lite\\\\.account-manager[open]::backdrop', {\r\n\t\t\tbackgroundColor: 'hsl(0deg 0% 0% / 50%)'\r\n\t\t}).set('.button-type-3', {\r\n\t\t\tbackgroundImage: 'linear-gradient(to bottom, hsl(7 86% 62% / 1), hsl(10 64% 46% / 1))'\r\n\t\t}).set('.button-type-3:hover', {\r\n\t\t\tbackgroundImage: 'linear-gradient(to bottom, hsl(4 79% 60% / 1), hsl(4 69% 37% / 1))'\r\n\t\t}));\r\n\t\treturn this.accountManager\r\n\t}\r\n\r\n\tstatic async createProgressElement(achievement) {\r\n\t\tlet container = this.createElement('div.achievement-info', {\r\n\t\t\tchildren: [\r\n\t\t\t\tthis.createElement('div', {\r\n\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\tthis.createElement('span.achievements-coin.store_icons.store_icons-coin_icon_lg.achievement-coin-value', {\r\n\t\t\t\t\t\t\tinnerText: achievement.coins,\r\n\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\tcolor: 'white',\r\n\t\t\t\t\t\t\t\tlineHeight: '45px',\r\n\t\t\t\t\t\t\t\ttextAlign: 'center',\r\n\t\t\t\t\t\t\t\ttextShadow: '0 -1px 1px #9E8500'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tthis.createElement('div.achievement-info', {\r\n\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\tthis.createElement('a.title', {\r\n\t\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\t\tthis.createElement('b', {\r\n\t\t\t\t\t\t\t\t\t\t\tinnerText: achievement.title\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\thref: await (description => {\r\n\t\t\t\t\t\t\t\t\t\tswitch (description) {\r\n\t\t\t\t\t\t\t\t\t\tcase 'Buy 1 item from the shop':\r\n\t\t\t\t\t\t\t\t\t\t\treturn 'store/gear';\r\n\t\t\t\t\t\t\t\t\t\tcase 'Complete 1 friend race':\r\n\t\t\t\t\t\t\t\t\t\tcase 'Win 5 friend(s) race':\r\n\t\t\t\t\t\t\t\t\t\t\treturn this.fetchCurrentUser().then(async ({ friends }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (friends.friend_cnt > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet track;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let friend of friends.friends_data) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (track = await fetch('/u/' + friend.u_name).then(r => r.json()).then(({ recently_ghosted_tracks: { tracks }}) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn tracks[Math.floor(Math.random() * tracks.length)];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn track;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn 'random/track'\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tcase 'Improve 5 best times':\r\n\t\t\t\t\t\t\t\t\t\tcase 'Send 5 friend race challenges':\r\n\t\t\t\t\t\t\t\t\t\t\treturn this.fetchCurrentUser().then(({ recently_ghosted_tracks: { tracks }}) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet track = tracks[Math.floor(Math.random() * tracks.length)];\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn track ? track.slug : 'random/track';\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\t\treturn 'random/track'\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})(achievement.desc),\r\n\t\t\t\t\t\t\t\t\tstyle: { width: '-webkit-fill-available' }\r\n\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\tthis.createElement('h6.achievement-info-desc.condensed', {\r\n\t\t\t\t\t\t\t\t\tinnerText: achievement.desc,\r\n\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\tcolor: 'hsl(190deg 25% 60%)',\r\n\t\t\t\t\t\t\t\t\t\tfontFamily: 'roboto_bold',\r\n\t\t\t\t\t\t\t\t\t\tmargin: 0\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t],\r\n\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\talignItems: 'center',\r\n\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\tgap: '0.5rem'\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\t// achievement.coins\r\n\t\t\t\tthis.createElement('span', {\r\n\t\t\t\t\tinnerText: achievement.progress, // achievement.current, // achievement.progress // achievement.current + '/' + achievement.max\r\n\t\t\t\t\tstyle: { fontSize: '1.25rem' }\r\n\t\t\t\t})\r\n\t\t\t],\r\n\t\t\tstyle: {\r\n\t\t\t\talignItems: 'center',\r\n\t\t\t\tdisplay: 'flex',\r\n\t\t\t\tjustifyContent: 'space-between'\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn container;\r\n\t}\r\n\r\n\tstatic createElement(type, options = {}) {\r\n\t\tconst callback = arguments[arguments.length - 1];\r\n\t\tconst element = document.createElement(type.replace(/[\\.#].+/g, ''));\r\n\t\tconst matchId = type.match(/(?<=#)([^\\.]+((?<=\\\\)\\.)?)+/);\r\n\t\tnull !== matchId && (element.setAttribute('id', matchId[0].replace(/\\\\/g, '')),\r\n\t\ttype = type.replace('#' + matchId[0], ''));\r\n\t\tconst classList = type.match(/(?<=\\.)([^\\.#]+((?<=\\\\)\\.)?)+/g);\r\n\t\tnull !== classList && element.classList.add(...classList.map(name => name.replace(/\\\\/g, '')));\r\n\t\tif ('innerText' in options) {\r\n\t\t\telement.innerText = options.innerText,\r\n\t\t\tdelete options.innerText;\r\n\t\t}\r\n\r\n\t\tfor (const attribute in options) {\r\n\t\t\tif (typeof options[attribute] == 'object') {\r\n\t\t\t\tif (options[attribute] instanceof Array) {\r\n\t\t\t\t\tif (/^children$/i.test(attribute)) {\r\n\t\t\t\t\t\telement.append(...options[attribute]);\r\n\t\t\t\t\t} else if (/^classlist$/i.test(attribute))\r\n\t\t\t\t\t\telement.classList.add(...options[attribute]);\r\n\t\t\t\t} else if (/^(dataset|style)$/i.test(attribute))\r\n\t\t\t\t\tObject.assign(element[attribute.toLowerCase()], options[attribute]);\r\n\t\t\t\telse continue;\r\n\t\t\t} else if (typeof options[attribute] == 'function') {\r\n\t\t\t\tif (/^mutation$/i.test(attribute)) {\r\n\t\t\t\t\ttypeof options['MutationObserverOptions'] == 'object' && (new MutationObserver(options[attribute]).observe(element, options['MutationObserverOptions']),\r\n\t\t\t\t\tdelete options['MutationObserverOptions']);\r\n\t\t\t\t} else if (element['on' + attribute] !== undefined)\r\n\t\t\t\t\telement.addEventListener(attribute, options[attribute], { passive: !/\\.preventDefault\\(\\)/g.test(options[attribute].toString()) });\r\n\t\t\t\telse continue;\r\n\t\t\t} else continue;\r\n\t\t\tdelete options[attribute]\r\n\t\t}\r\n\r\n\t\tObject.assign(element, options);\r\n\t\treturn typeof callback == 'function' && callback(element), element\r\n\t}\r\n\r\n\tstatic async downloadFile(name, contents, { desc } = {}) {\r\n\t\tlet mimeType = 'text/plain';\r\n\t\tif (!(contents instanceof Blob)) {\r\n\t\t\ttypeof contents == 'object' && (mimeType = 'application/json',\r\n\t\t\tcontents = JSON.stringify(contents, '\\t', 4));\r\n\t\t\tif ('showSaveFilePicker' in window) {\r\n\t\t\t\treturn showSaveFilePicker({\r\n\t\t\t\t\texcludeAcceptAllOption: true,\r\n\t\t\t\t\tstartIn: 'downloads',\r\n\t\t\t\t\tsuggestedName: name ?? '',\r\n\t\t\t\t\ttypes: [{\r\n\t\t\t\t\t\tdescription: 'Free Rider HD ' + desc,\r\n\t\t\t\t\t\taccept: { [mimeType]: ['.' + (mimeType == 'application/zip' ? 'zip' : mimeType == 'application/json' ? 'json' : 'txt')] }\r\n\t\t\t\t\t}]\r\n\t\t\t\t}).then(async fileHandle => {\r\n\t\t\t\t\tlet writable = fileHandle.createWritable();\r\n\t\t\t\t\tawait writable.write(contents);\r\n\t\t\t\t\tawait writable.close();\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tconsole.log('Download operation cancelled.')\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet download = this.createElement('a', {\r\n\t\t\tdownload: name || ('frhd-lite_download-' + Date.now()),\r\n\t\t\thref: URL.createObjectURL(\r\n\t\t\t\tcontents instanceof Blob ? contents : new Blob([contents], {\r\n\t\t\t\t\ttype: mimeType\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t});\r\n\t\tdownload.click();\r\n\t\tURL.revokeObjectURL(download.href)\r\n\t}\r\n\r\n\tstatic downloadRace(tid, uid) {\r\n\t\treturn Application.Helpers.AjaxHelper.post(\"/track_api/load_races\", {\r\n\t\t\tt_id: tid,\r\n\t\t\tu_ids: uid\r\n\t\t}).done(({ data: [entry], result: r }) => {\r\n\t\t\tr && this.downloadFile('frhd_ghost_' + tid + '-' + uid, Object.assign(entry.race, {\r\n\t\t\t\tt_id: tid,\r\n\t\t\t\tu_id: entry.user.u_id\r\n\t\t\t}), { desc: 'Race' })\r\n\t\t})\r\n\t}\r\n\r\n\tstatic downloadTrack(id) {\r\n\t\treturn fetch('/track_api/load_track?id=' + id + '&fields[]=code&fields[]=id&fields[]=title').then(r => r.json()).then(({ data: { track } = {}, result }) => {\r\n\t\t\tif (!result) return;\r\n\t\t\tthis.downloadFile(track.title + '-' + track.id, track.code, { desc: 'Track' })\r\n\t\t})\r\n\t}\r\n\r\n\tstatic async downloadAllTracks(username) {\r\n\t\treturn fetch('/u/' + username + '/created?ajax').then(r => r.json()).then(async ({ created_tracks }) => {\r\n\t\t\tlet zip = new Zip();\r\n\t\t\tlet tracks = await Promise.all(created_tracks.tracks.map(track => fetch('/track_api/load_track?id=' + track.id + '&fields[]=code&fields[]=id&fields[]=title').then(r => r.json())))\r\n\t\t\t.then(tracks => tracks.filter(({ result }) => result).map(({ data }) => data.track));\r\n\t\t\tfor (let track of tracks)\r\n\t\t\t\tzip.newFile(track.title + '-' + track.id + '.txt', track.code);\r\n\t\t\tthis.downloadFile('created-tracks', zip.blob(), { desc: 'Created' })\r\n\t\t})\r\n\t}\r\n\r\n\tstatic async fetchAchievements({ force } = {}) {\r\n\t\tconst KEY = this.keyify('achievements');\r\n\t\tlet cache = sessionStorage.getItem(KEY);\r\n\t\tif (cache && !force) {\r\n\t\t\treturn JSON.parse(cache);\r\n\t\t}\r\n\r\n\t\tlet data = await fetch('/achievements?ajax').then(r => r.json());\r\n\t\tsessionStorage.setItem(KEY, JSON.stringify(data));\r\n\t\treturn data\r\n\t}\r\n\r\n\tstatic async updateAchievements(data, { force } = {}) {\r\n\t\tconst KEY = this.keyify('achievements');\r\n\t\tconst entry = await this.fetchAchievements({ force });\r\n\t\tsessionStorage.setItem(KEY, JSON.stringify(Object.assign(entry, data)));\r\n\t\treturn entry\r\n\t}\r\n\r\n\tstatic async fetchCurrentUser({ force } = {}) {\r\n\t\tconst KEY = this.keyify('current_user');\r\n\t\tlet cache = sessionStorage.getItem(KEY);\r\n\t\tif (cache && !force) {\r\n\t\t\treturn JSON.parse(cache);\r\n\t\t}\r\n\r\n\t\tconst { ajax } = Application.router.current_view;\r\n\t\tconst entry = ajax && ajax.header_title && ((ajax.user && uid === ajax.user.id) || uid === ajax.header_title.toLowerCase()) ? ajax : await fetch('/u/' + Application.settings.user.u_name + '?ajax').then(r => r.json());\r\n\t\tsessionStorage.setItem(KEY, JSON.stringify(entry));\r\n\t\treturn entry || null\r\n\t}\r\n\r\n\tstatic async fetchCurrentUserCosmetics({ force } = {}) {\r\n\t\tconst KEY = this.keyify('current_user.cosmetics');\r\n\t\tlet cache = sessionStorage.getItem(KEY);\r\n\t\tif (cache && !force) {\r\n\t\t\treturn JSON.parse(cache);\r\n\t\t}\r\n\r\n\t\tlet data = await fetch('/store/gear?ajax').then(r => r.json());\r\n\t\tsessionStorage.setItem(KEY, JSON.stringify(data));\r\n\t\treturn data\r\n\t}\r\n\r\n\tstatic users = [];\r\n\tstatic async fetchUser(uid, { force } = {}) {\r\n\t\tuid = String(uid).toLowerCase();\r\n\t\tif (uid == Application.settings.user.u_id || uid == Application.settings.user.u_name) return this.fetchCurrentUser();\r\n\t\tlet cache = this.users.find(({ user: { u_id, u_name }}) => u_id == uid || u_name === uid.toLowerCase());\r\n\t\tif (cache && !force) {\r\n\t\t\treturn cache;\r\n\t\t}\r\n\t\tconst { ajax } = Application.router.current_view;\r\n\t\tconst entry = ajax && ajax.header_title && ((ajax.user && uid === ajax.user.id) || uid === ajax.header_title.toLowerCase()) ? ajax : await fetch(location.pathname + '?ajax').then(r => r.json());\r\n\t\t// let entry = await fetch('/u/' + uid + '?ajax').then(r => r.json());\r\n\t\tthis.users.push(entry);\r\n\t\treturn entry || null\r\n\t}\r\n\r\n\tstatic fetchComment(trackId, commentId) {\r\n\t\treturn Application.Helpers.AjaxHelper.post('track_comments/load_more/' + trackId + '/' + (commentId + 1)).then(r => r.result && r.data.track_comments[0]);\r\n\t}\r\n\r\n\tstatic async fetchFeaturedGhosts({ force } = {}) {\r\n\t\tconst KEY = this.keyify('featured_ghosts');\r\n\t\tlet cache = sessionStorage.getItem(KEY);\r\n\t\tif (cache && !force) {\r\n\t\t\treturn JSON.parse(cache);\r\n\t\t}\r\n\r\n\t\tlet data = await fetch(\"https://raw.githubusercontent.com/calculamatrise/frhd-featured-ghosts/master/data.json\").then(r => r.json());\r\n\t\tsessionStorage.setItem(KEY, JSON.stringify(data));\r\n\t\treturn data\r\n\t}\r\n\r\n\tstatic async fetchRaceBestDate({ force } = {}) {\r\n\t\tconst KEY = this.keyify('race_best_dates');\r\n\t\tlet cache = JSON.parse(sessionStorage.getItem(KEY)) || {}\r\n\t\t  , t = GameSettings.track.id;\r\n\t\tif (!force && cache[t]) {\r\n\t\t\treturn cache[t]\r\n\t\t}\r\n\t\tconst { ajax } = Application.router.current_view;\r\n\t\tconst { user_track_stats: { best_date: date } = {}} = ajax && ajax.track && ajax.track.id === t ? ajax : await fetch(location.pathname + '?ajax').then(r => r.json());\r\n\t\tsessionStorage.setItem(KEY, JSON.stringify(Object.assign(cache, { [t]: date })));\r\n\t\treturn date\r\n\t}\r\n\r\n\tstatic async fetchTrackLastPlayedDate({ force } = {}) {\r\n\t\tconst KEY = this.keyify('track_last_played_dates');\r\n\t\tlet cache = JSON.parse(sessionStorage.getItem(KEY)) || {}\r\n\t\t  , t = GameSettings.track.id;\r\n\t\tif (!force && cache[t]) {\r\n\t\t\treturn cache[t]\r\n\t\t}\r\n\t\tconst { ajax } = Application.router.current_view;\r\n\t\tconst { user_track_stats: { last_played_date: date } = {}} = ajax && ajax.track && ajax.track.id === t ? ajax : await fetch(location.pathname + '?ajax').then(r => r.json());\r\n\t\tsessionStorage.setItem(KEY, JSON.stringify(Object.assign(cache, { [t]: date })));\r\n\t\treturn date\r\n\t}\r\n\r\n\tstatic fetchRaceRow(data, { parent, placement }) {\r\n\t\tconst racerProfile = 'https://' + location.host + '/u/' + data.user.d_name.toLowerCase();\r\n\t\tconst racerAvatar = racerProfile + '/pic?sz=50';\r\n\t\tlet row = parent.querySelector('tr.track-leaderboard-race-' + data.user.u_id);\r\n\t\tif (row === null) {\r\n\t\t\trow = this.createElement('tr', {\r\n\t\t\t\tclassName: 'track-leaderboard-race-' + data.user.u_id + ' track-leaderboard-race-row',\r\n\t\t\t\tdataset: {\r\n\t\t\t\t\tu_id: data.user.u_id,\r\n\t\t\t\t\td_name: data.user.d_name,\r\n\t\t\t\t\trun_time: data.runTime,\r\n\t\t\t\t\t// type: 'tas'\r\n\t\t\t\t},\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\tthis.createElement('td.num', { innerText: placement + '.' }),\r\n\t\t\t\t\tthis.createElement('td.name', {\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\tthis.createElement('a.profile-icon', {\r\n\t\t\t\t\t\t\t\thref: racerProfile,\r\n\t\t\t\t\t\t\t\ttitle: 'View Profile',\r\n\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\tthis.createElement('div.circular', {\r\n\t\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\t\tbackground: 'url(' + racerAvatar + ') no-repeat center center',\r\n\t\t\t\t\t\t\t\t\t\t\tbackgroundSize: '100%'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\t\t\tthis.createElement('img', {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsrc: racerAvatar,\r\n\t\t\t\t\t\t\t\t\t\t\t\twidth: 35,\r\n\t\t\t\t\t\t\t\t\t\t\t\theight: 35,\r\n\t\t\t\t\t\t\t\t\t\t\t\talt: data.user.d_name\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\tthis.createElement('span.track-leaderboard-race', {\r\n\t\t\t\t\t\t\t\tinnerText: data.user.d_name,\r\n\t\t\t\t\t\t\t\ttitle: 'Race ' + data.user.d_name\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tdocument.createElement('td'),\r\n\t\t\t\t\tthis.createElement('td', {\r\n\t\t\t\t\t\tinnerText: data.runTime,\r\n\t\t\t\t\t\tstyle: { textAlign: 'left' }\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tthis.createElement('td.track-leaderboard-action', {\r\n\t\t\t\t\t\tstyle: { width: '20%' }\r\n\t\t\t\t\t})\r\n\t\t\t\t]\r\n\t\t\t})\r\n\t\t}\r\n\t\trow.dataset.d_name = data.user.d_name,\r\n\t\tdata.runTime && (row.dataset.run_time = data.runTime);\r\n\t\tlet time = row.querySelector('td:nth-child(4)');\r\n\t\ttime !== null && data.runTime && (time.innerText = data.runTime);\r\n\t\treturn row\r\n\t}\r\n\r\n\tstatic formatRaceTime(t) {\r\n\t\tt = parseInt(t, 10);\r\n\t\tlet e = t % 6e4 / 1e3;\r\n\t\treturn Math.floor(t / 6e4) + \":\" + e.toFixed(2).padStart(5, 0)\r\n\t}\r\n\r\n\tstatic isUserModerator(data) {\r\n\t\tdata.hasOwnProperty('user') && (data = data.user);\r\n\t\treturn data.moderator || data.admin\r\n\t}\r\n\r\n\tstatic _attachShortcuts(key, target) {\r\n\t\treturn Object.defineProperties(target, {\r\n\t\t\tdelete: {\r\n\t\t\t\tvalue: () => localStorage.removeItem(this.keyify(key)),\r\n\t\t\t\twritable: true\r\n\t\t\t},\r\n\t\t\tset: {\r\n\t\t\t\tvalue: value => this.setStorageEntry(key, value),\r\n\t\t\t\twritable: true\r\n\t\t\t},\r\n\t\t\tupdate: {\r\n\t\t\t\tvalue: value => this.setStorageEntry(key, value),\r\n\t\t\t\twritable: true\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tstatic deleteStorageEntry(key) {\r\n\t\treturn localStorage.removeItem(this.keyify(key))\r\n\t}\r\n\r\n\tstatic getStorageEntry(key, value) {\r\n\t\tlet entry = localStorage.getItem(this.keyify(key));\r\n\t\tif (!entry && value) {\r\n\t\t\treturn this.setStorageEntry(key, value)\r\n\t\t}\r\n\t\treturn entry !== null && /^[\\[{]]|[}\\]]$/g.test(entry) ? this._attachShortcuts(this.keyify(key), JSON.parse(entry)) : entry\r\n\t}\r\n\r\n\tstatic setStorageEntry(key, value) {\r\n\t\treturn localStorage.setItem(this.keyify(key), typeof value == 'object' ? JSON.stringify(value) : value),\r\n\t\ttypeof value == 'object' ? this._attachShortcuts(this.keyify(key), structuredClone(value)) : value\r\n\t}\r\n\r\n\tstatic updateStorageEntry(key, value) {\r\n\t\tlet entry = this.getStorageEntry(key) || new value.constructor;\r\n\t\tentry instanceof Array ? entry.push(...value) : Object.assign(entry, value); // recurse?\r\n\t\treturn this.setStorageEntry(key, value)\r\n\t}\r\n\r\n\tstatic keyify(key) {\r\n\t\treturn key.replace(/^(?:frhd-lite\\.)?(.+)/i, 'frhd-lite.$1')\r\n\t}\r\n\r\n\tstatic report(message, data = {}, { type } = {}) {\r\n\t\tif (!Application.settings.user) return alert('You must be logged in to perform this action.');\r\n\t\tdata = Object.assign({}, data, { t_id: GameSettings.track.id });\r\n\t\twindow.postMessage({\r\n\t\t\taction: 'report',\r\n\t\t\tdata,\r\n\t\t\treporter: Application.settings.user,\r\n\t\t\ttype\r\n\t\t});\r\n\t\treturn Application.Helpers.AjaxHelper.post('track_comments/post', {\r\n\t\t\tt_id: data.t_id,\r\n\t\t\tmsg: message.replace(/{data-(\\w+)}/g, (_, key) => data[key]) + ' was reported with frhd-lite. (@Calculus/@Eric/@Totoca12)'\r\n\t\t})\r\n\t}\r\n\r\n\tstatic reportRegex(message, data, { type } = {}) {\r\n\t\tconst hrefify = a => \"<a\\\\shref=\\\"\" + location.origin + \"\\\\/u\\\\/\" + a.toLowerCase() + \"\\\">\" + a + \"<\\/a>\";\r\n\t\tmessage = message.replace(/{data-(\\w+)}/g, (_, key) => data[key]).replace(/([\\(\\)])/g, '\\\\$1').replace(/@([\\w\\._-]+)/, (_, t) => hrefify(t));\r\n\t\treturn new RegExp((message ? \"^\" + type.replace(/^\\w/, c => c.toUpperCase()) + \"\\\\s\" + message : '') + \" was reported with frhd-lite. \\\\(\" + hrefify('Calculus') + \"\\\\/\" + hrefify('Eric') + \"\\\\/\" + hrefify('Totoca12') + \"\\\\)$\", 'i')\r\n\t}\r\n\r\n\tstatic fetchReports(...args) {\r\n\t\targs.length < 1 && (args.splice(0, 1, '.+'),\r\n\t\targs.splice(1, 1, { d_name: '\\\\w+', u_id: '\\\\d+' }),\r\n\t\targs.splice(2, 1, type = '\\\\w+'));\r\n\t\tconst comments = Array.from(document.querySelectorAll('.track-comment-msg'));\r\n\t\tconst reportRegex = this.reportRegex(...args);\r\n\t\treturn comments.filter(t => t.innerHTML.match(reportRegex))\r\n\t}\r\n\r\n\tstatic verifyRaceData(data) {\r\n\t\ttypeof data.race.code == 'string' && (data.race.code = JSON.parse(data.race.code));\r\n\t\tlet isTas = true == 'tas' in data.race.code;\r\n\t\tlet duplicateInputs = 0;\r\n\t\tfor (let i in data.race.code) {\r\n\t\t\tif (!/_down$/i.test(i)) continue;\r\n\t\t\tlet key = i.replace(/_\\w+$/i, '');\r\n\t\t\tlet ticksDown = Object.keys(data.race.code[i]);\r\n\t\t\tif (!data.race.code[key + '_up']) continue;\r\n\t\t\tfor (let s of ticksDown) {\r\n\t\t\t\tdata.race.code[key + '_up'][s] > 0 && (isTas = true,\r\n\t\t\t\tduplicateInputs++)\r\n\t\t\t}\r\n\t\t}\r\n\t\tduplicateInputs > 0 && (isTas = true);\r\n\t\tconsole.log(data.race.code, duplicateInputs, isTas);\r\n\t\treturn !isTas\r\n\t}\r\n\r\n\tstatic waitForElm(selector, limit) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet element = document.querySelector(selector);\r\n\t\t\tif (element)\r\n\t\t\t\treturn resolve(element);\r\n\t\t\tnew MutationObserver((mutations, observer) => {\r\n\t\t\t\tif (!mutations.find(({ addedNodes }) => addedNodes.length > 0)) return;\r\n\t\t\t\telement = document.querySelector(selector);\r\n\t\t\t\telement && (resolve(element),\r\n\t\t\t\tobserver.disconnect())\r\n\t\t\t}).observe(document.body, {\r\n\t\t\t\tchildList: true,\r\n\t\t\t\tsubtree: true\r\n\t\t\t});\r\n\t\t\tlimit && setTimeout(reject, limit, new Error('Operation timed out'))\r\n\t\t})\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/Lite.js?");

/***/ }),

/***/ "./src/game/class/ThirdPartyManager.js":
/*!*********************************************!*\
  !*** ./src/game/class/ThirdPartyManager.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ThirdPartyManager)\n/* harmony export */ });\n/* harmony import */ var _EventEmitter_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EventEmitter.js */ \"./src/game/class/EventEmitter.js\");\n\r\n\r\nclass ThirdPartyManager extends _EventEmitter_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\t#cache = new Map();\r\n\t#csPreference = null;\r\n\t#loaded = !1;\r\n\t#parent = null;\r\n\tpreferredColorScheme = null;\r\n\tconstructor(parent) {\r\n\t\tsuper(),\r\n\t\tparent.thirdParty = this,\r\n\t\tparent.on('stateChange', state => {\r\n\t\t\tif (state.preloading === !1 && this.#loaded === !1)\r\n\t\t\t\tthis.#loaded = (this.emit('ready', parent.game), !0);\r\n\t\t\tthis.#loaded && this.emit('stateChange', state)\r\n\t\t}),\r\n\t\tthis.#parent = parent,\r\n\t\twindow.hasOwnProperty('Application') && (Object.defineProperty(Application.router.current_view, 'ajax', { value: null, writable: true }),\r\n\t\tApplication.events.subscribe('ajax.request', e => typeof e.header_title == 'string' && (Application.router.current_view.ajax = e))),\r\n\t\twindow.hasOwnProperty('navigation') && navigation.addEventListener('navigate', e => e.navigationType != 'replace' && (this.#loaded = !1), { passive: true }),\r\n\t\tthis.#csPreference = matchMedia('(prefers-color-scheme: dark)'),\r\n\t\tthis._updatePreferredColorScheme(this.#csPreference),\r\n\t\tthis.#csPreference.onchange = event => this._updatePreferredColorScheme(event.target)\r\n\t}\r\n\r\n\t_updatePreferredColorScheme(mediaQuery) {\r\n\t\tthis.preferredColorScheme = mediaQuery.matches ? 'dark' : 'light'\r\n\t}\r\n\r\n\thook(instance, { name, overwrite } = {}) {\r\n\t\tname ??= instance.name ?? instance._name;\r\n\t\tif (overwrite || !this.#cache.has(name)) {\r\n\t\t\tthis.#cache.set(name, instance);\r\n\t\t\tif (!this.hasOwnProperty(name)) {\r\n\t\t\t\tthis[name] = instance;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this.#cache.get(name)\r\n\t}\r\n\r\n\tincludes(name) {\r\n\t\treturn this.#cache.has(name)\r\n\t}\r\n}\r\n\r\nlet GameManager = window.GameManager;\r\nlet start = Date.now();\r\nwhile (!GameManager) {\r\n\tGameManager = window.GameManager;\r\n\tif (Date.now() - start > 5e3)\r\n\t\tconsole.warn('GameManager load timed out.');\r\n\t\tbreak;\r\n}\r\n\r\nGameManager && (window.ModManager ||= new ThirdPartyManager(GameManager))\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/ThirdPartyManager.js?");

/***/ }),

/***/ "./src/game/class/controls/controls.js":
/*!*********************************************!*\
  !*** ./src/game/class/controls/controls.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tdefaultControlOptions = {\r\n\t\tvisible: !0\r\n\t}\r\n\tname = null;\r\n\tcontrolsSpriteSheetData = {};\r\n\tcontrolData = null;\r\n\tgame = null;\r\n\tscene = null;\r\n\tsettings = null;\r\n\tcontrolsSprite = null;\r\n\tgamepad = null;\r\n\tproperties = {\r\n\t\tright: 0,\r\n\t\tscaleX: window.devicePixelRatio / 2,\r\n\t\tscaleY: window.devicePixelRatio / 2,\r\n\t\ttop: 60,\r\n\t\tvisible: !0,\r\n\t\tx: 0,\r\n\t\ty: 0\r\n\t}\r\n\tconstructor(t) {\r\n\t\tthis.scene = t,\r\n\t\tthis.game = t.game,\r\n\t\tthis.assets = t.assets,\r\n\t\tthis.settings = t.settings,\r\n\t\tthis.mouse = t.mouse,\r\n\t\tthis.playerManager = t.playerManager\r\n\t}\r\n\tinit() {\r\n\t\tthis.createSprite(),\r\n\t\tthis.resize()\r\n\t}\r\n\tclick() {\r\n\t\tfor (const i in this.controlData) {\r\n\t\t\tconst component = this.controlData[i];\r\n\t\t\tif (component.disabled) continue;\r\n\t\t\tif (this.isMouseOverComponent(component)) {\r\n\t\t\t\tthis.scene.buttonDown(component.key)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcreateSprite() {\r\n\t\tlet t = this.scene.assets.getResult(this.name)\r\n\t\t  , e = this.controlsSpriteSheetData;\r\n\t\te.images = [t];\r\n\t\tthis.controlsSprite = t\r\n\t}\r\n\tdraw(t) {\r\n\t\tif (!this.properties.visible) return;\r\n\t\tlet globalAlpha = t.globalAlpha;\r\n\t\ttypeof this.properties.alpha == 'number' && (t.globalAlpha = this.properties.alpha);\r\n\t\tfor (const i in this.controlData) {\r\n\t\t\tconst component = this.controlData[i];\r\n\t\t\tlet ctrlData = this.controlsSpriteSheetData[(component.image || i) + \"_btn\"]\r\n\t\t\t  , width = ctrlData[2] * this.properties.scaleX\r\n\t\t\t  , height = ctrlData[3] * this.properties.scaleY;\r\n\t\t\ttypeof component.alpha == 'number' && (t.globalAlpha = (typeof this.properties.alpha != 'number' || this.properties.alpha) * ((component.alpha + (Boolean(component.active) && .25)) / (2 - !component.disabled))),\r\n\t\t\tt.drawImage(this.controlsSpriteSheetData.images[0], ...ctrlData, this.game.width - component.right * this.properties.scaleX - width / 2, component.top * this.properties.scaleY - height / 2, width, height);\r\n\t\t}\r\n\t\tglobalAlpha !== t.globalAlpha && (t.globalAlpha = globalAlpha)\r\n\t}\r\n\tisMouseOverComponent(component) {\r\n\t\tconst { x, y } = this.mouse.touch.pos;\r\n\t\treturn Math.sqrt((x - component.x) ** 2 + (y - component.y) ** 2) < component.width / 2 * component.scaleX\r\n\t}\r\n\tisVisible() {\r\n\t\treturn this.properties.visible\r\n\t}\r\n\thide() {\r\n\t\tthis.setVisibility(!1)\r\n\t}\r\n\tshow() {\r\n\t\tthis.setVisibility(!0)\r\n\t}\r\n\tsetVisibility(t) {\r\n\t\tthis.properties.visible = t\r\n\t}\r\n\tmouseOver(t) {\r\n\t\tt && (t.alpha = this.mouse.touch.down ? 1 : .8),\r\n\t\tthis.mouse.enabled = !1,\r\n\t\tthis.game.canvas.style.setProperty('cursor', 'pointer')\r\n\t}\r\n\tmouseOut(t) {\r\n\t\tt && (t.alpha = .5),\r\n\t\tthis.mouse.enabled = !0,\r\n\t\tthis.game.canvas.style.removeProperty('cursor')\r\n\t}\r\n\tcontrolDown(t) {\r\n\t\tlet e = t.target\r\n\t\t  , i = e.buttonDetails\r\n\t\t  , s = this.playerManager.firstPlayer.getGamepad();\r\n\t\ti.key && s.setButtonDown(i.key);\r\n\t\tif (i.keys)\r\n\t\t\tfor (let r = i.keys, o = 0; r.length > o; o++) {\r\n\t\t\t\ts.setButtonDown(r[o])\r\n\t\t\t}\r\n\t\ti.downCallback && i.downCallback(t),\r\n\t\tthis.mouse.enabled = !1,\r\n\t\te.alpha = 1\r\n\t}\r\n\tcontrolUp(t) {\r\n\t\tlet e = t.target\r\n\t\t  , i = e.buttonDetails\r\n\t\t  , s = this.playerManager.firstPlayer.getGamepad();\r\n\t\ti.key && s.setButtonUp(i.key);\r\n\t\tif (i.keys)\r\n\t\t\tfor (let r = i.keys, o = 0; r.length > o; o++) {\r\n\t\t\t\ts.setButtonUp(r[o])\r\n\t\t\t}\r\n\t\ti.upCallback && i.upCallback(t),\r\n\t\tthis.mouse.enabled = !0,\r\n\t\te.alpha = .8\r\n\t}\r\n\tclose() {}\r\n\tredraw() {\r\n\t\tfor (const i in this.controlData) {\r\n\t\t\tconst component = this.controlData[i];\r\n\t\t\tif (!component.disabled && this.isMouseOverComponent(component)) {\r\n\t\t\t\tthis.mouseOver(component)\r\n\t\t\t\tcomponent.hovering = true\r\n\t\t\t} else if (component.hovering && !this.mouse.enabled) {\r\n\t\t\t\tthis.mouseOut(component);\r\n\t\t\t\tdelete component.hovering\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tresize() {\r\n\t\tlet t = this.scene.game\r\n\t\t  , e = t.width\r\n\t\t  , i = t.height;\r\n\t\tthis.properties.scaleX = this.properties.scaleY = window.devicePixelRatio / 2,\r\n\t\tthis.properties.bottom && (this.properties.y = i - this.properties.bottom * this.properties.scaleY),\r\n\t\tthis.properties.left && (this.properties.x = this.properties.left * this.properties.scaleX),\r\n\t\tthis.properties.right && (this.properties.x = e - this.properties.right * this.properties.scaleX),\r\n\t\tthis.properties.top && (this.properties.y = this.properties.top * this.properties.scaleY)\r\n\t\tfor (const s in this.controlData) {\r\n\t\t\tconst component = this.controlData[s];\r\n\t\t\tcomponent.scaleX = component.scaleY = window.devicePixelRatio / 2,\r\n\t\t\tcomponent.bottom && (component.y = i - component.bottom * component.scaleY),\r\n\t\t\tcomponent.left && (component.x = component.left * component.scaleX),\r\n\t\t\tcomponent.right && (component.x = e - component.right * component.scaleX),\r\n\t\t\tcomponent.top && (component.y = component.top * component.scaleY)\r\n\t\t}\r\n\t}\r\n\tupdate() {}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/controls/controls.js?");

/***/ }),

/***/ "./src/game/class/controls/fullscreen.js":
/*!***********************************************!*\
  !*** ./src/game/class/controls/fullscreen.js ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _controls_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./controls.js */ \"./src/game/class/controls/controls.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _controls_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = \"fullscreen_controls\";\r\n\tfullscreen = !1;\r\n\tcontrolsSpriteSheetData = {\r\n\t\texit_fullscreen_btn: [230, 2, 76, 76],\r\n\t\tfullscreen_btn: [78, 2, 76, 76]\r\n\t}\r\n\tcontrolData = {\r\n\t\tfullscreen: {\r\n\t\t\ttop: 60,\r\n\t\t\tright: 150,\r\n\t\t\tkey: \"fullscreen\",\r\n\t\t\talpha: 0.5,\r\n\t\t\twidth: 76,\r\n\t\t\theight: 76\r\n\t\t}\r\n\t}\r\n\tconstructor() {\r\n\t\tsuper(...arguments),\r\n\t\tthis.init()\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.scene.settings.fullscreen;\r\n\t\tthis.fullscreen !== t && (this.controlData.fullscreen.image = t ? \"exit_fullscreen\" : \"fullscreen\",\r\n\t\tthis.fullscreen = t)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/controls/fullscreen.js?");

/***/ }),

/***/ "./src/game/class/controls/pathtracer.js":
/*!***********************************************!*\
  !*** ./src/game/class/controls/pathtracer.js ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _controls_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./controls.js */ \"./src/game/class/controls/controls.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _controls_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = \"phone_controls\";\r\n\tcontrolsSpriteSheetData = {\r\n\t\tcheckpoint_btn: [912, 78, 73, 73]\r\n\t}\r\n\tcontrolData = {\r\n\t\tcheckpoint: {\r\n\t\t\tdisabled: true,\r\n\t\t\ttop: 60,\r\n\t\t\tright: 310,\r\n\t\t\tkey: \"checkpoint\",\r\n\t\t\talpha: 0.5,\r\n\t\t\twidth: 76,\r\n\t\t\theight: 76\r\n\t\t}\r\n\t}\r\n\tconstructor() {\r\n\t\tsuper(...arguments),\r\n\t\tthis.init()\r\n\t}\r\n\tclick() {\r\n\t\tfor (const i in this.controlData) {\r\n\t\t\tconst component = this.controlData[i];\r\n\t\t\tif (component.disabled) continue;\r\n\t\t\tif (this.isMouseOverComponent(component)) {\r\n\t\t\t\tcomponent.active = !component.active,\r\n\t\t\t\tthis.scene.toolHandler.setTool(component.active ? 'pathtracer' : 'camera')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/controls/pathtracer.js?");

/***/ }),

/***/ "./src/game/class/controls/pause.js":
/*!******************************************!*\
  !*** ./src/game/class/controls/pause.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _controls_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./controls.js */ \"./src/game/class/controls/controls.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _controls_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = \"pause_controls\";\r\n\tpaused = !1;\r\n\tcontrolsSpriteSheetData = {\r\n\t\tpause_btn: [230, 2, 76, 76],\r\n\t\tplay_btn: [78, 2, 76, 76]\r\n\t}\r\n\tcontrolData = {\r\n\t\tpause: {\r\n\t\t\talpha: 0.5,\r\n\t\t\tkey: \"pause\",\r\n\t\t\ttop: 60,\r\n\t\t\tright: 70,\r\n\t\t\twidth: 76,\r\n\t\t\theight: 76\r\n\t\t}\r\n\t}\r\n\tconstructor() {\r\n\t\tsuper(...arguments),\r\n\t\tthis.init()\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.scene.state.paused;\r\n\t\tthis.paused !== t && (t ? (this.controlData.pause.image = \"play\",\r\n\t\tthis.paused = !0) : (this.controlData.pause.image = \"pause\",\r\n\t\tthis.paused = !1))\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/controls/pause.js?");

/***/ }),

/***/ "./src/game/class/controls/redoundo.js":
/*!*********************************************!*\
  !*** ./src/game/class/controls/redoundo.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _controls_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./controls.js */ \"./src/game/class/controls/controls.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _controls_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = \"redo_undo_controls\";\r\n\tcontrolsSpriteSheetData = {\r\n\t\tredo_btn: [78, 2, 76, 76],\r\n\t\tundo_btn: [2, 2, 76, 76]\r\n\t}\r\n\tcontrolData = {\r\n\t\tredo: {\r\n\t\t\tkeys: [\"ctrl\", \"y\"],\r\n\t\t\talpha: 0.5,\r\n\t\t\ttop: 60,\r\n\t\t\tright: 160,\r\n\t\t\twidth: 76,\r\n\t\t\theight: 76\r\n\t\t},\r\n\t\tundo: {\r\n\t\t\tkeys: [\"ctrl\", \"z\"],\r\n\t\t\talpha: 0.5,\r\n\t\t\ttop: 60,\r\n\t\t\tright: 240,\r\n\t\t\twidth: 76,\r\n\t\t\theight: 76\r\n\t\t}\r\n\t}\r\n\tconstructor() {\r\n\t\tsuper(...arguments),\r\n\t\tthis.init()\r\n\t}\r\n\tclick() {\r\n\t\tfor (const i in this.controlData) {\r\n\t\t\tconst component = this.controlData[i];\r\n\t\t\tif (this.isMouseOverComponent(component)) {\r\n\t\t\t\tthis.scene.toolHandler[(i == 'undo' ? 'revert' : 'apply') + 'Action']()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.scene.toolHandler;\r\n\t\tthis.controlData.undo.disabled = t.actionTimelinePointer === 0,\r\n\t\tthis.controlData.redo.disabled = t.actionTimelinePointer >= t.actionTimeline.length\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/controls/redoundo.js?");

/***/ }),

/***/ "./src/game/class/controls/settings.js":
/*!*********************************************!*\
  !*** ./src/game/class/controls/settings.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _controls_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./controls.js */ \"./src/game/class/controls/controls.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _controls_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = \"settings_controls\"\r\n\tcontrolsSpriteSheetData = {\r\n\t\tsettings_btn: [78, 2, 76, 76]\r\n\t}\r\n\tcontrolData = {\r\n\t\tsettings: {\r\n\t\t\ttop: 60,\r\n\t\t\tright: 230,\r\n\t\t\tkey: \"settings\",\r\n\t\t\talpha: 0.5,\r\n\t\t\twidth: 76,\r\n\t\t\theight: 76\r\n\t\t}\r\n\t}\r\n\tconstructor() {\r\n\t\tsuper(...arguments),\r\n\t\tthis.init()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/controls/settings.js?");

/***/ }),

/***/ "./src/game/class/cosmetics/heads/forward_cap.js":
/*!*******************************************************!*\
  !*** ./src/game/class/cosmetics/heads/forward_cap.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ForwardCap)\n/* harmony export */ });\nclass ForwardCap extends GameInventoryManager.HeadClass {\r\n\tdrawAngle = 0;\r\n\tconstructor(t) {\r\n\t\tsuper(),\r\n\t\tthis.colors = t,\r\n\t\tthis.createVersion()\r\n\t}\r\n\tcache(t) {\r\n\t\tlet e = this.versions[this.versionName]\r\n\t\t  , h = e.canvas\r\n\t\t  , d = this.getScale() * Math.max(t, 1);\r\n\t\te.dirty = !1;\r\n\t\th.width = this.getBaseWidth() * d,\r\n\t\th.height = this.getBaseHeight() * d;\r\n\t\tlet l = h.getContext('2d')\r\n\t\t  , f = this.colors\r\n\t\t  , r = Math.PI / 12;\r\n\t\tl.scale(d, d),\r\n\t\tl.strokeStyle = f.outline || lite.storage.get('theme') === 'darker' ? 'hsl(0, 0%, 100%)' : lite.storage.get('theme') === 'dark' ? 'hsl(0, 0%, 98%)' : lite.storage.get('theme') === 'midnight' ? 'hsl(0, 0%, 80%)' : 'hsl(0, 0%, 0%)',\r\n\t\tl.lineCap = 'round',\r\n\t\tl.lineJoin = 'miter',\r\n\t\tl.lineWidth = 7,\r\n\t\tl.miterLimit = 4,\r\n\t\tl.fillStyle = f.skin || lite.storage.get('theme') === 'darker' ? 'hsl(231, 16%, 8%)' : lite.storage.get('theme') === 'dark' ? 'hsl(0, 0%, 11%)' : lite.storage.get('theme') === 'midnight' ? 'hsl(207, 16%, 14%)' : 'hsl(0, 0%, 100%)',\r\n\t\tl.save(),\r\n\t\tl.beginPath(),\r\n\t\tl.arc(42.4, 52.5, 30.3 + l.lineWidth / 2, 0, 2 * Math.PI, !0),\r\n\t\tl.fill(),\r\n\t\tl.stroke(),\r\n\t\tl.clip(),\r\n\t\tl.beginPath(),\r\n\t\tl.arc(42.4, 52.5, 30.3, -r, Math.PI - r, !0),\r\n\t\tl.fillStyle = f.back,\r\n\t\tl.fill(),\r\n\t\tf.front && (l.beginPath(),\r\n\t\tl.arc(42.4, 52.5, 30.3, -r, r - Math.PI / 1.75, !0),\r\n\t\tl.lineTo(52.501, 44.894999999999996),\r\n\t\tl.fillStyle = f.front,\r\n\t\tl.fill()),\r\n\t\tl.restore(),\r\n\t\tl.lineWidth = 12,\r\n\t\tl.beginPath(),\r\n\t\tl.moveTo(16.3, 60),\r\n\t\tl.lineTo(103.5, 36.5),\r\n\t\tl.stroke()\r\n\t}\r\n\tgetBaseWidth() { return 115 }\r\n\tgetBaseHeight() { return 112 }\r\n\tgetDrawOffsetX() { return 2.2 }\r\n\tgetDrawOffsetY() { return 1 }\r\n\tgetScale() { return .17 }\r\n}\r\n\r\nGameInventoryManager && GameInventoryManager.register('forward_cap', ForwardCap);\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/cosmetics/heads/forward_cap.js?");

/***/ }),

/***/ "./src/game/class/cosmetics/heads/head.js":
/*!************************************************!*\
  !*** ./src/game/class/cosmetics/heads/head.js ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _inventorymanager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../inventorymanager.js */ \"./src/game/class/cosmetics/inventorymanager.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (GameInventoryManager.HeadClass = class {\r\n\tversions = {};\r\n\tcreateVersion() {\r\n\t\tlet t = this.colors\r\n\t\t  , e = this.getVersions()\r\n\t\t  , i = \"\";\r\n\t\tfor (let s in t)\r\n\t\t\ti += t[s];\r\n\t\tthis.versionName = i,\r\n\t\te[i] ||= {\r\n\t\t\tdirty: !0,\r\n\t\t\tcanvas: document.createElement('canvas')\r\n\t\t}\r\n\t}\r\n\tdraw(t, e, i, s, n, r) {\r\n\t\tlet o = this.getCache(n)\r\n\t\t  , l = this.getScale()\r\n\t\t  , p = this.getBaseWidth() * n * l\r\n\t\t  , d = this.getBaseHeight() * n * l\r\n\t\t  , f = this.getDrawOffsetX() * n - p / 2\r\n\t\t  , v = this.getDrawOffsetY() * n - d / 2\r\n\t\t  , g = -1 === r;\r\n\t\tt.translate(e, i),\r\n\t\tt.rotate(s),\r\n\t\tg && t.scale(1, -1),\r\n\t\tt.drawImage(o, f, v, p, d),\r\n\t\tg && t.scale(1, -1),\r\n\t\tt.rotate(-s),\r\n\t\tt.translate(-e, -i)\r\n\t}\r\n\tgetCache(t) {\r\n\t\tlet e = this.getVersions();\r\n\t\treturn e[this.versionName].dirty && this.cache(t),\r\n\t\te[this.versionName].canvas\r\n\t}\r\n\tgetVersions() {\r\n\t\treturn this.versions\r\n\t}\r\n\tsetDirty() {\r\n\t\tlet t = this.getVersions();\r\n\t\tt[this.versionName].dirty = !0\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/cosmetics/heads/head.js?");

/***/ }),

/***/ "./src/game/class/cosmetics/inventorymanager.js":
/*!******************************************************!*\
  !*** ./src/game/class/cosmetics/inventorymanager.js ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\nclass InventoryManager {\r\n\tcache = {};\r\n\tinventory = {};\r\n\tloaded = new Set();\r\n\tconstructor() {\r\n\t\tObject.defineProperty(this, 'cache', { enumerable: false })\r\n\t}\r\n\tgetItem(t) {\r\n\t\tlet e = t.classname\r\n\t\t  , i = t.script\r\n\t\t  , o = t.options\r\n\t\t  , a = t.type;\r\n\t\tthis.inventory[e] || ('1' === a && (e = 'forward_cap',\r\n\t\to = { back: 'white' }),\r\n\t\tthis.loaded.has(i) || (this.loaded.add(i),\r\n\t\tGameManager.loadFile(i)));\r\n\t\tlet h = this.generateID(a, e, o);\r\n\t\treturn this.cache[h] ||= new this.inventory[e](o)\r\n\t}\r\n\tredraw() {\r\n\t\tlet n = this.cache\r\n\t\tfor (let t in n)\r\n\t\t\tn[t].setDirty()\r\n\t}\r\n\tgenerateID(t, e, i) {\r\n\t\te = t + e;\r\n\t\tif (i)\r\n\t\t\tfor (let s in i)\r\n\t\t\t\ti.hasOwnProperty(s) && (e += i[s]);\r\n\t\treturn e\r\n\t}\r\n\tregister(t, e) {\r\n\t\tthis.inventory[t] = e\r\n\t}\r\n\tclear() {\r\n\t\tthis.cache = {},\r\n\t\tthis.inventory = {},\r\n\t\tthis.loaded.clear()\r\n\t}\r\n}\r\n\r\nwindow.GameInventoryManager = new InventoryManager;\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/cosmetics/inventorymanager.js?");

/***/ }),

/***/ "./src/game/class/interfaces/component.js":
/*!************************************************!*\
  !*** ./src/game/class/interfaces/component.js ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\talpha = null;\r\n\tbackground = null;\r\n\tcached = !1;\r\n\tcanvas = null;\r\n\tcolor = null;\r\n\tcontainer = null;\r\n\tfont = { size: null };\r\n\tscale = { x: 1, y: 1 };\r\n\ttext = null;\r\n\timage = null;\r\n\tx = 0;\r\n\ty = 0;\r\n\tvisible = true;\r\n\tconstructor(options, container) {\r\n\t\tObject.assign(this, options),\r\n\t\tcontainer && container.addChild(this)\r\n\t}\r\n\tcreateCanvas() {\r\n\t\tlet t = this.canvas;\r\n\t\tt || (t = document.createElement('canvas'),\r\n\t\tthis.canvas = t);\r\n\t\treturn t\r\n\t}\r\n\tcache(t = window.devicePixelRatio) {\r\n\t\tif (!this.cached && !this.image) {\r\n\t\t\tlet e = this.createCanvas()\r\n\t\t\t  , i = e.getContext('2d');\r\n\t\t\ti.clearRect(0, 0, e.width, e.height);\r\n\t\t\tif (this.text !== null) {\r\n\t\t\t\tlet s = (this.font.size ?? (this.container && this.container.font.size) ?? 16) + 'px ' + (this.font.family || 'helsinki');\r\n\t\t\t\ti.font = s;\r\n\t\t\t\tlet n = i.measureText(this.text);\r\n\t\t\t\te.width = Math.ceil(Math.max(n.width, n.actualBoundingBoxLeft + n.actualBoundingBoxRight)),\r\n\t\t\t\te.height = Math.ceil(Math.abs(n.actualBoundingBoxAscent) + Math.abs(n.actualBoundingBoxDescent)), // bad\r\n\t\t\t\tthis.radius && (n = this.radius,\r\n\t\t\t\te.width = Math.max(e.width, 2 * this.scale.x * n),\r\n\t\t\t\te.height = Math.max(e.height, 2 * this.scale.y * n)),\r\n\t\t\t\tthis.width = e.width,\r\n\t\t\t\tthis.height = e.height,\r\n\t\t\t\tthis.alpha && (i.globalAlpha = this.alpha),\r\n\t\t\t\tthis.background && (i.save(),\r\n\t\t\t\tthis.border === 'round' && i.arc(e.height / 2, e.height / 2, n, 0, 2 * Math.PI),\r\n\t\t\t\ti.fillStyle = this.background,\r\n\t\t\t\ti.fill(),\r\n\t\t\t\ti.restore()),\r\n\t\t\t\tthis.color && (i.fillStyle = this.color) || this.container && this.container.color && (i.fillStyle = this.container.color),\r\n\t\t\t\ti.font = s,\r\n\t\t\t\tthis.textAlign && (i.textAlign = this.textAlign) || this.container && this.container.textAlign && (i.textAlign = this.container.textAlign),\r\n\t\t\t\ti.textBaseline = this.textBaseline || (this.container && this.container.textBaseline) || 'top',\r\n\t\t\t\ti.fillText(this.text, i.textAlign === 'center' ? this.width / 2 : 0, i.textBaseline === 'middle' ? this.height / 2 : 0)\r\n\t\t\t}\r\n\t\t\tthis.cached = !0;\r\n\t\t}\r\n\t}\r\n\tdraw(t, e = 0, i = 0) {\r\n\t\tif (this.visible) {\r\n\t\t\tlet s = window.devicePixelRatio\r\n\t\t\t  , n = s * this.scale.x\r\n\t\t\t  , r = s * this.scale.y;\r\n\t\t\tif (this.image)\r\n\t\t\t\tt.imageSmoothingEnabled = true,\r\n\t\t\t\tt.drawImage(this.image.canvas, this.image.x, this.image.y, this.image.width, this.image.height, e + this.x * s, i + this.y * s, this.width * n, this.height * r),\r\n\t\t\t\tt.imageSmoothingEnabled = false;\r\n\t\t\telse\r\n\t\t\t\tthis.cached || this.cache(s),\r\n\t\t\t\tt.drawImage(this.canvas, e + this.x * s, i + this.y * s, this.width * n, this.height * r);\r\n\t\t}\r\n\t}\r\n\tsetDirty() {\r\n\t\tthis.cached = !1,\r\n\t\tthis.container && (this.container.cached = !1)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/interfaces/component.js?");

/***/ }),

/***/ "./src/game/class/interfaces/container.js":
/*!************************************************!*\
  !*** ./src/game/class/interfaces/container.js ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _component_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component.js */ \"./src/game/class/interfaces/component.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tget width() {\r\n\t\treturn (this.inline ? this.children.reduce((t, e) => t += e.width + e.x, 0) : this.children.reduce((t, e) => t = Math.max(t, e.width + e.x), 0));\r\n\t}\r\n\tget height() {\r\n\t\treturn this.children.reduce((t, e) => t = Math.max(t, e.height + e.y), 0)\r\n\t}\r\n\tchildren = [];\r\n\tfont = { size: 16 };\r\n\tinline = null;\r\n\tconstructor(options, container) {\r\n\t\tsuper(options, container),\r\n\t\tObject.assign(this, options);\r\n\t\tfor (let i of this.children)\r\n\t\t\tObject.defineProperty(i, 'container', { value: this, writable: true })\r\n\t}\r\n\taddChild() {\r\n\t\tlet t = arguments\r\n\t\t  , e = this.children;\r\n\t\tfor (let e of t)\r\n\t\t\tObject.defineProperty(e, 'container', { value: this, writable: true });\r\n\t\te.push(...Array.prototype.filter.call(t, t => e.indexOf(t) === -1));\r\n\t\treturn t\r\n\t}\r\n\tcache(scale = window.devicePixelRatio) {\r\n\t\tif (!this.cached) {\r\n\t\t\tlet t = (this.createCanvas(),\r\n\t\t\tthis.canvas.getContext('2d'));\r\n\t\t\tt.clearRect(0, 0, t.canvas.width, t.canvas.height),\r\n\t\t\tthis.width > 0 && (t.canvas.width = this.width * window.devicePixelRatio),\r\n\t\t\tthis.height > 0 && (t.canvas.height = this.height * window.devicePixelRatio),\r\n\t\t\tthis.alpha && (t.globalAlpha = this.alpha),\r\n\t\t\tt.imageSmoothingEnabled = false;\r\n\t\t\tfor (let e in this.children) {\r\n\t\t\t\tlet i = this.children[e]\r\n\t\t\t\t  , s = this.inline\r\n\t\t\t\t  , q = this.children.slice(0, e)\r\n\t\t\t\t  , a = q.reduce((t, e) => t += e.width + e.x, 0) * window.devicePixelRatio\r\n\t\t\t\t  , h = q.reduce((t, e) => t += e.height + e.y, 0) * window.devicePixelRatio;\r\n\t\t\t\ti.cached || i.cache(scale),\r\n\t\t\t\ti.draw(t, s && (this.gap ?? a)/*, s || h */);\r\n\t\t\t}\r\n\t\t\tthis.cached = !0\r\n\t\t}\r\n\t}\r\n\tdraw(t, e = 0, i = 0) {\r\n\t\tif (this.visible) {\r\n\t\t\tlet s = window.devicePixelRatio;\r\n\t\t\tthis.cached || this.cache(s);\r\n\t\t\tlet n = this.canvas;\r\n\t\t\tt.drawImage(n, e + this.x * s, i + this.y * s, n.width * this.scale.x, n.height * this.scale.y)\r\n\t\t}\r\n\t}\r\n\tsetDirty() {\r\n\t\tthis.cached = !1;\r\n\t\tfor (let t of this.children.filter(t => !t.image))\r\n\t\t\tt.setDirty()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/interfaces/container.js?");

/***/ }),

/***/ "./src/game/class/interfaces/gui.js":
/*!******************************************!*\
  !*** ./src/game/class/interfaces/gui.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _container_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./container.js */ \"./src/game/class/interfaces/container.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tcached = !1;\r\n\tcanvas = null;\r\n\tcontainer = new _container_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n\tconstructor(t, e) {\r\n\t\tObject.defineProperty(this, 'scene', { value: t, writable: true }),\r\n\t\tObject.assign(this.container, e)\r\n\t}\r\n\tdraw(t) {\r\n\t\tthis.container.draw(t)\r\n\t}\r\n\tredraw() {\r\n\t\tthis.container.setDirty()\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.container;\r\n\t\tt.cached ||= -1 === t.children.findIndex(t => !t.cached)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/interfaces/gui.js?");

/***/ }),

/***/ "./src/game/class/math/bresenham.js":
/*!******************************************!*\
  !*** ./src/game/class/math/bresenham.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* export default binding */ __WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ function __WEBPACK_DEFAULT_EXPORT__(t, e, i, a, h, q) {\r\n\tlet l = []\r\n\t  , c = t\r\n\t  , u = e\r\n\t  , p = (a - e) / (i - t)\r\n\t  , d = i > t ? 1 : -1\r\n\t  , f = a > e ? 1 : -1\r\n\t  , v = 0;\r\n\tl.push(t, e),\r\n\tq === !0 && (t % h == 0 && l.push(t - .5, e),\r\n\te % h == 0 && l.push(t, e - .5));\r\n\tdo {\r\n\t\tlet g = Math.floor(c / h) == Math.floor(i / h)\r\n\t\t  , m = Math.floor(u / h) == Math.floor(a / h);\r\n\t\tif (g && m)\r\n\t\t\tbreak;\r\n\t\tlet y = 0\r\n\t\t  , w = 0;\r\n\t\ty = Math.round(Math.floor(c / h + d) * h),\r\n\t\t0 > d && (y = Math.round(Math.ceil((c + 1) / h + d) * h) - 1),\r\n\t\tw = Math.round(e + (y - t) * p);\r\n\t\tlet x = 0\r\n\t\t  , _ = 0;\r\n\t\t_ = Math.round(Math.floor(u / h + f) * h),\r\n\t\t0 > f && (_ = Math.round(Math.ceil((u + 1) / h + f) * h) - 1),\r\n\t\tx = Math.round(t + (_ - e) / p),\r\n\t\tMath.pow(y - t, 2) + Math.pow(w - e, 2) < Math.pow(x - t, 2) + Math.pow(_ - e, 2) ? (c = y,\r\n\t\tu = w,\r\n\t\tl.push(y, w),\r\n\t\tq === !0 && (y % h == 0 && l.push(y - 1, w),\r\n\t\tw % h == 0 && l.push(y, w - 1))) : (c = x,\r\n\t\tu = _,\r\n\t\tl.push(x, _),\r\n\t\tq === !0 && (x % h == 0 && l.push(x - .5, _),\r\n\t\t_ % h == 0 && l.push(x, _ - .5)))\r\n\t} while (v++ < 5e3);\r\n\treturn l;\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/math/bresenham.js?");

/***/ }),

/***/ "./src/game/class/math/cartesian.js":
/*!******************************************!*\
  !*** ./src/game/class/math/cartesian.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tx = 0;\r\n\ty = 0;\r\n\tconstructor(t, e) {\r\n\t\tisFinite(t) && (this.x = t),\r\n\t\tisFinite(e) && (this.y = e)\r\n\t}\r\n\ttoReal(t) {\r\n\t\tlet e = t.camera\r\n\t\t  , s = t.screen\r\n\t\t  , n = (this.x - s.center.x) / e.zoom + e.position.x\r\n\t\t  , r = (this.y - s.center.y) / e.zoom + e.position.y;\r\n\t\treturn new this.constructor(n, r)\r\n\t}\r\n\ttoScreen(t) {\r\n\t\tlet e = t.camera\r\n\t\t  , s = t.screen\r\n\t\t  , n = (this.x - e.position.x) * e.zoom + s.center.x\r\n\t\t  , r = (this.y - e.position.y) * e.zoom + s.center.y;\r\n\t\treturn new this.constructor(n, r)\r\n\t}\r\n\tlenSqr() {\r\n\t\treturn this.dot(this)\r\n\t}\r\n\tlen() {\r\n\t\treturn Math.sqrt(this.lenSqr())\r\n\t}\r\n\tdelta(t) {\r\n\t\treturn this.sub(t).len()\r\n\t}\r\n\tdot(t) {\r\n\t\treturn this.x * t.x + this.y * t.y\r\n\t}\r\n\tfactor(t) {\r\n\t\treturn new this.constructor(this.x * t, this.y * t)\r\n\t}\r\n\tfactorSelf(t) {\r\n\t\tthis.x *= t,\r\n\t\tthis.y *= t\r\n\t}\r\n\tfactorOut(t, e) {\r\n\t\te.x = this.x * t,\r\n\t\te.y = this.y * t\r\n\t}\r\n\tadd(t) {\r\n\t\treturn new this.constructor(this.x + t.x, this.y + t.y)\r\n\t}\r\n\tinc(t) {\r\n\t\tthis.x += t.x,\r\n\t\tthis.y += t.y\r\n\t}\r\n\taddOut(t, e) {\r\n\t\te.x = this.x + t.x,\r\n\t\te.y = this.y + t.y\r\n\t}\r\n\tsub(t) {\r\n\t\treturn new this.constructor(this.x - t.x, this.y - t.y)\r\n\t}\r\n\tsubOut(t, e) {\r\n\t\te.x = this.x - t.x,\r\n\t\te.y = this.y - t.y\r\n\t}\r\n\tsubSelf(t) {\r\n\t\tthis.x -= t.x,\r\n\t\tthis.y -= t.y\r\n\t}\r\n\tequ(t) {\r\n\t\tthis.x = t.x,\r\n\t\tthis.y = t.y\r\n\t}\r\n\tnormalize() {\r\n\t\tlet t = this.len();\r\n\t\treturn new this.constructor(this.x / t, this.y / t)\r\n\t}\r\n\tgetAngleInDegrees(t) {\r\n\t\tlet e = t.sub(this)\r\n\t\t  , i = Math.atan2(e.x, -e.y)\r\n\t\t  , s = i * (180 / Math.PI);\r\n\t\treturn s < 0 && (s += 360),\r\n\t\ts\r\n\t}\r\n\tgetAngleInRadians(t) {\r\n\t\tlet e = t.sub(this);\r\n\t\treturn Math.atan2(e.x, -e.y)\r\n\t}\r\n\tstatic max(...args) {\r\n\t\treturn args.length > 0 && args.sort((a, b) => a.dot(1) - b.dot(1))[0] || new this(-Infinity, -Infinity)\r\n\t}\r\n\tstatic min(...args) {\r\n\t\treturn args.length > 0 && args.sort((a, b) => b.dot(1) - a.dot(1))[0] || new this(Infinity, Infinity)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/math/cartesian.js?");

/***/ }),

/***/ "./src/game/class/math/curvedivision.js":
/*!**********************************************!*\
  !*** ./src/game/class/math/curvedivision.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* export default binding */ __WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ function __WEBPACK_DEFAULT_EXPORT__(...t) {\r\n\tlet options = t.pop();\r\n\tlet points = [];\r\n\tlet length = t.reduce((sum, point, i) => sum += point.delta(t[(i < 1 ? t.length : i) - 1]), 0) / t.length;\r\n\t// let length = (i.delta(e) + e.delta(t)) / 2;\r\n\tlet minDistance = 2;\r\n\tlet breakLength = Math.max(minDistance, options.breakLength * 100);\r\n\tfor (let s = 0; s < length; s += breakLength) {\r\n\t\tlet n = s / length;\r\n\t\tlet [pointX, pointY] = multiCurve(n, ...t);\r\n\r\n\t\t// Calculate distance from the last point if it exists\r\n\t\tif (points.length > 0) {\r\n\t\t\tlet lastPointX = points[points.length - 2];\r\n\t\t\tlet lastPointY = points[points.length - 1];\r\n\t\t\tlet distance = Math.sqrt((pointX - lastPointX) ** 2 + (pointY - lastPointY) ** 2);\r\n\r\n\t\t\t// Only add the point if it's beyond minDistance\r\n\t\t\tif (distance < minDistance) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpoints.push(pointX, pointY);\r\n\t}\r\n\r\n\t// Ensure the start point is included\r\n\tlet e = t[0];\r\n\tif (points[0] !== e.x || points[1] !== e.y) {\r\n\t\tpoints.unshift(e.x, e.y);\r\n\t}\r\n\r\n\t// Ensure the end point is included\r\n\tlet i = t.at(-1);\r\n\tif (points[points.length - 2] !== i.x || points[points.length - 1] !== i.y) {\r\n\t\tpoints.push(i.x, i.y);\r\n\t}\r\n\r\n\treturn points\r\n}\r\n\r\nfunction binomialCoefficient(n, k) {\r\n\tif (Number.isNaN(n) || Number.isNaN(k)) return NaN;\r\n\tif (k < 0 || k > n) return 0;\r\n\tif (k === 0 || k === n) return 1;\r\n\tif (k === 1 || k === n - 1) return n;\r\n\tif (n - k < k) k = n - k;\r\n\r\n\tlet res = n;\r\n\tfor (let i = 2; i <= k; i++) res *= (n - i + 1) / i;\r\n\treturn Math.round(res)\r\n}\r\n\r\nfunction multiCurve(t, ...points) {\r\n\tlet p = points.length - 1;\r\n\treturn [\r\n\t\tpoints.reduce((sum, { x }, i) => sum += binomialCoefficient(p, i) * (1 - t) ** (p - i) * t ** i * x, 0),\r\n\t\tpoints.reduce((sum, { y }, i) => sum += binomialCoefficient(p, i) * (1 - t) ** (p - i) * t ** i * y, 0)\r\n\t]\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/math/curvedivision.js?");

/***/ }),

/***/ "./src/game/class/scenes/BaseScene.js":
/*!********************************************!*\
  !*** ./src/game/class/scenes/BaseScene.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _tracks_track_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../tracks/track.js */ \"./src/game/class/tracks/track.js\");\n/* harmony import */ var _utils_loadingcircle_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/loadingcircle.js */ \"./src/game/class/utils/loadingcircle.js\");\n/* harmony import */ var _utils_messagemanager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/messagemanager.js */ \"./src/game/class/utils/messagemanager.js\");\n/* harmony import */ var _utils_score_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/score.js */ \"./src/game/class/utils/score.js\");\n/* harmony import */ var _utils_mousehandler_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/mousehandler.js */ \"./src/game/class/utils/mousehandler.js\");\n/* harmony import */ var _utils_soundmanager_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/soundmanager.js */ \"./src/game/class/utils/soundmanager.js\");\n/* harmony import */ var _tools_cameratool_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../tools/cameratool.js */ \"./src/game/class/tools/cameratool.js\");\n/* harmony import */ var _tools_toolhandler_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../tools/toolhandler.js */ \"./src/game/class/tools/toolhandler.js\");\n/* harmony import */ var _utils_vehicletimer_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utils/vehicletimer.js */ \"./src/game/class/utils/vehicletimer.js\");\n/* harmony import */ var _vehicles_player_manager_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../vehicles/player_manager.js */ \"./src/game/class/vehicles/player_manager.js\");\n/* harmony import */ var _view_camera_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../view/camera.js */ \"./src/game/class/view/camera.js\");\n/* harmony import */ var _view_screen_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../view/screen.js */ \"./src/game/class/view/screen.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tassets = null;\r\n\tsettings = null;\r\n\tcamera = null;\r\n\tscreen = null;\r\n\tmouse = null;\r\n\ttrack = null;\r\n\tticks = 0;\r\n\tstate = null;\r\n\toldState = null;\r\n\tvehicle = \"Mtb\";\r\n\timportCode = !1;\r\n\tpauseControls = null;\r\n\tmessage = null;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'game', { value: t, writable: true });\r\n\t\tthis.assets = t.assets,\r\n\t\tthis.settings = t.settings,\r\n\t\tthis.sound = new _utils_soundmanager_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](this),\r\n\t\tthis.mouse = new _utils_mousehandler_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this),\r\n\t\tthis.score = new _utils_score_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this),\r\n\t\tthis.camera = new _view_camera_js__WEBPACK_IMPORTED_MODULE_10__[\"default\"](this),\r\n\t\tthis.screen = new _view_screen_js__WEBPACK_IMPORTED_MODULE_11__[\"default\"](this),\r\n\t\tthis.message = new _utils_messagemanager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this),\r\n\t\tthis.createTrack(),\r\n\t\tthis.loadingcircle = new _utils_loadingcircle_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this),\r\n\t\tthis.playerManager = new _vehicles_player_manager_js__WEBPACK_IMPORTED_MODULE_9__[\"default\"](this),\r\n\t\tthis.vehicleTimer = new _utils_vehicletimer_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"](this),\r\n\t\tObject.defineProperty(this, '_onresize', { value: this.redraw.bind(this), writable: true }),\r\n\t\twindow.addEventListener('resize', this._onresize, { passive: true })\r\n\t}\r\n\tbuttonDown(t) {\r\n\t\tlet e = this.camera;\r\n\t\tswitch (t) {\r\n\t\tcase \"change_camera\":\r\n\t\t\te.focusOnNextPlayer();\r\n\t\t\tbreak;\r\n\t\tcase \"pause\":\r\n\t\t\tthis.state.paused = !this.state.paused,\r\n\t\t\t'mediaSession' in navigator && (navigator.mediaSession.playbackState = this.state.paused ? 'paused' : 'playing');\r\n\t\t\tthis.state.paused && Object.defineProperty(this, '_idleStateTimeout', {\r\n\t\t\t\tvalue: setTimeout(() => this.state.idle = this.state.paused, 300),\r\n\t\t\t\twritable: true\r\n\t\t\t}) || (this._idleStateTimeout && clearTimeout(this._idleStateTimeout),\r\n\t\t\tthis.state.idle = false);\r\n\t\t\tthis.updateState();\r\n\t\t\tbreak;\r\n\t\tcase \"settings\":\r\n\t\t\tthis.openDialog(\"settings\");\r\n\t\t\tbreak;\r\n\t\tcase \"exit_fullscreen\":\r\n\t\t\tthis.exitFullscreen();\r\n\t\t\tbreak;\r\n\t\tcase \"change_vehicle\":\r\n\t\t\tthis.toggleVehicle(),\r\n\t\t\tthis.updateState();\r\n\t\t\tbreak;\r\n\t\tcase \"zoom_increase\":\r\n\t\t\te.increaseZoom(),\r\n\t\t\tthis.updateState();\r\n\t\t\tbreak;\r\n\t\tcase \"zoom_decrease\":\r\n\t\t\te.decreaseZoom(),\r\n\t\t\tthis.updateState();\r\n\t\t\tbreak;\r\n\t\tcase \"fullscreen\":\r\n\t\t\tthis.toggleFullscreen(),\r\n\t\t\tthis.updateState()\r\n\t\t}\r\n\t}\r\n\tcreateMainPlayer() {\r\n\t\tlet t = this.playerManager\r\n\t\t  , e = t.createPlayer(this, this.settings.user)\r\n\t\t  , i = e.getGamepad();\r\n\t\ti.onButtonDown = this.buttonDown.bind(this),\r\n\t\ti.listen(),\r\n\t\tthis.playerManager.firstPlayer = e,\r\n\t\tthis.playerManager.addPlayer(e);\r\n\t\treturn i\r\n\t}\r\n\tcreateTrack() {\r\n\t\tthis.track && this.track.close();\r\n\t\tlet t = new _tracks_track_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this);\r\n\t\tthis.track = t;\r\n\t\treturn t\r\n\t}\r\n\tcommand(t, ...e) {\r\n\t\tswitch (t) {\r\n\t\tcase \"resize\":\r\n\t\t\tthis.resize();\r\n\t\t\tbreak;\r\n\t\tcase \"dialog\":\r\n\t\t\tvar i = e[0];\r\n\t\t\ti === !1 ? this.listen() : this.unlisten(),\r\n\t\t\tthis.openDialog(i);\r\n\t\t\tbreak;\r\n\t\tcase \"focused\":\r\n\t\t\tlet s = e[0];\r\n\t\t\ts === !0 ? (this.state.inFocus = !0,\r\n\t\t\tthis.state.showDialog === !1 && this.listen()) : (this.state.inFocus = !1,\r\n\t\t\tthis.unlisten(),\r\n\t\t\tthis.state.playing = !1);\r\n\t\t\tbreak;\r\n\t\tcase \"add track\":\r\n\t\t\tthis.importCode = e[0].code\r\n\t\t}\r\n\t}\r\n\tdraw(ctx) {\r\n\t\t/* !this.state.paused && */ /* !this.state.idle && */ (ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height),\r\n\t\tthis.game.emit('clearRect', 0, 0, ctx.canvas.width, ctx.canvas.height, true),\r\n\t\tthis.toolHandler.drawGrid(ctx),\r\n\t\tthis.track.draw(ctx)),\r\n\t\tthis.score.draw(ctx),\r\n\t\tthis.playerManager.draw(ctx),\r\n\t\tthis.vehicleTimer.player && this.vehicleTimer.player._tempVehicleTicks > 0 && this.vehicleTimer.draw(ctx),\r\n\t\tthis.toolHandler.draw(ctx),\r\n\t\tthis.loading && this.loadingcircle.draw(ctx),\r\n\t\tthis.message.draw(ctx),\r\n\t\tthis.pauseControls.draw(ctx)\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tthis.screen.update(),\r\n\t\tthis.updateControls(),\r\n\t\tthis.camera.update(),\r\n\t\tthis.sound.update(),\r\n\t\tthis.restartTrack && this.restart(),\r\n\t\t!this.state.paused && this.state.playing && (this.message.update(),\r\n\t\tthis.playerManager.fixedUpdate(),\r\n\t\t!this.camera.focusIndex && (this.playerManager.firstPlayer.complete ? this.trackComplete() : this.ticks++)),\r\n\t\tthis.score.update(),\r\n\t\tthis.vehicleTimer.fixedUpdate(),\r\n\t\tthis.isStateDirty() && this.updateState(),\r\n\t\tthis.camera.updateZoom()\r\n\t}\r\n\tgetAvailableTrackCode() {\r\n\t\tlet t = this.settings\r\n\t\t  , e = !1;\r\n\t\treturn t.importCode && e != t.importCode ? (e = t.importCode,\r\n\t\tt.importCode = null) : this.importCode && (e = this.importCode,\r\n\t\tthis.importCode = null),\r\n\t\te\r\n\t}\r\n\thideControlPlanel() {}\r\n\tinitAnalytics() {\r\n\t\tObject.defineProperty(this, 'analytics', {\r\n\t\t\tvalue: { deaths: 0 },\r\n\t\t\twritable: true\r\n\t\t})\r\n\t}\r\n\tinteractWithControls() {\r\n\t\tthis.pauseControls.click()\r\n\t}\r\n\tisStateDirty() {\r\n\t\tlet i = !1;\r\n\t\tfor (let s in this.state)\r\n\t\t\tthis.state[s] !== this.oldState[s] && (i = !0,\r\n\t\t\tthis.oldState[s] = this.state[s]);\r\n\t\treturn i\r\n\t}\r\n\tredraw() {\r\n\t\tthis.score.redraw(),\r\n\t\tthis.track.undraw(),\r\n\t\tGameInventoryManager.redraw(),\r\n\t\tthis.toolHandler.resize()\r\n\t}\r\n\tredrawControls() {\r\n\t\tthis.pauseControls.redraw()\r\n\t}\r\n\tregisterTools() {\r\n\t\tlet t = new _tools_toolhandler_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"](this);\r\n\t\tthis.toolHandler = t,\r\n\t\tt.registerTool(_tools_cameratool_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"]);\r\n\t\treturn t\r\n\t}\r\n\tresize() {\r\n\t\tthis.redrawControls()\r\n\t}\r\n\tshowControlPlanel() {}\r\n\tupdateState() {\r\n\t\tlet t = this.state\r\n\t\t  , e = structuredClone(this.state);\r\n\t\tt.zoomPercentage = this.camera.zoomPercentage,\r\n\t\tt.vehicle = this.vehicle,\r\n\t\tthis.game.emit('stateChange', this.state),\r\n\t\tthis.game.emit('stateUpdate', e, structuredClone(this.state)),\r\n\t\tnull !== this.game.onStateChange && this.game.onStateChange(this.state)\r\n\t}\r\n\ttoggleVehicle() {\r\n\t\tlet t = this.track.allowedVehicles\r\n\t\t  , e = t.length\r\n\t\t  , i = (this.state.vehicle || this.vehicle).toUpperCase()\r\n\t\t  , s = t.indexOf(i);\r\n\t\ti = t[++s % e];\r\n\t\tthis.selectVehicle(i)\r\n\t}\r\n\tupdateControls() {\r\n\t\tthis.pauseControls.update()\r\n\t}\r\n\tupdateToolHandler() {\r\n\t\tthis.toolHandler.update()\r\n\t}\r\n\tselectVehicle(t) {\r\n\t\tlet e = this.track.allowedVehicles\r\n\t\t  , i = e.indexOf(t);\r\n\t\t-1 !== i && (this.settings.track.vehicle = t,\r\n\t\tthis.vehicle = t,\r\n\t\tthis.playerManager.firstPlayer.setBaseVehicle(t),\r\n\t\tthis.restartTrack = !0)\r\n\t}\r\n\tlisten() {\r\n\t\tlet t = this.playerManager.firstPlayer\r\n\t\t  , e = t.getGamepad();\r\n\t\te.listen()\r\n\t}\r\n\tunlisten() {\r\n\t\tlet t = this.playerManager.firstPlayer\r\n\t\t  , e = t.getGamepad();\r\n\t\te.unlisten()\r\n\t}\r\n\topenDialog(t) {\r\n\t\tthis.state.playing = !1,\r\n\t\tthis.state.showDialog = t\r\n\t}\r\n\tsetStateDefaults() {\r\n\t\tlet t = {};\r\n\t\treturn t.playing = !this.settings.waitForKeyPress,\r\n\t\tt.showDialog = !1,\r\n\t\tt.dialogOptions = !1,\r\n\t\tt.preloading = !0,\r\n\t\tt.fullscreen = this.settings.fullscreen,\r\n\t\tt.inFocus = !0,\r\n\t\tt\r\n\t}\r\n\tstopAudio() {\r\n\t\tthis.sound && this.sound.stop_all()\r\n\t}\r\n\ttoggleFullscreen() {\r\n\t\tif (this.settings.embedded) {\r\n\t\t\tlet t = this.settings\r\n\t\t\t  , e = t.basePlatformUrl + \"/t/\" + t.track.url;\r\n\t\t\twindow.open(e)\r\n\t\t} else if (this.settings.fullscreenAvailable) {\r\n\t\t\tlet e = !this.settings.fullscreen;\r\n\t\t\tthis.settings.fullscreen = e,\r\n\t\t\tthis.state.fullscreen = e;\r\n\t\t\treturn !0\r\n\t\t}\r\n\t}\r\n\tclose() {\r\n\t\twindow.removeEventListener('resize', this._onresize),\r\n\t\tthis._onresize = null,\r\n\t\tthis.pauseControls = null,\r\n\t\tthis.score = null,\r\n\t\tthis.mouse.close(),\r\n\t\tthis.mouse = null,\r\n\t\tthis.camera.close(),\r\n\t\tthis.camera = null,\r\n\t\tthis.screen.close(),\r\n\t\tthis.screen = null,\r\n\t\tthis.vehicleTimer.close(),\r\n\t\tthis.vehicleTimer = null,\r\n\t\tthis.playerManager.close(),\r\n\t\tthis.playerManager = null,\r\n\t\tthis.sound.close(),\r\n\t\tthis.sound = null,\r\n\t\tthis.track.close(),\r\n\t\tthis.toolHandler.close(),\r\n\t\tthis.game = null,\r\n\t\tthis.assets = null,\r\n\t\tthis.settings = null,\r\n\t\tthis.track = null,\r\n\t\tthis.state = null,\r\n\t\tthis.stopAudio()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/scenes/BaseScene.js?");

/***/ }),

/***/ "./src/game/class/scenes/Editor.js":
/*!*****************************************!*\
  !*** ./src/game/class/scenes/Editor.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _BaseScene_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseScene.js */ \"./src/game/class/scenes/BaseScene.js\");\n/* harmony import */ var _controls_pause_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../controls/pause.js */ \"./src/game/class/controls/pause.js\");\n/* harmony import */ var _controls_redoundo_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../controls/redoundo.js */ \"./src/game/class/controls/redoundo.js\");\n/* harmony import */ var _tools_brushtool_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../tools/brushtool.js */ \"./src/game/class/tools/brushtool.js\");\n/* harmony import */ var _tools_curvetool_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../tools/curvetool.js */ \"./src/game/class/tools/curvetool.js\");\n/* harmony import */ var _tools_erasertool_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../tools/erasertool.js */ \"./src/game/class/tools/erasertool.js\");\n/* harmony import */ var _tools_poweruptool_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../tools/poweruptool.js */ \"./src/game/class/tools/poweruptool.js\");\n/* harmony import */ var _tools_selecttool_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../tools/selecttool.js */ \"./src/game/class/tools/selecttool.js\");\n/* harmony import */ var _tools_straightlinetool_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../tools/straightlinetool.js */ \"./src/game/class/tools/straightlinetool.js\");\n/* harmony import */ var _tools_vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../tools/vehiclepoweruptool.js */ \"./src/game/class/tools/vehiclepoweruptool.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _BaseScene_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tclear = !1;\r\n\tredoundoControls = null;\r\n\tverified = !1;\r\n\tconstructor(t) {\r\n\t\tsuper(t);\r\n\t\tthis.mouse.disableContextMenu(),\r\n\t\tthis.createMainPlayer(),\r\n\t\tthis.createControls(),\r\n\t\tthis.registerTools(),\r\n\t\tthis.state = this.setStateDefaults(),\r\n\t\tthis.oldState = this.setStateDefaults(),\r\n\t\tthis.restart(),\r\n\t\tt.settings.analyticsEnabled !== false && this.initAnalytics(),\r\n\t\tObject.defineProperty(this, '_pasteEvent', {\r\n\t\t\tvalue:  ({ clipboardData }) => {\r\n\t\t\t\tif (this.state.showDialog === 'import') return;\r\n\t\t\t\tlet e = clipboardData.getData('text');\r\n\t\t\t\tthis.state.dialogOptions = {},\r\n\t\t\t\tthis.state.dialogOptions.code = e,\r\n\t\t\t\tthis.openDialog('import');\r\n\t\t\t\twindow.hasOwnProperty('lite') && lite.constructor.waitForElm('.importDialog-code', 1e3 / this.game.ups).then(importDialog => {\r\n\t\t\t\t\timportDialog.focus(),\r\n\t\t\t\t\timportDialog.value = e\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\twritable: true\r\n\t\t}),\r\n\t\tdocument.addEventListener('paste', this._pasteEvent, { passive: true })\r\n\t}\r\n\tcreateMainPlayer() {\r\n\t\tlet i = super.createMainPlayer();\r\n\t\ti.setKeyMap(this.settings.editorHotkeys)\r\n\t}\r\n\tcreateTrack() {\r\n\t\tlet t = super.createTrack()\r\n\t\t  , e = this.getAvailableTrackCode();\r\n\t\t0 != e ? (t.read(e),\r\n\t\tthis.state.preloading = !1,\r\n\t\tthis.state.loading = !1) : t.addDefaultLine(),\r\n\t\tthis.importCode = !1,\r\n\t\tthis.restartTrack = !0,\r\n\t\tthis.clear = !1\r\n\t}\r\n\tgetCanvasOffset() {\r\n\t\treturn {\r\n\t\t\theight: this.settings.isStandalone ? 202 : 90,\r\n\t\t\twidth: 0\r\n\t\t}\r\n\t}\r\n\tinitAnalytics() {\r\n\t\tsuper.initAnalytics(),\r\n\t\tObject.assign(this.analytics, {\r\n\t\t\tmouseEvents: 0\r\n\t\t}),\r\n\t\tthis.trackAction(\"editor-open\", \"open\")\r\n\t}\r\n\tcreateControls() {\r\n\t\tthis.redoundoControls = new _controls_redoundo_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this),\r\n\t\tthis.pauseControls = new _controls_pause_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this)\r\n\t}\r\n\tredrawControls() {\r\n\t\tsuper.redrawControls(),\r\n\t\tthis.redoundoControls.redraw()\r\n\t}\r\n\tregisterTools() {\r\n\t\tlet t = super.registerTools();\r\n\t\tt.enableGridUse(),\r\n\t\tt.registerTool(_tools_curvetool_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"]),\r\n\t\tt.registerTool(_tools_straightlinetool_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"]),\r\n\t\tt.registerTool(_tools_brushtool_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"]),\r\n\t\tt.registerTool(_tools_selecttool_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"]),\r\n\t\tt.registerTool(_tools_erasertool_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"]),\r\n\t\tt.registerTool(_tools_poweruptool_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"]),\r\n\t\tt.registerTool(_tools_vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_9__[\"default\"]),\r\n\t\tt.setTool(this.settings.startTool)\r\n\t}\r\n\tplay() {\r\n\t\tthis.state.playing = !0\r\n\t}\r\n\tinteractWithControls() {\r\n\t\tsuper.interactWithControls(),\r\n\t\tthis.redoundoControls.click()\r\n\t}\r\n\tupdateControls() {\r\n\t\tsuper.updateControls(),\r\n\t\tthis.redoundoControls.update()\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tthis.updateToolHandler(),\r\n\t\tthis.mouse.update(),\r\n\t\tthis.state.showDialog || (this.playerManager.updateGamepads(),\r\n\t\tthis.playerManager.checkKeys()),\r\n\t\tsuper.fixedUpdate(),\r\n\t\t(this.importCode || this.clear) && this.createTrack()\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tsuper.draw(...arguments),\r\n\t\tthis.redoundoControls.draw(ctx)\r\n\t}\r\n\trestart() {\r\n\t\tthis.verified = !this.settings.requireTrackVerification,\r\n\t\tthis.track.dirty = !1,\r\n\t\tthis.track.resetPowerups(),\r\n\t\tthis.message.hide(),\r\n\t\tthis.restartTrack = !1,\r\n\t\tthis.state.playing = !1,\r\n\t\tthis.ticks = 0,\r\n\t\tthis.playerManager.reset(),\r\n\t\tthis.camera.focusOnPlayer(),\r\n\t\tthis.camera.fastforward(),\r\n\t\tthis.score.update()\r\n\t}\r\n\tbuttonDown(t) {\r\n\t\tsuper.buttonDown(t);\r\n\t\tlet e = this.camera;\r\n\t\tthis.state.playing = !0;\r\n\t\tswitch (t) {\r\n\t\tcase \"up\":\r\n\t\tcase \"down\":\r\n\t\tcase \"left\":\r\n\t\tcase \"right\":\r\n\t\t\te.focusOnMainPlayer()\r\n\t\t}\r\n\t}\r\n\tresize() {\r\n\t\tthis.pauseControls.resize(),\r\n\t\tthis.redoundoControls.resize(),\r\n\t\tsuper.resize()\r\n\t}\r\n\tupdateState() {\r\n\t\tlet t = this.state;\r\n\t\tt && (t.tool = this.toolHandler.currentTool,\r\n\t\tt.toolOptions = this.toolHandler.getToolOptions(),\r\n\t\tt.grid = this.toolHandler.options.grid,\r\n\t\tt.cameraLocked = this.toolHandler.options.cameraLocked,\r\n\t\tsuper.updateState())\r\n\t}\r\n\tsetStateDefaults() {\r\n\t\tlet t = super.setStateDefaults();\r\n\t\treturn t.paused = this.settings.startPaused,\r\n\t\tt.loading = !1,\r\n\t\tt.playing = this.settings.waitForKeyPress,\r\n\t\tt.preloading = !1,\r\n\t\tt.tool = this.toolHandler.currentTool,\r\n\t\tt.toolOptions = this.toolHandler.getToolOptions(),\r\n\t\tt.grid = this.toolHandler.options.grid,\r\n\t\tt.cameraLocked = this.toolHandler.options.cameraLocked,\r\n\t\tt.zoomPercentage = this.camera.zoomPercentage,\r\n\t\tt.vehicle = this.vehicle,\r\n\t\tt\r\n\t}\r\n\ttrackAction(t, e) {\r\n\t\tif (this.game.settings.analyticsEnabled === false) return;\r\n\t\tvar i = this.toolHandler.analytics.actions\r\n\t\t  , s = this.mouse.analytics.clicks\r\n\t\t  , n = i + s\r\n\t\t  , r = {\r\n\t\t\tcategory: \"create\",\r\n\t\t\taction: t,\r\n\t\t\tlabel: e,\r\n\t\t\tvalue: n,\r\n\t\t\tnon_interaction: !0\r\n\t\t};\r\n\t\tApplication.Helpers.GoogleAnalyticsHelper.track_event(r)\r\n\t}\r\n\topenDialog(t) {\r\n\t\tsuper.openDialog(t);\r\n\t\tswitch (this.state.dialogOptions = {},\r\n\t\tt) {\r\n\t\tcase \"import\":\r\n\t\t\tbreak;\r\n\t\tcase \"export\":\r\n\t\t\tsetTimeout(this.getTrackCode.bind(this), 1e3 / this.game.ups);\r\n\t\t\tbreak;\r\n\t\tcase \"upload\":\r\n\t\t\t\"undefined\" == typeof isChromeApp && setTimeout(this.getTrackCode.bind(this), 1e3 / this.game.ups)\r\n\t\t}\r\n\t}\r\n\tgetTrackCode() {\r\n\t\tthis.state.dialogOptions = {},\r\n\t\tthis.state.dialogOptions.verified = this.verified,\r\n\t\tthis.state.dialogOptions.code = this.track.getCode()\r\n\t}\r\n\ttrackComplete() {\r\n\t\tthis.verified = !this.track.dirty\r\n\t}\r\n\thideControlPlanel() {}\r\n\tshowControlPlanel() {}\r\n\tcommand(t, ...e) {\r\n\t\tsuper.command(...arguments);\r\n\t\tswitch (t) {\r\n\t\tcase \"change tool\":\r\n\t\t\tlet i = e[0];\r\n\t\t\tthis.toolHandler.setTool(i);\r\n\t\t\tbreak;\r\n\t\tcase \"change tool option\":\r\n\t\t\tlet s = e[0]\r\n\t\t\t  , n = e[1];\r\n\t\t\t\"undefined\" != typeof e[2] ? this.toolHandler.setToolOption(s, n, e[2]) : this.toolHandler.setToolOption(s, n);\r\n\t\t\tbreak;\r\n\t\tcase \"snap\":\r\n\t\t\tthis.toolHandler.toggleSnap();\r\n\t\t\tbreak;\r\n\t\tcase \"redraw\":\r\n\t\t\tthis.redraw();\r\n\t\t\tbreak;\r\n\t\tcase \"fullscreen\":\r\n\t\t\tthis.settings.fullscreen = this.state.fullscreen = !this.settings.fullscreen;\r\n\t\t\tbreak;\r\n\t\tcase \"grid\":\r\n\t\t\tthis.toolHandler.toggleGrid();\r\n\t\t\tbreak;\r\n\t\tcase \"lock camera\":\r\n\t\t\tthis.toolHandler.toggleCameraLock();\r\n\t\t\tbreak;\r\n\t\tcase \"toggle vehicle\":\r\n\t\t\tthis.toggleVehicle(),\r\n\t\t\tthis.updateState();\r\n\t\t\tbreak;\r\n\t\tcase \"reset zoom\":\r\n\t\t\tthis.camera.resetZoom();\r\n\t\t\tbreak;\r\n\t\tcase \"increase zoom\":\r\n\t\t\tthis.camera.increaseZoom();\r\n\t\t\tbreak;\r\n\t\tcase \"decrease zoom\":\r\n\t\t\tthis.camera.decreaseZoom();\r\n\t\t\tbreak;\r\n\t\tcase \"change lineType\":\r\n\t\t\tlet r = e[0];\r\n\t\t\tthis.toolHandler.options.lineType = r,\r\n\t\t\tthis.updateState();\r\n\t\t\tbreak;\r\n\t\tcase \"clear track\":\r\n\t\t\tthis.settings.analyticsEnabled !== !1 && this.trackAction(\"editor-action\", \"clear\"),\r\n\t\t\tthis.clear = !0;\r\n\t\t\tbreak;\r\n\t\tcase \"import\":\r\n\t\t\tlet h = e[0];\r\n\t\t\th.length <= 0 && (h = !1),\r\n\t\t\tthis.importCode = h,\r\n\t\t\tthis.clear = e[1],\r\n\t\t\tthis.command(\"dialog\", !1)\r\n\t\t}\r\n\t}\r\n\tclose() {\r\n\t\tthis.settings.analyticsEnabled !== !1 && this.trackAction(\"editor-exit\", \"exit\"),\r\n\t\tdocument.removeEventListener('paste', this._pasteEvent),\r\n\t\tthis._pasteEvent = null,\r\n\t\tsuper.close()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/scenes/Editor.js?");

/***/ }),

/***/ "./src/game/class/scenes/Main.js":
/*!***************************************!*\
  !*** ./src/game/class/scenes/Main.js ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _BaseScene_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseScene.js */ \"./src/game/class/scenes/BaseScene.js\");\n/* harmony import */ var _controls_fullscreen_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../controls/fullscreen.js */ \"./src/game/class/controls/fullscreen.js\");\n/* harmony import */ var _controls_pause_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../controls/pause.js */ \"./src/game/class/controls/pause.js\");\n/* harmony import */ var _controls_pathtracer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../controls/pathtracer.js */ \"./src/game/class/controls/pathtracer.js\");\n/* harmony import */ var _controls_settings_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../controls/settings.js */ \"./src/game/class/controls/settings.js\");\n/* harmony import */ var _utils_campaignscore_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/campaignscore.js */ \"./src/game/class/utils/campaignscore.js\");\n/* harmony import */ var _utils_formatnumber_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/formatnumber.js */ \"./src/game/class/utils/formatnumber.js\");\n/* harmony import */ var _utils_racetimes_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/racetimes.js */ \"./src/game/class/utils/racetimes.js\");\n/* harmony import */ var _tools_pathtracertool_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../tools/pathtracertool.js */ \"./src/game/class/tools/pathtracertool.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nasync function digestMessage(message) {\r\n\tconst msgUint8 = new TextEncoder().encode(message);\r\n\tconst hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);\r\n\tconst hashArray = Array.from(new Uint8Array(hashBuffer));\r\n\tconst hashHex = hashArray\r\n\t.map((b) => b.toString(16).padStart(2, '0'))\r\n\t.join('');\r\n\treturn hashHex\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _BaseScene_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\traces = [];\r\n\tplaying = false;\r\n\tready = false;\r\n\tloading = false;\r\n\tfullscreenControls = null;\r\n\tpathtracerControls = null;\r\n\tsettingsControls = null;\r\n\tconstructor(t) {\r\n\t\tsuper(t);\r\n\t\tthis.raceTimes = new _utils_racetimes_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"](this);\r\n\t\tthis.settings.isCampaign && (this.campaignScore = new _utils_campaignscore_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](this));\r\n\t\tthis.setStartingVehicle(),\r\n\t\tthis.state = this.setStateDefaults(),\r\n\t\tthis.oldState = this.setStateDefaults(),\r\n\t\tthis.createMainPlayer(),\r\n\t\tthis.createControls(),\r\n\t\tthis.registerTools(),\r\n\t\tthis.setStartingVehicle(),\r\n\t\tthis.restart(),\r\n\t\tt.settings.analyticsEnabled !== false && this.initAnalytics()\r\n\t}\r\n\tgetCanvasOffset() {\r\n\t\treturn {\r\n\t\t\theight: 0,\r\n\t\t\twidth: 0\r\n\t\t}\r\n\t}\r\n\tcreateMainPlayer() {\r\n\t\tlet t = super.createMainPlayer();\r\n\t\tt.setKeyMap(this.settings.playHotkeys),\r\n\t\tt.recordKeys(this.settings.keysToRecord)\r\n\t}\r\n\tcreateControls() {\r\n\t\tthis.pauseControls = new _controls_pause_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this),\r\n\t\tthis.pathtracerControls = new _controls_pathtracer_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this);\r\n\t\tthis.settings.fullscreenAvailable && (this.fullscreenControls = new _controls_fullscreen_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this)),\r\n\t\tthis.settingsControls = new _controls_settings_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this)\r\n\t}\r\n\tcreateTrack() {\r\n\t\tlet t = super.createTrack()\r\n\t\t  , e = this.getAvailableTrackCode();\r\n\t\t0 != e && (t.read(e),\r\n\t\tthis.setTrackAllowedVehicles(),\r\n\t\tthis.state.preloading = !1,\r\n\t\tthis.loading = !1,\r\n\t\tthis.restartTrack = !0,\r\n\t\tthis.ready = !0)\r\n\t}\r\n\tplay() {\r\n\t\tthis.state.playing || (this.state.playing = !0,\r\n\t\tthis.hideControlPlanel())\r\n\t}\r\n\tbuttonDown(t) {\r\n\t\tthis.state.showDialog || super.buttonDown(t)\r\n\t}\r\n\texitFullscreen() {\r\n\t\tthis.settings.fullscreenAvailable && (this.settings.fullscreen = !1,\r\n\t\tthis.state.fullscreen = !1,\r\n\t\tthis.settings.analyticsEnabled !== !1 && this.trackEvent(\"game-ui\", \"game-fullscreen-toggle\", \"game-out-fullscreen\"))\r\n\t}\r\n\ttoggleFullscreen() {\r\n\t\tlet t = super.toggleFullscreen();\r\n\t\tt && this.settings.analyticsEnabled !== !1 && this.trackEvent(\"game-ui\", \"game-fullscreen-toggle\", this.settings.fullscreen ? \"game-into-fullscreen\" : \"game-out-fullscreen\")\r\n\t}\r\n\ttrackEvent(t, e, i) {\r\n\t\tApplication.Helpers.GoogleAnalyticsHelper.track_event({\r\n\t\t\tcategory: t,\r\n\t\t\taction: e,\r\n\t\t\tlabel: i,\r\n\t\t\tvalue: 0,\r\n\t\t\tnon_interaction: !0\r\n\t\t})\r\n\t}\r\n\tsetTrackAllowedVehicles() {\r\n\t\tlet t = this.track\r\n\t\t  , e = this.settings.track;\r\n\t\te && (t.allowedVehicles = e.vehicles)\r\n\t}\r\n\tinteractWithControls() {\r\n\t\tsuper.interactWithControls(),\r\n\t\tthis.pathtracerControls.click(),\r\n\t\tthis.settings.fullscreenAvailable && this.fullscreenControls.click()\r\n\t\tthis.settingsControls.click()\r\n\t}\r\n\tupdateControls() {\r\n\t\tsuper.updateControls(),\r\n\t\tthis.settings.fullscreenAvailable && this.fullscreenControls.update()\r\n\t}\r\n\tredrawControls() {\r\n\t\tsuper.redrawControls(),\r\n\t\tthis.pathtracerControls.redraw(),\r\n\t\tthis.settings.fullscreenAvailable && this.fullscreenControls.redraw(),\r\n\t\tthis.settingsControls.redraw()\r\n\t}\r\n\tregisterTools() {\r\n\t\tlet t = super.registerTools();\r\n\t\tt.registerTool(_tools_pathtracertool_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"]),\r\n\t\tt.setTool(\"Camera\")\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tlet t, e;\r\n\t\tthis.ready ? (this.updateToolHandler(),\r\n\t\tthis.mouse.update(),\r\n\t\tthis.state.paused || this.state.showDialog || (this.playerManager.updateGamepads(),\r\n\t\tthis.playerManager.checkKeys()),\r\n\t\tthis.camera.focusIndex > 0 && (t =  this.playerManager.firstPlayer._gamepad.downButtons,\r\n\t\tt = ~~t['right'] - ~~t['left']) && (e = this.playerManager.getPlayerByIndex(this.camera.focusIndex)) && e.isGhost() && e._gamepad.playbackTicks > 0 && (e._replayIterator.next((e._gamepad.playbackTicks ?? this.ticks) + 5 * t), /* add option for amount of ticks to skip */\r\n\t\tthis.state.playing = false),\r\n\t\tsuper.fixedUpdate(),\r\n\t\tthis.updateScore()) : this.importCode && this.createTrack()\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tsuper.draw(...arguments),\r\n\t\tthis.pathtracerControls.draw(ctx),\r\n\t\tthis.settings.fullscreenAvailable && this.fullscreenControls.draw(ctx),\r\n\t\tthis.settingsControls.draw(ctx),\r\n\t\tthis.campaignScore && this.campaignScore.draw(ctx),\r\n\t\tthis.raceTimes.draw(ctx)\r\n\t}\r\n\tisStateDirty() {\r\n\t\tlet e = this.state;\r\n\t\te.fullscreen != GameSettings.fullscreen && (e.fullscreen = GameSettings.fullscreen);\r\n\t\treturn super.isStateDirty()\r\n\t}\r\n\tupdateScore() {\r\n\t\tthis.campaignScore && this.campaignScore.update(),\r\n\t\tthis.raceTimes.update()\r\n\t}\r\n\trestart() {\r\n\t\tthis.message.show(\"Press Any Key To Start\", 1, \"#333333\", \"#FFFFFF\"),\r\n\t\tthis.track.resetPowerups(),\r\n\t\tthis.restartTrack = !1,\r\n\t\tthis.state.paused = !1,\r\n\t\tthis.state.playing = !this.settings.waitForKeyPress,\r\n\t\tthis.ticks = 0,\r\n\t\tthis.playerManager.reset(),\r\n\t\tthis.playerManager.getPlayerCount() > 0 && (this.camera.focusIndex = 1),\r\n\t\tthis.camera.focusOnPlayer(),\r\n\t\tthis.camera.fastforward(),\r\n\t\tthis.showControlPlanel(\"main\")\r\n\t}\r\n\tsetStartingVehicle() {\r\n\t\tlet t = this.settings\r\n\t\t  , e = t.startVehicle;\r\n\t\tt.track && (e = t.track.vehicle),\r\n\t\tthis.vehicle = e\r\n\t}\r\n\tupdatePlayers() {\r\n\t\tthis.playerManager.update()\r\n\t}\r\n\thideControlPlanel() {\r\n\t\tthis.state.showSkip && (this.state.showSkip = !1),\r\n\t\tthis.state.showControls !== !1 && (this.state.showControls = !1)\r\n\t}\r\n\tshowControlPlanel(t) {\r\n\t\tthis.settings.isCampaign && this.settings.campaignData.can_skip && this.analytics && this.analytics.deaths > 5 && (this.state.showSkip = !0),\r\n\t\tthis.stateshowControls !== t && this.settings.showHelpControls && (this.state.showControls = t)\r\n\t}\r\n\tresize() {\r\n\t\tthis.pauseControls.resize(),\r\n\t\tthis.settings.fullscreenAvailable && this.fullscreenControls.resize(),\r\n\t\tthis.settingsControls.resize(),\r\n\t\tsuper.resize()\r\n\t}\r\n\tsetStateDefaults() {\r\n\t\tlet t = super.setStateDefaults();\r\n\t\treturn t.paused = !1,\r\n\t\tt.playerAlive = !0,\r\n\t\tt.showControls = !1,\r\n\t\tt.showSkip = !1,\r\n\t\tt\r\n\t}\r\n\tcommand(t, ...e) {\r\n\t\tsuper.command(...arguments);\r\n\t\tswitch (t) {\r\n\t\tcase \"clear race\":\r\n\t\t\tthis.races.splice(0),\r\n\t\t\tthis.restartTrack = !0,\r\n\t\t\tthis.raceTimes.clear();\r\n\t\t\tbreak;\r\n\t\tcase \"add race\":\r\n\t\t\tlet r = e[0]\r\n\t\t\t  , o = e[1];\r\n\t\t\tthis.addRaces(r),\r\n\t\t\to && (this.state.dialogOptions = {\r\n\t\t\t\traces: this.races\r\n\t\t\t},\r\n\t\t\tthis.command(\"dialog\", \"race_dialog\"));\r\n\t\t\tbreak;\r\n\t\tcase \"change vehicle\":\r\n\t\t\tlet a = e[0];\r\n\t\t\tthis.selectVehicle(a);\r\n\t\t\tbreak;\r\n\t\tcase \"restart\":\r\n\t\t\tthis.command(\"dialog\", !1),\r\n\t\t\tthis.restartTrack = !0;\r\n\t\t\tbreak;\r\n\t\tcase \"resume\":\r\n\t\t\tthis.state.paused = !1;\r\n\t\t\tbreak;\r\n\t\tcase \"fullscreen\":\r\n\t\t\tthis.toggleFullscreen();\r\n\t\t\tbreak;\r\n\t\tcase \"exit_fullscreen\":\r\n\t\t\tthis.exitFullscreen()\r\n\t\t}\r\n\t}\r\n\taddRaces(t) {\r\n\t\tthis.mergeRaces(t),\r\n\t\tthis.sortRaces(),\r\n\t\tthis.formatRaces(),\r\n\t\tthis.game.emit('trackChallengeUpdate', this.races),\r\n\t\tthis.addRaceTimes(),\r\n\t\tthis.addPlayers(),\r\n\t\tthis.restartTrack = !0\r\n\t}\r\n\taddRaceTimes() {\r\n\t\tlet t = this.settings.raceColors\r\n\t\t  , e = t.length\r\n\t\t  , i = this.races\r\n\t\t  , s = this.raceTimes;\r\n\t\ts.clear();\r\n\t\tfor (let n in i) {\r\n\t\t\tlet r = i[n];\r\n\t\t\tr.user.color = t[n % e],\r\n\t\t\ts.addRace(r, n)\r\n\t\t}\r\n\t}\r\n\taddPlayers() {\r\n\t\tlet t = this.playerManager;\r\n\t\tt.clear();\r\n\t\tlet e = this.settings.keysToRecord;\r\n\t\tfor (let { user, race: i } of this.races) {\r\n\t\t\tlet s = i.code;\r\n\t\t\t\"string\" == typeof s && (s = JSON.parse(s));\r\n\t\t\tlet h = t.createPlayer(this, user);\r\n\t\t\th.setBaseVehicle(i.vehicle),\r\n\t\t\th.setAsGhost();\r\n\t\t\tlet l = h.getGamepad();\r\n\t\t\tl.loadPlayback(s, e),\r\n\t\t\tt.addPlayer(h)\r\n\t\t}\r\n\t}\r\n\tclearRaces() {\r\n\t\tthis.races.splice(0),\r\n\t\tthis.game.emit('trackChallengeUpdate', this.races),\r\n\t\tthis.raceTimes.clear(),\r\n\t\tthis.playerManager.clear()\r\n\t}\r\n\tformatRaces(t) {\r\n\t\tt ||= this.races;\r\n\t\tfor (let { race: e } of t.filter(t => 'string' == typeof t.race.code)) {\r\n\t\t\tlet i = JSON.parse(e.code);\r\n\t\t\ti.hasOwnProperty('bike_options') && i.bike_options instanceof Array && (i.bike_options = new Map(i.bike_options.map(s => s.split(/\\s*:\\s*/))));\r\n\t\t\tfor (let s of Object.keys(Object.fromEntries(Object.entries(i).filter(([, value]) => value instanceof Array))))\r\n\t\t\t\ti[s] = i[s].reduce((s, n) => (s[n] = ~~s[n] + 1, s), {});\r\n\t\t\te.code = i\r\n\t\t}\r\n\t\treturn t\r\n\t}\r\n\tremoveDuplicateRaces() {\r\n\t\tthis.races = this.races.filter((race, index, races) => index === races.findIndex(dup => this.uniqesByUserIdIterator(dup) == this.uniqesByUserIdIterator(race)))\r\n\t}\r\n\tremoveRaces(t) {\r\n\t\tt = Array.from(t).map(e => parseInt(e));\r\n\t\tlet e = this.races\r\n\t\t  , i = [];\r\n\t\tfor (let i of e.filter(({ user: i }) => t.includes(i.u_id)))\r\n\t\t\ti = e.splice(e.indexOf(i), 1),\r\n\t\t\tthis.playerManager.removePlayer(t),\r\n\t\t\tthis.game.emit('trackRaceDelete', i[0]);\r\n\t\tthis.game.emit('trackRacesDelete', i);\r\n\t\tthis.game.emit('trackChallengeUpdate', this.races),\r\n\t\tthis.addRaceTimes(),\r\n\t\tthis.camera.focusOnMainPlayer()\r\n\t}\r\n\tuniqesByUserIdIterator(t) {\r\n\t\tlet e = t.user;\r\n\t\treturn String(e.u_id)\r\n\t}\r\n\tsortRaces() {\r\n\t\tthis.races.length > 1 ? this.races.sort((a, b) => this.sortByRunTicksIterator(a) - this.sortByRunTicksIterator(b)) : this.sortByRunTicksIterator(this.races[0]),\r\n\t\tthis.game.emit('trackRacesSort', this.races)\r\n\t}\r\n\tmergeRaces(t) {\r\n\t\tlet e = this.races;\r\n\t\tt && t.forEach(i => {\r\n\t\t\tlet s = e.find(n => this.uniqesByUserIdIterator(n) == this.uniqesByUserIdIterator(i));\r\n\t\t\ts ? (s.runTime = null, this.sortByRunTicksIterator(Object.assign(s, i))) : (e.push(i),\r\n\t\t\tthis.game.emit('trackRaceCreate', i))\r\n\t\t})\r\n\t}\r\n\tredraw() {\r\n\t\tsuper.redraw(),\r\n\t\tthis.raceTimes.redraw()\r\n\t}\r\n\tsortByRunTicksIterator(t) {\r\n\t\tlet e = parseInt(t.race.run_ticks);\r\n\t\treturn t.runTime ||= (0,_utils_formatnumber_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(e / this.settings.drawFPS * 1e3),\r\n\t\te\r\n\t}\r\n\tverifyComplete() {\r\n\t\tlet t = this.playerManager.firstPlayer\r\n\t\t  , e = t._powerupsConsumed.targets\r\n\t\t  , i = this.track.targets;\r\n\t\treturn i.findIndex(n => -1 === e.indexOf(n.id)) === -1\r\n\t}\r\n\tasync trackComplete() {\r\n\t\tif (this.verifyComplete()) {\r\n\t\t\tthis.sound.play(\"victory_sound\");\r\n\t\t\tlet t = this.playerManager;\r\n\t\t\tt.mutePlayers();\r\n\t\t\tlet e = t.firstPlayer\r\n\t\t\t  , i = e.getGamepad()\r\n\t\t\t  , s = i.getReplayString()\r\n\t\t\t  , n = this.settings\r\n\t\t\t  , r = this.ticks\r\n\t\t\t  , o = (0,_utils_formatnumber_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(r / n.drawFPS * 1e3)\r\n\t\t\t  , a = $(\"#track-data\").data(\"t_id\")\r\n\t\t\t  , h = {\r\n\t\t\t\t\tt_id: a,\r\n\t\t\t\t\tu_id: n.user.u_id,\r\n\t\t\t\t\tcode: s,\r\n\t\t\t\t\tvehicle: e._baseVehicleType,\r\n\t\t\t\t\trun_ticks: r,\r\n\t\t\t\t\tfps: 25,\r\n\t\t\t\t\ttime: o\r\n\t\t\t\t};\r\n\t\t\th.sig = await digestMessage(h.t_id + \"|\" + h.u_id + \"|\" + h.code + \"|\" + h.run_ticks + \"|\" + h.vehicle + \"|\" + h.fps + \"|erxrHHcksIHHksktt8933XhwlstTekz\");\r\n\t\t\tlet u = this.races;\r\n\t\t\tu.length > 0 && (h.races = u.map(({ user }) => user.u_id)),\r\n\t\t\tn.isCampaign && (h.is_campaign = !0);\r\n\t\t\tlet q = {\r\n\t\t\t\tpostData: h,\r\n\t\t\t\tanalytics: this.analytics\r\n\t\t\t};\r\n\t\t\tthis.state.dialogOptions = Object.assign({}, q)\r\n\t\t\tif (!navigator.onLine) {\r\n\t\t\t\tthis.state.dialogOptions.postData = {},\r\n\t\t\t\tthis.game.emit('trackRaceUploadError', Object.defineProperty(new Error(\"Failed to upload race\"), 'data', {\r\n\t\t\t\t\tvalue: Object.assign({}, q)\r\n\t\t\t\t}));\r\n\t\t\t} else\r\n\t\t\t\tthis.settings.bestGhostEnabled && -1 === this.races.findIndex(t => n.user.u_id == this.uniqesByUserIdIterator(t) && t.race.run_ticks <= r) && this.addRaces([{\r\n\t\t\t\t\trace: structuredClone(h),\r\n\t\t\t\t\tuser: n.user\r\n\t\t\t\t}]),\r\n\t\t\t\tthis.game.emit('trackRaceUpload', q);\r\n\t\t\tthis.command(\"dialog\", (n.isCampaign ? \"campaign\" : \"track\") + '_complete'),\r\n\t\t\ti.reset(!0),\r\n\t\t\tthis.listen()\r\n\t\t}\r\n\t}\r\n\tclose() {\r\n\t\tthis.fullscreenControls = null,\r\n\t\tthis.settingsControls = null,\r\n\t\tthis.raceTimes = null,\r\n\t\tthis.score = null,\r\n\t\tthis.campaignScore = null,\r\n\t\tsuper.close()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/scenes/Main.js?");

/***/ }),

/***/ "./src/game/class/sector/physicsline.js":
/*!**********************************************!*\
  !*** ./src/game/class/sector/physicsline.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _sceneryline_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sceneryline.js */ \"./src/game/class/sector/sceneryline.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _sceneryline_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcollide(t) {\r\n\t\tif (this.collided) return;\r\n\t\tthis.collided = !0;\r\n\t\tlet e = t.pos\r\n\t\t\t, i = t.vel\r\n\t\t\t, s = t.radius\r\n\t\t\t, o = 0\r\n\t\t\t, a = 0\r\n\t\t\t, h = 0\r\n\t\t\t, l = this.p1\r\n\t\t\t, c = this.p2\r\n\t\t\t, u = e.x - l.x\r\n\t\t\t, p = e.y - l.y\r\n\t\t\t, d = this.pp\r\n\t\t\t, f = this.len\r\n\t\t\t, v = (u * d.x + p * d.y) / f / f;\r\n\t\tif (v >= 0 && 1 >= v) {\r\n\t\t\tlet g = (u * d.y - p * d.x) * ((u - i.x) * d.y - (p - i.y) * d.x) < 0 ? -1 : 1\r\n\t\t\t\t, o = u - d.x * v\r\n\t\t\t\t, a = p - d.y * v;\r\n\t\t\tif (h = Math.sqrt(Math.pow(o, 2) + Math.pow(a, 2)),\r\n\t\t\t0 === h && (h = 1),\r\n\t\t\ts > h || 0 > g) {\r\n\t\t\t\tlet m = (s * g - h) / h;\r\n\t\t\t\treturn e.x += o * m,\r\n\t\t\t\te.y += a * m,\r\n\t\t\t\tvoid t.drive(-a / h, o / h)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!(-s > v * f || v * f > f + s)) {\r\n\t\t\tlet y = v > 0 ? c : l;\r\n\t\t\tif (o = e.x - y.x,\r\n\t\t\t\ta = e.y - y.y,\r\n\t\t\t\th = Math.sqrt(o ** 2 + a ** 2),\r\n\t\t\t\t0 === h && (h = 1),\r\n\t\t\t\ts > h) {\r\n\t\t\t\tlet m = (s - h) / h;\r\n\t\t\t\treturn e.x += o * m,\r\n\t\t\t\te.y += a * m,\r\n\t\t\t\tvoid t.drive(-a / h, o / h)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic type = 'physics';\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/physicsline.js?");

/***/ }),

/***/ "./src/game/class/sector/powerup.js":
/*!******************************************!*\
  !*** ./src/game/class/sector/powerup.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tgame = null;\r\n\tscene = null;\r\n\tcolor = '#FFF';\r\n\tx = 0;\r\n\ty = 0;\r\n\tmultiplier = 1;\r\n\tname = null;\r\n\tsector = null;\r\n\tsettings = null;\r\n\toutline = '#000';\r\n\tremove = !1;\r\n\tconstructor(t, e) {\r\n\t\tObject.defineProperty(this, 'game', { enumerable: false }),\r\n\t\tObject.defineProperty(this, 'scene', { enumerable: false });\r\n\t\tlet i = arguments[arguments.length - 1];\r\n\t\tthis.game = i.scene.game,\r\n\t\tthis.scene = i.scene,\r\n\t\tthis.settings = this.game.settings,\r\n\t\tthis.x = t,\r\n\t\tthis.y = e,\r\n\t\tthis.remove = !1\r\n\t}\r\n\taddSectorReference(t) {\r\n\t\tthis.sector = t\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet e = t.pos.x - this.x\r\n\t\t  , i = t.pos.y - this.y\r\n\t\t  , r = Math.sqrt(e ** 2 + i ** 2);\r\n\t\t!this.hit && 26 > r && (this.hit = !0,\r\n\t\tthis.sector.powerupCanvasDrawn = !1)\r\n\t}\r\n\tdraw(t, e, i, s) {\r\n\t\tthis.constructor.cache.dirty && this.recache(i);\r\n\t\tlet r = this.constructor.cache.width * i\r\n\t\t  , o = this.constructor.cache.height * i\r\n\t\t  , a = r / 2\r\n\t\t  , h = o / 2;\r\n\t\ts.drawImage(this.constructor.cache.canvas, t - a, e - h, r, o)\r\n\t}\r\n\tdrawPowerup() {}\r\n\terase(t, e) {\r\n\t\tlet i = !1;\r\n\t\tif (!this.remove) {\r\n\t\t\tlet s = Math.sqrt(Math.pow(t.x - this.x, 2) + Math.pow(t.y - this.y, 2));\r\n\t\t\te >= s && (i = [this],\r\n\t\t\tthis.removeAllReferences())\r\n\t\t}\r\n\t\treturn i\r\n\t}\r\n\tgetCode() {\r\n\t\tlet t = '';\r\n\t\tthis.prefix && (t = this.prefix + ' ');\r\n\t\treturn t + this.x.toString(32) + ' ' + this.y.toString(32)\r\n\t}\r\n\tmove(t, e) {\r\n\t\tthis.x += parseInt(t) | 0,\r\n\t\tthis.y += parseInt(e) | 0;\r\n\t\treturn this\r\n\t}\r\n\trecache(t) {\r\n\t\tthis.setDirty(!1);\r\n\t\tlet e = this.constructor.cache.canvas\r\n\t\t  , i = this.constructor.cache.width * t\r\n\t\t  , s = this.constructor.cache.height * t\r\n\t\t  , n = e.getContext('2d');\r\n\t\t(e.width !== i || e.height !== s) && this.updateCache(n, t);\r\n\t\tlet r = e.width / 2\r\n\t\t  , a = e.height / 2;\r\n\t\tthis.drawPowerup(n, t, r, a),\r\n\t\tthis.settings.developerMode && (n.beginPath(),\r\n\t\tn.rect(0, 0, e.width, e.height),\r\n\t\tn.strokeStyle = 'red',\r\n\t\tn.strokeWidth = 1 * t,\r\n\t\tn.stroke())\r\n\t}\r\n\tremoveAllReferences() {\r\n\t\tthis.remove = !0,\r\n\t\tthis.sector && (this.sector.powerupCanvasDrawn = !1,\r\n\t\tthis.sector.dirty = !0,\r\n\t\tthis.sector = null),\r\n\t\tthis.scene.track.cleanPowerups()\r\n\t}\r\n\tsetDirty(t) {\r\n\t\tthis.constructor.cache.dirty = t\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tlet i = this.constructor.cache\r\n\t\t  , s = i.canvas;\r\n\t\ts.width = i.width * e,\r\n\t\ts.height = i.height * e\r\n\t}\r\n\tstatic createCache(options, callback) {\r\n\t\tlet cache = Object.assign({\r\n\t\t\tcanvas: document.createElement('canvas'),\r\n\t\t\tdirty: !0,\r\n\t\t\twidth: 25,\r\n\t\t\theight: 25\r\n\t\t}, options);\r\n\t\ttypeof callback == 'function' && callback(cache.canvas.getContext('2d'));\r\n\t\treturn cache\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerup.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/antigravity.js":
/*!*******************************************************!*\
  !*** ./src/game/class/sector/powerups/antigravity.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _powerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../powerup.js */ \"./src/game/class/sector/powerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _powerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#08faf3';\r\n\tname = 'antigravity';\r\n\tprefix = 'A';\r\n\tconstructor(t, e, i) {\r\n\t\tsuper(i);\r\n\t\tthis.x = t;\r\n\t\tthis.y = e;\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , r = t.pos.y - this.y\r\n\t\t  , o = Math.pow(s, 2) + Math.pow(r, 2);\r\n\t\t1e3 > o && i.isAlive() && (i.isGhost() === !1 && ((0 != e.gravity.x || 0 != e.gravity.y) && this.scene.sound.play('antigravity_sound', .3),\r\n\t\tthis.scene.message.show('Antigravity Engaged', 50, this.color)),\r\n\t\te.gravity.x = 0,\r\n\t\te.gravity.y = 0)\r\n\t}\r\n\tdrawPowerup(t, e) {\r\n\t\te *= this.constructor.cache.scale,\r\n\t\tt.scale(e, e),\r\n\t\tt.beginPath();\r\n\t\tlet i = t.lineWidth;\r\n\t\tt.arc(25, 25, 11 - i / 2, 0, 2 * Math.PI, !0),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(3, 29.3196417),\r\n\t\tt.bezierCurveTo(4.74079001, 38.2359804, 11.7640196, 45.2589035, 20.6800518, 46.9996935),\r\n\t\tt.lineTo(20.6800518, 40.7043471),\r\n\t\tt.bezierCurveTo(15.1649961, 39.1854465, 10.814247, 34.8350039, 9.29534642, 29.3196417),\r\n\t\tt.closePath(),\r\n\t\tt.moveTo(47, 20.6803583),\r\n\t\tt.bezierCurveTo(45.25921, 11.7640196, 38.2362869, 4.74079001, 29.3196417, 3),\r\n\t\tt.lineTo(29.3196417, 9.29534642),\r\n\t\tt.bezierCurveTo(34.8350039, 10.814247, 39.185753, 15.1646897, 40.7046536, 20.6803583),\r\n\t\tt.closePath(),\r\n\t\tt.moveTo(9.29534642, 20.6803583),\r\n\t\tt.bezierCurveTo(10.814247, 15.1646897, 15.1649961, 10.814247, 20.6800518, 9.29534642),\r\n\t\tt.lineTo(20.6800518, 3),\r\n\t\tt.bezierCurveTo(11.7640196, 4.74109649, 4.74079001, 11.7640196, 3, 20.6803583),\r\n\t\tt.closePath(),\r\n\t\tt.moveTo(29.3196417, 46.9996935),\r\n\t\tt.bezierCurveTo(38.2362869, 45.2589035, 45.25921, 38.2359804, 47, 29.3196417),\r\n\t\tt.lineTo(40.7046536, 29.3196417),\r\n\t\tt.bezierCurveTo(39.185753, 34.8350039, 34.8350039, 39.1854465, 29.3196417, 40.7043471),\r\n\t\tt.closePath(),\r\n\t\tt.lineWidth = 5,\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = i,\r\n        t.fill()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.strokeStyle = i,\r\n\t\tt.lineWidth = 3\r\n\t}\r\n\tstatic cache = this.createCache({ scale: .5 })\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/antigravity.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/bomb.js":
/*!************************************************!*\
  !*** ./src/game/class/sector/powerups/bomb.js ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _powerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../powerup.js */ \"./src/game/class/sector/powerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _powerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#d12929';\r\n\thit = !1;\r\n\tname = 'bomb';\r\n\tprefix = 'O';\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , n = t.pos.y - this.y\r\n\t\t  , a = Math.sqrt(s ** 2 + n ** 2);\r\n\t\t20 > a && i.isAlive() && (e.explode(),\r\n\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\tthis.sector.powerupCanvasDrawn = !1))\r\n\t}\r\n\tdraw(...t) {\r\n\t\tthis.hit || super.draw(...t)\r\n\t}\r\n\tdrawPowerup(t, e) {\r\n\t\te *= this.constructor.cache.scale,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(53 * e, 105 * e),\r\n\t\tt.lineTo(41.5 * e, 115 * e),\r\n\t\tt.lineTo(43 * e, 100 * e),\r\n\t\tt.bezierCurveTo(35.5 * e, 95 * e, 30 * e, 88.5 * e, 26.5 * e, 80 * e),\r\n\t\tt.lineTo(11 * e, 78 * e),\r\n\t\tt.lineTo(24 * e, 69.5 * e),\r\n\t\tt.bezierCurveTo(24 * e, 68 * e, 24 * e, 67 * e, 24 * e, 66 * e),\r\n\t\tt.bezierCurveTo(24 * e, 58.5 * e, 26 * e, 51 * e, 30 * e, 45 * e),\r\n\t\tt.lineTo(22 * e, 31.5 * e),\r\n\t\tt.lineTo(37.5 * e, 36 * e),\r\n\t\tt.bezierCurveTo(43.5 * e, 31 * e, 51 * e, 27.5 * e, 60 * e, 26 * e),\r\n\t\tt.lineTo(66 * e, 11 * e),\r\n\t\tt.lineTo(72 * e, 26.5 * e),\r\n\t\tt.bezierCurveTo(80.5 * e, 27.5 * e, 88 * e, 31 * e, 93.5 * e, 36.5 * e),\r\n\t\tt.lineTo(110 * e, 31.5 * e),\r\n\t\tt.lineTo(101.5 * e, 46 * e),\r\n\t\tt.bezierCurveTo(105 * e, 52 * e, 107 * e, 59 * e, 107 * e, 66 * e),\r\n\t\tt.bezierCurveTo(107 * e, 67 * e, 107 * e, 68 * e, 107 * e, 69 * e),\r\n\t\tt.lineTo(121 * e, 78 * e),\r\n\t\tt.lineTo(104.5 * e, 80.5 * e),\r\n\t\tt.bezierCurveTo(101.5 * e, 88 * e, 96 * e, 95 * e, 89 * e, 99.5 * e),\r\n\t\tt.lineTo(90.5 * e, 115 * e),\r\n\t\tt.lineTo(78.5 * e, 104.5 * e),\r\n\t\tt.bezierCurveTo(74.5 * e, 106 * e, 70 * e, 107 * e, 65.5 * e, 107 * e),\r\n\t\tt.bezierCurveTo(61 * e, 107 * e, 57 * e, 106 * e, 53 * e, 105 * e),\r\n\t\tt.lineTo(53 * e, 105 * e),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.arc(66 * e, 66 * e, 40 * e, 0 * e, 2 * Math.PI, !0);\r\n\t\tt.save(),\r\n\t\tt.lineWidth = 2 * e,\r\n\t\tt.save(),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.restore(),\r\n\t\tt.beginPath(),\r\n\t\tt.arc(66 * e, 66 * e, 8 * e, 0 * e, 2 * Math.PI, !0),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.restore()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.fillStyle = i,\r\n\t\tt.strokeStyle = i,\r\n\t\tt.lineWidth = 8 * e * this.constructor.cache.scale\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 26,\r\n\t\theight: 26,\r\n\t\tscale: .2\r\n\t});\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/bomb.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/boost.js":
/*!*************************************************!*\
  !*** ./src/game/class/sector/powerups/boost.js ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _directional_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./directional.js */ \"./src/game/class/sector/powerups/directional.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _directional_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#8ac832';\r\n\tname = 'boost';\r\n\tprefix = 'B';\r\n\tconstructor(t, e, i, s) {\r\n\t\tsuper(t, e, i, s),\r\n\t\tthis.angle = i;\r\n\t\tlet n = (i - 180) / 360 * 2 * Math.PI;\r\n\t\tthis.directionX = (-Math.sin(n)).toFixed(15) / 1,\r\n\t\tthis.directionY = Math.cos(n).toFixed(15) / 1\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , r = t.pos.y - this.y\r\n\t\t  , o = s ** 2 + r ** 2\r\n\t\t  , a = e.masses\r\n\t\t  , h = a.length;\r\n\t\tif (1e3 > o && i.isAlive()) {\r\n\t\t\tfor (let n = 0; n < this.multiplier; n++) {\r\n\t\t\t\t// invalid solution -- neglects order of powerups\r\n\t\t\t\tfor (var u = h - 1; u >= 0; u--) {\r\n\t\t\t\t\tvar p = a[u].pos;\r\n\t\t\t\t\tp.x += this.directionX,\r\n\t\t\t\t\tp.y += this.directionY\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ti.isGhost() === !1 && (this.scene.sound.play('boost_sound'),\r\n\t\t\tthis.scene.message.show('Boost Engaged', 50, this.color))\r\n\t\t}\r\n\t}\r\n\tdrawPowerup(t, e) {\r\n\t\te *= this.constructor.cache.scale,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(8 * e, 4 * e),\r\n\t\tt.lineTo(39 * e, 4 * e),\r\n\t\tt.lineTo(70 * e, 40 * e),\r\n\t\tt.lineTo(38 * e, 76 * e),\r\n\t\tt.lineTo(8 * e, 76 * e),\r\n\t\tt.lineTo(40 * e, 39 * e),\r\n\t\tt.closePath(),\r\n\t\tt.moveTo(57 * e, 4 * e),\r\n\t\tt.lineTo(89 * e, 4 * e),\r\n\t\tt.lineTo(120 * e, 40 * e),\r\n\t\tt.lineTo(88 * e, 76 * e),\r\n\t\tt.lineTo(58 * e, 76 * e),\r\n\t\tt.lineTo(89 * e, 39 * e),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.strokeStyle = i,\r\n\t\tt.lineWidth = Math.max(8 * e * this.constructor.cache.scale, 1)\r\n\t}\r\n\tstatic angleOffset = -90;\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 25,\r\n\t\theight: 16,\r\n\t\tscale: .2\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/boost.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/checkpoint.js":
/*!******************************************************!*\
  !*** ./src/game/class/sector/powerups/checkpoint.js ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _consumable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./consumable.js */ \"./src/game/class/sector/powerups/consumable.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _consumable_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#826cdc';\r\n\tname = 'checkpoint';\r\n\tprefix = 'C';\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , o = t.pos.y - this.y\r\n\t\t  , a = Math.sqrt(Math.pow(s, 2) + Math.pow(o, 2))\r\n\t\t  , h = i._powerupsConsumed.checkpoints;\r\n\t\t26 > a && i.isAlive() && -1 === h.indexOf(this.id) && (h.push(this.id),\r\n\t\ti.setCheckpointOnUpdate(),\r\n\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\tthis.sector.powerupCanvasDrawn = !1,\r\n\t\tthis.scene.message.show('Checkpoint Saved', 50, this.color, '#FFFFFF'),\r\n\t\tthis.scene.sound.play('checkpoint_sound')))\r\n\t}\r\n\tdraw(t, e, i, s) {\r\n\t\ts.save(),\r\n\t\tthis.hit && (s.globalAlpha = .3),\r\n\t\tsuper.draw(t, e, i, s),\r\n\t\ts.restore()\r\n\t}\r\n\tdrawPowerup(t, e) {\r\n\t\te *= this.constructor.cache.scale,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(4 * e, 11 * e),\r\n\t\tt.bezierCurveTo(4 * e, 11 * e, 34.5 * e, 28 * e, 56 * e, 11 * e),\r\n\t\tt.bezierCurveTo(77 * e, -5 * e, 109 * e, 11 * e, 109 * e, 11 * e),\r\n\t\tt.lineTo(110 * e, 87 * e),\r\n\t\tt.bezierCurveTo(110 * e, 87 * e, 75 * e, 74.5 * e, 57.5 * e, 87 * e),\r\n\t\tt.bezierCurveTo(41 * e, 99 * e, 4 * e, 89.5 * e, 4 * e, 89.5 * e),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(5 * e, 11 * e),\r\n\t\tt.lineTo(5 * e, 181 * e);\r\n\t\tlet i = t.lineWidth;\r\n\t\tt.lineWidth = 10 * e,\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = i\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.strokeStyle = i,\r\n\t\tt.lineWidth = 8 * e * this.constructor.cache.scale\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 18,\r\n\t\theight: 28,\r\n\t\tscale: .15\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/checkpoint.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/consumable.js":
/*!******************************************************!*\
  !*** ./src/game/class/sector/powerups/consumable.js ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _powerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../powerup.js */ \"./src/game/class/sector/powerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _powerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\thit = !1;\r\n\tid = crypto.randomUUID();\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/consumable.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/directional.js":
/*!*******************************************************!*\
  !*** ./src/game/class/sector/powerups/directional.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _powerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../powerup.js */ \"./src/game/class/sector/powerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _powerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tangle = null;\r\n\tdirectionX = 0;\r\n\tdirectionY = 0;\r\n\trealAngle = 0;\r\n\tconstructor(t, e, i, s) {\r\n\t\tsuper(t, e, s),\r\n\t\tthis.realAngle = i\r\n\t}\r\n\tdraw(t, e, i, s) {\r\n\t\tthis.constructor.cache.dirty && this.recache(i);\r\n\t\tlet n = this.constructor.cache.width * i\r\n\t\t  , o = this.constructor.cache.height * i\r\n\t\t  , a = n / 2\r\n\t\t  , h = o / 2\r\n\t\t  , u = (this.angle + this.constructor.angleOffset) * (Math.PI / 180);\r\n\t\ts.translate(t, e),\r\n\t\ts.rotate(u),\r\n\t\ts.drawImage(this.constructor.cache.canvas, -a, -h, n, o),\r\n\t\ts.rotate(-u),\r\n\t\ts.translate(-t, -e)\r\n\t}\r\n\tgetCode() {\r\n\t\treturn (super.getCode() + ' ' + this.realAngle.toString(32) + ',').repeat(this.multiplier).slice(0, -1)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/directional.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/gravity.js":
/*!***************************************************!*\
  !*** ./src/game/class/sector/powerups/gravity.js ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _directional_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./directional.js */ \"./src/game/class/sector/powerups/directional.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _directional_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tangle = -180;\r\n\tcolor = '#376eb7';\r\n\tname = \"gravity\";\r\n\tprefix = 'G';\r\n\tconstructor(t, e, i, s) {\r\n\t\tsuper(t, e, i, s),\r\n\t\tthis.angle = i - 180;\r\n\t\tlet n = this.angle / 360 * 2 * Math.PI;\r\n\t\tthis.directionX = (-.3 * Math.sin(n)).toFixed(15) / 1,\r\n\t\tthis.directionY = (.3 * Math.cos(n)).toFixed(15) / 1\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , r = t.pos.y - this.y\r\n\t\t  , o = s ** 2 + r ** 2;\r\n\t\t1e3 > o && i.isAlive() && (e.gravity.x = this.directionX,\r\n\t\te.gravity.y = this.directionY,\r\n\t\ti.isGhost() === !1 && (this.scene.message.show('Gravity Changed', 50, '#1F80C3', '#FFFFFF'),\r\n\t\tthis.scene.sound.play('gravity_down_sound')))\r\n\t}\r\n\tdrawPowerup(t, e) {\r\n\t\te *= this.constructor.cache.scale,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(45 * e, 70 * e),\r\n\t\tt.lineTo(45 * e, 95 * e),\r\n\t\tt.lineTo(97 * e, 50 * e),\r\n\t\tt.lineTo(45 * e, 5 * e),\r\n\t\tt.lineTo(45 * e, 30 * e),\r\n\t\tt.lineTo(3 * e, 30 * e),\r\n\t\tt.lineTo(3 * e, 70 * e),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.lineJoin = 'round',\r\n\t\tt.lineWidth = Math.max(6 * e * this.constructor.cache.scale, 1),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.strokeStyle = i\r\n\t}\r\n\tstatic angleOffset = 90;\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 20,\r\n\t\theight: 20,\r\n\t\tscale: .2\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/gravity.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/slowmo.js":
/*!**************************************************!*\
  !*** ./src/game/class/sector/powerups/slowmo.js ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _powerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../powerup.js */ \"./src/game/class/sector/powerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _powerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'slowmo';\r\n\tprefix = 'S';\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , o = t.pos.y - this.y\r\n\t\t  , a = Math.sqrt(Math.pow(s, 2) + Math.pow(o, 2));\r\n\t\t26 > a && i.isAlive() && (e.slow = !0,\r\n\t\ti.isGhost() === !1 && (this.scene.sound.play('slowmo_sound'),\r\n\t\tthis.scene.message.show('Slow Motion', 50, this.color, '#000000')))\r\n\t}\r\n\tdrawPowerup(t, e) {\r\n\t\te *= .24,\r\n\t\tt.scale(e, e),\r\n\t\tt.beginPath(),\r\n\t\tt.arc(50, 50, 50 - t.lineWidth / 2, 0, 2 * Math.PI),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.arc(50, 50, 42.5 - t.lineWidth / 2, 0, 2 * Math.PI),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(70, 50),\r\n\t\tt.lineTo(50, 50),\r\n\t\tt.lineTo(30, 20),\r\n\t\tt.moveTo(92.5, 50),\r\n\t\tt.lineTo(82.5, 50),\r\n\t\tt.moveTo(50, 7.5),\r\n\t\tt.lineTo(50, 17.5),\r\n\t\tt.moveTo(50, 92.5),\r\n\t\tt.lineTo(50, 82.5),\r\n\t\tt.moveTo(7.5, 50),\r\n\t\tt.lineTo(17.5, 50);\r\n\t\tlet i = t.lineWidth;\r\n\t\tt.lineWidth = 5,\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = i\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.strokeStyle = i,\r\n\t\tt.lineWidth = 3\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 26,\r\n\t\theight: 24\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/slowmo.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/target.js":
/*!**************************************************!*\
  !*** ./src/game/class/sector/powerups/target.js ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _consumable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./consumable.js */ \"./src/game/class/sector/powerups/consumable.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _consumable_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#FAE335';\r\n\tname = \"goal\";\r\n\tprefix = 'T';\r\n\tcacheStar(t) {\r\n\t\tlet e = this.constructor.cache.canvas;\r\n\t\te.width = this.constructor.cache.width * t,\r\n\t\te.height = this.constructor.cache.height * t;\r\n\t\tlet i = e.getContext('2d')\r\n\t\t  , s = e.width / 2\r\n\t\t  , n = e.height / 2;\r\n\t\tthis.drawStar(s, n, 5, 10, 5, !0, t, i),\r\n\t\tthis.settings.developerMode && (i.beginPath(),\r\n\t\ti.rect(0, 0, e.width, e.height),\r\n\t\ti.strokeStyle = 'red',\r\n\t\ti.strokeWidth = 1 * t,\r\n\t\ti.stroke())\r\n\t}\r\n\tcacheEmptyStar(t) {\r\n\t\tlet e = this.constructor.hitCache.canvas;\r\n\t\te.width = this.constructor.hitCache.width * t,\r\n\t\te.height = this.constructor.hitCache.height * t;\r\n\t\tlet i = e.getContext('2d')\r\n\t\t  , s = e.width / 2\r\n\t\t  , n = e.height / 2;\r\n\t\tthis.drawStar(s, n, 5, 10, 5, !1, t, i),\r\n\t\tthis.settings.developerMode && (i.beginPath(),\r\n\t\ti.rect(0, 0, e.width, e.height),\r\n\t\ti.strokeStyle = 'red',\r\n\t\ti.strokeWidth = 1 * t,\r\n\t\ti.stroke())\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , o = t.pos.y - this.y\r\n\t\t  , a = Math.sqrt(s ** 2 + o ** 2)\r\n\t\t  , h = i._powerupsConsumed.targets\r\n\t\t  , l = this.scene;\r\n\t\tif (26 > a && i.isAlive() && -1 === h.indexOf(this.id)) {\r\n\t\t\th.push(this.id);\r\n\t\t\tlet c = i.getTargetsHit() // h.length\r\n\t\t\t  , u = l.track.targetCount;\r\n\t\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\t\tthis.sector.powerupCanvasDrawn = !1,\r\n\t\t\tl.sound.play('goal_sound'),\r\n\t\t\tl.message.show(c + \" of \" + u + ' Stars', 50, this.color, '#666')),\r\n\t\t\tc >= u && (i.complete = !0);\r\n\t\t\tif (i.isGhost()) {\r\n\t\t\t\tlet raceTime = this.scene.raceTimes.container.children.find(({ data }) => data.user.u_id === i._user.u_id);\r\n\t\t\t\tif (raceTime && raceTime.children.length > 0) {\r\n\t\t\t\t\tlet targets = raceTime.children[raceTime.children.length - 1];\r\n\t\t\t\t\ttargets.text = c + '/' + u;\r\n\t\t\t\t\tthis.scene.raceTimes.redraw()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tdraw(t, e, i, s) {\r\n\t\tlet cache = this.constructor.hitCache;\r\n\t\tthis.hit || (cache = this.constructor.cache,\r\n\t\tcache.dirty && this.recache(i));\r\n\t\tlet n = cache.width * i\r\n\t\t  , r = cache.height * i\r\n\t\t  , o = n / 2\r\n\t\t  , c = r / 2;\r\n\t\ts.drawImage(cache.canvas, t - o, e - c, n, r)\r\n\t}\r\n\tdrawStar(t, e, i, s, n, r, o, a) {\r\n\t\tlet h = Math.PI / 2 * 3\r\n\t\t  , l = t\r\n\t\t  , c = e\r\n\t\t  , u = Math.PI / i;\r\n\t\ts *= o,\r\n\t\tn *= o,\r\n\t\ta.beginPath(),\r\n\t\ta.moveTo(t, e - s);\r\n\t\tfor (let p = 0; i > p; p++)\r\n\t\t\tl = t + Math.cos(h) * s,\r\n\t\t\tc = e + Math.sin(h) * s,\r\n\t\t\ta.lineTo(l, c),\r\n\t\t\th += u,\r\n\t\t\tl = t + Math.cos(h) * n,\r\n\t\t\tc = e + Math.sin(h) * n,\r\n\t\t\ta.lineTo(l, c),\r\n\t\t\th += u;\r\n\t\ta.lineTo(t, e - s),\r\n\t\ta.closePath(),\r\n\t\ta.lineWidth = Math.max(2 * o, 1),\r\n\t\ta.strokeStyle = /^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) ? '#FBFBFB' : this.outline,\r\n\t\ta.stroke(),\r\n\t\ta.fillStyle = r ? this.color : '#FFFFFF',\r\n\t\ta.fill()\r\n\t}\r\n\trecache(t) {\r\n\t\tthis.setDirty(!1);\r\n\t\tthis.cacheStar(t),\r\n\t\tthis.cacheEmptyStar(t)\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 35,\r\n\t\theight: 35\r\n\t})\r\n\tstatic hitCache = this.createCache({\r\n\t\twidth: 35,\r\n\t\theight: 35\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/target.js?");

/***/ }),

/***/ "./src/game/class/sector/powerups/teleport.js":
/*!****************************************************!*\
  !*** ./src/game/class/sector/powerups/teleport.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _consumable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./consumable.js */ \"./src/game/class/sector/powerups/consumable.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _consumable_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#dd45ec';\r\n\totherPortal = null;\r\n\tname = 'teleport';\r\n\tprefix = 'W';\r\n\trecorded = !1;\r\n\taddOtherPortalRef(t) {\r\n\t\tthis.otherPortal = t\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = i._powerupsConsumed.misc;\r\n\t\tif (-1 === s.indexOf(this.id)) {\r\n\t\t\tlet n = t.pos.x - this.x\r\n\t\t\t  , o = t.pos.y - this.y\r\n\t\t\t  , a = n ** 2 + o ** 2;\r\n\t\t\t1e3 > a && i.isAlive() && (s.push(this.id),\r\n\t\t\ts.push(this.otherPortal.id),\r\n\t\t\te.moveVehicle(this.otherPortal.x - this.x, this.otherPortal.y - this.y),\r\n\t\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\t\tthis.otherPortal.hit = !0,\r\n\t\t\tthis.sector.powerupCanvasDrawn = !1,\r\n\t\t\tthis.otherPortal.sector.powerupCanvasDrawn = !1,\r\n\t\t\tthis.scene.sound.play('teleport_sound', .3),\r\n\t\t\tthis.scene.message.show('Teleport Engaged', 50, this.color)))\r\n\t\t}\r\n\t}\r\n\tdraw(t, e, i, s) {\r\n\t\ts.save(),\r\n\t\ts.globalAlpha = this.hit === !1 ? 1 : .2,\r\n\t\tsuper.draw(t, e, i, s),\r\n\t\ts.restore()\r\n\t}\r\n\tdrawPowerup(t, e) {\r\n\t\tlet n = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (n = this.settings.physicsLineColor),\r\n\t\te *= this.constructor.cache.scale,\r\n\t\tt.save(),\r\n\t\tt.scale(e, e),\r\n\t\tt.translate(2.6, 3),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.strokeStyle = n,\r\n\t\tt.lineWidth = 5,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(23.9052288, 5.91261647),\r\n\t\tt.bezierCurveTo(23.9052288, 5.91261647, 22.5543791, 5.13614588, 18.1099346, 5.04995765),\r\n\t\tt.bezierCurveTo(13.6479739, 5.05021647, 9.39411765, 6.99424, 5.93111111, 10.2266871),\r\n\t\tt.bezierCurveTo(2.88431373, 13.0698635, .969542484, 16.6517224, .241437908, 20.8723576),\r\n\t\tt.bezierCurveTo(.0837908497, 22.1227341, .0816993464, 22.1341224, .0796078431, 22.1452518),\r\n\t\tt.bezierCurveTo(.0929411765, 25.8184753, .118562092, 26.0470165, .145751634, 26.2752988),\r\n\t\tt.bezierCurveTo(.550457516, 29.6511341, 1.80196078, 32.7860047, 3.86601307, 35.59424),\r\n\t\tt.bezierCurveTo(4.76326797, 36.8153694, 6.27176471, 38.4928047, 7.6179085, 39.4864282),\r\n\t\tt.bezierCurveTo(7.6179085, 39.4864282, 13.4911111, 44.3481694, 22.5543791, 43.7872988),\r\n\t\tt.bezierCurveTo(16.5849673, 39.6461224, 15.7624837, 37.5460282, 15.7624837, 37.5460282),\r\n\t\tt.bezierCurveTo(16.4521569, 37.6208282, 18.1535948, 38.5391341, 21.868366, 38.5391341),\r\n\t\tt.bezierCurveTo(27.0628758, 38.5391341, 31.7535948, 36.2909929, 35.4330719, 32.0377459),\r\n\t\tt.bezierCurveTo(37.5739869, 29.5631341, 38.9739869, 26.6037459, 39.5941176, 23.2421459),\r\n\t\tt.lineTo(39.8856209, 21.2448047),\r\n\t\tt.bezierCurveTo(39.7975163, 18.0607576, 39.7695425, 17.8096988, 39.7394771, 17.5591576),\r\n\t\tt.bezierCurveTo(39.3355556, 14.1864282, 38.0845752, 11.0515576, 36.0215686, 8.24176941),\r\n\t\tt.bezierCurveTo(34.9975163, 6.84826353, 33.8019608, 5.59038118, 32.4675817, 4.50202824),\r\n\t\tt.bezierCurveTo(32.4675817, 4.50202824, 25.996732, -1.07536, 16.5653595, .558592941),\r\n\t\tt.bezierCurveTo(21.6393464, 2.28934588, 23.9052288, 5.91261647, 23.9052288, 5.91261647),\r\n\t\tt.stroke(),\r\n\t\tt.fill(),\r\n\t\tt.fillStyle = /^(dark(er)|midnight)?$/i.test(lite.storage.get('theme')) ? '#1e1e1e' : '#fefefe',\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(5.22875817, 24.6992965),\r\n\t\tt.lineTo(5.22875817, 23.0451553),\r\n\t\tt.bezierCurveTo(5.24078431, 22.97812, 5.25647059, 22.9113435, 5.26457516, 22.8437906),\r\n\t\tt.bezierCurveTo(5.30823529, 22.4770376, 5.33254902, 22.1071788, 5.39555556, 21.7440494),\r\n\t\tt.bezierCurveTo(5.9179085, 18.7173671, 7.26117647, 16.0988494, 9.5179085, 13.9930612),\r\n\t\tt.bezierCurveTo(12.7882353, 10.9404965, 16.6520261, 9.83428471, 21.0614379, 10.8020259),\r\n\t\tt.bezierCurveTo(23.1579085, 11.2619553, 24.9563399, 12.2887082, 26.3997386, 13.8804729),\r\n\t\tt.bezierCurveTo(27.8005229, 15.4251318, 28.5681046, 17.2482847, 28.8130719, 19.3033435),\r\n\t\tt.bezierCurveTo(29.0044444, 20.9103788, 28.7861438, 22.4467553, 28.0836601, 23.9122141),\r\n\t\tt.bezierCurveTo(26.5186928, 27.1764965, 23.3458824, 28.74652, 19.8862745, 27.9666847),\r\n\t\tt.bezierCurveTo(17.6018301, 27.4518847, 16.0658824, 25.7762612, 15.7793464, 23.4833435),\r\n\t\tt.bezierCurveTo(15.7513725, 23.2566141, 15.7422222, 23.0278141, 15.7233987, 22.7920259),\r\n\t\tt.bezierCurveTo(15.6826144, 22.7959082, 15.6577778, 22.7959082, 15.6345098, 22.8013435),\r\n\t\tt.bezierCurveTo(15.2580392, 22.8929671, 15.0844444, 23.1867318, 14.9532026, 23.5037906),\r\n\t\tt.bezierCurveTo(14.6407843, 24.2592965, 14.6128105, 25.0383553, 14.8180392, 25.8238847),\r\n\t\tt.bezierCurveTo(15.1252288, 26.9999788, 15.8075817, 27.9480494, 16.7301961, 28.7162376),\r\n\t\tt.bezierCurveTo(19.105098, 30.6939082, 21.8201307, 31.2356259, 24.7777778, 30.3869435),\r\n\t\tt.bezierCurveTo(27.9027451, 29.4903788, 30.1628758, 27.5002847, 31.6556863, 24.6703082),\r\n\t\tt.bezierCurveTo(33.1751634, 21.7893435, 33.4169935, 18.73652, 32.7003922, 15.5969906),\r\n\t\tt.bezierCurveTo(32.1134641, 13.0263553, 30.9056209, 10.7471553, 29.2807843, 8.67397882),\r\n\t\tt.bezierCurveTo(29.2345098, 8.61496706, 29.1887582, 8.55595529, 29.1427451, 8.49694353),\r\n\t\tt.bezierCurveTo(30.1487582, 9.31767294, 31.0295425, 10.2476259, 31.7918954, 11.2855082),\r\n\t\tt.bezierCurveTo(33.305098, 13.3460024, 34.2433987, 15.6329671, 34.5471895, 18.1681435),\r\n\t\tt.bezierCurveTo(34.5856209, 18.4903788, 34.6206536, 18.8131318, 34.6569935, 19.1356259),\r\n\t\tt.lineTo(34.6569935, 20.7897671),\r\n\t\tt.bezierCurveTo(34.6449673, 20.8565435, 34.629281, 20.92332, 34.620915, 20.9908729),\r\n\t\tt.bezierCurveTo(34.5644444, 21.4313906, 34.5309804, 21.8763082, 34.4501961, 22.3121671),\r\n\t\tt.bezierCurveTo(34.0122876, 24.6873906, 33.0475817, 26.8374376, 31.4616993, 28.6706847),\r\n\t\tt.bezierCurveTo(28.1134641, 32.5408729, 23.9121569, 34.11012, 18.8256209, 33.0287553),\r\n\t\tt.bezierCurveTo(16.5994771, 32.5553671, 14.72, 31.4287082, 13.2504575, 29.68372),\r\n\t\tt.bezierCurveTo(11.9879739, 28.1846141, 11.2983007, 26.4463553, 11.0705882, 24.5126847),\r\n\t\tt.bezierCurveTo(10.871634, 22.8236024, 11.1286275, 21.2212259, 11.9113725, 19.7042612),\r\n\t\tt.bezierCurveTo(13.5228758, 16.5810376, 16.6386928, 15.0982376, 19.9803922, 15.8646141),\r\n\t\tt.bezierCurveTo(22.303268, 16.3975318, 23.7997386, 18.0288965, 24.1079739, 20.3696965),\r\n\t\tt.bezierCurveTo(24.136732, 20.5899553, 24.1440523, 20.8128024, 24.1662745, 21.1008729),\r\n\t\tt.bezierCurveTo(24.343268, 20.9921671, 24.5147712, 20.9334141, 24.6146405, 20.8153906),\r\n\t\tt.bezierCurveTo(24.7620915, 20.6414612, 24.8909804, 20.4375082, 24.970719, 20.2255318),\r\n\t\tt.bezierCurveTo(25.28, 19.4032494, 25.2648366, 18.5688024, 24.9890196, 17.7405671),\r\n\t\tt.bezierCurveTo(24.5738562, 16.4935553, 23.7654902, 15.5263318, 22.715817, 14.7615082),\r\n\t\tt.bezierCurveTo(20.315817, 13.0147082, 17.6664052, 12.6334612, 14.8541176, 13.5207082),\r\n\t\tt.bezierCurveTo(11.8538562, 14.4672259, 9.67267974, 16.4187553, 8.23006536, 19.1622847),\r\n\t\tt.bezierCurveTo(6.68470588, 22.1014847, 6.45960784, 25.2078847, 7.22352941, 28.3996965),\r\n\t\tt.bezierCurveTo(7.82248366, 30.8996729, 9.0096732, 33.1206376, 10.5921569, 35.1438612),\r\n\t\tt.bezierCurveTo(10.6420915, 35.2083082, 10.692549, 35.2724965, 10.743268, 35.3364259),\r\n\t\tt.bezierCurveTo(9.97568627, 34.7698612, 8.83764706, 33.5606376, 8.09385621, 32.5486376),\r\n\t\tt.bezierCurveTo(6.57986928, 30.4886612, 5.6420915, 28.2016965, 5.33830065, 25.66652),\r\n\t\tt.bezierCurveTo(5.29960784, 25.3442847, 5.26535948, 25.0215318, 5.22875817, 24.6992965),\r\n\t\tt.fill(),\r\n\t\tt.restore()\r\n\t}\r\n\terase(t, e) {\r\n\t\tlet i = !1;\r\n\t\tif (!this.remove) {\r\n\t\t\tlet s = Math.sqrt(Math.pow(t.x - this.x, 2) + Math.pow(t.y - this.y, 2));\r\n\t\t\te >= s && (i = [this, this.otherPortal],\r\n\t\t\tthis.removeAllReferences(),\r\n\t\t\tthis.otherPortal.removeAllReferences())\r\n\t\t}\r\n\t\treturn i\r\n\t}\r\n\tgetCode() {\r\n\t\tlet t = '';\r\n\t\treturn this.recorded === !1 && this.otherPortal.recorded === !0 ? this.recorded = !0 : this.recorded === !1 && this.otherPortal.recorded === !1 ? (this.recorded = !0,\r\n\t\tt = super.getCode() + ' ' + this.otherPortal.x.toString(32) + ' ' + this.otherPortal.y.toString(32)) : this.recorded === !0 && this.otherPortal.recorded === !0 && (this.otherPortal.recorded = !1,\r\n\t\tt = super.getCode() + ' ' + this.otherPortal.x.toString(32) + ' ' + this.otherPortal.y.toString(32)),\r\n\t\tt\r\n\t}\r\n\tmove(t, e) {\r\n\t\tthis.otherPortal.x += parseInt(t) | 0,\r\n\t\tthis.otherPortal.y += parseInt(e) | 0;\r\n\t\treturn super.move(t, e)\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 29,\r\n\t\theight: 32,\r\n\t\tscale: .64\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/powerups/teleport.js?");

/***/ }),

/***/ "./src/game/class/sector/sceneryline.js":
/*!**********************************************!*\
  !*** ./src/game/class/sector/sceneryline.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tsectors = [];\r\n\tp1 = null;\r\n\tp2 = null;\r\n\tpp = null;\r\n\tlen = 0;\r\n\tcollided = !1;\r\n\thighlight = !1;\r\n\trecorded = !1;\r\n\tremove = !1;\r\n\tconstructor(t, e, i, n) {\r\n\t\tObject.defineProperties(this, {\r\n\t\t\trecorded: { enumerable: false },\r\n\t\t\tremove: { enumerable: false },\r\n\t\t\tsectors: { enumerable: false }\r\n\t\t});\r\n\t\tthis.p1 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t, e);\r\n\t\tthis.p2 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](i, n);\r\n\t\tthis.pp = this.p2.sub(this.p1);\r\n\t\tthis.len = this.pp.len()\r\n\t}\r\n\tmove(t, e) {\r\n\t\tthis.p1.x += parseInt(t) | 0,\r\n\t\tthis.p1.y += parseInt(e) | 0,\r\n\t\tthis.p2.x += parseInt(t) | 0,\r\n\t\tthis.p2.y += parseInt(e) | 0\r\n\t}\r\n\tgetCode(t) {\r\n\t\tthis.recorded = !0;\r\n\t\tlet e = this.p2\r\n\t\t  , i = \" \" + e.x.toString(32) + \" \" + e.y.toString(32)\r\n\t\t  , s = this.checkForConnectedLine(t, e);\r\n\t\treturn s && (i += s.getCode(t)),\r\n\t\ti\r\n\t}\r\n\tcheckForConnectedLine(t, e) {\r\n\t\tlet i = t.settings.drawSectorSize\r\n\t\t  , s = t.sectors.drawSectors\r\n\t\t  , n = Math.floor(e.x / i)\r\n\t\t  , o = Math.floor(e.y / i);\r\n\t\treturn s[n][o].searchForLine(this.constructor.type + \"Lines\", e)\r\n\t}\r\n\terase(t, e) {\r\n\t\tlet i = !1;\r\n\t\tif (!this.remove) {\r\n\t\t\tlet s = this.p1\r\n\t\t\t  , r = this.p2\r\n\t\t\t  , h = r.sub(s)\r\n\t\t\t  , l = s.sub(t)\r\n\t\t\t  , c = h.dot(h)\r\n\t\t\t  , u = 2 * l.dot(h)\r\n\t\t\t  , p = l.dot(l) - e ** 2\r\n\t\t\t  , d = u * u - 4 * c * p;\r\n\t\t\tif (d > 0) {\r\n\t\t\t\td = Math.sqrt(d);\r\n\t\t\t\tlet f = (-u - d) / (2 * c)\r\n\t\t\t\t  , v = (-u + d) / (2 * c);\r\n\t\t\t\tf >= 0 && 1 >= f && (i = !0,\r\n\t\t\t\tthis.removeAllReferences()),\r\n\t\t\t\tv >= 0 && 1 >= v && (i = !0,\r\n\t\t\t\tthis.removeAllReferences())\r\n\t\t\t}\r\n\t\t\tthis.intersects(this.p1.x, this.p1.y, t.x, t.y, e) ? (i = !0,\r\n\t\t\tthis.removeAllReferences()) : this.intersects(this.p2.x, this.p2.y, t.x, t.y, e) && (i = !0,\r\n\t\t\tthis.removeAllReferences())\r\n\t\t}\r\n\t\treturn i\r\n\t}\r\n\tintersects(t, e, i, s, n) {\r\n\t\tlet r = t - i\r\n\t\t  , o = e - s;\r\n\t\treturn n ** 2 >= r ** 2 + o ** 2\r\n\t}\r\n\taddSectorReference(t) {\r\n\t\tthis.sectors.push(t)\r\n\t}\r\n\tremoveAllReferences() {\r\n\t\tthis.remove = !0;\r\n\t\tfor (let t of this.sectors)\r\n\t\t\tt.drawn = !1,\r\n\t\t\tt.dirty = !0;\r\n\t\tthis.sectors = []\r\n\t}\r\n\r\n\tstatic type = 'scenery';\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/sceneryline.js?");

/***/ }),

/***/ "./src/game/class/sector/sector.js":
/*!*****************************************!*\
  !*** ./src/game/class/sector/sector.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _physicsline_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./physicsline.js */ \"./src/game/class/sector/physicsline.js\");\n/* harmony import */ var _sceneryline_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sceneryline.js */ \"./src/game/class/sector/sceneryline.js\");\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tscene = null;\r\n\tsettings = null;\r\n\tdrawSectorSize = null;\r\n\trow = 0;\r\n\tcolumn = 0;\r\n\tcamera = null;\r\n\tzoom = 0;\r\n\tx = 0;\r\n\ty = 0;\r\n\trealX = 0;\r\n\trealY = 0;\r\n\tphysicsLines = [];\r\n\tsceneryLines = [];\r\n\tcanvasPool = null;\r\n\tcanvas = null;\r\n\tctx = null;\r\n\tdirty = !1;\r\n\tdrawn = !1;\r\n\thasPowerups = !1;\r\n\tlineCount = 0;\r\n\tpowerupCanvas = null;\r\n\tpowerupCanvasOffset = 35;\r\n\tpowerupCanvasDrawn = !1;\r\n\tpowerups = {\r\n\t\tall: [],\r\n\t\tgoals: [],\r\n\t\tgravitys: [],\r\n\t\tboosts: [],\r\n\t\tslowmos: [],\r\n\t\tcheckpoints: [],\r\n\t\tbombs: [],\r\n\t\tantigravitys: [],\r\n\t\tteleports: [],\r\n\t\thelicopters: [],\r\n\t\ttrucks: [],\r\n\t\tballoons: [],\r\n\t\tblobs: []\r\n\t};\r\n\tpowerupsCount = 0;\r\n\tconstructor(t, e, i) {\r\n\t\tthis.track = i,\r\n\t\tthis.scene = i.scene,\r\n\t\tthis.settings = i.settings,\r\n\t\tthis.drawSectorSize = i.settings.drawSectorSize,\r\n\t\tthis.row = e,\r\n\t\tthis.column = t,\r\n\t\tthis.camera = i.camera,\r\n\t\tthis.zoom = i.camera.zoom,\r\n\t\tthis.canvasPool = i.canvasPool,\r\n\t\tthis.x = t * this.drawSectorSize,\r\n\t\tthis.y = e * this.drawSectorSize,\r\n\t\tthis.realX = this.x * this.zoom,\r\n\t\tthis.realY = this.y * this.zoom\r\n\t}\r\n\taddLine(t) {\r\n\t\tt instanceof _physicsline_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] && this.physicsLines.push(t) || t instanceof _sceneryline_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] && this.sceneryLines.push(t),\r\n\t\tthis.lineCount++,\r\n\t\tthis.drawn = !1\r\n\t}\r\n\tsearchForLine(t, e) {\r\n\t\treturn this[t].find(item => item.p1.x === e.x && item.p1.y === e.y && !item.recorded && !item.remove)\r\n\t}\r\n\taddPowerup(t) {\r\n\t\tthis.powerups.all.push(t),\r\n\t\tthis.powerups.hasOwnProperty(t.name + 's') && this.powerups[t.name + \"s\"].push(t),\r\n\t\tthis.powerupsCount++,\r\n\t\tthis.hasPowerups = !0,\r\n\t\tthis.powerupCanvasDrawn = !1\r\n\t}\r\n\tcachePowerupSector() {\r\n\t\tthis.powerupCanvasDrawn = !0;\r\n\t\tif (this.powerups.all.length > 0) {\r\n\t\t\tthis.powerupCanvas = this.canvasPool.getCanvas();\r\n\t\t\tthis.powerupCanvas.width = (this.drawSectorSize * this.scene.camera.zoom) + this.powerupCanvasOffset * this.scene.camera.zoom | 0,\r\n\t\t\tthis.powerupCanvas.height = (this.drawSectorSize * this.scene.camera.zoom) + this.powerupCanvasOffset * this.scene.camera.zoom | 0;\r\n\t\t\tlet ctx = this.powerupCanvas.getContext(\"2d\");\r\n\t\t\tctx.clearRect(0, 0, this.powerupCanvas.width, this.powerupCanvas.height),\r\n\t\t\tthis.drawPowerups(this.powerups.slowmos, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.checkpoints, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.boosts, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.gravitys, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.bombs, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.goals, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.antigravitys, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.teleports, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.helicopters, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.trucks, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.balloons, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.drawPowerups(this.powerups.blobs, this.scene.camera.zoom, ctx),\r\n\t\t\tthis.settings.developerMode && (ctx.beginPath(),\r\n\t\t\tctx.strokeStyle = \"red\",\r\n\t\t\tctx.rect(0, 0, this.powerupCanvas.width, this.powerupCanvas.height),\r\n\t\t\tctx.stroke())\r\n\t\t}\r\n\t}\r\n\tcreateCanvas() {\r\n\t\tthis.canvas = this.canvasPool.getCanvas(),\r\n\t\tthis.canvas.width = this.drawSectorSize * this.scene.camera.zoom | 0,\r\n\t\tthis.canvas.height = this.drawSectorSize * this.scene.camera.zoom | 0,\r\n\t\tthis.ctx = this.canvas.getContext(\"2d\"),\r\n\t\tthis.ctx.lineCap = 'round',\r\n\t\tthis.ctx.lineWidth = Math.max(2 * this.scene.camera.zoom, .5);\r\n\t}\r\n\tcleanSector() {\r\n\t\tthis.cleanSectorType(\"physicsLines\"),\r\n\t\tthis.cleanSectorType(\"sceneryLines\"),\r\n\t\tthis.cleanSectorType(\"powerups\", \"all\");\r\n\t\tthis.powerups.all.length === 0 ? (this.hasPowerups = !1,\r\n\t\tthis.powerupCanvas && (this.canvasPool.releaseCanvas(this.powerupCanvas),\r\n\t\tthis.powerupCanvas = null)) : this.hasPowerups = !0,\r\n\t\tthis.dirty = !1\r\n\t}\r\n\tcleanSectorType(t, e) {\r\n\t\tlet i = this[t];\r\n\t\te && (i = i[e]);\r\n\t\tfor (let n of i.filter(s => s.remove))\r\n\t\t\ti.splice(i.indexOf(n), 1)\r\n\t}\r\n\tdraw() {\r\n\t\t!this.canvas && this.createCanvas(),\r\n\t\tthis.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height),\r\n\t\tthis.ctx.beginPath(),\r\n\t\tthis.ctx.strokeStyle = this.settings.sceneryLineColor,\r\n\t\tthis.drawLines(this.sceneryLines, this.scene.camera.zoom, this.ctx),\r\n\t\tthis.ctx.stroke(),\r\n\t\tthis.ctx.beginPath(),\r\n\t\tthis.ctx.strokeStyle = this.settings.physicsLineColor,\r\n\t\tthis.drawLines(this.physicsLines, this.scene.camera.zoom, this.ctx),\r\n\t\tthis.ctx.stroke(),\r\n\t\tthis.settings.developerMode && (this.ctx.beginPath(),\r\n\t\tthis.ctx.strokeStyle = 'blue',\r\n\t\tthis.ctx.rect(0, 0, this.canvas.width, this.canvas.height),\r\n\t\tthis.ctx.stroke()),\r\n\t\tthis.drawn = !0\r\n\t}\r\n\tdrawLine(t, e) {\r\n\t\t!this.canvas && this.createCanvas(),\r\n\t\tthis.ctx.beginPath(),\r\n\t\tthis.ctx.strokeStyle = e,\r\n\t\tthis.ctx.moveTo((t.p1.x - this.x) * this.scene.camera.zoom, (t.p1.y - this.y) * this.scene.camera.zoom),\r\n\t\tthis.ctx.lineTo((t.p2.x - this.x) * this.scene.camera.zoom, (t.p2.y - this.y) * this.scene.camera.zoom),\r\n\t\tthis.ctx.stroke()\r\n\t}\r\n\terase(t, e, i) {\r\n\t\tlet s = [];\r\n\t\tif (i.physics === !0)\r\n\t\t\tfor (let n of this.physicsLines.filter(n => n.erase(t, e)))\r\n\t\t\t\ts.push(n);\r\n\t\tif (i.scenery === !0)\r\n\t\t\tfor (let n of this.sceneryLines.filter(n => n.erase(t, e)))\r\n\t\t\t\ts.push(n);\r\n\t\tif (i.powerups === !0)\r\n\t\t\tfor (let n of this.powerups.all.map(n => n.erase(t, e)).filter(n => n))\r\n\t\t\t\ts.push(...n);\r\n\t\treturn s\r\n\t}\r\n\tupdate() {\r\n\t\tthis.realX = this.x * this.camera.zoom | 0,\r\n\t\tthis.realY = this.y * this.camera.zoom | 0,\r\n\t\tthis.zoom = this.camera.zoom\r\n\t}\r\n\tresetCollided() {\r\n\t\tlet physicsLines = this.physicsLines.filter(item => item.collided);\r\n\t\tfor (let i = physicsLines.length - 1; i >= 0; i--)\r\n\t\t\tphysicsLines[i].collided = !1\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet physicsLines = this.physicsLines.filter(item => !item.collided);\r\n\t\tfor (let n = physicsLines.length - 1; n >= 0; n--)\r\n\t\t\tphysicsLines[n].remove ? this.physicsLines.splice(this.physicsLines.indexOf(physicsLines[n]), 1) : physicsLines[n].collide(t)\r\n\t\tif (t.parent.powerupsEnabled) {\r\n\t\t\tlet i = t.parent.player\r\n\t\t\t  , s = this.powerups.all.filter(item => -1 === i._powerupsConsumed.misc.indexOf(item.id));\r\n\t\t\t!i.isGhost() && (s = s.filter(item => !item.hit));\r\n\t\t\tfor (let h = s.length - 1; h >= 0; h--)\r\n\t\t\t\ts[h].remove ? this.powerups.all.splice(this.powerups.all.indexOf(s[h]), 1) : s[h].collide(t)\r\n\t\t}\r\n\t}\r\n\tdrawLines(t, e, i) {\r\n\t\tfor (let s in t) {\r\n\t\t\tif (t[s].remove) t.splice(s, 1);\r\n\t\t\telse i.moveTo((t[s].p1.x - this.x) * e, (t[s].p1.y - this.y) * e),\r\n\t\t\ti.lineTo((t[s].p2.x - this.x) * e, (t[s].p2.y - this.y) * e)\r\n\t\t}\r\n\t}\r\n\tdrawPowerups(t, e, i) {\r\n\t\tlet n = t.reduce((e, i) => { // filter overlapping powerups\r\n\t\t\tlet n = e.filter(s => s.name === i.name && s.x === i.x && s.y === i.y);\r\n\t\t\tswitch(i.prefix) {\r\n\t\t\tcase 'B':\r\n\t\t\tcase 'G':\r\n\t\t\t\tn = n.filter(s => s.angle === i.angle);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'C':\r\n\t\t\tcase 'O':\r\n\t\t\tcase 'T':\r\n\t\t\tcase 'V':\r\n\t\t\t\tn = n.filter(s => s.hit === i.hit)\r\n\t\t\t}\r\n\t\t\tn.length > 0 || e.push(i);\r\n\t\t\treturn e\r\n\t\t}, []);\r\n\t\tfor (let s of n) {\r\n\t\t\tif (s.remove)\r\n\t\t\t\tt.splice(t.indexOf(s), 1);\r\n\t\t\telse {\r\n\t\t\t\ts.draw((s.x - this.x) * e + this.powerupCanvasOffset * e / 2, (s.y - this.y) * e + this.powerupCanvasOffset * e / 2, e, i)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tdrawBackground(ctx, e, i) {\r\n\t\tctx.beginPath(),\r\n\t\tctx.rect(0, 0, this.drawSectorSize * e | 0, this.drawSectorSize * e | 0),\r\n\t\tctx.fillStyle = i,\r\n\t\tctx.fill()\r\n\t}\r\n\tclear() {\r\n\t\tthis.drawn = !1,\r\n\t\tthis.powerupCanvasDrawn = !1,\r\n\t\tthis.canvas && (this.canvasPool.releaseCanvas(this.canvas),\r\n\t\tthis.canvas = null,\r\n\t\tthis.ctx = null),\r\n\t\tthis.powerupCanvas && (this.canvasPool.releaseCanvas(this.powerupCanvas),\r\n\t\tthis.powerupCanvas = null)\r\n\t}\r\n\tclose() {\r\n\t\tthis.track = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.settings = null,\r\n\t\tthis.drawSectorSize = null,\r\n\t\tthis.row = null,\r\n\t\tthis.column = null,\r\n\t\tthis.camera = null,\r\n\t\tthis.zoom = null,\r\n\t\tthis.canvasPool = null,\r\n\t\tthis.x = null,\r\n\t\tthis.y = null,\r\n\t\tthis.realX = null,\r\n\t\tthis.realY = null,\r\n\t\tthis.lineCount = null,\r\n\t\tthis.drawn = null,\r\n\t\tthis.physicsLines = null,\r\n\t\tthis.sceneryLines = null,\r\n\t\tthis.canvas = null,\r\n\t\tthis.ctx = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/sector.js?");

/***/ }),

/***/ "./src/game/class/sector/vehiclepowerup.js":
/*!*************************************************!*\
  !*** ./src/game/class/sector/vehiclepowerup.js ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _powerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./powerup.js */ \"./src/game/class/sector/powerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _powerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\thit = !1;\r\n\tindex = null;\r\n\tprefix = 'V';\r\n\tstack = [];\r\n\tconstructor(t, e, i, s) {\r\n\t\tsuper(s);\r\n\t\tthis.x = t;\r\n\t\tthis.y = e;\r\n\t\tthis.time = i;\r\n\t\tthis.id = Math.random().toString(36).slice(2);\r\n\t}\r\n\tdraw(t, e, i, s) {\r\n\t\tthis.hit || super.draw(t, e, i, s)\r\n\t}\r\n\tdrawIcon() {}\r\n\tdrawPowerup() {\r\n\t\tthis.drawIcon(...arguments)\r\n\t}\r\n\tgetCode() {\r\n\t\tlet t = this.time\r\n\t\t  , e = super.getCode() + ' ' + this.index + ' '\r\n\t\t  , i = '';\r\n\t\tthis.stack.length > 0 && (i += ',' + this.stack.map(s => e + s.toString(32)).join(','),\r\n\t\tt -= this.stack.reduce((i, s) => i += s, 0));\r\n\t\treturn e + t.toString(32) + i\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/vehiclepowerup.js?");

/***/ }),

/***/ "./src/game/class/sector/vehiclepowerups/balloon.js":
/*!**********************************************************!*\
  !*** ./src/game/class/sector/vehiclepowerups/balloon.js ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../vehiclepowerup.js */ \"./src/game/class/sector/vehiclepowerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#f02728';\r\n\tindex = 3;\r\n\tname = 'balloon';\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , n = t.pos.y - this.y\r\n\t\t  , r = Math.sqrt(Math.pow(s, 2) + Math.pow(n, 2))\r\n\t\t  , h = i._powerupsConsumed.misc\r\n\t\t  , l = this.scene;\r\n\t\tif (30 > r && i.isAlive() && -1 === h.indexOf(this.id)) {\r\n\t\t\th.push(this.id);\r\n\t\t\tlet c = this.time * l.settings.drawFPS;\r\n\t\t\ti.setTempVehicle(this.name.toUpperCase(), c, {\r\n\t\t\t\tx: this.x,\r\n\t\t\t\ty: this.y\r\n\t\t\t}, e.dir),\r\n\t\t\tl.camera.playerFocus === i && (l.camera.focusOnPlayer(),\r\n\t\t\tl.vehicleTimer.playerAddedTime(i)),\r\n\t\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\t\tthis.sector.powerupCanvasDrawn = !1,\r\n\t\t\tthis.scene.message.show('Balloon Powerup!', 50, this.color, !1))\r\n\t\t}\r\n\t}\r\n\tdrawIcon(t, e) {\r\n\t\tt.scale(e, e),\r\n\t\tt.beginPath(),\r\n\t\tt.roundRect(6, 23, 9, 8, 1),\r\n\t\tt.fill(),\r\n\t\tt.beginPath(),\r\n\t\tt.arc(10.5, 10.5, 10.5 - t.lineWidth / 2, 0, 2 * Math.PI, !0);\r\n\t\tlet i = t.fillStyle;\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.fill(),\r\n\t\tt.fillStyle = i,\r\n\t\tt.moveTo(15, 18.5),\r\n\t\tt.lineTo(13, 24),\r\n\t\tt.moveTo(8, 24),\r\n\t\tt.lineTo(6, 18.5),\r\n\t\tt.stroke()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.lineWidth = 2,\r\n\t\tt.strokeStyle = i,\r\n\t\tt.fillStyle = i\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 21,\r\n\t\theight: 31\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/vehiclepowerups/balloon.js?");

/***/ }),

/***/ "./src/game/class/sector/vehiclepowerups/blob.js":
/*!*******************************************************!*\
  !*** ./src/game/class/sector/vehiclepowerups/blob.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../vehiclepowerup.js */ \"./src/game/class/sector/vehiclepowerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#a784c5';\r\n\tindex = 4;\r\n\tname = 'blob';\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , n = t.pos.y - this.y\r\n\t\t  , r = Math.sqrt(Math.pow(s, 2) + Math.pow(n, 2))\r\n\t\t  , h = i._powerupsConsumed.misc\r\n\t\t  , l = this.scene;\r\n\t\tif (30 > r && i.isAlive() && -1 === h.indexOf(this.id)) {\r\n\t\t\th.push(this.id);\r\n\t\t\tvar c = this.time * l.settings.drawFPS;\r\n\t\t\ti.setTempVehicle(this.name.toUpperCase(), c, {\r\n\t\t\t\tx: this.x,\r\n\t\t\t\ty: this.y\r\n\t\t\t}, e.dir),\r\n\t\t\tl.camera.playerFocus === i && (l.camera.focusOnPlayer(),\r\n\t\t\tl.vehicleTimer.playerAddedTime(i)),\r\n\t\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\t\tthis.sector.powerupCanvasDrawn = !1,\r\n\t\t\tthis.scene.message.show('Blob Powerup!', 50, this.color, !1))\r\n\t\t}\r\n\t}\r\n\tdrawIcon(t, e) {\r\n\t\tt.scale(e, e),\r\n\t\tt.beginPath(),\r\n\t\tt.roundRect(1, 1, 22, 22, 3.5),\r\n\t\tt.fill(),\r\n\t\tt.stroke()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.strokeStyle = i,\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.lineWidth = 2\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 24,\r\n\t\theight: 24\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/vehiclepowerups/blob.js?");

/***/ }),

/***/ "./src/game/class/sector/vehiclepowerups/helicopter.js":
/*!*************************************************************!*\
  !*** ./src/game/class/sector/vehiclepowerups/helicopter.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../vehiclepowerup.js */ \"./src/game/class/sector/vehiclepowerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#f59423';\r\n\tindex = 1;\r\n\tname = 'helicopter';\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , n = t.pos.y - this.y\r\n\t\t  , r = Math.sqrt(Math.pow(s, 2) + Math.pow(n, 2))\r\n\t\t  , h = i._powerupsConsumed.misc\r\n\t\t  , l = this.scene;\r\n\t\tif (30 > r && i.isAlive() && -1 === h.indexOf(this.id)) {\r\n\t\t\th.push(this.id);\r\n\t\t\tlet c = this.time * l.settings.drawFPS;\r\n\t\t\ti.setTempVehicle('HELI', c, {\r\n\t\t\t\tx: this.x,\r\n\t\t\t\ty: this.y\r\n\t\t\t}, e.dir),\r\n\t\t\tl.camera.playerFocus === i && (l.camera.focusOnPlayer(),\r\n\t\t\tl.vehicleTimer.playerAddedTime(i)),\r\n\t\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\t\tthis.sector.powerupCanvasDrawn = !1,\r\n\t\t\tthis.scene.message.show('Helicopter Powerup!', 50, '#F2902E', !1))\r\n\t\t}\r\n\t}\r\n\tdrawIcon(t, e) {\r\n\t\tt.scale(e, e),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(15, 4.5),\r\n\t\tt.lineTo(15, 2.5),\r\n\t\tt.bezierCurveTo(15, 1.4, 14.1, .5, 13, .5),\r\n\t\tt.bezierCurveTo(11.9, .5, 11, 1.4, 11, 2.5),\r\n\t\tt.lineTo(11, 4.5),\r\n\t\tt.bezierCurveTo(11, 5.6, 11.9, 6.5, 13, 6.5),\r\n\t\tt.bezierCurveTo(14.1, 6.5, 15, 5.6, 15, 4.5),\r\n\t\tt.lineTo(15, 4.5),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.beginPath(),\r\n\t\tt.lineCap = 'round',\r\n\t\tt.moveTo(1, 3),\r\n\t\tt.lineTo(25, 3),\r\n\t\tt.stroke(),\r\n\t\tt.lineCap = 'butt',\r\n\t\tt.lineWidth = 1,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(6.1, 26.9),\r\n\t\tt.lineTo(4.1, 31.9),\r\n\t\tt.bezierCurveTo(3.8, 32.7, 4.2, 33.6, 4.9, 33.9),\r\n\t\tt.bezierCurveTo(5.7, 34.2, 6.6, 33.8, 6.9, 33),\r\n\t\tt.lineTo(8.9, 28),\r\n\t\tt.bezierCurveTo(9.2, 27.3, 8.8, 26.4, 8, 26.1),\r\n\t\tt.bezierCurveTo(7.3, 25.8, 6.4, 26.1, 6.1, 26.9),\r\n\t\tt.lineTo(6.1, 26.9),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(17, 28),\r\n\t\tt.lineTo(19, 33),\r\n\t\tt.bezierCurveTo(19.4, 33.8, 20.3, 34.2, 21, 33.9),\r\n\t\tt.bezierCurveTo(21.8, 33.6, 22.2, 32.7, 21.9, 31.9),\r\n\t\tt.lineTo(19.9, 26.9),\r\n\t\tt.bezierCurveTo(19.6, 26.2, 18.7, 25.8, 17.9, 26.1),\r\n\t\tt.bezierCurveTo(17.2, 26.4, 16.8, 27.3, 17.1, 28),\r\n\t\tt.lineTo(17, 28),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke();\r\n\t\tlet i = t.fillStyle;\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.lineWidth = 2,\r\n\t\tt.beginPath(),\r\n\t\tt.arc(13, 17, 11, 0, 2 * Math.PI, !0),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.fillStyle = i,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(21, 17),\r\n\t\tt.bezierCurveTo(21, 12.6, 17.4, 9, 13, 9),\r\n\t\tt.bezierCurveTo(8.6, 9, 5, 12.6, 5, 17),\r\n\t\tt.lineTo(21, 17),\r\n\t\tt.closePath(),\r\n\t\tt.fill()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.lineCap = 'butt',\r\n\t\tt.lineJoin = 'miter',\r\n\t\tt.lineWidth = 2,\r\n\t\tt.miterLimit = 4,\r\n\t\tt.strokeStyle = i;\r\n\t\tt.fillStyle = i\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 26,\r\n\t\theight: 35\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/vehiclepowerups/helicopter.js?");

/***/ }),

/***/ "./src/game/class/sector/vehiclepowerups/truck.js":
/*!********************************************************!*\
  !*** ./src/game/class/sector/vehiclepowerups/truck.js ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../vehiclepowerup.js */ \"./src/game/class/sector/vehiclepowerup.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehiclepowerup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = '#94d44e';\r\n\tindex = 2;\r\n\tname = 'truck';\r\n\tcollide(t) {\r\n\t\tlet e = t.parent\r\n\t\t  , i = e.player\r\n\t\t  , s = t.pos.x - this.x\r\n\t\t  , n = t.pos.y - this.y\r\n\t\t  , r = Math.sqrt(Math.pow(s, 2) + Math.pow(n, 2))\r\n\t\t  , h = i._powerupsConsumed.misc\r\n\t\t  , l = this.scene;\r\n\t\tif (30 > r && i.isAlive() && -1 === h.indexOf(this.id)) {\r\n\t\t\th.push(this.id);\r\n\t\t\tlet c = this.time * l.settings.drawFPS;\r\n\t\t\ti.setTempVehicle(this.name.toUpperCase(), c, {\r\n\t\t\t\tx: this.x,\r\n\t\t\t\ty: this.y\r\n\t\t\t}, e.dir),\r\n\t\t\tl.camera.playerFocus === i && (l.camera.focusOnPlayer(),\r\n\t\t\tl.vehicleTimer.playerAddedTime(i)),\r\n\t\t\ti.isGhost() === !1 && (this.hit = !0,\r\n\t\t\tthis.sector.powerupCanvasDrawn = !1,\r\n\t\t\tthis.scene.message.show(\"Truck Powerup!\", 50, this.color, !1))\r\n\t\t}\r\n\t}\r\n\tdrawIcon(t, e) {\r\n\t\tt.scale(e, e),\r\n\t\tt.save(),\r\n\t\tt.beginPath(),\r\n\t\tt.roundRect(1, 16.5, 6, 10.5, 1.5),\r\n\t\tt.roundRect(18, 16.5, 6, 10.5, 1.5),\r\n\t\tt.fill(),\r\n\t\tt.moveTo(4, 22),\r\n\t\tt.lineTo(21, 22),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(23, 10),\r\n\t\tt.bezierCurveTo(23.5, 10.5, 24, 11, 24, 12),\r\n\t\tt.lineTo(24, 18),\r\n\t\tt.bezierCurveTo(23.5, 19, 23.5, 20, 21, 20),\r\n\t\tt.lineTo(3, 20),\r\n\t\tt.bezierCurveTo(2.5, 20, 1.5, 19.5, 1, 18.5),\r\n\t\tt.lineTo(1, 12),\r\n\t\tt.bezierCurveTo(1, 11, 1.5, 10.5, 2, 10),\r\n\t\tt.lineTo(2, 4),\r\n\t\tt.bezierCurveTo(2, 2, 3, 1, 4, 1),\r\n\t\tt.lineTo(21, 1),\r\n\t\tt.bezierCurveTo(22, 1, 23, 2, 23, 3),\r\n\t\tt.closePath();\r\n\t\tlet i = t.fillStyle;\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.fill(),\r\n\t\tt.fillStyle = i,\r\n\t\tt.stroke(),\r\n\t\tt.restore(),\r\n\t\tt.beginPath(),\r\n\t\tt.rect(5.5, 5, 14, 6),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.arc(5.5, 15, 1.895, 0, 2 * Math.PI, !0),\r\n\t\tt.arc(19.5, 15, 1.895, 0, 2 * Math.PI, !0),\r\n\t\tt.fill()\r\n\t}\r\n\tupdateCache(t, e) {\r\n\t\tsuper.updateCache(t, e);\r\n\t\tlet i = this.outline;\r\n\t\t/^(dark(er)?|midnight)$/i.test(lite.storage.get('theme')) && (i = this.settings.physicsLineColor),\r\n\t\tt.fillStyle = i,\r\n\t\tt.strokeStyle = i,\r\n\t\tt.lineWidth = 2\r\n\t}\r\n\tstatic cache = this.createCache({\r\n\t\twidth: 25,\r\n\t\theight: 28\r\n\t})\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/sector/vehiclepowerups/truck.js?");

/***/ }),

/***/ "./src/game/class/tools/basepoweruptool.js":
/*!*************************************************!*\
  !*** ./src/game/class/tools/basepoweruptool.js ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ BasePowerupTool)\n/* harmony export */ });\n/* harmony import */ var _tool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tool.js */ \"./src/game/class/tools/tool.js\");\n\r\n\r\nclass BasePowerupTool extends _tool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = '';\r\n\tpowerupTools = {};\r\n\tregisterTool(t) {\r\n\t\tthis.powerupTools[this.toolhandler.constructor.parseToolName(t.name)] = t\r\n\t}\r\n\tsetOption(t, e) {\r\n\t\tthis.options[t] = e\r\n\t}\r\n\tpress() {\r\n\t\tlet t = this.options.selected;\r\n\t\tthis.powerupTools[t].press()\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.options.selected;\r\n\t\tthis.powerupTools[t].hold()\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.options.selected;\r\n\t\tthis.powerupTools[t].release()\r\n\t}\r\n\tdraw(t) {\r\n\t\tsuper.draw(t),\r\n\t\tthis.powerupTools[this.options.selected].draw(t)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/basepoweruptool.js?");

/***/ }),

/***/ "./src/game/class/tools/brushtool.js":
/*!*******************************************!*\
  !*** ./src/game/class/tools/brushtool.js ***!
  \*******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Brush)\n/* harmony export */ });\n/* harmony import */ var _straightlinetool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./straightlinetool.js */ \"./src/game/class/tools/straightlinetool.js\");\n\r\n\r\nclass Brush extends _straightlinetool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'brush';\r\n\tconstructor(t) {\r\n\t\tsuper(t);\r\n\t\tlet e = t.scene.settings.brush;\r\n\t\tthis.addedObjects = [],\r\n\t\tthis.options = {\r\n\t\t\tbreakLength: e.breakLength,\r\n\t\t\tmaxBreakLength: e.maxBreakLength,\r\n\t\t\tminBreakLength: e.minBreakLength,\r\n\t\t\tbreakLengthSensitivity: e.breakLengthSensitivity,\r\n\t\t\ttrailSpeed: e.trailSpeed,\r\n\t\t\tmaxTrailSpeed: e.maxTrailSpeed,\r\n\t\t\tminTrailSpeed: e.minTrailSpeed,\r\n\t\t\ttrailSpeedSensitivity: e.trailSpeedSensitivity\r\n\t\t}\r\n\t}\r\n\treset() {\r\n\t\tthis.recordActionsToToolhandler(),\r\n\t\tsuper.reset()\r\n\t}\r\n\trecordActionsToToolhandler() {\r\n\t\tvar t, e = this.addedObjects, i = e.length;\r\n\t\tif (i)\r\n\t\t\tfor (t = 0; i > t; t++)\r\n\t\t\t\tthis.toolhandler.addActionToTimeline({\r\n\t\t\t\t\ttype: \"add\",\r\n\t\t\t\t\tobjects: [e[t]]\r\n\t\t\t\t});\r\n\t\tthis.addedObjects = []\r\n\t}\r\n\tpress() {\r\n\t\tthis.recordActionsToToolhandler(),\r\n\t\tsuper.press();\r\n\t\tif (!this.active) {\r\n\t\t\tlet t = this.mouse.touch.real;\r\n\t\t\tthis.p2.x = t.x,\r\n\t\t\tthis.p2.y = t.y\r\n\t\t}\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.mouse.touch.real\r\n\t\t  , e = this.p1\r\n\t\t  , i = this.p2\r\n\t\t  , s = this.options.trailSpeed\r\n\t\t  , n = this.options.breakLength;\r\n\t\ti.inc(t.sub(i).factor(s));\r\n\t\tlet r = screen.height + t.sub(i).len();\r\n\t\tif (r *= n,\r\n\t\ti.sub(e).lenSqr() > r) {\r\n\t\t\tlet o = this.scene.track,\r\n\t\t\t\ta = !1;\r\n\t\t\ta = o['add' + ('physics' === this.toolhandler.options.lineType ? 'Physics' : 'Scenery') + 'Line'](e.x, e.y, i.x, i.y),\r\n\t\t\ta && this.addedObjects.push(a),\r\n\t\t\te.equ(i),\r\n\t\t\tthis.toolhandler.snapPoint.x = i.x,\r\n\t\t\tthis.toolhandler.snapPoint.y = i.y\r\n\t\t}\r\n\t\tthis.toolhandler.moveCameraTowardsMouse()\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.p1\r\n\t\t  , e = this.p2\r\n\t\t  , i = this.scene.track\r\n\t\t  , s = !1;\r\n\t\ts = i['add' + ('physics' === this.toolhandler.options.lineType ? 'Physics' : 'Scenery') + 'Line'](t.x, t.y, e.x, e.y),\r\n\t\ts && this.addedObjects.push(s),\r\n\t\tthis.recordActionsToToolhandler();\r\n\t\tlet n = this.toolhandler\r\n\t\t  , r = n.snapPoint;\r\n\t\tr.x = e.x,\r\n\t\tr.y = e.y,\r\n\t\tthis.active = !1\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.toolhandler\r\n\t\t  , e = t.gamepad\r\n\t\t  , i = this.mouse;\r\n\t\te.isButtonDown(\"alt\") ? i.mousewheel !== !1 && this.adjustTrailSpeed(i.mousewheel) : e.isButtonDown(\"shift\") && i.mousewheel !== !1 && this.adjustBreakLength(i.mousewheel);\r\n\t\tsuper.update();\r\n\t\tt.options.snap && (this.p2 = i.touch.real)\r\n\t}\r\n\tadjustTrailSpeed(t) {\r\n\t\tlet e = this.options.trailSpeed\r\n\t\t  , i = this.options.trailSpeedSensitivity\r\n\t\t  , s = this.options.maxTrailSpeed\r\n\t\t  , n = this.options.minTrailSpeed;\r\n\t\tt > 0 ? (e += i,\r\n\t\te > s && (e = s)) : (e -= i,\r\n\t\tn > e && (e = n)),\r\n\t\tthis.setOption(\"trailSpeed\", e)\r\n\t}\r\n\tadjustBreakLength(t) {\r\n\t\tlet e = this.options.breakLength\r\n\t\t  , i = this.options.breakLengthSensitivity\r\n\t\t  , s = this.options.maxBreakLength\r\n\t\t  , n = this.options.minBreakLength;\r\n\t\tt > 0 ? (e += i,\r\n\t\te > s && (e = s)) : (e -= i,\r\n\t\tn > e && (e = n)),\r\n\t\tthis.setOption(\"breakLength\", e)\r\n\t}\r\n\tsetOption(t, e) {\r\n\t\tthis.options[t] = e\r\n\t}\r\n\tdrawText(t) {\r\n\t\tlet e = this.name\r\n\t\t  , i = this.options.breakLength\r\n\t\t  , s = this.options.trailSpeed\r\n\t\t  , n = this.game.pixelRatio;\r\n\t\tt.fillStyle = this.scene.settings.physicsLineColor,\r\n\t\tt.font = 12 * n + \"pt arial\",\r\n\t\tt.fillText(e, 10 * n, 20 * n),\r\n\t\tt.font = 8 * n + \"pt arial\",\r\n\t\ts = 0 | s,\r\n\t\tt.fillText(\"Trail speed : \" + s, 10 * n, 40 * n),\r\n\t\tt.fillText(\"Break length : \" + i, 10 * n, 60 * n)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/brushtool.js?");

/***/ }),

/***/ "./src/game/class/tools/cameratool.js":
/*!********************************************!*\
  !*** ./src/game/class/tools/cameratool.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Camera)\n/* harmony export */ });\n/* harmony import */ var _tool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tool.js */ \"./src/game/class/tools/tool.js\");\n\r\n\r\nclass Camera extends _tool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'camera';\r\n\thold() {\r\n\t\tlet t = this.mouse.touch\r\n\t\t  , e = t.pos\r\n\t\t  , i = this.camera\r\n\t\t  , s = t.old.pos.sub(e).factor(1 / i.zoom);\r\n\t\ti.position.inc(s)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/cameratool.js?");

/***/ }),

/***/ "./src/game/class/tools/curvetool.js":
/*!*******************************************!*\
  !*** ./src/game/class/tools/curvetool.js ***!
  \*******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Curve)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _math_curvedivision_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/curvedivision.js */ \"./src/game/class/math/curvedivision.js\");\n/* harmony import */ var _straightlinetool_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./straightlinetool.js */ \"./src/game/class/tools/straightlinetool.js\");\n\r\n\r\n\r\n\r\nclass Curve extends _straightlinetool_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"] {\r\n\tname = 'curve';\r\n\tmidpoint = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n\tanchoring = !1;\r\n\tcontrolPoints = [];\r\n\toptions = {\r\n\t\tbreakLength: .2,\r\n\t\tbreakLengthSensitivity: .1,\r\n\t\tcontrolPoints: 1,\r\n\t\tmaxBreakLength: 3,\r\n\t\tminBreakLength: .02\r\n\t};\r\n\tgetControlPoints(limit) {\r\n\t\tlet controlPoints = Array.from(this.controlPoints);\r\n\t\tcontrolPoints.length < this.options.controlPoints && controlPoints.push(...Array.from({ length: limit ?? (this.options.controlPoints - controlPoints.length) }, () => this.midpoint.factor(1)));\r\n\t\treturn controlPoints\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.mouse.touch.real;\r\n\t\tthis.p2.x = t.x,\r\n\t\tthis.p2.y = t.y;\r\n\t\tlet e = this.p1\r\n\t\t  , i = this.p2;\r\n\t\tthis.midpoint.x = (e.x + i.x) / 2,\r\n\t\tthis.midpoint.y = (e.y + i.y) / 2,\r\n\t\tthis.toolhandler.moveCameraTowardsMouse()\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.p1\r\n\t\t  , e = this.p2\r\n\t\t  , i = this.midpoint;\r\n\t\tif (this.anchoring) {\r\n\t\t\t// also check if the midpoint is on the line -- straight line\r\n\t\t\tif (i.x === e.x && i.y === e.y) {\r\n\t\t\t\tsuper.release()\r\n\t\t\t} else if (this.options.controlPoints > this.controlPoints.length + 1) {\r\n\t\t\t\tthis.controlPoints.push(this.midpoint.factor(1));\r\n\t\t\t\treturn;\r\n\t\t\t} else\r\n\t\t\t\tthis.splitAndAddCurve();\r\n\t\t\tthis.reset()\r\n\t\t} else {\r\n\t\t\tlet h = e.x - t.x\r\n\t\t\t  , l = e.y - t.y\r\n\t\t\t  , c = Math.sqrt(h ** 2 + l ** 2);\r\n\t\t\tc > 0 ? this.anchoring = !0 : this.active = !1\r\n\t\t}\r\n\t}\r\n\treset() {\r\n\t\tsuper.reset(),\r\n\t\tthis.anchoring = !1,\r\n\t\tthis.controlPoints.splice(0)\r\n\t}\r\n\tupdateAnchor() {\r\n\t\tlet t = this.mouse.touch.real;\r\n\t\tthis.midpoint.x = t.x,\r\n\t\tthis.midpoint.y = t.y;\r\n\t\tif (window.hasOwnProperty('lite') && lite.storage.get('preciseEditorTools')) {\r\n\t\t\tif (this.options.controlPoints > 1) {\r\n\t\t\t\t// let last = this.controlPoints.at(-1) || this.p1;\r\n\t\t\t\t// last = this.p1.add(last).factor(1 / 2);\r\n\t\t\t\t// let midpoint = last.add(this.p2).factor(1 / 2);\r\n\t\t\t\t// this.midpoint.inc(this.midpoint.sub(midpoint))\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet midpoint = this.p1.add(this.p2).factor(1 / 2);\r\n\t\t\tthis.midpoint.inc(this.midpoint.sub(midpoint))\r\n\t\t}\r\n\t}\r\n\tsplitAndAddCurve() {\r\n\t\tfor (var t = (0,_math_curvedivision_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.p1, ...this.getControlPoints(), this.p2, this.getOptions()), e = this.scene.track, i = t.length, n = this.toolhandler, r = [], o = 0; i - 2 > o; o += 2) {\r\n\t\t\tlet a = t[o]\r\n\t\t\t  , h = t[o + 1]\r\n\t\t\t  , l = t[o + 2]\r\n\t\t\t  , c = t[o + 3]\r\n\t\t\t  , u = e['add' + ('physics' === n.options.lineType ? 'Physics' : 'Scenery') + 'Line'](a, h, l, c);\r\n\t\t\tu && r.push(u),\r\n\t\t\tn.snapPoint.x = l,\r\n\t\t\tn.snapPoint.y = c\r\n\t\t}\r\n\t\tr.length > 0 && n.addActionToTimeline({\r\n\t\t\ttype: 'add',\r\n\t\t\tobjects: r\r\n\t\t})\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.mouse\r\n\t\t  , e = t.touch\r\n\t\t  , i = t.secondaryTouch\r\n\t\t  , s = this.toolhandler.gamepad\r\n\t\t  , n = this.toolhandler;\r\n\t\tn.options.snap && (this.active = !0,\r\n\t\tthis.p1 = n.snapPoint,\r\n\t\tthis.anchoring || this.hold());\r\n\t\tvar r = this.toolhandler.options\r\n\t\t  , o = s.isButtonDown(\"shift\");\r\n\t\tr.rightClickMove && (o = i.old.down),\r\n\t\to ? (e.old.down || r.rightClickMove) && this.moveCamera() : (e.press && !this.anchoring && this.press(),\r\n\t\te.old.down && !this.anchoring && this.hold(),\r\n\t\te.release && this.release(),\r\n\t\tthis.anchoring && this.updateAnchor()),\r\n\t\tt.mousewheel !== !1 && (s.isButtonDown(\"shift\") === !1 ? this.mousewheel(t.mousewheel) : this.adjustBreakLength(t.mousewheel))\r\n\t}\r\n\tdrawPoint(t, e, i) {\r\n\t\tlet s = e.toScreen(this.scene)\r\n\t\t  , n = this.getControlPoints(1).concat(this.p2);\r\n\t\tn.unshift(this.p1);\r\n\t\tlet a = n.reduce((sum, point, i) => sum += point.delta(n[(i < 1 ? n.length : i) - 1]), 0) / n.length;\r\n\t\tt.beginPath(),\r\n\t\tt.arc(s.x, s.y, 1 * i, 0, 2 * Math.PI, !1),\r\n\t\tt.lineWidth = 1,\r\n\t\tt.fillStyle = a < 2 ? '#cc4444' : '#1884cf',\r\n\t\tt.fill()\r\n\t}\r\n\tdrawLine(t, e) {\r\n\t\tlet n = this.toolhandler\r\n\t\t  , r = n.options.lineType\r\n\t\t  , p = this.getControlPoints(1).concat(this.p2);\r\n\t\tp.unshift(this.p1);\r\n\t\tlet q = p.reduce((sum, point, i) => sum += point.delta(p[(i < 1 ? p.length : i) - 1]), 0) / p.length;\r\n\t\tt.beginPath(),\r\n\t\tt.lineWidth = Math.max(.5, 2 * e),\r\n\t\tt.lineCap = 'round',\r\n\t\tt.strokeStyle = q < 2 ? '#cc4444' : this.scene.settings[r + 'LineColor'];\r\n\t\tlet a = this.p1.toScreen(this.scene)\r\n\t\t  , h = this.p2.toScreen(this.scene)\r\n\t\t  , l = this.midpoint.toScreen(this.scene);\r\n\t\tt.moveTo(a.x, a.y);\r\n\t\tif (this.options.controlPoints > 1) {\r\n\t\t\tlet q = (0,_math_curvedivision_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(a, ...this.getControlPoints().map(t => t.toScreen(this.scene)), h, this.getOptions());\r\n\t\t\tfor (let i = 0; i < q.length; i += 2) {\r\n\t\t\t\tt.lineTo(Math.floor(q[i]), Math.floor(q[i + 1]));\r\n\t\t\t}\r\n\t\t} else\r\n\t\t\tt.quadraticCurveTo(l.x, l.y, h.x, h.y);\r\n\t\t// for (let i = 0; i < q.length; i += 2) {\r\n\t\t// \tt.lineTo(Math.floor(q[i]), Math.floor(q[i + 1]));\r\n\t\t// }\r\n\t\tt.stroke()\r\n\t}\r\n\tadjustBreakLength(t) {\r\n\t\tlet e = this.options.breakLength\r\n\t\t  , i = this.options.breakLengthSensitivity\r\n\t\t  , s = this.options.maxBreakLength\r\n\t\t  , n = this.options.minBreakLength;\r\n\t\tt > 0 ? (e += i,\r\n\t\te > s && (e = s)) : (e -= i,\r\n\t\tn > e && (e = n)),\r\n\t\tthis.setOption(\"breakLength\", e)\r\n\t}\r\n\tsetOption(t, e) {\r\n\t\tthis.options[t] = e\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/curvetool.js?");

/***/ }),

/***/ "./src/game/class/tools/erasertool.js":
/*!********************************************!*\
  !*** ./src/game/class/tools/erasertool.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Eraser)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _tool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tool.js */ \"./src/game/class/tools/tool.js\");\n\r\n\r\n\r\nclass Eraser extends _tool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\terasedObjects = [];\r\n\teraserPoint = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n\tname = 'eraser';\r\n\toptions = null;\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.options = t.scene.settings.eraser\r\n\t}\r\n\treset() {\r\n\t\tthis.recordActionsToToolhandler()\r\n\t}\r\n\tpress() {\r\n\t\tthis.recordActionsToToolhandler()\r\n\t}\r\n\trecordActionsToToolhandler() {\r\n\t\tthis.erasedObjects.length > 0 && this.toolhandler.addActionToTimeline({\r\n\t\t\ttype: \"remove\",\r\n\t\t\tobjects: this.erasedObjects.flat()\r\n\t\t}),\r\n\t\tthis.erasedObjects = []\r\n\t}\r\n\trelease() {\r\n\t\tthis.recordActionsToToolhandler()\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.mouse.touch\r\n\t\t  , e = t.pos\r\n\t\t  , i = this.scene.track\r\n\t\t  , s = this.scene.screen\r\n\t\t  , n = this.scene.camera\r\n\t\t  , o = s.center\r\n\t\t  , a = n.position\r\n\t\t  , h = (e.x - o.x) / n.zoom + a.x\r\n\t\t  , l = (e.y - o.y) / n.zoom + a.y;\r\n\t\tthis.eraserPoint.x = Math.round(h),\r\n\t\tthis.eraserPoint.y = Math.round(l);\r\n\t\tlet c = i.erase(this.eraserPoint, this.options.radius / this.scene.camera.zoom, this.options.types);\r\n\t\tc.length > 0 && this.erasedObjects.push(c)\r\n\t}\r\n\tdraw(e) {\r\n\t\tsuper.draw(e),\r\n\t\tthis.drawEraser(e)\r\n\t}\r\n\tdrawEraser(t) {\r\n\t\tlet e = this.mouse.touch\r\n\t\t  , i = e.pos\r\n\t\t  , colorScheme = window.lite && lite.storage.get('theme');\r\n\t\tt.save();\r\n\t\tt.beginPath(),\r\n\t\tt.arc(i.x, i.y, this.options.radius, 0, 2 * Math.PI, !1),\r\n\t\tt.lineWidth = 1,\r\n\t\tt.fillStyle = /^midnight$/i.test(colorScheme) ? \"rgba(29,35,40,0.8)\" : /^dark$/i.test(colorScheme) ? \"rgba(33,33,33,0.8)\" : \"rgba(255,255,255,0.8)\",\r\n\t\tt.fill(),\r\n\t\tt.strokeStyle = this.scene.settings.physicsLineColor,\r\n\t\tt.stroke(),\r\n\t\tt.restore()\r\n\t}\r\n\tsetOption(t, e) {\r\n\t\tthis.options[t] = e\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.toolhandler.gamepad\r\n\t\t  , e = this.mouse;\r\n\t\tt.isButtonDown(\"shift\") && e.mousewheel !== !1 && this.adjustRadius(e.mousewheel),\r\n\t\tsuper.update();\r\n\t}\r\n\tadjustRadius(t) {\r\n\t\tlet e = this.options.radius\r\n\t\t  , i = this.options.radiusSizeSensitivity\r\n\t\t  , s = this.options.maxRadius\r\n\t\t  , n = this.options.minRadius\r\n\t\t  , r = t > 0 ? i : -i;\r\n\t\te += r,\r\n\t\tthis.setOption(\"radius\", Math.min(s, Math.max(n, e)))\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/erasertool.js?");

/***/ }),

/***/ "./src/game/class/tools/pathtracertool.js":
/*!************************************************!*\
  !*** ./src/game/class/tools/pathtracertool.js ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ PathTracer)\n/* harmony export */ });\n/* harmony import */ var _tool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tool.js */ \"./src/game/class/tools/tool.js\");\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n\r\nclass PathTracer extends _tool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tactive = !1;\r\n\tname = 'pathtracer';\r\n\tp1 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n\tp2 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n\tpath = [];\r\n\tpoints = [];\r\n\treset() {\r\n\t\tthis.active = !1\r\n\t}\r\n\tpress() {\r\n\t\tsuper.press();\r\n\t\tif (!this.active) {\r\n\t\t\tlet t = this.mouse.touch.real;\r\n\t\t\tthis.p1.x = t.x,\r\n\t\t\tthis.p1.y = t.y,\r\n\t\t\tthis.p2.x = t.x,\r\n\t\t\tthis.p2.y = t.y\r\n\t\t}\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.mouse.touch.real\r\n\t\t  , e = this.p1\r\n\t\t  , i = this.p2;\r\n\t\ti.inc(t.sub(i));\r\n\t\tlet r = screen.height + t.sub(i).len();\r\n\t\tif (i.sub(e).len() > 4) {\r\n\t\t\tthis.points.push(i.factor(1)),\r\n\t\t\te.equ(i),\r\n\t\t\tthis.toolhandler.snapPoint.x = i.x,\r\n\t\t\tthis.toolhandler.snapPoint.y = i.y\r\n\t\t}\r\n\t\tthis.toolhandler.moveCameraTowardsMouse()\r\n\t}\r\n\trelease() {\r\n\t\tlet e = this.p2;\r\n\t\tlet n = this.toolhandler\r\n\t\t  , r = n.snapPoint;\r\n\t\tr.x = e.x,\r\n\t\tr.y = e.y,\r\n\t\tthis.active = !1\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.toolhandler\r\n\t\t  , e = this.mouse;\r\n\t\tsuper.update();\r\n\t\tt.options.snap && (this.p2 = e.touch.real)\r\n\t}\r\n\tdraw(e) {\r\n\t\tsuper.draw(e);\r\n\t\tlet t = this.scene\r\n\t\t  , i = t.camera\r\n\t\t  , s = i.zoom;\r\n\t\te.save(),\r\n\t\tthis.drawCursor(e),\r\n\t\tthis.active && (this.drawLine(e, s),\r\n\t\tthis.drawPoint(e, this.p1, s),\r\n\t\tthis.drawPoint(e, this.p2, s)),\r\n\t\te.restore()\r\n\t}\r\n\tdrawCursor(t) {\r\n\t\tlet e = this.mouse.touch\r\n\t\t  , i = e.real.toScreen(this.scene)\r\n\t\t  , s = this.camera.zoom\r\n\t\t  , n = this.toolhandler\r\n\t\t  , r = n.options.grid\r\n\t\t  , o = \"#1884cf\";\r\n\t\tt.beginPath();\r\n\t\tif (r) {\r\n\t\t\tlet a = 5 * s;\r\n\t\t\tt.moveTo(i.x, i.y - a),\r\n\t\t\tt.lineTo(i.x, i.y + a),\r\n\t\t\tt.moveTo(i.x - a, i.y),\r\n\t\t\tt.lineTo(i.x + a, i.y),\r\n\t\t\tt.lineWidth = 1 * s,\r\n\t\t\tt.stroke()\r\n\t\t} else\r\n\t\t\tt.arc(i.x, i.y, 1 * s, 0, 2 * Math.PI, !1),\r\n\t\t\tt.lineWidth = 1,\r\n\t\t\tt.fillStyle = o,\r\n\t\t\tt.fill()\r\n\t}\r\n\tdrawPoint(t, e, i) {\r\n\t\tlet s = e.toScreen(this.scene);\r\n\t\tt.beginPath(),\r\n\t\tt.arc(s.x, s.y, 1 * i, 0, 2 * Math.PI, !1),\r\n\t\tt.lineWidth = 1,\r\n\t\tt.fillStyle = '#1884cf',\r\n\t\tt.fill()\r\n\t}\r\n\tdrawLine(t, e) {\r\n\t\tlet i = this.p1.toScreen(this.scene)\r\n\t\t  , s = this.p2.toScreen(this.scene);\r\n\t\tt.beginPath(),\r\n\t\tt.lineWidth = Math.max(0.5, 2 * e),\r\n\t\tt.lineCap = 'round',\r\n\t\tt.strokeStyle = \"#1884cf80\",\r\n\t\tt.moveTo(i.x, i.y);\r\n\t\tfor (let n of this.points.map(r => r.toScreen(this.scene))) {\r\n\t\t\tt.lineTo(n.x, n.y);\r\n\t\t}\r\n\t\tt.lineTo(s.x, s.y),\r\n\t\tt.stroke()\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/pathtracertool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptool.js":
/*!*********************************************!*\
  !*** ./src/game/class/tools/poweruptool.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Powerup)\n/* harmony export */ });\n/* harmony import */ var _basepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./basepoweruptool.js */ \"./src/game/class/tools/basepoweruptool.js\");\n/* harmony import */ var _poweruptools_antigravitytool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./poweruptools/antigravitytool.js */ \"./src/game/class/tools/poweruptools/antigravitytool.js\");\n/* harmony import */ var _poweruptools_bombtool_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./poweruptools/bombtool.js */ \"./src/game/class/tools/poweruptools/bombtool.js\");\n/* harmony import */ var _poweruptools_boosttool_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./poweruptools/boosttool.js */ \"./src/game/class/tools/poweruptools/boosttool.js\");\n/* harmony import */ var _poweruptools_checkpointtool_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./poweruptools/checkpointtool.js */ \"./src/game/class/tools/poweruptools/checkpointtool.js\");\n/* harmony import */ var _poweruptools_goaltool_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./poweruptools/goaltool.js */ \"./src/game/class/tools/poweruptools/goaltool.js\");\n/* harmony import */ var _poweruptools_gravitytool_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./poweruptools/gravitytool.js */ \"./src/game/class/tools/poweruptools/gravitytool.js\");\n/* harmony import */ var _poweruptools_slowmotool_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./poweruptools/slowmotool.js */ \"./src/game/class/tools/poweruptools/slowmotool.js\");\n/* harmony import */ var _poweruptools_teleporttool_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./poweruptools/teleporttool.js */ \"./src/game/class/tools/poweruptools/teleporttool.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Powerup extends _basepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'powerup';\r\n\toptions = { selected: \"goal\" };\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.registerPowerupTools()\r\n\t}\r\n\tregisterPowerupTools() {\r\n\t\tthis.registerTool(new _poweruptools_goaltool_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](this.toolhandler)),\r\n\t\tthis.registerTool(new _poweruptools_boosttool_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this.toolhandler)),\r\n\t\tthis.registerTool(new _poweruptools_gravitytool_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"](this.toolhandler)),\r\n\t\tthis.registerTool(new _poweruptools_slowmotool_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"](this.toolhandler)),\r\n\t\tthis.registerTool(new _poweruptools_bombtool_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.toolhandler)),\r\n\t\tthis.registerTool(new _poweruptools_checkpointtool_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this.toolhandler)),\r\n\t\tthis.registerTool(new _poweruptools_antigravitytool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.toolhandler)),\r\n\t\tthis.registerTool(new _poweruptools_teleporttool_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"](this.toolhandler))\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.toolhandler.gamepad\r\n\t\t  , e = this.options;\r\n\t\tt.isButtonDown(\"opt1\") && (e.selected = \"goal\",\r\n\t\tt.setButtonUp(\"opt1\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tt.isButtonDown(\"opt2\") && (e.selected = \"boost\",\r\n\t\tt.setButtonUp(\"opt2\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tt.isButtonDown(\"opt3\") && (e.selected = \"gravity\",\r\n\t\tt.setButtonUp(\"opt3\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tt.isButtonDown(\"opt4\") && (e.selected = \"slowmo\",\r\n\t\tt.setButtonUp(\"opt4\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tt.isButtonDown(\"opt5\") && (e.selected = \"bomb\",\r\n\t\tt.setButtonUp(\"opt5\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tt.isButtonDown(\"opt6\") && (e.selected = \"checkpoint\",\r\n\t\tt.setButtonUp(\"opt6\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tt.isButtonDown(\"opt7\") && (e.selected = \"antigravity\",\r\n\t\tt.setButtonUp(\"opt7\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tt.isButtonDown(\"opt8\") && Application.User.get(\"classic\") && (e.selected = \"teleport\",\r\n\t\tt.setButtonUp(\"opt8\"),\r\n\t\tthis.scene.updateState()),\r\n\t\tsuper.update();\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/antigravitytool.js":
/*!**************************************************************!*\
  !*** ./src/game/class/tools/poweruptools/antigravitytool.js ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Antigravity)\n/* harmony export */ });\n/* harmony import */ var _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n/* harmony import */ var _sector_powerups_antigravity_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/powerups/antigravity.js */ \"./src/game/class/sector/powerups/antigravity.js\");\n\r\n\r\n\r\nclass Antigravity extends _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'antigravity';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.powerup = new _sector_powerups_antigravity_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, t.scene.track)\r\n\t}\r\n\tpress() {\r\n\t\tlet t = this.mouse.touch\r\n\t\t  , e = t.real;\r\n\t\tthis.p1.x = e.x,\r\n\t\tthis.p1.y = e.y;\r\n\t\tlet i = this.scene.track\r\n\t\t  , s = new this.powerup.constructor(this.p1.x,this.p1.y,i);\r\n\t\ti.addPowerup(s),\r\n\t\tthis.toolhandler.addActionToTimeline({\r\n\t\t\ttype: \"add\",\r\n\t\t\tobjects: [s]\r\n\t\t})\r\n\t}\r\n\trelease() {}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/antigravitytool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/bombtool.js":
/*!*******************************************************!*\
  !*** ./src/game/class/tools/poweruptools/bombtool.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Bomb)\n/* harmony export */ });\n/* harmony import */ var _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n/* harmony import */ var _sector_powerups_bomb_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/powerups/bomb.js */ \"./src/game/class/sector/powerups/bomb.js\");\n\r\n\r\n\r\nclass Bomb extends _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'bomb';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.powerup = new _sector_powerups_bomb_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, t.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/bombtool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/boosttool.js":
/*!********************************************************!*\
  !*** ./src/game/class/tools/poweruptools/boosttool.js ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Boost)\n/* harmony export */ });\n/* harmony import */ var _directionalpoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./directionalpoweruptool.js */ \"./src/game/class/tools/poweruptools/directionalpoweruptool.js\");\n/* harmony import */ var _sector_powerups_boost_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/powerups/boost.js */ \"./src/game/class/sector/powerups/boost.js\");\n\r\n\r\n\r\nclass Boost extends _directionalpoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = 'rgba(173, 207, 125,0.2)';\r\n\tname = 'boost';\r\n\toutline = '#ADCF7D';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.powerup = new _sector_powerups_boost_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, 0, t.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/boosttool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/checkpointtool.js":
/*!*************************************************************!*\
  !*** ./src/game/class/tools/poweruptools/checkpointtool.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Checkpoint)\n/* harmony export */ });\n/* harmony import */ var _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n/* harmony import */ var _sector_powerups_checkpoint_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/powerups/checkpoint.js */ \"./src/game/class/sector/powerups/checkpoint.js\");\n\r\n\r\n\r\nclass Checkpoint extends _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'checkpoint';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.powerup = new _sector_powerups_checkpoint_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, t.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/checkpointtool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/directionalpoweruptool.js":
/*!*********************************************************************!*\
  !*** ./src/game/class/tools/poweruptools/directionalpoweruptool.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Boost)\n/* harmony export */ });\n/* harmony import */ var _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n\r\nclass Boost extends _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = null;\r\n\tp2 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n\tpress() {\r\n\t\tsuper.press(),\r\n\t\tthis.p2.x = this.p1.x,\r\n\t\tthis.p2.y = this.p1.y\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.mouse.touch\r\n\t\t  , e = t.real;\r\n\t\tthis.p2.x = e.x,\r\n\t\tthis.p2.y = e.y\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.scene.track\r\n\t\t  , e = new this.powerup.constructor(this.p1.x,this.p1.y,this.powerup.angle - (90 + this.powerup.constructor.angleOffset),t);\r\n\t\tt.addPowerup(e),\r\n\t\tthis.active = !1,\r\n\t\tthis.toolhandler.addActionToTimeline({\r\n\t\t\ttype: \"add\",\r\n\t\t\tobjects: [e]\r\n\t\t})\r\n\t}\r\n\tdraw(t) {\r\n\t\tlet e = this.mouse.touch\r\n\t\t  , i = this.camera.zoom\r\n\t\t  , s = this.scene.screen\r\n\t\t  , n = this.scene.settings.device;\r\n\t\tif (this.active === !0) {\r\n\t\t\tlet a = s.realToScreen(this.p1.x, \"x\")\r\n\t\t\t  , h = s.realToScreen(this.p1.y, \"y\")\r\n\t\t\t  , l = this.p1\r\n\t\t\t  , c = this.p2\r\n\t\t\t  , u = l.y - c.y\r\n\t\t\t  , p = l.x - c.x\r\n\t\t\t  , d = Math.atan2(l.y - c.y, l.x - c.x);\r\n\t\t\t0 === p && 0 === u && (d = Math.PI - Math.PI / 2),\r\n\t\t\t0 > d && (d += 2 * Math.PI),\r\n\t\t\tthis.drawPathToMouse(t, d),\r\n\t\t\tthis.powerup.angle = d * (180 / Math.PI) + this.powerup.constructor.angleOffset | 0,\r\n\t\t\tthis.powerup.draw(a, h, i, t)\r\n\t\t} else if (\"desktop\" === n) {\r\n\t\t\tt.globalAlpha = .8,\r\n\t\t\tthis.powerup.angle = 90 + this.powerup.constructor.angleOffset;\r\n\t\t\tlet a = s.realToScreen(e.real.x, \"x\")\r\n\t\t\t  , h = s.realToScreen(e.real.y, \"y\");\r\n\t\t\tthis.powerup.draw(a, h, i, t),\r\n\t\t\tt.globalAlpha = 1\r\n\t\t}\r\n\t}\r\n\tdrawPathToMouse(t, e) {\r\n\t\tlet i = this.p1\r\n\t\t  , s = this.p2\r\n\t\t  , n = this.scene.screen\r\n\t\t  , o = this.scene.camera.zoom\r\n\t\t  , u = n.realToScreen(i.x, \"x\")\r\n\t\t  , p = n.realToScreen(i.y, \"y\")\r\n\t\t  , d = n.realToScreen(s.x, \"x\")\r\n\t\t  , f = n.realToScreen(s.y, \"y\")\r\n\t\t  , v = Math.sqrt((d - u) ** 2 + (f - p) ** 2);\r\n\t\t30 * o > v && (v = 30 * o),\r\n\t\tt.strokeStyle = this.outline,\r\n\t\tt.lineWidth = Math.max(1, 2 * o),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(u + v, p),\r\n\t\tt.lineTo(u, p),\r\n\t\tt.lineTo(d, f),\r\n\t\tt.stroke();\r\n\t\tlet g = e + 180 * (Math.PI / 180)\r\n\t\t  , m = Math.min(v, 50 * o);\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(u, p),\r\n\t\tt.arc(u, p, m, g, 0, !1),\r\n\t\tt.stroke(),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.fill()\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/directionalpoweruptool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/goaltool.js":
/*!*******************************************************!*\
  !*** ./src/game/class/tools/poweruptools/goaltool.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Goal)\n/* harmony export */ });\n/* harmony import */ var _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n/* harmony import */ var _sector_powerups_target_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/powerups/target.js */ \"./src/game/class/sector/powerups/target.js\");\n\r\n\r\n\r\nclass Goal extends _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'goal';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.powerup = new _sector_powerups_target_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, t.scene.track)\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.scene.track\r\n\t\t  , e = new this.powerup.constructor(this.p1.x,this.p1.y,t);\r\n\t\tt.addTarget(e),\r\n\t\tt.addPowerup(e),\r\n\t\tthis.active = !1,\r\n\t\tthis.toolhandler.addActionToTimeline({\r\n\t\t\ttype: \"add\",\r\n\t\t\tobjects: [e]\r\n\t\t})\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/goaltool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/gravitytool.js":
/*!**********************************************************!*\
  !*** ./src/game/class/tools/poweruptools/gravitytool.js ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Gravity)\n/* harmony export */ });\n/* harmony import */ var _directionalpoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./directionalpoweruptool.js */ \"./src/game/class/tools/poweruptools/directionalpoweruptool.js\");\n/* harmony import */ var _sector_powerups_gravity_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/powerups/gravity.js */ \"./src/game/class/sector/powerups/gravity.js\");\n\r\n\r\n\r\nclass Gravity extends _directionalpoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tcolor = 'rgba(162, 183, 210,0.2)';\r\n\tname = 'gravity';\r\n\toutline = '#A2B7D2';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.powerup = new _sector_powerups_gravity_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, 0, t.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/gravitytool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/poweruptool.js":
/*!**********************************************************!*\
  !*** ./src/game/class/tools/poweruptools/poweruptool.js ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ BasePowerupTool)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _tool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../tool.js */ \"./src/game/class/tools/tool.js\");\n\r\n\r\n\r\nclass BasePowerupTool extends _tool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\tactive = !1;\r\n\tp1 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n\tpowerup = null;\r\n\tdraw(t) {\r\n\t\tlet e = this.mouse.touch\r\n\t\t  , i = this.camera.zoom\r\n\t\t  , s = this.scene.settings.device\r\n\t\t  , n = this.scene.screen;\r\n\t\tif (this.active === !0) {\r\n\t\t\tlet r = n.realToScreen(this.p1.x, \"x\")\r\n\t\t\t  , o = n.realToScreen(this.p1.y, \"y\");\r\n\t\t\tt.globalAlpha = .4,\r\n\t\t\tthis.powerup.draw(r, o, i, t),\r\n\t\t\tt.globalAlpha = 1\r\n\t\t} else if (\"desktop\" === s) {\r\n\t\t\tlet r = n.realToScreen(e.real.x, \"x\")\r\n\t\t\t  , o = n.realToScreen(e.real.y, \"y\");\r\n\t\t\tt.globalAlpha = .8,\r\n\t\t\tthis.powerup.draw(r, o, i, t),\r\n\t\t\tt.globalAlpha = 1\r\n\t\t}\r\n\t}\r\n\tpress() {\r\n\t\tlet t = this.mouse.touch\r\n\t\t  , e = t.real;\r\n\t\tthis.p1.x = e.x,\r\n\t\tthis.p1.y = e.y,\r\n\t\tthis.active = !0\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.scene.track\r\n\t\t  , e = new this.powerup.constructor(this.p1.x,this.p1.y,t);\r\n\t\tt.addPowerup(e),\r\n\t\tthis.active = !1,\r\n\t\tthis.toolhandler.addActionToTimeline({\r\n\t\t\ttype: \"add\",\r\n\t\t\tobjects: [e]\r\n\t\t})\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/poweruptool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/slowmotool.js":
/*!*********************************************************!*\
  !*** ./src/game/class/tools/poweruptools/slowmotool.js ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Slowmo)\n/* harmony export */ });\n/* harmony import */ var _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n/* harmony import */ var _sector_powerups_slowmo_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/powerups/slowmo.js */ \"./src/game/class/sector/powerups/slowmo.js\");\n\r\n\r\n\r\nclass Slowmo extends _poweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'slowmo';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.powerup = new _sector_powerups_slowmo_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, t.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/slowmotool.js?");

/***/ }),

/***/ "./src/game/class/tools/poweruptools/teleporttool.js":
/*!***********************************************************!*\
  !*** ./src/game/class/tools/poweruptools/teleporttool.js ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Teleport)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _poweruptool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n/* harmony import */ var _sector_powerups_teleport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sector/powerups/teleport.js */ \"./src/game/class/sector/powerups/teleport.js\");\n\r\n\r\n\r\n\r\nclass Teleport extends _poweruptool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\tname = 'teleport';\r\n\tp2 = null;\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.p2 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0),\r\n\t\tthis.powerup = new _sector_powerups_teleport_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](0, 0, t.scene.track)\r\n\t}\r\n\tpress() {\r\n\t\tsuper.press(),\r\n\t\tthis.portal1 = new this.powerup.constructor(this.p1.x,this.p1.y,this.scene.track)\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.mouse.touch\r\n\t\t  , e = t.real;\r\n\t\tthis.p2.x = e.x,\r\n\t\tthis.p2.y = e.y\r\n\t}\r\n\trelease() {\r\n\t\tlet t = Math.abs(this.p2.x - this.p1.x)\r\n\t\t  , e = Math.abs(this.p2.y - this.p1.y);\r\n\t\tif (t > 40 || e > 40) {\r\n\t\t\tlet i = this.scene.track;\r\n\t\t\tthis.portal2 = new this.powerup.constructor(this.p2.x,this.p2.y,i),\r\n\t\t\tthis.portal1.addOtherPortalRef(this.portal2),\r\n\t\t\tthis.portal2.addOtherPortalRef(this.portal1),\r\n\t\t\ti.addPowerup(this.portal1),\r\n\t\t\ti.addPowerup(this.portal2),\r\n\t\t\tthis.toolhandler.addActionToTimeline({\r\n\t\t\t\ttype: \"add\",\r\n\t\t\t\tobjects: [this.portal1, this.portal2]\r\n\t\t\t})\r\n\t\t} else\r\n\t\t\tthis.portal1 = null;\r\n\t\tthis.active = !1\r\n\t}\r\n\tdraw(t) {\r\n\t\tlet e = this.mouse.touch\r\n\t\t  , i = this.camera.zoom\r\n\t\t  , s = this.scene.screen\r\n\t\t  , n = this.scene.settings.device;\r\n\t\tif (this.active === !0) {\r\n\t\t\tlet a = s.realToScreen(this.p1.x, \"x\")\r\n\t\t\t  , h = s.realToScreen(this.p1.y, \"y\")\r\n\t\t\t  , l = s.realToScreen(this.p2.x, \"x\")\r\n\t\t\t  , c = s.realToScreen(this.p2.y, \"y\")\r\n\t\t\t  , u = this.p1\r\n\t\t\t  , p = this.p2\r\n\t\t\t  , d = u.y - p.y\r\n\t\t\t  , f = u.x - p.x\r\n\t\t\t  , v = Math.atan2(u.y - p.y, u.x - p.x);\r\n\t\t\t0 === f && 0 === d && (v = Math.PI - Math.PI / 2),\r\n\t\t\t0 > v && (v += 2 * Math.PI),\r\n\t\t\tthis.drawPathToMouse(t, v),\r\n\t\t\tthis.portal1.draw(a, h, i, t),\r\n\t\t\tthis.powerup.draw(l, c, i, t)\r\n\t\t} else if (\"desktop\" === n) {\r\n\t\t\tt.globalAlpha = .8;\r\n\t\t\tlet g = s.realToScreen(e.real.x, \"x\")\r\n\t\t\t  , m = s.realToScreen(e.real.y, \"y\");\r\n\t\t\tthis.powerup.draw(g, m, i, t),\r\n\t\t\tt.globalAlpha = 1\r\n\t\t}\r\n\t}\r\n\tdrawPathToMouse(t) {\r\n\t\tlet e = this.p1\r\n\t\t  , i = this.p2\r\n\t\t  , s = this.scene.screen\r\n\t\t  , n = this.scene.camera.zoom\r\n\t\t  , r = s.realToScreen(e.x, \"x\")\r\n\t\t  , o = s.realToScreen(e.y, \"y\")\r\n\t\t  , c = s.realToScreen(i.x, \"x\")\r\n\t\t  , u = s.realToScreen(i.y, \"y\")\r\n\t\t  , p = Math.sqrt(Math.pow(c - r, 2) + Math.pow(u - o, 2));\r\n\t\t30 * n > p && (p = 30 * n),\r\n\t\tt.strokeStyle = \"#dd45ec\", // render red if not long enough\r\n\t\tt.lineWidth = Math.max(1, 2 * n),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(r, o),\r\n\t\tt.lineTo(c, u),\r\n\t\tt.stroke(),\r\n\t\tt.closePath()\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/poweruptools/teleporttool.js?");

/***/ }),

/***/ "./src/game/class/tools/selecttool.js":
/*!********************************************!*\
  !*** ./src/game/class/tools/selecttool.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Select)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _tool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tool.js */ \"./src/game/class/tools/tool.js\");\n/* harmony import */ var _utils_path_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/path.js */ \"./src/game/class/utils/path.js\");\n\r\n\r\n\r\n\r\nclass Select extends _tool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\tname = 'select';\r\n\tpassive = !1;\r\n\tactive = !1;\r\n\tdashOffset = 0;\r\n\tp1 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n\tp2 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n\ttravelDistance = 5;\r\n\taddedObjects = [];\r\n\tselectedElements = [];\r\n\tselectedSegments = [];\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tdocument.addEventListener('keydown', this.keyPress.bind(this))\r\n\t}\r\n\tpress() {\r\n\t\t// if there is a selection, move it\r\n\t\tif (this.selectedElements.length > 0 && this.passive) return;\r\n\t\tlet t = this.mouse.touch.real;\r\n\t\tthis.passive = !1,\r\n\t\tthis.active = !0,\r\n\t\tthis.p1.x = t.x,\r\n\t\tthis.p1.y = t.y,\r\n\t\tthis.p2.x = t.x,\r\n\t\tthis.p2.y = t.y\r\n\t}\r\n\thold() {\r\n\t\tif (this.passive) {\r\n\t\t\tthis.moveSelected(this.mouse.touch.real.sub(this.mouse.touch.old.real));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet t = this.mouse.touch.real;\r\n\t\tthis.p2.x = t.x,\r\n\t\tthis.p2.y = t.y\r\n\t}\r\n\tunselectElements() {\r\n\t\tfor (let t of this.selectedElements) {\r\n\t\t\tt.highlight = false;\r\n\t\t}\r\n\t\tthis.selectedElements = [],\r\n\t\tthis.selectedSegments = []\r\n\t}\r\n\tmoveSelected(t) {\r\n\t\tthis.p1.inc(t),\r\n\t\tthis.p2.inc(t);\r\n\t\tfor (let e in this.selectedSegments) {\r\n\t\t\tif (this.selectedSegments.find(i => i.otherPortal == e)) {\r\n\t\t\t\tthis.selectedSegments.splice(e, 1);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tthis.selectedSegments[e].move(t.x, t.y);\r\n\t\t\tthis.scene.track.undraw()\r\n\t\t}\r\n\t}\r\n\tfillSelected() {\r\n\t\tlet min = Math.min(this.p1.y, this.p2.y)\r\n\t\t  , max = Math.max(this.p1.y, this.p2.y);\r\n\t\tfor (let y = min; y < max; y++) {\r\n\t\t\tthis.selectedSegments.push(this.scene.track.addPhysicsLine(this.p1.x, y, this.p2.x, y));\r\n\t\t}\r\n\t\tthis.selectedElements.push(...this.selectedSegments);\r\n\t\tthis.selectedSegments.length > 0 && this.toolhandler.addActionToTimeline({\r\n\t\t\ttype: \"add\",\r\n\t\t\tobjects: this.selectedSegments.flat()\r\n\t\t});\r\n\t}\r\n\trotateSelected() {\r\n\t\tlet x = (this.travelDistance || 0) * Math.PI / 180;\r\n\t\tlet selectedSegments = this.selectedSegments;\r\n\t\tthis.selectedSegments = [];\r\n\t\tfor (let i of selectedSegments.filter(t => t.constructor.type == 'physics' || t.constructor.type == 'scenery')) {\r\n\t\t\tthis.selectedSegments.push(this.scene.track[i.constructor.type == \"physics\" ? \"addPhysicsLine\" : \"addSceneryLine\"](Math.cos(x) * i.p1.x + Math.sin(x) * i.p1.y, -Math.sin(x) * i.p1.x + Math.cos(x) * i.p1.y, Math.cos(x) * i.p2.x + Math.sin(x) * i.p2.y, -Math.sin(x) * i.p2.x + Math.cos(x) * i.p2.y));\r\n\t\t\ti.removeAllReferences();\r\n\t\t}\r\n\t}\r\n\tcopyAndPasteSelected() {\r\n\t\tfor (let i of this.selectedSegments.filter(i => i.constructor.type == 'physics' || i.constructor.type == 'scenery'))\r\n\t\t\tthis.scene.track['add' + (i.constructor.type == 'physics' ? 'Physics' : 'Scenery') + 'Line'](i.p1.x, i.p1.y, i.p2.x, i.p2.y)\r\n\t}\r\n\trelease() {\r\n\t\tthis.unselectElements();\r\n\t\tif (this.passive) {\r\n\t\t\tthis.active = !1;\r\n\t\t\tthis.passive = !1;\r\n\t\t\tthis._reset && (this.toolhandler.setTool(this.toolhandler.previousTool),\r\n\t\t\tthis._reset = !1)\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (let t of this.scene.track.select(this.p1, this.p2))\r\n\t\t\tthis.intersectsLine(t.x ? t : t.p1, t.x ? t : t.p2) && this.selectedSegments.push(t)\r\n\t\tthis.selectedElements = this.selectedSegments,\r\n\t\tthis.active = !1,\r\n\t\tthis.passive = !0,\r\n\t\tthis.toolhandler.currentTool !== this.name && (this.toolhandler.setTool(this.name),\r\n\t\tthis._reset = !0)\r\n\t\t// when action is completed, set currentTool to previousTool\r\n\t}\r\n\tkeyPress(e) {\r\n\t\tif (!this.passive) return;\r\n\t\te.preventDefault();\r\n\t\tswitch(e.key) {\r\n\t\tcase \"=\":\r\n\t\tcase \"+\":\r\n\t\t\tthis.travelDistance++;\r\n\t\t\tthis.scene.message.show(\"Increased travel distance for the Select Tool - \" + this.travelDistance, !1, \"#000\", \"#FFF\");\r\n\t\t\tbreak;\r\n\t\tcase \"-\":\r\n\t\t\tthis.travelDistance--;\r\n\t\t\tthis.scene.message.show(\"Decreased travel distance for the Select Tool - \" + this.travelDistance, !1, \"#000\", \"#FFF\");\r\n\t\t\tbreak;\r\n\t\tcase \"c\":\r\n\t\t\tthis.copyAndPasteSelected(e.key),\r\n\t\t\tthis.scene.message.show(\"Copied selected area\", !1, \"#000000\", \"#FFFFFF\");\r\n\t\t\tbreak;\r\n\t\tcase \"Delete\":\r\n\t\t\tthis.selectedElements.length > 0 && this.toolhandler.addActionToTimeline({\r\n\t\t\t\ttype: \"remove\",\r\n\t\t\t\tobjects: this.selectedElements.flatMap(t => t)\r\n\t\t\t});\r\n\t\t\tfor (const t of this.selectedElements) {\r\n\t\t\t\tt.removeAllReferences()\r\n\t\t\t}\r\n\t\t\tthis.reset();\r\n\t\t\tthis.scene.message.show(\"Deleted selected area\", !1, \"#000\", \"#FFF\");\r\n\t\t\tbreak;\r\n\t\tcase \"f\":\r\n\t\t\tif (confirm(\"Are you sure you would you like to fill the selected area?\"))\r\n\t\t\t\tthis.fillSelected(),\r\n\t\t\t\tthis.scene.message.show(\"Filled selected area\", !1, \"#000\", \"#FFF\");\r\n\t\t\tbreak;\r\n\t\tcase \"r\":\r\n\t\t\tthis.rotateSelected(),\r\n\t\t\tthis.scene.message.show(\"Rotated selected area\", !1, \"#000\", \"#FFF\");\r\n\t\t\tbreak;\r\n\t\tcase \"`\":\r\n\t\tcase \"Escape\":\r\n\t\t\tthis.reset()\r\n\t\t}\r\n\t\tthis.timeout = setTimeout(() => this.scene.message.hide(), 1e3)\r\n\t}\r\n\tbuildPaths(t) {\r\n\t\tfor (let e = []; t.length > 0; ) {\r\n\t\t\tlet i = new _utils_path_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"];\r\n\t\t\ti.build(t),\r\n\t\t\te.push(i)\r\n\t\t}\r\n\t}\r\n\tintersectsLine(t, e) {\r\n\t\tlet i = Math.min(this.p1.y, this.p2.y)\r\n\t\t  , s = Math.min(this.p1.x, this.p2.x)\r\n\t\t  , n = Math.max(this.p1.y, this.p2.y)\r\n\t\t  , r = Math.max(this.p1.x, this.p2.x)\r\n\t\t  , o = Math.abs(r - s)\r\n\t\t  , c = Math.abs(i - n)\r\n\t\t  , u = t.x\r\n\t\t  , p = e.x;\r\n\t\tif (t.x > e.x && (u = e.x,\r\n\t\tp = t.x),\r\n\t\tp > s + o && (p = s + o),\r\n\t\ts > u && (u = s),\r\n\t\tu > p)\r\n\t\t\treturn !1;\r\n\t\tlet d = t.y\r\n\t\t  , f = e.y\r\n\t\t  , v = e.x - t.x;\r\n\t\tif (Math.abs(v) > 1e-7) {\r\n\t\t\tlet g = (e.y - t.y) / v\r\n\t\t\t  , m = t.y - g * t.x;\r\n\t\t\td = g * u + m,\r\n\t\t\tf = g * p + m\r\n\t\t}\r\n\t\td > f && ([f, d] = [d, f]);\r\n\t\treturn f > i + c && (f = i + c),\r\n\t\ti > d && (d = i),\r\n\t\td > f ? !1 : !0\r\n\t}\r\n\ttoScreen(t, e) {\r\n\t\tlet i = this.scene.camera\r\n\t\t  , s = this.scene.screen;\r\n\t\treturn (t - i.position[e]) * i.zoom + s.center[e]\r\n\t}\r\n\tdraw(e) {\r\n\t\tlet t = this.scene;\r\n\t\tif (this.active || this.passive) {\r\n\t\t\tlet i = this.p1.toScreen(t)\r\n\t\t\t, s = this.p2.toScreen(t)\r\n\t\t\t, n = s.x - i.x\r\n\t\t\t, r = s.y - i.y;\r\n\t\t\te.save(),\r\n\t\t\tthis.active ? (e.beginPath(),\r\n\t\t\te.rect(i.x, i.y, n, r),\r\n\t\t\te.fillStyle = \"rgba(24, 132, 207, 0.2)\",\r\n\t\t\te.fill(),\r\n\t\t\te.lineWidth = 2,\r\n\t\t\te.strokeStyle = \"rgba(24, 132, 207, 0.7)\",\r\n\t\t\te.stroke()) : this.passive && (e.strokeStyle = \"rgba(24, 132, 207, 0.7)\",\r\n\t\t\te.lineWidth = 2,\r\n\t\t\te.strokeRect(i.x, i.y, n, r)),\r\n\t\t\te.restore()\r\n\t\t}\r\n\t}\r\n\treset() {\r\n\t\tthis.p1.x = 0,\r\n\t\tthis.p1.y = 0,\r\n\t\tthis.p2.x = 0,\r\n\t\tthis.p2.y = 0,\r\n\t\tthis.active = !1,\r\n\t\tthis.passive = !1,\r\n\t\tthis.unselectElements()\r\n\t}\r\n\tclose() {\r\n\t\tsuper.close(),\r\n\t\tthis.dashOffset = 0,\r\n\t\tthis.selectedElements = null,\r\n\t\tthis.p2 = null,\r\n\t\tthis.p1 = null,\r\n\t\tthis.active = !1,\r\n\t\tthis.passive = !1\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/selecttool.js?");

/***/ }),

/***/ "./src/game/class/tools/straightlinetool.js":
/*!**************************************************!*\
  !*** ./src/game/class/tools/straightlinetool.js ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ StraightLine)\n/* harmony export */ });\n/* harmony import */ var _tool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tool.js */ \"./src/game/class/tools/tool.js\");\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n\r\nclass StraightLine extends _tool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tactive = !1;\r\n\tname = 'straightline';\r\n\toptions = {};\r\n\tp1 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n\tp2 = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n\tshouldDrawMetadata = !1;\r\n\treset() {\r\n\t\tthis.active = !1\r\n\t}\r\n\tpress() {\r\n\t\tif (!this.active) {\r\n\t\t\tlet t = this.mouse.touch.real;\r\n\t\t\tthis.p1.x = t.x,\r\n\t\t\tthis.p1.y = t.y,\r\n\t\t\tthis.active = !0\r\n\t\t}\r\n\t}\r\n\tgetOptions() {\r\n\t\tlet t = this.toolhandler\r\n\t\t  , e = this.options;\r\n\t\treturn e.lineType = t.options.lineType,\r\n\t\te.snap = t.options.snap,\r\n\t\te\r\n\t}\r\n\thold() {\r\n\t\tlet t = this.mouse.touch.real;\r\n\t\tthis.p2.x = t.x,\r\n\t\tthis.p2.y = t.y,\r\n\t\tthis.toolhandler.moveCameraTowardsMouse()\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.p1\r\n\t\t  , e = this.p2\r\n\t\t  , i = this.scene.track\r\n\t\t  , s = this.toolhandler\r\n\t\t  , n = !1;\r\n\t\tn = i['add' + (\"physics\" === s.options.lineType ? 'Physics' : 'Scenery') + 'Line'](t.x, t.y, e.x, e.y),\r\n\t\tn && s.addActionToTimeline({\r\n\t\t\ttype: \"add\",\r\n\t\t\tobjects: [n]\r\n\t\t});\r\n\t\tlet r = s.snapPoint;\r\n\t\tr.x = e.x,\r\n\t\tr.y = e.y,\r\n\t\tthis.reset()\r\n\t}\r\n\tupdate() {\r\n\t\tsuper.update();\r\n\t\tlet t = this.toolhandler\r\n\t\t  , e = t.gamepad;\r\n\t\tt.options.snap && (this.active = !0,\r\n\t\tthis.p1 = t.snapPoint,\r\n\t\tthis.hold()),\r\n\t\tthis.shouldDrawMetadata = e.isButtonDown(\"ctrl\")\r\n\t}\r\n\tdraw(e) {\r\n\t\tsuper.draw(e);\r\n\t\tlet t = this.scene\r\n\t\t  , i = t.camera\r\n\t\t  , s = i.zoom;\r\n\t\te.save(),\r\n\t\tthis.drawCursor(e),\r\n\t\tthis.active && (this.drawLine(e, s),\r\n\t\tthis.drawPoint(e, this.p1, s),\r\n\t\tthis.drawPoint(e, this.p2, s),\r\n\t\tthis.shouldDrawMetadata && this.drawPointData(e, this.p2, s)),\r\n\t\te.restore()\r\n\t}\r\n\tdrawCursor(t) {\r\n\t\tlet e = this.mouse.touch\r\n\t\t  , i = e.real.toScreen(this.scene)\r\n\t\t  , s = this.camera.zoom\r\n\t\t  , n = this.toolhandler\r\n\t\t  , r = n.options.grid\r\n\t\t  , o = \"#1884cf\";\r\n\t\tt.beginPath();\r\n\t\tif (r) {\r\n\t\t\tlet a = 5 * s;\r\n\t\t\tt.moveTo(i.x, i.y - a),\r\n\t\t\tt.lineTo(i.x, i.y + a),\r\n\t\t\tt.moveTo(i.x - a, i.y),\r\n\t\t\tt.lineTo(i.x + a, i.y),\r\n\t\t\tt.lineWidth = 1 * s,\r\n\t\t\tt.stroke()\r\n\t\t} else\r\n\t\t\tt.arc(i.x, i.y, 1 * s, 0, 2 * Math.PI, !1),\r\n\t\t\tt.lineWidth = 1,\r\n\t\t\tt.fillStyle = o,\r\n\t\t\tt.fill()\r\n\t}\r\n\tdrawPoint(t, e, i) {\r\n\t\tlet s = e.toScreen(this.scene)\r\n\t\t  , n = this.p2.delta(this.p1);\r\n\t\tt.beginPath(),\r\n\t\tt.arc(s.x, s.y, 1 * i, 0, 2 * Math.PI, !1),\r\n\t\tt.lineWidth = 1,\r\n\t\tt.fillStyle = n < 2 ? '#cc4444' : '#1884cf',\r\n\t\tt.fill()\r\n\t}\r\n\tdrawPointData(t, e) {\r\n\t\tlet i = e.toScreen(this.scene)\r\n\t\t  , s = this.p1.getAngleInDegrees(this.p2).toFixed(2)\r\n\t\t  , n = this.game.pixelRatio;\r\n\t\tt.fillStyle = this.scene.settings.physicsLineColor,\r\n\t\tt.strokeStyle = this.scene.settings.physicsLineColor,\r\n\t\tt.font = 8 * n + \"pt arial\",\r\n\t\tt.fillText(s + \"°\", i.x + 10, i.y + 10),\r\n\t\tt.strokeText(s + \"°\", i.x + 10, i.y + 10)\r\n\t}\r\n\tdrawLine(t, e) {\r\n\t\tlet n = this.toolhandler\r\n\t\t  , r = n.options.lineType\r\n\t\t  , a = this.p1.toScreen(this.scene)\r\n\t\t  , h = this.p2.toScreen(this.scene)\r\n\t\t  , q = this.p2.delta(this.p1);\r\n\t\tt.beginPath(),\r\n\t\tt.lineWidth = Math.max(0.5, 2 * e),\r\n\t\tt.lineCap = 'round',\r\n\t\tt.strokeStyle = q < 2 ? '#cc4444' : this.scene.settings[r + 'LineColor'],\r\n\t\tt.moveTo(a.x, a.y),\r\n\t\tt.lineTo(h.x, h.y),\r\n\t\tt.stroke()\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/straightlinetool.js?");

/***/ }),

/***/ "./src/game/class/tools/tool.js":
/*!**************************************!*\
  !*** ./src/game/class/tools/tool.js ***!
  \**************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Tool)\n/* harmony export */ });\nclass Tool {\r\n\ttoolhandler = null;\r\n\tcamera = null;\r\n\tmouse = null;\r\n\tname = '';\r\n\tscene = null;\r\n\tconstructor(t) {\r\n\t\tthis.toolhandler = t,\r\n\t\tthis.scene = t.scene,\r\n\t\tthis.game = t.scene.game,\r\n\t\tthis.camera = t.scene.camera,\r\n\t\tthis.mouse = t.scene.mouse,\r\n\t\tthis.gamepad = t.gamepad\r\n\t}\r\n\tcheckKeys() {\r\n\t\tlet t = this.gamepad\r\n\t\t  , e = this.toolhandler.constructor.parseToolName(this.constructor.name)\r\n\t\t  , i = this.toolhandler;\r\n\t\tt.isButtonDown(e) && (i.setTool(e),\r\n\t\tt.setButtonUp(e))\r\n\t}\r\n\tdraw(t) {\r\n\t\tlet e = this.toolhandler\r\n\t\t  , i = e.gamepad\r\n\t\t  , s = e.tools\r\n\t\t  , n = s.select;\r\n\t\t  n && (i.isButtonDown(\"ctrl\") || n.selectedElements.length > 0) && n.draw(t)\r\n\t}\r\n\tgetOptions() {\r\n\t\treturn this.options || {}\r\n\t}\r\n\tpress() { }\r\n\thold() { }\r\n\trelease() { }\r\n\treset() { }\r\n\tupdate() {\r\n\t\tlet t = this.mouse\r\n\t\t  , e = t.touch\r\n\t\t  , i = t.secondaryTouch\r\n\t\t  , s = this.toolhandler.gamepad\r\n\t\t  , n = this.toolhandler.options\r\n\t\t  , r = s.isButtonDown(\"shift\")\r\n\t\t  , g = s.isButtonDown(\"ctrl\");\r\n\t\tn.rightClickMove && (r = i.old.down),\r\n\t\tr ? (e.old.down || n.rightClickMove) && this.moveCamera() : (!this.toolhandler.tools[this.toolhandler.currentTool].active && g) ? this.selectArea(e) : (e.press && this.press(),\r\n\t\te.old.down && this.hold(),\r\n\t\te.release && this.release()),\r\n\t\tt.mousewheel !== !1 && r === !1 && this.mousewheel(t.mousewheel)\r\n\t}\r\n\tmoveCamera() {\r\n\t\treturn this.toolhandler.tools.camera.hold()\r\n\t}\r\n\tmousewheel(t) {\r\n\t\tlet e = this.scene.settings\r\n\t\t  , i = this.scene.game.pixelRatio\r\n\t\t  , s = e.cameraSensitivity\r\n\t\t  , n = e.cameraZoomMin\r\n\t\t  , r = e.cameraZoomMax\r\n\t\t  , o = n * i\r\n\t\t  , a = r * i\r\n\t\t  , h = this.camera\r\n\t\t  , l = this.mouse.touch\r\n\t\t  , c = h.desiredZoom;\r\n\t\tc += t * s,\r\n\t\th.setZoom(c / i, l.pos),\r\n\t\th.desiredZoom < o ? h.setZoom(n, l.pos) : h.desiredZoom > a && h.setZoom(r, l.pos)\r\n\t}\r\n\tselectArea(t) {\r\n\t\tlet e = this.toolhandler\r\n\t\t  , i = e.tools\r\n\t\t  , s = i.select;\r\n\t\ts && (t.press && s.press(),\r\n\t\tt.old.down && s.hold(),\r\n\t\tt.release && s.release())\r\n\t}\r\n\tclose() {\r\n\t\tthis.camera = null,\r\n\t\tthis.mouse = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.toolhandler = null\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/tool.js?");

/***/ }),

/***/ "./src/game/class/tools/toolhandler.js":
/*!*********************************************!*\
  !*** ./src/game/class/tools/toolhandler.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _sector_physicsline_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sector/physicsline.js */ \"./src/game/class/sector/physicsline.js\");\n/* harmony import */ var _sector_sceneryline_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sector/sceneryline.js */ \"./src/game/class/sector/sceneryline.js\");\n/* harmony import */ var _sector_powerups_target_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sector/powerups/target.js */ \"./src/game/class/sector/powerups/target.js\");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tcurrentTool = \"\";\r\n\tscene = null;\r\n\tcamera = null;\r\n\tmouse = null;\r\n\ttools = {};\r\n\tgamepad = null;\r\n\tgridCache = !1;\r\n\tgridCacheAlpha = 1;\r\n\tgridUseEnabled = !1;\r\n\tsnapPoint = !1;\r\n\tpreviousTool = \"\";\r\n\toptions = null;\r\n\tconstructor(t) {\r\n\t\tthis.scene = t;\r\n\t\tthis.camera = t.camera;\r\n\t\tthis.mouse = t.mouse;\r\n\t\tthis.mouse.updateCallback = this.draw.bind(this);\r\n\t\tthis.gamepad = t.playerManager.firstPlayer.getGamepad();\r\n\t\tthis.options = t.settings.toolHandler;\r\n\t\tthis.snapPoint = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\n\t\tthis.snapPoint.equ(this.scene.track.defaultLine.p2),\r\n\t\tt.settings.analyticsEnabled !== false && this.initAnalytics(),\r\n\t\tthis.actionTimeline = [],\r\n\t\tthis.actionTimelineMax = 50,\r\n\t\tthis.actionTimelinePointer = 0\r\n\t}\r\n\tinitAnalytics() {\r\n\t\tObject.defineProperty(this, 'analytics', {\r\n\t\t\tvalue: { actions: 0 },\r\n\t\t\twritable: true\r\n\t\t})\r\n\t}\r\n\tenableGridUse() {\r\n\t\tthis.gridUseEnabled = !0\r\n\t}\r\n\tgetToolOptions() {\r\n\t\treturn this.tools[this.currentTool].getOptions()\r\n\t}\r\n\tsetToolOption(t, e, i) {\r\n\t\t\"undefined\" != typeof i && \"undefined\" != typeof this.tools[i] ? this.tools[i].setOption(t, e) : this.tools[this.currentTool].setOption(t, e),\r\n\t\tthis.scene.updateState()\r\n\t}\r\n\tregisterTool(t) {\r\n\t\tt = new t(this);\r\n\t\tthis.tools[this.constructor.parseToolName(t.name)] = t;\r\n\t}\r\n\tsetTool(t) {\r\n\t\tt = this.constructor.parseToolName(t);\r\n\t\tthis.currentTool !== t && this.tools.hasOwnProperty(t) && (this.resetTool(),\r\n\t\tthis.previousTool = this.currentTool,\r\n\t\tthis.currentTool = t,\r\n\t\tthis.scene.updateState(),\r\n\t\tthis.scene.message.show(),\r\n\t\tthis.analytics && this.analytics.actions++)\r\n\t}\r\n\taddActionToTimeline(t) {\r\n\t\tthis.actionTimeline.length >= this.actionTimelineMax && (this.actionTimeline.splice(0, this.actionTimeline.length - this.actionTimelineMax),\r\n\t\tthis.actionTimelinePointer = this.actionTimelineMax),\r\n\t\tthis.actionTimeline.splice(this.actionTimelinePointer),\r\n\t\tthis.actionTimeline.push(t),\r\n\t\tthis.actionTimelinePointer++\r\n\t}\r\n\trevertAction() {\r\n\t\tlet t = this.actionTimelinePointer;\r\n\t\tif (t > 0) {\r\n\t\t\tlet e = this.actionTimeline[t - 1];\r\n\t\t\tswitch (t--,\r\n\t\t\te.type) {\r\n\t\t\tcase \"add\":\r\n\t\t\t\tthis.removeObjects(e.objects);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"remove\":\r\n\t\t\t\tthis.addObjects(e.objects)\r\n\t\t\t}\r\n\t\t\tthis.actionTimelinePointer = t\r\n\t\t}\r\n\t}\r\n\tapplyAction() {\r\n\t\tlet t = this.actionTimeline\r\n\t\t  , e = this.actionTimelinePointer;\r\n\t\tif (e < t.length) {\r\n\t\t\tlet i = this.actionTimeline[e];\r\n\t\t\tswitch (e++,\r\n\t\t\ti.type) {\r\n\t\t\tcase \"add\":\r\n\t\t\t\tthis.addObjects(i.objects);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"remove\":\r\n\t\t\t\tthis.removeObjects(i.objects)\r\n\t\t\t}\r\n\t\t\tthis.actionTimelinePointer = e\r\n\t\t}\r\n\t}\r\n\tremoveObjects(t) {\r\n\t\tfor (let e = 0; e < t.length; e++) {\r\n\t\t\tlet i = t[e];\r\n\t\t\ti.remove = !0,\r\n\t\t\ti.removeAllReferences()\r\n\t\t}\r\n\t\tthis.scene.track.cleanTrack()\r\n\t}\r\n\taddObjects(t) {\r\n\t\tfor (let e = t.length, i = this.scene.track, s = 0; e > s; s++) {\r\n\t\t\tlet a = t[s];\r\n\t\t\ta instanceof _sector_physicsline_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] ? (a.remove = !1,\r\n\t\t\ti.addPhysicsLineToTrack(a)) : a instanceof _sector_sceneryline_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"] ? (a.remove = !1,\r\n\t\t\ti.addSceneryLineToTrack(a)) : a instanceof _sector_powerups_target_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"] ? (a.remove = !1,\r\n\t\t\ti.addTarget(a),\r\n\t\t\ti.addPowerup(a)) : (a.remove = !1,\r\n\t\t\ti.addPowerup(a))\r\n\t\t}\r\n\t}\r\n\tresetTool() {\r\n\t\t\"\" !== this.currentTool && this.tools[this.currentTool].reset()\r\n\t}\r\n\tupdate() {\r\n\t\tthis.checkGrid(),\r\n\t\tthis.mouse.enabled && this.tools[this.currentTool].update(),\r\n\t\tthis.checkHotkeys(),\r\n\t\tthis.checkMouse(),\r\n\t\tthis.checkSnap()\r\n\t}\r\n\tcheckGrid() {\r\n\t\tlet t = this.scene.camera;\r\n\t\tt.zoom !== t.desiredZoom && (this.gridCache = !1)\r\n\t}\r\n\tcheckSnap() {\r\n\t\tthis.options.snapLocked && (this.options.snap = !0)\r\n\t}\r\n\tmoveCameraTowardsMouse() {\r\n\t\tif (this.options.cameraLocked === !1) {\r\n\t\t\tlet t = this.scene.screen\r\n\t\t\t  , e = 100\r\n\t\t\t  , i = t.height - e\r\n\t\t\t  , s = 0 + e\r\n\t\t\t  , n = t.width - e\r\n\t\t\t  , r = 0 + e\r\n\t\t\t  , o = this.options.cameraMoveSpeed\r\n\t\t\t  , a = t.center\r\n\t\t\t  , h = this.camera\r\n\t\t\t  , l = this.mouse.touch\r\n\t\t\t  , c = l.pos.x\r\n\t\t\t  , u = l.pos.y\r\n\t\t\t  , p = .8 * (c - a.x)\r\n\t\t\t  , d = u - a.y;\r\n\t\t\t(c >= n || r >= c || u >= i || s >= u) && (h.position.x += p * o * (1 / h.zoom),\r\n\t\t\th.position.y += d * o * (1 / h.zoom))\r\n\t\t}\r\n\t}\r\n\tcheckMouse() {\r\n\t\tlet t = this.mouse.touch\r\n\t\t  , e = this.mouse.secondaryTouch;\r\n\t\t(t.press || e.press) && this.press()\r\n\t}\r\n\tpress() {\r\n\t\tthis.camera.unfocus()\r\n\t}\r\n\tcheckHotkeys() {\r\n\t\tlet t = this.gamepad\r\n\t\t  , e = this.options.snap\r\n\t\t  , i = this.options.snapLocked\r\n\t\t  , s = this.options.rightClickMove\r\n\t\t  , n = t.isButtonDown(\"alt\");\r\n\t\ts && (n = t.isButtonDown(\"shift\")),\r\n\t\tn && !e ? this.toggleQuickSnap() : n || !e || i || this.toggleQuickSnap(),\r\n\t\tt.isButtonDown(\"ctrl\") && t.isButtonDown(\"z\") && (t.setButtonUp(\"z\"),\r\n\t\tthis[(t.isButtonDown(\"shift\") ? 'apply' : 'revert') + 'Action']()),\r\n\t\tt.isButtonDown(\"ctrl\") && t.isButtonDown(\"y\") && (t.setButtonUp(\"y\"),\r\n\t\tthis.applyAction());\r\n\t\tlet r = this.tools;\r\n\t\tfor (let o in r) {\r\n\t\t\tlet a = r[o];\r\n\t\t\ta.checkKeys()\r\n\t\t}\r\n\t\tthis.gridUseEnabled && t.isButtonDown(\"grid\") && (t.setButtonUp(\"grid\"),\r\n\t\tthis.toggleGrid()),\r\n\t\tt.isButtonDown(\"zoom_increase\") && (t.setButtonUp(\"zoom_increase\"),\r\n\t\tthis.scene.camera.increaseZoom()),\r\n\t\tt.isButtonDown(\"zoom_decrease\") && (t.setButtonUp(\"zoom_decrease\"),\r\n\t\tthis.scene.camera.decreaseZoom()),\r\n\t\tt.isButtonDown(\"zoom_100\") && (t.setButtonUp(\"zoom_100\"),\r\n\t\tthis.scene.camera.resetZoom()),\r\n\t\tt.isButtonDown(\"lineType\") && (t.setButtonUp(\"lineType\"),\r\n\t\tthis.toggleLineType())\r\n\t}\r\n\ttoggleLineType() {\r\n\t\tlet t = this.options.lineType;\r\n\t\tthis.options.lineType = \"physics\" === t ? \"scenery\" : \"physics\",\r\n\t\tthis.scene.updateState()\r\n\t}\r\n\ttoggleGrid() {\r\n\t\tthis.options.grid = this.scene.state.grid = !this.options.grid,\r\n\t\tthis.scene.updateState()\r\n\t}\r\n\ttoggleSnap() {\r\n\t\tthis.options.snap = !this.options.snap,\r\n\t\tthis.options.snapLocked = !this.options.snapLocked,\r\n\t\tthis.resetTool(),\r\n\t\tthis.scene.updateState()\r\n\t}\r\n\ttoggleQuickSnap() {\r\n\t\tthis.options.snapLocked || (this.options.snap = !this.options.snap,\r\n\t\tthis.resetTool(),\r\n\t\tthis.scene.updateState())\r\n\t}\r\n\ttoggleCameraLock() {\r\n\t\tthis.options.cameraLocked = !this.options.cameraLocked,\r\n\t\tthis.scene.updateState()\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tthis.mouse.enabled && this.tools[this.currentTool].draw(ctx)\r\n\t}\r\n\tdrawGrid(e) {\r\n\t\tlet t = this.scene.game.pixelRatio;\r\n\t\tthis.options.grid === !0 && this.options.visibleGrid && this.drawCachedGrid(e, t)\r\n\t}\r\n\tdrawCachedGrid(t, e) {\r\n\t\tthis.gridCache === !1 && this.cacheGrid(e);\r\n\t\tlet i = this.gridCache\r\n\t\t  , s = i.width\r\n\t\t  , n = i.height\r\n\t\t  , r = this.scene.screen\r\n\t\t  , o = r.center\r\n\t\t  , a = (o.x / s | 0) + 2\r\n\t\t  , h = (o.y / n | 0) + 2\r\n\t\t  , l = this.camera.zoom\r\n\t\t  , c = this.camera.position.x * l % s\r\n\t\t  , u = this.camera.position.y * l % n;\r\n\t\tt.globalAlpha = this.gridCacheAlpha;\r\n\t\tfor (var p = -a; a > p; p++)\r\n\t\t\tfor (var d = -h; h > d; d++) {\r\n\t\t\t\tvar f = p * s - c + o.x\r\n\t\t\t\t\t, v = d * n - u + o.y;\r\n\t\t\t\tt.drawImage(i, 0, 0, n, s, f, v, s, n)\r\n\t\t\t}\r\n\t\tt.globalAlpha = 1\r\n\t}\r\n\tcacheGrid() {\r\n\t\tif (window.lite && lite.storage.get(\"isometricGrid\"))\r\n\t\t\treturn this.cacheIsometricGrid()\r\n\t\tlet t = this.scene.camera.zoom\r\n\t\t  , e = 200 * t\r\n\t\t  , i = 200 * t\r\n\t\t  , n = this.options.gridSize\r\n\t\t  , r = n * t\r\n\t\t  , o = document.createElement(\"canvas\");\r\n\t\to.width = e,\r\n\t\to.height = i;\r\n\t\tlet a = o.getContext(\"2d\");\r\n\t\ta.strokeStyle = this.options.gridMinorLineColor,\r\n\t\ta.strokeWidth = 1 * window.devicePixelRatio,\r\n\t\ta.beginPath();\r\n\t\tlet h = null\r\n\t\t  , l = null\r\n\t\t  , c = null\r\n\t\t  , u = null;\r\n\t\tfor (h = Math.floor(e / r), l = 0; h >= l; l++)\r\n\t\t\tc = l * r,\r\n\t\t\ta.moveTo(c, 0),\r\n\t\t\ta.lineTo(c, i);\r\n\t\tfor (h = Math.floor(i / r), l = 0; h >= l; l++)\r\n\t\t\tu = l * r,\r\n\t\t\ta.moveTo(0, u),\r\n\t\t\ta.lineTo(e, u);\r\n\t\ta.stroke();\r\n\t\ta.beginPath(),\r\n\t\ta.rect(0, 0, e, i),\r\n\t\ta.lineWidth = 2 * window.devicePixelRatio,\r\n\t\ta.strokeStyle = this.options.gridMajorLineColor,\r\n\t\ta.stroke(),\r\n\t\tthis.gridCache = o,\r\n\t\tthis.gridCacheAlpha = Math.min(t + .2, 1)\r\n\t}\r\n\tcacheIsometricGrid() {\r\n\t\tlet t = this.scene.camera.zoom\r\n\t\t  , e = 200 * t\r\n\t\t  , i = 200 * t\r\n\t\t  , n = this.options.gridSize\r\n\t\t  , r = n * t\r\n\t\t  , o = document.createElement(\"canvas\");\r\n\t\to.width = e,\r\n\t\to.height = i;\r\n\t\tlet a = o.getContext(\"2d\");\r\n\t\ta.fillStyle = this.options.gridMinorLineColor;\r\n\t\tfor (let width = Math.floor(e / r), l = 0; width >= l; l++)\r\n\t\t\tfor (let height = Math.floor(i / r), b = 0; height >= b; b += .5) {\r\n\t\t\t\ta.beginPath();\r\n\t\t\t\ta.arc(2 * b * r, (l + b % 1) * r, 1 * t, 0, 2 * Math.PI)\r\n\t\t\t\ta.fill()\r\n\t\t\t}\r\n\t\tthis.gridCache = o,\r\n\t\tthis.gridCacheAlpha = Math.min(t + .2, 1)\r\n\t}\r\n\tresize() {\r\n\t\tlet t = this.scene.game.pixelRatio;\r\n\t\tthis.cacheGrid(t)\r\n\t}\r\n\tundo() {}\r\n\tredo() {}\r\n\tclose() {\r\n\t\tthis.actionTimeline = [],\r\n\t\tthis.actionTimelinePointer = 0,\r\n\t\tthis.tools = null,\r\n\t\tthis.mouse = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.camera = null,\r\n\t\tthis.options.grid = !1,\r\n\t\tthis.options = null,\r\n\t\tthis.gridCache = null\r\n\t}\r\n\r\n\tstatic parseToolName(t) {\r\n\t\t// typeof t == 'function' && (t = t.constructor.name); // does not work when minified/obfuscated\r\n\t\ttypeof t == 'object' && t != null && (t = t.name);\r\n\t\treturn t.toLowerCase().replace(/tool$/i, '')\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/toolhandler.js?");

/***/ }),

/***/ "./src/game/class/tools/vehiclepoweruptool.js":
/*!****************************************************!*\
  !*** ./src/game/class/tools/vehiclepoweruptool.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ VehiclePowerup)\n/* harmony export */ });\n/* harmony import */ var _basepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./basepoweruptool.js */ \"./src/game/class/tools/basepoweruptool.js\");\n/* harmony import */ var _vehiclepoweruptools_balloontool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./vehiclepoweruptools/balloontool.js */ \"./src/game/class/tools/vehiclepoweruptools/balloontool.js\");\n/* harmony import */ var _vehiclepoweruptools_blobtool_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./vehiclepoweruptools/blobtool.js */ \"./src/game/class/tools/vehiclepoweruptools/blobtool.js\");\n/* harmony import */ var _vehiclepoweruptools_helicoptertool_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./vehiclepoweruptools/helicoptertool.js */ \"./src/game/class/tools/vehiclepoweruptools/helicoptertool.js\");\n/* harmony import */ var _vehiclepoweruptools_trucktool_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./vehiclepoweruptools/trucktool.js */ \"./src/game/class/tools/vehiclepoweruptools/trucktool.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nclass VehiclePowerup extends _basepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'vehiclepowerup';\r\n\tconstructor(t) {\r\n\t\tsuper(t),\r\n\t\tthis.options = t.scene.settings.vehiclePowerup,\r\n\t\tthis.registerPowerupTools()\r\n\t}\r\n\tregisterPowerupTools() {\r\n\t\tthis.registerTool(new _vehiclepoweruptools_helicoptertool_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this, this.toolhandler)),\r\n\t\tthis.registerTool(new _vehiclepoweruptools_trucktool_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this, this.toolhandler)),\r\n\t\tthis.registerTool(new _vehiclepoweruptools_balloontool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this, this.toolhandler)),\r\n\t\tthis.registerTool(new _vehiclepoweruptools_blobtool_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this, this.toolhandler))\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/vehiclepoweruptool.js?");

/***/ }),

/***/ "./src/game/class/tools/vehiclepoweruptools/balloontool.js":
/*!*****************************************************************!*\
  !*** ./src/game/class/tools/vehiclepoweruptools/balloontool.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Balloon)\n/* harmony export */ });\n/* harmony import */ var _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./vehiclepoweruptool.js */ \"./src/game/class/tools/vehiclepoweruptools/vehiclepoweruptool.js\");\n/* harmony import */ var _sector_vehiclepowerups_balloon_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/vehiclepowerups/balloon.js */ \"./src/game/class/sector/vehiclepowerups/balloon.js\");\n\r\n\r\n\r\nclass Balloon extends _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'balloon';\r\n\tconstructor(t, e) {\r\n\t\tsuper(t, e),\r\n\t\tthis.powerup = new _sector_vehiclepowerups_balloon_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, 0, e.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/vehiclepoweruptools/balloontool.js?");

/***/ }),

/***/ "./src/game/class/tools/vehiclepoweruptools/blobtool.js":
/*!**************************************************************!*\
  !*** ./src/game/class/tools/vehiclepoweruptools/blobtool.js ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Blob)\n/* harmony export */ });\n/* harmony import */ var _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./vehiclepoweruptool.js */ \"./src/game/class/tools/vehiclepoweruptools/vehiclepoweruptool.js\");\n/* harmony import */ var _sector_vehiclepowerups_blob_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/vehiclepowerups/blob.js */ \"./src/game/class/sector/vehiclepowerups/blob.js\");\n\r\n\r\n\r\nclass Blob extends _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'blob';\r\n\tconstructor(t, e) {\r\n\t\tsuper(t, e),\r\n\t\tthis.powerup = new _sector_vehiclepowerups_blob_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, 0, e.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/vehiclepoweruptools/blobtool.js?");

/***/ }),

/***/ "./src/game/class/tools/vehiclepoweruptools/helicoptertool.js":
/*!********************************************************************!*\
  !*** ./src/game/class/tools/vehiclepoweruptools/helicoptertool.js ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Helicopter)\n/* harmony export */ });\n/* harmony import */ var _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./vehiclepoweruptool.js */ \"./src/game/class/tools/vehiclepoweruptools/vehiclepoweruptool.js\");\n/* harmony import */ var _sector_vehiclepowerups_helicopter_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/vehiclepowerups/helicopter.js */ \"./src/game/class/sector/vehiclepowerups/helicopter.js\");\n\r\n\r\n\r\nclass Helicopter extends _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'helicopter';\r\n\tconstructor(t, e) {\r\n\t\tsuper(t, e),\r\n\t\tthis.powerup = new _sector_vehiclepowerups_helicopter_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, 0, e.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/vehiclepoweruptools/helicoptertool.js?");

/***/ }),

/***/ "./src/game/class/tools/vehiclepoweruptools/trucktool.js":
/*!***************************************************************!*\
  !*** ./src/game/class/tools/vehiclepoweruptools/trucktool.js ***!
  \***************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Truck)\n/* harmony export */ });\n/* harmony import */ var _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./vehiclepoweruptool.js */ \"./src/game/class/tools/vehiclepoweruptools/vehiclepoweruptool.js\");\n/* harmony import */ var _sector_vehiclepowerups_truck_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sector/vehiclepowerups/truck.js */ \"./src/game/class/sector/vehiclepowerups/truck.js\");\n\r\n\r\n\r\nclass Truck extends _vehiclepoweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tname = 'truck';\r\n\tconstructor(t, e) {\r\n\t\tsuper(t, e),\r\n\t\tthis.powerup = new _sector_vehiclepowerups_truck_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](0, 0, 0, e.scene.track)\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/vehiclepoweruptools/trucktool.js?");

/***/ }),

/***/ "./src/game/class/tools/vehiclepoweruptools/vehiclepoweruptool.js":
/*!************************************************************************!*\
  !*** ./src/game/class/tools/vehiclepoweruptools/vehiclepoweruptool.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ BaseVehiclePowerupTool)\n/* harmony export */ });\n/* harmony import */ var _poweruptools_poweruptool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../poweruptools/poweruptool.js */ \"./src/game/class/tools/poweruptools/poweruptool.js\");\n\r\n\r\nclass BaseVehiclePowerupTool extends _poweruptools_poweruptool_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\toptions = null;\r\n\tconstructor(t, e) {\r\n\t\tsuper(e),\r\n\t\tthis.options = t.options\r\n\t}\r\n\trelease() {\r\n\t\tlet t = this.scene.track\r\n\t\t  , e = new this.powerup.constructor(this.p1.x,this.p1.y,this.options.time,t);\r\n\t\tt.addPowerup(e),\r\n\t\tthis.active = !1,\r\n\t\tthis.toolhandler.addActionToTimeline({\r\n\t\t\ttype: \"add\",\r\n\t\t\tobjects: [e]\r\n\t\t})\r\n\t}\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tools/vehiclepoweruptools/vehiclepoweruptool.js?");

/***/ }),

/***/ "./src/game/class/tracks/track.js":
/*!****************************************!*\
  !*** ./src/game/class/tracks/track.js ***!
  \****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_bresenham_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/bresenham.js */ \"./src/game/class/math/bresenham.js\");\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _sector_physicsline_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sector/physicsline.js */ \"./src/game/class/sector/physicsline.js\");\n/* harmony import */ var _sector_powerups_antigravity_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sector/powerups/antigravity.js */ \"./src/game/class/sector/powerups/antigravity.js\");\n/* harmony import */ var _sector_powerups_bomb_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sector/powerups/bomb.js */ \"./src/game/class/sector/powerups/bomb.js\");\n/* harmony import */ var _sector_powerups_boost_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sector/powerups/boost.js */ \"./src/game/class/sector/powerups/boost.js\");\n/* harmony import */ var _sector_powerups_checkpoint_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sector/powerups/checkpoint.js */ \"./src/game/class/sector/powerups/checkpoint.js\");\n/* harmony import */ var _sector_powerups_gravity_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sector/powerups/gravity.js */ \"./src/game/class/sector/powerups/gravity.js\");\n/* harmony import */ var _sector_powerups_slowmo_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sector/powerups/slowmo.js */ \"./src/game/class/sector/powerups/slowmo.js\");\n/* harmony import */ var _sector_powerups_target_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sector/powerups/target.js */ \"./src/game/class/sector/powerups/target.js\");\n/* harmony import */ var _sector_powerups_teleport_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sector/powerups/teleport.js */ \"./src/game/class/sector/powerups/teleport.js\");\n/* harmony import */ var _sector_sceneryline_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sector/sceneryline.js */ \"./src/game/class/sector/sceneryline.js\");\n/* harmony import */ var _sector_sector_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sector/sector.js */ \"./src/game/class/sector/sector.js\");\n/* harmony import */ var _sector_vehiclepowerups_balloon_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sector/vehiclepowerups/balloon.js */ \"./src/game/class/sector/vehiclepowerups/balloon.js\");\n/* harmony import */ var _sector_vehiclepowerups_blob_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sector/vehiclepowerups/blob.js */ \"./src/game/class/sector/vehiclepowerups/blob.js\");\n/* harmony import */ var _sector_vehiclepowerups_helicopter_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sector/vehiclepowerups/helicopter.js */ \"./src/game/class/sector/vehiclepowerups/helicopter.js\");\n/* harmony import */ var _sector_vehiclepowerups_truck_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sector/vehiclepowerups/truck.js */ \"./src/game/class/sector/vehiclepowerups/truck.js\");\n/* harmony import */ var _utils_canvaspool_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../utils/canvaspool.js */ \"./src/game/class/utils/canvaspool.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet M = {\r\n\tLINE: 1,\r\n\tPOWERUPS: 2  \r\n}\r\nlet A = [];\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tdefaultLine = {\r\n\t\tp1: new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](-40,50),\r\n\t\tp2: new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](40,50)\r\n\t}\r\n\tcamera = null;\r\n\tcanvasPool = null;\r\n\tsettings = null;\r\n\tphysicsLines = [];\r\n\tsceneryLines = [];\r\n\tpowerups = [];\r\n\tpowerupsLookupTable = {};\r\n\ttargets = [];\r\n\ttargetCount = 0;\r\n\tsectors = {};\r\n\ttotalSectors = [];\r\n\tallowedVehicles = null;\r\n\tdirty = !1;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tscene: { value: t, writable: true },\r\n\t\t\tgame: { value: t.game, writable: true }\r\n\t\t});\r\n\t\tthis.settings = t.game.settings;\r\n\t\tif (!this.settings.track) {\r\n\t\t\tthis.settings.track = {\r\n\t\t\t\tvehicle: this.settings.startVehicle\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.camera = t.camera;\r\n\t\tthis.sectors.drawSectors = [];\r\n\t\tthis.sectors.physicsSectors = [];\r\n\t\tthis.allowedVehicles = [\"MTB\", \"BMX\"];\r\n\t\tthis.canvasPool = new _utils_canvaspool_js__WEBPACK_IMPORTED_MODULE_17__[\"default\"](t);\r\n\t\tthis.createPowerupCache();\r\n\t}\r\n\tcreatePowerupCache() {\r\n\t\tA.push(new _sector_powerups_boost_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](0, 0, 0, this)),\r\n\t\tA.push(new _sector_powerups_slowmo_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"](0, 0, this)),\r\n\t\tA.push(new _sector_powerups_bomb_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](0, 0, this)),\r\n\t\tA.push(new _sector_powerups_gravity_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"](0, 0, 0, this)),\r\n\t\tA.push(new _sector_powerups_checkpoint_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"](0, 0, this)),\r\n\t\tA.push(new _sector_powerups_target_js__WEBPACK_IMPORTED_MODULE_9__[\"default\"](0, 0, this)),\r\n\t\tA.push(new _sector_powerups_antigravity_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](0, 0, this)),\r\n\t\tA.push(new _sector_powerups_teleport_js__WEBPACK_IMPORTED_MODULE_10__[\"default\"](0, 0, this)),\r\n\t\tA.push(new _sector_vehiclepowerups_helicopter_js__WEBPACK_IMPORTED_MODULE_15__[\"default\"](0, 0, 0, this)),\r\n\t\tA.push(new _sector_vehiclepowerups_truck_js__WEBPACK_IMPORTED_MODULE_16__[\"default\"](0, 0, 0, this)),\r\n\t\tA.push(new _sector_vehiclepowerups_balloon_js__WEBPACK_IMPORTED_MODULE_13__[\"default\"](0, 0, 0, this)),\r\n\t\tA.push(new _sector_vehiclepowerups_blob_js__WEBPACK_IMPORTED_MODULE_14__[\"default\"](0, 0, 0, this))\r\n\t}\r\n\trecachePowerups(t) {\r\n\t\tfor (const e of A)\r\n\t\t\te.recache(t)\r\n\t}\r\n\tread(t) {\r\n\t\tvar e = t.split(\"#\")\r\n\t\t  , i = e.length > 0 && e[0].split(\",\")\r\n\t\t  , s = e.length > 1 && e[1].split(\",\")\r\n\t\t  , n = e.length > 2 && e[2].split(\",\");\r\n\t\ti && i.length > 0 && this.addLines(i, this.addPhysicsLine),\r\n\t\ts && s.length > 0 && this.addLines(s, this.addSceneryLine),\r\n\t\tn && n.length > 0 && this.addPowerups(n)\r\n\t}\r\n\tmove(x = 0, y = 0) {\r\n\t\tfor (const t in this.physicsLines)\r\n\t\t\tthis.physicsLines[t].p1.x -= x,\r\n\t\t\tthis.physicsLines[t].p1.y -= y,\r\n\t\t\tthis.physicsLines[t].p2.x -= x,\r\n\t\t\tthis.physicsLines[t].p2.y -= y,\r\n\t\t\tthis.addPhysicsLineToTrack(this.physicsLines[t]),\r\n\t\t\tthis.physicsLines.splice(i, 1); // remove from sectors\r\n\t\t\t// make removePhysicsLineFromTrack method\r\n\t\tfor (const t in this.sceneryLines)\r\n\t\t\tthis.sceneryLines[t].p1.x -= x,\r\n\t\t\tthis.sceneryLines[t].p1.y -= y,\r\n\t\t\tthis.sceneryLines[t].p2.x -= x,\r\n\t\t\tthis.sceneryLines[t].p2.y -= y,\r\n\t\t\tthis.addSceneryLineToTrack(t),\r\n\t\t\tthis.sceneryLines.splice(i, 1);\r\n\t\tfor (const t in this.powerups) {\r\n\t\t\tthis.powerups[t].x -= x,\r\n\t\t\tthis.powerups[t].y -= y;\r\n\t\t\tif (this.powerups[t].otherPortal)\r\n\t\t\t\tthis.powerups[t].otherPortal.x -= x,\r\n\t\t\t\tthis.powerups[t].otherPortal.y -= y;\r\n\t\t\tthis.addPowerup(this.powerups[t]),\r\n\t\t\tthis.powerups.splice(t, 1);\r\n\t\t}\r\n\t\tthis.scene.redraw()\r\n\t}\r\n\taddPowerups(t) {\r\n\t\tfor (var e = t.length, i = [], s = 0; e > s; s++)\r\n\t\t\tif (i = t[s].split(\" \"), i.length >= 2) {\r\n\t\t\t\tfor (var n = [], r = i.length, o = 1; r > o; o++) {\r\n\t\t\t\t\tvar a = parseInt(i[o], 32);\r\n\t\t\t\t\tn.push(a)\r\n\t\t\t\t}\r\n\t\t\t\tvar h = Math.round(n[0])\r\n\t\t\t\t  , l = Math.round(n[1])\r\n\t\t\t\t  , p = null;\r\n\t\t\t\tswitch (i[0]) {\r\n\t\t\t\tcase \"B\":\r\n\t\t\t\t\tp = new _sector_powerups_boost_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](h,l,n[2],this);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"S\":\r\n\t\t\t\t\tp = new _sector_powerups_slowmo_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"](h,l,this);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"O\":\r\n\t\t\t\t\tp = new _sector_powerups_bomb_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](h,l,this);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"G\":\r\n\t\t\t\t\tp = new _sector_powerups_gravity_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"](h,l,n[2],this);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"C\":\r\n\t\t\t\t\tp = new _sector_powerups_checkpoint_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"](h,l,this);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"T\":\r\n\t\t\t\t\tp = new _sector_powerups_target_js__WEBPACK_IMPORTED_MODULE_9__[\"default\"](h,l,this),\r\n\t\t\t\t\tthis.addTarget(p);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"A\":\r\n\t\t\t\t\tp = new _sector_powerups_antigravity_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](h,l,this);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"V\":\r\n\t\t\t\t\tvar d = n[2]\r\n\t\t\t\t\t  , P = n[3]\r\n\t\t\t\t\t  , M = this.settings.vehiclePowerup.minTime\r\n\t\t\t\t\t  , A = this.settings.vehiclePowerup.maxTime;\r\n\t\t\t\t\tP = P || M,\r\n\t\t\t\t\tP = Math.min(P, A),\r\n\t\t\t\t\tP = Math.max(P, M);\r\n\t\t\t\t\tswitch (d) {\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tp = new _sector_vehiclepowerups_helicopter_js__WEBPACK_IMPORTED_MODULE_15__[\"default\"](h,l,P,this);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tp = new _sector_vehiclepowerups_truck_js__WEBPACK_IMPORTED_MODULE_16__[\"default\"](h,l,P,this);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\tp = new _sector_vehiclepowerups_balloon_js__WEBPACK_IMPORTED_MODULE_13__[\"default\"](h,l,P,this);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\tp = new _sector_vehiclepowerups_blob_js__WEBPACK_IMPORTED_MODULE_14__[\"default\"](h,l,P,this);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"W\":\r\n\t\t\t\t\tvar D = n[0]\r\n\t\t\t\t\t  , I = n[1]\r\n\t\t\t\t\t  , E = n[2]\r\n\t\t\t\t\t  , O = n[3]\r\n\t\t\t\t\t  , z = new _sector_powerups_teleport_js__WEBPACK_IMPORTED_MODULE_10__[\"default\"](D,I,this)\r\n\t\t\t\t\t  , j = new _sector_powerups_teleport_js__WEBPACK_IMPORTED_MODULE_10__[\"default\"](E,O,this);\r\n\t\t\t\t\tz.addOtherPortalRef(j),\r\n\t\t\t\t\tj.addOtherPortalRef(z),\r\n\t\t\t\t\tthis.addPowerup(z),\r\n\t\t\t\t\tthis.addPowerup(j);\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tthis.addPowerup(p);\r\n\t\t\t}\r\n\t}\r\n\taddTarget(t) {\r\n\t\tthis.dirty = !0,\r\n\t\tthis.targetCount++;\r\n\t\tthis.targets.push(t)\r\n\t}\r\n\taddPowerup(t) {\r\n\t\tif (window.hasOwnProperty('lite') && lite.storage.get('filterDuplicatePowerups')) {\r\n\t\t\tlet e = this.powerups.filter(e => e.name === t.name && e.x == t.x && e.y == t.y)\r\n\t\t\t  , i = e.length > 0 && e[0];\r\n\t\t\tif (e.length > 0) {\r\n\t\t\t\tswitch(t.prefix) {\r\n\t\t\t\tcase 'B':\r\n\t\t\t\tcase 'G':\r\n\t\t\t\t\te = e.filter(e => e.angle == t.angle);\r\n\t\t\t\t\ti = e.length > 0 && e[0];\r\n\t\t\t\t\tif (e.length < 1)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\treturn i.multiplier++,\r\n\t\t\t\t\ti;\r\n\t\t\t\tcase 'V':\r\n\t\t\t\t\t// i.multiplier++,\r\n\t\t\t\t\t// i.stack.push(t.time);\r\n\t\t\t\t\t// return i\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'W': // maybe limit to 2\r\n\t\t\t\t\t// also check other portal to see if it's identical\r\n\t\t\t\t\t// e = e.filter();\r\n\t\t\t\t\t// if (e.length > 2 * (1 + this.maxDuplicatePowerups))\r\n\t\t\t\t\t// \treturn t;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'T':\r\n\t\t\t\t\tthis.dirty = !0,\r\n\t\t\t\t\tthis.targets.pop()\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn i.multiplier++,\r\n\t\t\t\t\ti\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.addRef(t.x, t.y, t, M.POWERUPS, this.sectors.physicsSectors, this.settings.physicsSectorSize);\r\n\t\tlet a = this.addRef(t.x, t.y, t, M.POWERUPS, this.sectors.drawSectors, this.settings.drawSectorSize);\r\n\t\treturn a !== !1 && this.totalSectors.push(a), t !== null && (this.powerups.push(t), t.id && (this.powerupsLookupTable[t.id] = t)), t\r\n\t}\r\n\taddLines(t, e) {\r\n\t\tfor (let i = t.length, s = 0; i > s; s++) {\r\n\t\t\tlet n = t[s].split(\" \")\r\n\t\t\t  , r = n.length;\r\n\t\t\tif (r > 3)\r\n\t\t\t\tfor (let o = 0; r - 2 > o; o += 2) {\r\n\t\t\t\t\tlet a = parseInt(n[o], 32)\r\n\t\t\t\t\t, h = parseInt(n[o + 1], 32)\r\n\t\t\t\t\t, l = parseInt(n[o + 2], 32)\r\n\t\t\t\t\t, c = parseInt(n[o + 3], 32)\r\n\t\t\t\t\t, u = a + h + l + c;\r\n\t\t\t\t\tisNaN(u) || e.call(this, a, h, l, c)\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\taddPhysicsLine(t, e, i, s) {\r\n\t\tif (Math.sqrt(Math.pow(Math.round(i) - Math.round(t), 2) + Math.pow(Math.round(s) - Math.round(e), 2)) >= 2) {\r\n\t\t\treturn this.addPhysicsLineToTrack(new _sector_physicsline_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](Math.round(t), Math.round(e), Math.round(i), Math.round(s)))\r\n\t\t}\r\n\t}\r\n\taddPhysicsLineToTrack(t) {\r\n\t\tfor (let l = (0,_math_bresenham_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(t.p1.x, t.p1.y, t.p2.x, t.p2.y, this.settings.drawSectorSize, !0), p = 0; l.length > p; p += 2) {\r\n\t\t\tlet v = this.addRef(l[p], l[p + 1], t, M.LINE, this.sectors.drawSectors, this.settings.drawSectorSize);\r\n\t\t\tv !== !1 && this.totalSectors.push(v)\r\n\t\t}\r\n\t\tfor (let m = (0,_math_bresenham_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(t.p1.x, t.p1.y, t.p2.x, t.p2.y, this.settings.physicsSectorSize), p = 0; m.length > p; p += 2) {\r\n\t\t\tthis.addRef(m[p], m[p + 1], t, M.LINE, this.sectors.physicsSectors, this.settings.physicsSectorSize)\r\n\t\t}\r\n\t\treturn this.physicsLines.push(t), t\r\n\t}\r\n\taddSceneryLine(t, e, i, s) {\r\n\t\tif (Math.sqrt(Math.pow(Math.round(i) - Math.round(t), 2) + Math.pow(Math.round(s) - Math.round(e), 2)) >= 2) {\r\n\t\t\treturn this.addSceneryLineToTrack(new _sector_sceneryline_js__WEBPACK_IMPORTED_MODULE_11__[\"default\"](Math.round(t), Math.round(e), Math.round(i), Math.round(s)))\r\n\t\t}\r\n\t}\r\n\taddSceneryLineToTrack(t) {\r\n\t\tfor (let e = this.settings.drawSectorSize, i = t.p1, s = t.p2, n = i.x, r = i.y, a = s.x, h = s.y, l = (0,_math_bresenham_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(n, r, a, h, e, !0), c = this.sectors.drawSectors, u = l.length, p = 0; u > p; p += 2) {\r\n\t\t\tlet v = this.addRef(l[p], l[p + 1], t, M.LINE, c, e);\r\n\t\t\tv !== !1 && this.totalSectors.push(v)\r\n\t\t}\r\n\t\treturn this.sceneryLines.push(t), t\r\n\t}\r\n\taddRef(t, e, i, s, n, r) {\r\n\t\tlet o = Math.floor(t / r)\r\n\t\t  , h = Math.floor(e / r)\r\n\t\t  , c = !1;\r\n\t\tif (void 0 === n[o] && (n[o] = []), void 0 === n[o][h]) {\r\n\t\t\tlet u = new _sector_sector_js__WEBPACK_IMPORTED_MODULE_12__[\"default\"](o, h, this);\r\n\t\t\tn[o][h] = u,\r\n\t\t\tc = u\r\n\t\t}\r\n\t\tswitch (s) {\r\n\t\tcase M.LINE:\r\n\t\t\tn[o][h].addLine(i),\r\n\t\t\ti.addSectorReference(n[o][h]);\r\n\t\t\tbreak;\r\n\t\tcase M.POWERUPS:\r\n\t\t\tn[o][h].addPowerup(i),\r\n\t\t\ti.addSectorReference(n[o][h])\r\n\t\t}\r\n\t\treturn this.dirty = !0, c\r\n\t}\r\n\tcleanTrack() {\r\n\t\tthis.cleanLines(),\r\n\t\tthis.cleanPowerups()\r\n\t}\r\n\tcleanLines() {\r\n\t\tlet t = this.physicsLines\r\n\t\t  , e = this.sceneryLines;\r\n\t\tfor (let i of t.filter(t => t.remove))\r\n\t\t\tt.splice(t.indexOf(i), 1);\r\n\t\tfor (let i of e.filter(t => t.remove))\r\n\t\t\te.splice(e.indexOf(i), 1)\r\n\t}\r\n\tcleanPowerups() {\r\n\t\tlet t = this.powerups\r\n\t\t  , e = this.targets;\r\n\t\tfor (let i of t.filter(t => t.remove))\r\n\t\t\tt.splice(t.indexOf(i), 1);\r\n\t\tfor (let i of e.filter(t => t.remove))\r\n\t\t\te.splice(e.indexOf(i), 1);\r\n\t\tthis.targetCount = this.targets.length\r\n\t}\r\n\tupdatePowerupState(t) {\r\n\t\tthis.resetPowerups(),\r\n\t\tthis.setPowerupStates(t._powerupsConsumed.targets),\r\n\t\tthis.setPowerupStates(t._powerupsConsumed.checkpoints),\r\n\t\tthis.setPowerupStates(t._powerupsConsumed.misc)\r\n\t}\r\n\tsetPowerupStates(t) {\r\n\t\tfor (let e of t) {\r\n\t\t\tthis.powerupsLookupTable[e].remove && this.powerupsLookupTable[e].id && (delete this.powerupsLookupTable[e], delete t[e]),\r\n\t\t\tthis.powerupsLookupTable[e].hit = !0,\r\n\t\t\tthis.powerupsLookupTable[e].sector.powerupCanvasDrawn = !1\r\n\t\t}\r\n\t}\r\n\tselect(a, b) {\r\n\t\tconst segments = [];\r\n\t\tlet min = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](Math.min(a.x, b.x), Math.min(a.y, b.y))\r\n\t\t  , max = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](Math.max(a.x, b.x), Math.max(a.y, b.y));\r\n\t\tfor (const i of [...this.physicsLines, ...this.sceneryLines, ...this.powerups].filter(t => !t.remove)) {\r\n\t\t\tif (i.p1 && i.p2) {\r\n\t\t\t\tif (((i.p1.x > min.x && i.p1.y > min.y) || (i.p2.x > min.x && i.p2.y > min.y)) && ((i.p1.x < max.x && i.p1.y < max.y) || (i.p2.x < max.x && i.p2.y < max.y))) {\r\n\t\t\t\t\tsegments.push(i);\r\n\t\t\t\t}\r\n\t\t\t} else if (i.x > min.x && i.y > min.y && i.x < max.x && i.y < max.y) {\r\n\t\t\t\tsegments.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn segments\r\n\t}\r\n\tgetCode() {\r\n\t\tthis.cleanTrack();\r\n\t\tvar t = this.powerups\r\n\t\t  , e = this.physicsLines\r\n\t\t  , i = this.sceneryLines\r\n\t\t  , s = \"\";\r\n\t\tif (e.length > 0) {\r\n\t\t\tfor (var a of e)\r\n\t\t\t\ta.recorded || (s += a.p1.x.toString(32) + \" \" + a.p1.y.toString(32) + a.getCode(this) + \",\");\r\n\t\t\ts = s.slice(0, -1);\r\n\t\t\tfor (var a of e)\r\n\t\t\t\ta.recorded = !1\r\n\t\t}\r\n\t\tif (s += \"#\",\r\n\t\ti.length > 0) {\r\n\t\t\tfor (var l of i)\r\n\t\t\t\tl.recorded || (s += l.p1.x.toString(32) + \" \" + l.p1.y.toString(32) + l.getCode(this) + \",\");\r\n\t\t\ts = s.slice(0, -1);\r\n\t\t\tfor (var l of i)\r\n\t\t\t\tl.recorded = !1\r\n\t\t}\r\n\t\tif (s += \"#\",\r\n\t\tt.length > 0) {\r\n\t\t\tfor (var c of t.map(t => t.getCode()).filter(t => t))\r\n\t\t\t\ts += c + \",\";\r\n\t\t\ts = s.slice(0, -1)\r\n\t\t}\r\n\t\treturn s\r\n\t}\r\n\tresetPowerups() {\r\n\t\tfor (let t of this.powerups.filter(t => t.hit && !t.remove))\r\n\t\t\tt.sector.powerupCanvasDrawn = t.hit = !1\r\n\t}\r\n\taddDefaultLine() {\r\n\t\tthis.addPhysicsLine(this.defaultLine.p1.x, this.defaultLine.p1.y, this.defaultLine.p2.x, this.defaultLine.p2.y)\r\n\t}\r\n\terase(t, e, i) {\r\n\t\tthis.dirty = !0;\r\n\t\tfor (var b = Math.floor(Math.min(t.x - e, t.x + e) / this.settings.drawSectorSize), _ = []; Math.floor(Math.max(t.x - e, t.x + e) / this.settings.drawSectorSize) >= b; b++)\r\n\t\t\tfor (var T = Math.floor(Math.min(t.y - e, t.y + e) / this.settings.drawSectorSize); Math.floor(Math.max(t.y - e, t.y + e) / this.settings.drawSectorSize) >= T; T++)\r\n\t\t\t\tthis.sectors.drawSectors[b] && this.sectors.drawSectors[b][T] && _.push(this.sectors.drawSectors[b][T].erase(t, e, i));\r\n\t\treturn _.flat()\r\n\t}\r\n\tdrawAndCache() {\r\n\t\tfor (var t = performance.now(), e = this.totalSectors, i = e.length, s = 0; i > s; s++) {\r\n\t\t\t!function(t) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tt.draw(),\r\n\t\t\t\t\tt.cacheAsImage()\r\n\t\t\t\t}, 250 * s)\r\n\t\t\t}(e[s])\r\n\t\t}\r\n\t\tlet r = performance.now();\r\n\t\tconsole.log(\"Track :: Time to draw entire track : \" + (r - t) + \"ms\")\r\n\t}\r\n\tundraw() {\r\n\t\tfor (let t of this.totalSectors.filter(t => t.drawn))\r\n\t\t\tt.clear(!0);\r\n\t\tthis.recachePowerups(Math.max(this.camera.zoom, 1)),\r\n\t\tthis.canvasPool.update()\r\n\t}\r\n\tcollide(t) {\r\n\t\tlet i = Math.floor(t.pos.x / this.settings.physicsSectorSize - .5)\r\n\t\t  , s = Math.floor(t.pos.y / this.settings.physicsSectorSize - .5);\r\n\t\tthis.sectors.physicsSectors[i] && this.sectors.physicsSectors[i][s] && this.sectors.physicsSectors[i][s].resetCollided(),\r\n\t\tthis.sectors.physicsSectors[i + 1] && this.sectors.physicsSectors[i + 1][s] && this.sectors.physicsSectors[i + 1][s].resetCollided(),\r\n\t\tthis.sectors.physicsSectors[i + 1] && this.sectors.physicsSectors[i + 1][s + 1] && this.sectors.physicsSectors[i + 1][s + 1].resetCollided(),\r\n\t\tthis.sectors.physicsSectors[i] && this.sectors.physicsSectors[i][s + 1] && this.sectors.physicsSectors[i][s + 1].resetCollided(),\r\n\t\tthis.sectors.physicsSectors[i] && this.sectors.physicsSectors[i][s] && this.sectors.physicsSectors[i][s].collide(t),\r\n\t\tthis.sectors.physicsSectors[i + 1] && this.sectors.physicsSectors[i + 1][s] && this.sectors.physicsSectors[i + 1][s].collide(t),\r\n\t\tthis.sectors.physicsSectors[i + 1] && this.sectors.physicsSectors[i + 1][s + 1] && this.sectors.physicsSectors[i + 1][s + 1].collide(t),\r\n\t\tthis.sectors.physicsSectors[i] && this.sectors.physicsSectors[i][s + 1] && this.sectors.physicsSectors[i][s + 1].collide(t)\r\n\t}\r\n\tgetDrawSector(t, e) {\r\n\t\tlet s = Math.floor(t / this.settings.drawSectorSize)\r\n\t\t  , n = Math.floor(e / this.settings.drawSectorSize);\r\n\t\treturn typeof this.sectors.drawSectors[s] != \"undefined\" && typeof this.sectors.drawSectors[s][n] != \"undefined\" && (this.sectors.drawSectors[s][n])\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tlet f = this.scene.camera.position.x * this.scene.camera.zoom / (this.settings.drawSectorSize * this.scene.camera.zoom) - this.scene.screen.width / (this.settings.drawSectorSize * this.scene.camera.zoom) / 2 - 1,\r\n\t\t\tv = this.scene.camera.position.y * this.scene.camera.zoom / (this.settings.drawSectorSize * this.scene.camera.zoom) - this.scene.screen.height / (this.settings.drawSectorSize * this.scene.camera.zoom) / 2 - 1,\r\n\t\t\tg = this.scene.camera.position.x * this.scene.camera.zoom / (this.settings.drawSectorSize * this.scene.camera.zoom) + this.scene.screen.width / (this.settings.drawSectorSize * this.scene.camera.zoom) / 2,\r\n\t\t\tm = this.scene.camera.position.y * this.scene.camera.zoom / (this.settings.drawSectorSize * this.scene.camera.zoom) + this.scene.screen.height / (this.settings.drawSectorSize * this.scene.camera.zoom) / 2;\r\n\t\tfor (const t of this.totalSectors) {\r\n\t\t\tif (t.dirty && t.cleanSector(), t.column >= f && g >= t.column && t.row >= v && m >= t.row) {\r\n\t\t\t\tt.drawn === !1 && t.draw(),\r\n\t\t\t\tt.hasPowerups && (t.powerupCanvasDrawn || t.cachePowerupSector());\r\n\t\t\t\tlet S = t.column * (this.settings.drawSectorSize * this.scene.camera.zoom) - (this.scene.camera.position.x * this.scene.camera.zoom - this.scene.screen.center.x) | 0,\r\n\t\t\t\t\tP = t.row * (this.settings.drawSectorSize * this.scene.camera.zoom) - (this.scene.camera.position.y * this.scene.camera.zoom - this.scene.screen.center.y) | 0;\r\n\t\t\t\tctx.drawImage(t.canvas, S, P, this.settings.drawSectorSize * this.scene.camera.zoom, this.settings.drawSectorSize * this.scene.camera.zoom);\r\n\t\t\t\tif (t.hasPowerups && t.powerupCanvasDrawn) {\r\n\t\t\t\t\tctx.drawImage(t.powerupCanvas, S - t.powerupCanvasOffset * this.scene.camera.zoom / 2, P - t.powerupCanvasOffset * this.scene.camera.zoom / 2, (this.settings.drawSectorSize * this.scene.camera.zoom) + t.powerupCanvasOffset * this.scene.camera.zoom, (this.settings.drawSectorSize * this.scene.camera.zoom) + t.powerupCanvasOffset * this.scene.camera.zoom)\r\n\t\t\t\t}\r\n\t\t\t} else\r\n\t\t\t\tt.drawn && t.clear()\r\n\t\t}\r\n\t}\r\n\tcloseSectors() {\r\n\t\tfor (const t of this.totalSectors)\r\n\t\t\tt.close()\r\n\t}\r\n\tclose() {\r\n\t\tthis.scene = null,\r\n\t\tthis.closeSectors(),\r\n\t\tthis.totalSectors = null,\r\n\t\tthis.canvasPool = null,\r\n\t\tthis.sectors = null,\r\n\t\tthis.physicsLines = null,\r\n\t\tthis.sceneryLines = null,\r\n\t\tthis.powerups = null,\r\n\t\tthis.camera = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/tracks/track.js?");

/***/ }),

/***/ "./src/game/class/utils/campaignscore.js":
/*!***********************************************!*\
  !*** ./src/game/class/utils/campaignscore.js ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _interfaces_gui_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces/gui.js */ \"./src/game/class/interfaces/gui.js\");\n/* harmony import */ var _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces/component.js */ \"./src/game/class/interfaces/component.js\");\n/* harmony import */ var _interfaces_container_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces/container.js */ \"./src/game/class/interfaces/container.js\");\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _interfaces_gui_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tsprite = null;\r\n\tspriteSheet = {\r\n\t\tbronze_medal: [548, 68, 44, 44],\r\n\t\tcenter_panel: [2, 68, 452, 56],\r\n\t\tsilver_medal: [502, 68, 44, 44],\r\n\t\tleft_panel: [2, 2, 588, 64],\r\n\t\tgold_medal: [456, 68, 44, 44]\r\n\t}\r\n\tbronze_container = new _interfaces_container_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\r\n\t\talpha: 0.4,\r\n\t\tfont: { size: 12 },\r\n\t\tinline: true,\r\n\t\tx: 6.4\r\n\t}, this.container)\r\n\tsilver_container = new _interfaces_container_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\r\n\t\talpha: 0.4,\r\n\t\tfont: { size: 12 },\r\n\t\tinline: true,\r\n\t\tx: 6.4\r\n\t}, this.container)\r\n\tgold_container = new _interfaces_container_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\r\n\t\talpha: 0.4,\r\n\t\tfont: { size: 12 },\r\n\t\tinline: true,\r\n\t\tx: 6.4\r\n\t}, this.container)\r\n\tconstructor(t) {\r\n\t\tsuper(t, {\r\n\t\t\tfont: { size: 12 },\r\n\t\t\tinline: true,\r\n\t\t\ty: 32\r\n\t\t}),\r\n\t\tthis.settings = t.settings;\r\n\t\tlet e = t.settings.campaignData.goals;\r\n\t\tthis.sprite = t.assets.getResult(\"campaign_icons\"),\r\n\t\tthis.bronze_container.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\tcached: true,\r\n\t\t\timage: {\r\n\t\t\t\tcanvas: this.sprite,\r\n\t\t\t\tx: 548,\r\n\t\t\t\ty: 68,\r\n\t\t\t\twidth: 44,\r\n\t\t\t\theight: 44\r\n\t\t\t},\r\n\t\t\twidth: 18,\r\n\t\t\theight: 18\r\n\t\t})),\r\n\t\tthis.bronze_container.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\ttext: e.third,\r\n\t\t\tx: 4,\r\n\t\t\ty: 3\r\n\t\t})),\r\n\t\tthis.silver_container.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\tcached: true,\r\n\t\t\timage: {\r\n\t\t\t\tcanvas: this.sprite,\r\n\t\t\t\tx: 502,\r\n\t\t\t\ty: 68,\r\n\t\t\t\twidth: 44,\r\n\t\t\t\theight: 44\r\n\t\t\t},\r\n\t\t\twidth: 18,\r\n\t\t\theight: 18\r\n\t\t})),\r\n\t\tthis.silver_container.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\ttext: e.second,\r\n\t\t\tx: 4,\r\n\t\t\ty: 3\r\n\t\t})),\r\n\t\tthis.gold_container.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\tcached: true,\r\n\t\t\timage: {\r\n\t\t\t\tcanvas: this.sprite,\r\n\t\t\t\tx: 456,\r\n\t\t\t\ty: 68,\r\n\t\t\t\twidth: 44,\r\n\t\t\t\theight: 44\r\n\t\t\t},\r\n\t\t\twidth: 18,\r\n\t\t\theight: 18\r\n\t\t})),\r\n\t\tthis.gold_container.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\ttext: e.first,\r\n\t\t\tx: 4,\r\n\t\t\ty: 3\r\n\t\t})),\r\n\t\tthis.updateState()\r\n\t}\r\n\tupdateState() {\r\n\t\tswitch (this.settings.campaignData.user.has_goal) {\r\n\t\tcase 1:\r\n\t\tcase \"first\":\r\n\t\t\tthis.gold_container.alpha = 1;\r\n\t\tcase 2:\r\n\t\tcase \"second\":\r\n\t\t\tthis.silver_container.alpha = 1;\r\n\t\tcase 3:\r\n\t\tcase \"third\":\r\n\t\t\tthis.bronze_container.alpha = 1;\r\n\t\t}\r\n\t\tthis.redraw()\r\n\t}\r\n\tcenterContainer() {\r\n\t\tlet t = this.scene.screen\r\n\t\t  , e = this.container\r\n\t\t  , i = e.width;\r\n\t\te.x = t.width / 2 / window.devicePixelRatio - i / 2,\r\n\t\te.y = 40\r\n\t}\r\n\tupdate() {\r\n\t\tthis.updateState()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/campaignscore.js?");

/***/ }),

/***/ "./src/game/class/utils/canvaspool.js":
/*!********************************************!*\
  !*** ./src/game/class/utils/canvaspool.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tcanvasPool = [];\r\n\tpoolCap = 5e3;\r\n\tsetToScreen = true;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'options', { value: t, writable: true }),\r\n\t\tt.screen && this.update(),\r\n\t\tt.cap && (this.setToScreen = !1,\r\n\t\tthis.poolCap = t.cap)\r\n\t}\r\n\tupdate() {\r\n\t\tthis.setToScreen && (this.getPoolCapFromScreen(),\r\n\t\tthis.cleanPool())\r\n\t}\r\n\tgetPoolCapFromScreen() {\r\n\t\tlet t = this.options\r\n\t\t  , e = t.screen\r\n\t\t  , i = t.camera\r\n\t\t  , s = t.settings;\r\n\t\tthis.poolCap = Math.ceil(e.width / Math.floor(s.drawSectorSize * i.zoom)) * Math.ceil(e.height / Math.floor(s.drawSectorSize * i.zoom)) + Math.ceil(e.width / Math.floor(s.drawSectorSize * i.zoom)) + Math.ceil(e.height / Math.floor(s.drawSectorSize * i.zoom))\r\n\t}\r\n\tgetCanvas() {\r\n\t\tlet t = this.canvasPool.pop();\r\n\t\treturn t ??= document.createElement(\"canvas\")\r\n\t}\r\n\treleaseCanvas(t) {\r\n\t\tthis.canvasPool.length < this.poolCap && this.canvasPool.push(t)\r\n\t}\r\n\tcleanPool() {\r\n\t\tthis.canvasPool.length > this.poolCap && (this.canvasPool = this.canvasPool.slice(0, this.poolCap + 1))\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/canvaspool.js?");

/***/ }),

/***/ "./src/game/class/utils/formatnumber.js":
/*!**********************************************!*\
  !*** ./src/game/class/utils/formatnumber.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* export default binding */ __WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ function __WEBPACK_DEFAULT_EXPORT__(t) {\r\n\tt = parseInt(t, 10);\r\n\tlet e = t % 6e4 / 1e3;\r\n\treturn Math.floor(t / 6e4) + \":\" + e.toFixed(2).padStart(5, 0)\r\n}\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/formatnumber.js?");

/***/ }),

/***/ "./src/game/class/utils/gamepad.js":
/*!*****************************************!*\
  !*** ./src/game/class/utils/gamepad.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _EventEmitter_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../EventEmitter.js */ \"./src/game/class/EventEmitter.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _EventEmitter_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\ttickDownButtons = {};\r\n\tpreviousTickDownButtons = {};\r\n\tdownButtons = {};\r\n\tinactiveDownButtons = new Set();\r\n\tpaused = !1;\r\n\tkeymap = {};\r\n\trecords = {};\r\n\tkeysToRecord = null;\r\n\tkeysToPlay = null;\r\n\trecording = !1;\r\n\tplayback = null;\r\n\tnumberOfKeysDown = 0;\r\n\ttickNumberOfKeysDown = 0;\r\n\treplaying = !1;\r\n\tconstructor(t) {\r\n\t\tsuper(),\r\n\t\tObject.defineProperty(this, 'scene', { value: t, writable: true }),\r\n\t\tObject.defineProperty(this, 'inactiveDownButtons', { enumerable: false })\r\n\t}\r\n\tlisten() {\r\n\t\tdocument.onkeydown = this.handleButtonDown.bind(this),\r\n\t\tdocument.onkeyup = this.handleButtonUp.bind(this),\r\n\t\twindow.onblur = this.handleBlur.bind(this),\r\n\t\twindow.onfocus = this.handleFocus.bind(this)\r\n\t}\r\n\tunlisten() {\r\n\t\tthis.downButtons = {},\r\n\t\tdocument.onkeydown = null,\r\n\t\tdocument.onkeyup = null,\r\n\t\twindow.onblur = null,\r\n\t\twindow.onfocus = null\r\n\t}\r\n\tpause() {\r\n\t\tthis.paused = !0\r\n\t}\r\n\tunpause() {\r\n\t\tthis.paused = !1\r\n\t}\r\n\trecordKeys(t) {\r\n\t\tthis.keysToRecord = t,\r\n\t\tthis.recording = !0\r\n\t}\r\n\tloadPlayback(t, e) {\r\n\t\tthis.keysToPlay = e,\r\n\t\tthis.playback = t,\r\n\t\tthis.replaying = !0\r\n\t}\r\n\tsetKeyMap(t) {\r\n\t\tlet e = {};\r\n\t\tfor (let i in t)\r\n\t\t\tif (t[i] instanceof Array)\r\n\t\t\t\tfor (let s of t[i])\r\n\t\t\t\t\te[s] = i;\r\n\t\t\telse\r\n\t\t\t\te[t[i]] = i;\r\n\t\tthis.keymap = e\r\n\t}\r\n\thandleButtonDown(t) {\r\n\t\tlet e = this.getInternalCode(t.keyCode);\r\n\t\t\"string\" == typeof e && !t.ctrlKey && t.preventDefault(),\r\n\t\tthis.setButtonDown(e)\r\n\t}\r\n\thandleButtonUp(t) {\r\n\t\tlet e = this.getInternalCode(t.keyCode);\r\n\t\t\"string\" == typeof e && t.preventDefault(),\r\n\t\tthis.setButtonUp(e)\r\n\t}\r\n\tblurred = false;\r\n\tpreviousDownButtons = {};\r\n\thandleBlur() {\r\n\t\tthis.blurred = true,\r\n\t\tthis.previousDownButtons = Object.assign({}, this.tickDownButtons)\r\n\t}\r\n\thandleFocus() {\r\n\t\tthis.blurred && (this.tickDownButtons = Object.assign({}, this.previousDownButtons),\r\n\t\tthis.downButtons = Object.fromEntries(Object.keys(this.tickDownButtons).map(key => [key, false])))\r\n\t}\r\n\tgetInternalCode(t) {\r\n\t\treturn this.keymap[t] || t\r\n\t}\r\n\tsetButtonsDown(t) {\r\n\t\tfor (let e in t)\r\n\t\t\tthis.setButtonDown(t[e])\r\n\t}\r\n\tsetButtonUp(t) {\r\n\t\tthis.blurred = false;\r\n\t\tthis.downButtons[t] && (this.onButtonUp && this.onButtonUp(t),\r\n\t\tthis.downButtons[t] = !1,\r\n\t\tthis.inactiveDownButtons.delete(t),\r\n\t\tthis.inactiveDownButtons.delete(t == 'left' ? 'right' : t == 'right' ? 'left' : null),\r\n\t\tthis.emit('buttonUp', t),\r\n\t\tthis.numberOfKeysDown--)\r\n\t}\r\n\tsetButtonDown(t, e) {\r\n\t\tthis.blurred = false;\r\n\t\tthis.downButtons[t] || (this.onButtonDown && this.onButtonDown(t),\r\n\t\tthis.downButtons[t] = e ? e : !0,\r\n\t\te = t == 'left' ? 'right' : t == 'right' ? 'left' : null,\r\n\t\te && this.downButtons[e] && this.inactiveDownButtons.add(e),\r\n\t\tthis.emit('buttonDown', t),\r\n\t\tthis.numberOfKeysDown++)\r\n\t}\r\n\tisButtonDown(t) {\r\n\t\treturn this.tickDownButtons[t] > 0\r\n\t}\r\n\tgetButtonDownOccurances(t) {\r\n\t\tlet e = 0;\r\n\t\tif (this.isButtonDown(t)) {\r\n\t\t\te = 1;\r\n\t\t\tlet i = this.tickDownButtons[t];\r\n\t\t\ti !== !0 && (e = i)\r\n\t\t}\r\n\t\treturn e\r\n\t}\r\n\tgetDownButtons() {\r\n\t\tlet t = [];\r\n\t\tfor (let e in this.tickDownButtons)\r\n\t\t\tthis.tickDownButtons[e] && t.push(e);\r\n\t\treturn t\r\n\t}\r\n\treset(t) {\r\n\t\t(this.replaying || t) && (this.downButtons = {},\r\n\t\tthis.playbackTicks = 0),\r\n\t\tthis.tickDownButtons = {},\r\n\t\tthis.previousDownButtons = {},\r\n\t\tthis.previousTickDownButtons = {},\r\n\t\tthis.records = {}\r\n\t}\r\n\tupdate() {\r\n\t\tthis.replaying && this.updatePlayback()\r\n\t\t!this.blurred && (this.previousTickDownButtons = Object.assign({}, this.tickDownButtons),\r\n\t\tthis.tickDownButtons = window.hasOwnProperty('lite') && lite.storage.get('inputRollover') && this.recording ? Object.fromEntries(Object.entries(this.downButtons).map(([key, value]) => [key, value && this.inactiveDownButtons.has(key) ? false : value])) : Object.assign({}, this.downButtons));\r\n\t\tthis.tickNumberOfKeysDown = this.numberOfKeysDown;\r\n\t\tthis.recording && this.updateRecording()\r\n\t}\r\n\tareKeysDown() {\r\n\t\tfor (let t in this.downButtons)\r\n\t\t\tif (this.downButtons[t] === !0)\r\n\t\t\t\treturn !0;\r\n\t\treturn !1\r\n\t}\r\n\tupdatePlayback() {\r\n\t\tlet t = this.playback\r\n\t\t  , e = this.playbackTicks ?? this.scene.ticks;\r\n\t\tfor (let i of this.keysToPlay) {\r\n\t\t\tlet s = i + \"_up\"\r\n\t\t\t  , n = i + \"_down\";\r\n\t\t\tif (\"undefined\" != typeof t[n] && \"undefined\" != typeof t[n][e]) {\r\n\t\t\t\tlet a = t[n][e];\r\n\t\t\t\tthis.setButtonDown(i, a)\r\n\t\t\t}\r\n\t\t\t\"undefined\" != typeof t[s] && \"undefined\" != typeof t[s][e] && this.setButtonUp(i)\r\n\t\t}\r\n\t}\r\n\tupdateRecording() {\r\n\t\tlet t = this.scene.ticks\r\n\t\t  , e = this.records\r\n\t\t  , s = this.tickDownButtons\r\n\t\t  , n = this.previousTickDownButtons;\r\n\t\tfor (let o of this.keysToRecord.filter(t => 'undefined' != typeof s[t])) {\r\n\t\t\tlet a = s[o]\r\n\t\t\t  , h = \"undefined\" != typeof n[o] && n[o];\r\n\t\t\tif (a !== h) {\r\n\t\t\t\tlet l = o + \"_up\"\r\n\t\t\t\t  , c = o + \"_down\"\r\n\t\t\t\t  , u = l;\r\n\t\t\t\ta && (u = c);\r\n\t\t\t\tif (!a && e[c] && -1 !== e[c].indexOf(t)) {\r\n\t\t\t\t\tif (/^(backspace|enter)$/.test(o)) {\r\n\t\t\t\t\t\te[u] || (e[u] = []),\r\n\t\t\t\t\t\te[u].push(t + 1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\te[c].splice(e[c].indexOf(t), 1),\r\n\t\t\t\t\t\te[c].length || delete e[c];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else\r\n\t\t\t\t\te[u] || (e[u] = []),\r\n\t\t\t\t\te[u].push(t)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tbuttonWasRecentlyDown(t) {\r\n\t\tlet e = this.records;\r\n\t\tthis.replaying && (e = this.playback);\r\n\t\tlet i = t + \"_down\"\r\n\t\t  , s = !1;\r\n\t\tif (e[i]) {\r\n\t\t\tlet n = (this.replaying && this.playbackTicks) ?? this.scene.ticks\r\n\t\t\t  , o = e[i]\r\n\t\t\t  , a = -1;\r\n\t\t\ta = this.replaying ? \"undefined\" != typeof o[n] : o.indexOf(n),\r\n\t\t\t-1 !== a && (s = !0)\r\n\t\t}\r\n\t\treturn s\r\n\t}\r\n\tgetReplayString() {\r\n\t\twindow.hasOwnProperty('lite') && lite.storage.get('showCustomizations') && Object.assign(this.records, lite._appendRecords());\r\n\t\treturn JSON.stringify(this.records)\r\n\t}\r\n\tencodeReplayString(t) {\r\n\t\tlet e = this.scene.settings\r\n\t\t  , i = {\r\n\t\t\t\tversion: e.replayVersion\r\n\t\t\t};\r\n\t\tfor (let s in t) {\r\n\t\t\tlet n = t[s];\r\n\t\t\ti[s] = \"\";\r\n\t\t\tfor (let r in n) {\r\n\t\t\t\tlet o = n[r];\r\n\t\t\t\ti[s] += o.toString(32) + \" \"\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn i\r\n\t}\r\n\tclose() {\r\n\t\tthis.unlisten(),\r\n\t\tthis.onButtonDown = null,\r\n\t\tthis.onButtonUp = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.tickDownButtons = null,\r\n\t\tthis.downButtons = null,\r\n\t\tthis.keymap = null,\r\n\t\tthis.records = null,\r\n\t\tthis.keysToRecord = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/gamepad.js?");

/***/ }),

/***/ "./src/game/class/utils/loadingcircle.js":
/*!***********************************************!*\
  !*** ./src/game/class/utils/loadingcircle.js ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tscene = null;\r\n\tclockwise = !1;\r\n\tscreen = null;\r\n\tsettings = null;\r\n\tconstructor(t) {\r\n\t\tthis.scene = t;\r\n\t\tthis.screen = t.screen;\r\n\t\tthis.settings = {\r\n\t\t\tradius: 10,\r\n\t\t\tcolor: \"#1884cf\"\r\n\t\t}\r\n\t}\r\n\tdraw(t) {\r\n\t\tlet e = this.screen\r\n\t\t  , i = this.settings\r\n\t\t  , s = this.scene.game.pixelRatio\r\n\t\t  , n = i.radius\r\n\t\t  , o = this.scene.game._updates % 25 / 25 * 2 * Math.PI;\r\n\t\t0 === o && (this.clockwise = !this.clockwise);\r\n\t\tlet l = e.width - 25 * s\r\n\t\t  , c = e.height - 25 * s;\r\n\t\tt.beginPath(),\r\n\t\tt.arc(l, c, n * s, 0, o, !this.clockwise),\r\n\t\tt.lineWidth = 3 * s,\r\n\t\tt.strokeStyle = i.color,\r\n\t\tt.stroke()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/loadingcircle.js?");

/***/ }),

/***/ "./src/game/class/utils/messagemanager.js":
/*!************************************************!*\
  !*** ./src/game/class/utils/messagemanager.js ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tcolor = \"#000\";\r\n\tmessage = false;\r\n\ttimeout = false;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'scene', { value: t, writable: true })\r\n\t}\r\n\tdraw(a) {\r\n\t\tlet t = this.message\r\n\t\t  , e = this.timeout\r\n\t\t  , i = this.color\r\n\t\t  , s = this.outline;\r\n\t\tif (e !== !1 && 0 >= e && (t = !1),\r\n\t\tthis.scene.state.paused && (i = !1,\r\n\t\ts = !1,\r\n\t\tt = 'Paused' + (this.scene.settings.mobile ? '' : \" - Press Spacebar to Continue\")),\r\n\t\ti === !1 && (i = '#'.padEnd(7, lite.storage.get(\"theme\") == \"midnight\" ? '8' : /^dark(er)?$/i.test(lite.storage.get(\"theme\")) ? 'c' : '3')),\r\n\t\tt) {\r\n\t\t\tlet n = this.scene.game\r\n\t\t\t  , r = this.scene\r\n\t\t\t  , o = n.pixelRatio\r\n\t\t\t  , h = r.screen.center.x\r\n\t\t\t  , l = 100\r\n\t\t\t  , c = r.settings;\r\n\t\t\t\"phone\" === c.controls && (l = 80),\r\n\t\t\ta.save(),\r\n\t\t\ta.fillStyle = i,\r\n\t\t\ta.lineWidth = 4 * (o / 2),\r\n\t\t\ta.font = 12 * o + \"pt helsinki\",\r\n\t\t\ta.textAlign = \"center\",\r\n\t\t\ts && (a.strokeStyle = s,\r\n\t\t\ta.strokeText(t, h, l * o)),\r\n\t\t\ta.fillText(t, h, l * o),\r\n\t\t\ta.restore()\r\n\t\t}\r\n\t}\r\n\tshow(t, e, i, s) {\r\n\t\tthis.message = t,\r\n\t\tthis.timeout = e,\r\n\t\tthis.color = /^#(0|3){3,6}$/.test(i) ? this.scene.settings.physicsLineColor : i,\r\n\t\tthis.outline = lite.storage.get('theme') == 'midnight' ? '#1d2328' : lite.storage.get('theme') == 'darker' ? '#000' : lite.storage.get('theme') == 'dark' ? '#1b1b1b' : s\r\n\t}\r\n\thide() {\r\n\t\tthis.message = !1,\r\n\t\tthis.color = !1,\r\n\t\tthis.outline = !1\r\n\t}\r\n\tupdate() {\r\n\t\tthis.timeout !== !1 && this.timeout--\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/messagemanager.js?");

/***/ }),

/***/ "./src/game/class/utils/mousehandler.js":
/*!**********************************************!*\
  !*** ./src/game/class/utils/mousehandler.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _EventEmitter_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../EventEmitter.js */ \"./src/game/class/EventEmitter.js\");\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _EventEmitter_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\tenabled = !0;\r\n\ttouch = null;\r\n\ttouches = [];\r\n\tupdateCallback = !1;\r\n\twheel = !1;\r\n\tmousewheel = !1;\r\n\tthrottledMouseWheel = null;\r\n\tconstructor(t) {\r\n\t\tsuper();\r\n\t\tObject.defineProperty(this, 'scene', { value: t || null, writable: true });\r\n\t\tthis.touch = this.getTouchObject();\r\n\t\tthis.touch.old = this.getTouchObject();\r\n\t\tthis.secondaryTouch = this.getTouchObject();\r\n\t\tthis.secondaryTouch.old = this.getTouchObject();\r\n\t\tt.settings.analyticsEnabled !== false && this.initAnalytics();\r\n\t\tthis.bindToMouseEvents()\r\n\t}\r\n\tinitAnalytics() {\r\n\t\tObject.defineProperty(this, 'analytics', {\r\n\t\t\tvalue: { clicks: 0 },\r\n\t\t\twritable: true\r\n\t\t})\r\n\t}\r\n\tgetTouchObject() {\r\n\t\treturn {\r\n\t\t\tid: null,\r\n\t\t\tdown: !1,\r\n\t\t\tpress: !1,\r\n\t\t\trelease: !1,\r\n\t\t\tpos: new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0),\r\n\t\t\treal: new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0),\r\n\t\t\ttype: 1\r\n\t\t}\r\n\t}\r\n\tbindToMouseEvents() {\r\n\t\tlet e = this.scene.game.canvas\r\n\t\t  , i = this.onMouseMove.bind(this)\r\n\t\t  , n = this.onMouseDown.bind(this)\r\n\t\t  , r = this.onMouseUp.bind(this);\r\n\t\te.addEventListener(\"pointermove\", i, { passive: true }),\r\n\t\te.addEventListener(\"pointerdown\", n, { passive: true }),\r\n\t\te.addEventListener(\"pointerup\", r, { passive: true }),\r\n\t\tObject.defineProperties(this, {\r\n\t\t\t_moveListener: { value: i, writable: true },\r\n\t\t\t_upListener: { value: r, writable: true },\r\n\t\t\t_downListener: { value: n, writable: true }\r\n\t\t});\r\n\t\tlet o = this.onMouseWheel.bind(this);\r\n\t\te.addEventListener(\"mousewheel\", o),\r\n\t\te.addEventListener(\"wheel\", o),\r\n\t\tObject.defineProperty(this, '_wheelListener', { value: o, writable: true })\r\n\t}\r\n\tcontextMenuHandler(t) {\r\n\t\treturn t.stopPropagation(),\r\n\t\tt.preventDefault(),\r\n\t\t!1\r\n\t}\r\n\tdisableContextMenu() {\r\n\t\tthis.scene.game.canvas.oncontextmenu = function() {\r\n\t\t\treturn !1\r\n\t\t}\r\n\t}\r\n\tonMouseDown(t) {\r\n\t\tthis.scene.game.canvas.setPointerCapture(t.pointerId),\r\n\t\tthis.analytics && this.analytics.clicks++,\r\n\t\t2 === t.button ? this.secondaryTouch.down === !1 && (this.updatePosition(t, this.secondaryTouch),\r\n\t\tthis.secondaryTouch.down = !0) : this.touch.down === !1 && (this.updatePosition(t, this.touch),\r\n\t\tthis.touch.down = !0,\r\n\t\tthis.scene.redrawControls())\r\n\t}\r\n\tonMouseMove(t) {\r\n\t\tthis.updatePosition(t, this.touch),\r\n\t\tthis.scene.redrawControls(),\r\n\t\tthis.updatePosition(t, this.secondaryTouch)\r\n\t}\r\n\tonMouseUp(t) {\r\n\t\tthis.scene.game.canvas.releasePointerCapture(t.pointerId),\r\n\t\t2 === t.button ? this.secondaryTouch.down === !0 && (this.updatePosition(t, this.secondaryTouch),\r\n\t\tthis.secondaryTouch.down = !1) : this.touch.down === !0 && (this.updatePosition(t, this.touch),\r\n\t\tthis.scene.interactWithControls(),\r\n\t\tthis.touch.down = !1,\r\n\t\tthis.scene.redrawControls())\r\n\t}\r\n\tonMouseWheel(t) {\r\n\t\tt.preventDefault(),\r\n\t\tt.stopPropagation();\r\n\t\tlet e = Math.max(-1, Math.min(1, -t.deltaY || -t.detail));\r\n\t\treturn 0 == e && (e = Math.max(-1, Math.min(1, t.deltaX || -t.detail))),\r\n\t\tthis.wheel = e,\r\n\t\t!1\r\n\t}\r\n\tupdate() {\r\n\t\tthis.enabled && (this.updateTouch(this.touch),\r\n\t\tthis.updateTouch(this.secondaryTouch),\r\n\t\tthis.updateWheel())\r\n\t}\r\n\tupdatePosition(t, e) {\r\n\t\te.id = t.pointerId,\r\n\t\te.type = t.button;\r\n\t\tlet i = e.pos;\r\n\t\ti.x = t.offsetX * window.devicePixelRatio,\r\n\t\ti.y = t.offsetY * window.devicePixelRatio,\r\n\t\tthis.updateRealPosition(e)\r\n\t}\r\n\tupdateRealPosition(t) {\r\n\t\tlet i = t.real;\r\n\t\ti.x = Math.round((t.pos.x - this.scene.screen.center.x) / this.scene.camera.zoom + this.scene.camera.position.x),\r\n\t\ti.y = Math.round((t.pos.y - this.scene.screen.center.y) / this.scene.camera.zoom + this.scene.camera.position.y);\r\n\t\tif (this.scene.toolHandler.options.grid) {\r\n\t\t\tlet p = this.scene.settings.toolHandler.gridSize | 0;\r\n\t\t\tif (lite.storage.get(\"isometricGrid\")) {\r\n\t\t\t\tconst c = (t, e) => ((t % e) + e) % e;\r\n\t\t\t\tlet g = p / 2\r\n\t\t\t\t  , adjusted = Math.round(i.x / p)\r\n\t\t\t\t  , k = c(adjusted, 2);\r\n\t\t\t\ti.x = adjusted * p;\r\n\t\t\t\ti.y = i.y - c(i.y + g * (k + 1), p) - (g * (k - 1)) + (k * g);\r\n\t\t\t} else {\r\n\t\t\t\ti.x = Math.round(i.x / p) * p\r\n\t\t\t\ti.y = Math.round(i.y / p) * p\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.updateCallback = !0\r\n\t}\r\n\tupdateTouch(t) {\r\n\t\tt.old.pos.x = t.pos.x,\r\n\t\tt.old.pos.y = t.pos.y,\r\n\t\tt.old.real.x = t.real.x,\r\n\t\tt.old.real.y = t.real.y,\r\n\t\t!t.old.down && t.down && (t.press = !0),\r\n\t\tt.old.down && !t.down && (t.release = !0),\r\n\t\tt.old.press && (t.press = !1),\r\n\t\tt.old.release && (t.release = !1),\r\n\t\tthis.updateRealPosition(t),\r\n\t\tt.old.down = t.down,\r\n\t\tt.old.press = t.press,\r\n\t\tt.old.release = t.release\r\n\t}\r\n\tupdateWheel() {\r\n\t\tthis.mousewheel = this.wheel,\r\n\t\tthis.wheel = !1\r\n\t}\r\n\tclose() {\r\n\t\tlet e = this.scene.game.canvas;\r\n\t\te.removeEventListener(\"mousewheel\", this._wheelListener),\r\n\t\te.removeEventListener(\"wheel\", this._wheelListener),\r\n\t\tthis.touches = null,\r\n\t\tthis.touch = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.wheel = null,\r\n\t\tthis._moveListener = null,\r\n\t\tthis._downListener = null,\r\n\t\tthis._upListener = null,\r\n\t\tthis._wheelListener = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/mousehandler.js?");

/***/ }),

/***/ "./src/game/class/utils/path.js":
/*!**************************************!*\
  !*** ./src/game/class/utils/path.js ***!
  \**************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tstart = null;\r\n\tend = null;\r\n\tverticies = [];\r\n\tbuild(t) {\r\n\t\tlet e = t.pop();\r\n\t\tthis.start = e.p1,\r\n\t\tthis.end = e.p2,\r\n\t\tthis.verticies.push(e);\r\n\t\tfor (let i = t.length, s = i - 1; s >= 0; s--) {\r\n\t\t\tlet n = t[s]\r\n\t\t\t  , r = n.p1\r\n\t\t\t  , o = n.p2;\r\n\t\t\tthis.start.x === o.x && this.start.y === o.y ? (this.verticies.unshift(n),\r\n\t\t\tthis.start = n.p1,\r\n\t\t\tt.splice(s, 1)) : this.end.x === r.x && this.end.y === r.y && (this.verticies.push(n),\r\n\t\t\tthis.end = n.p2,\r\n\t\t\tt.splice(s, 1))\r\n\t\t}\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/path.js?");

/***/ }),

/***/ "./src/game/class/utils/racetimes.js":
/*!*******************************************!*\
  !*** ./src/game/class/utils/racetimes.js ***!
  \*******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _interfaces_gui_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces/gui.js */ \"./src/game/class/interfaces/gui.js\");\n/* harmony import */ var _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces/component.js */ \"./src/game/class/interfaces/component.js\");\n/* harmony import */ var _interfaces_container_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces/container.js */ \"./src/game/class/interfaces/container.js\");\n/* harmony import */ var _formatnumber_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./formatnumber.js */ \"./src/game/class/utils/formatnumber.js\");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _interfaces_gui_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\traceCount = 0;\r\n\traceList = null;\r\n\thighlightedRace = null;\r\n\traceOpacity = .3;\r\n\traceYOffset = 20;\r\n\tmobileRaceXOffset = 72;\r\n\tmaxRaces = 10;\r\n\tconstructor(t) {\r\n\t\tsuper(t, {\r\n\t\t\tfont: { size: 10 },\r\n\t\t\tx: 6,\r\n\t\t\ty: 32\r\n\t\t}),\r\n\t\tthis.scene.game.settings.isCampaign && (this.container.y += 24),\r\n\t\tthis.maxRaces = this.scene.settings.mobile ? 3 : 10,\r\n\t\tthis.raceList = this.container.children\r\n\t}\r\n\taddRace(t, e) {\r\n\t\tif (this.raceCount < this.maxRaces) {\r\n\t\t\tlet i = this.scene\r\n\t\t\t  , r = t.user\r\n\t\t\t  , o = t.race\r\n\t\t\t  , a = i.settings\r\n\t\t\t  , h = a.drawFPS\r\n\t\t\t  , u = new _interfaces_container_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\r\n\t\t\t\t\talpha: this.raceOpacity,\r\n\t\t\t\t\tcolor: '#'.padEnd(7, /^midnight$/i.test(window.lite?.storage.get('theme')) ? 'd' : /^dark(er)?$/i.test(window.lite?.storage.get('theme')) ? 'f' : '0'),\r\n\t\t\t\t\tdata: t,\r\n\t\t\t\t\tinline: true,\r\n\t\t\t\t\ttextAlign: 'center',\r\n\t\t\t\t\ttextBaseline: 'middle'\r\n\t\t\t\t}, this.container);\r\n\t\t\ta.mobile ? u.x = e * this.mobileRaceXOffset : u.y = e * this.raceYOffset,\r\n\t\t\tu.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\t\tbackground: r.color,\r\n\t\t\t\tborder: 'round',\r\n\t\t\t\tfont: { size: 10 },\r\n\t\t\t\tradius: 8,\r\n\t\t\t\ttext: r.d_name.charAt(0).toUpperCase(),\r\n\t\t\t\ttextAlign: 'center'\r\n\t\t\t})),\r\n\t\t\tu.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\t\tfont: { size: 12 },\r\n\t\t\t\ttext: (0,_formatnumber_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(parseInt(o.run_ticks) / h * 1e3),\r\n\t\t\t\tx: 4,\r\n\t\t\t\ty: 2\r\n\t\t\t})),\r\n\t\t\tu.addChild(new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\r\n\t\t\t\tfont: { size: 12 },\r\n\t\t\t\ttext: '0/' + i.track.targetCount,\r\n\t\t\t\tx: 4,\r\n\t\t\t\ty: 2\r\n\t\t\t})),\r\n\t\t\tthis.raceCount++,\r\n\t\t\tthis.redraw()\r\n\t\t}\r\n\t}\r\n\tcenterContainer() {\r\n\t\tlet t = this.scene\r\n\t\t  , e = t.screen\r\n\t\t  , i = this.container\r\n\t\t  , s = i.width;\r\n\t\ti.x = e.width / 2 / window.devicePixelRatio - s / 2;\r\n\t\tt.settings.isCampaign && (i.visible = !1),\r\n\t\ti.y = 40\r\n\t}\r\n\tclear() {\r\n\t\tthis.container.children.splice(0),\r\n\t\tthis.raceCount = 0,\r\n\t\tthis.redraw()\r\n\t}\r\n\thighlightRace(t) {\r\n\t\tif (this.highlightedRace !== this.raceList[t]) {\r\n\t\t\tthis.unhighlightRace();\r\n\t\t\tlet e = this.raceList[t];\r\n\t\t\te.alpha = 1,\r\n\t\t\tthis.highlightedRace = e,\r\n\t\t\tthis.redraw()\r\n\t\t}\r\n\t}\r\n\tunhighlightRace() {\r\n\t\tthis.highlightedRace && (this.highlightedRace.alpha = this.raceOpacity,\r\n\t\tthis.highlightedRace = null,\r\n\t\tthis.redraw())\r\n\t}\r\n\tupdate() {\r\n\t\tif (this.raceCount > 0) {\r\n\t\t\tlet t = this.scene.camera;\r\n\t\t\tt.focusIndex > 0 && t.focusIndex < this.maxRaces ? this.highlightRace(t.focusIndex - 1) : this.unhighlightRace()\r\n\t\t}\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/racetimes.js?");

/***/ }),

/***/ "./src/game/class/utils/score.js":
/*!***************************************!*\
  !*** ./src/game/class/utils/score.js ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces/component.js */ \"./src/game/class/interfaces/component.js\");\n/* harmony import */ var _interfaces_gui_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces/gui.js */ \"./src/game/class/interfaces/gui.js\");\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _formatnumber_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./formatnumber.js */ \"./src/game/class/utils/formatnumber.js\");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _interfaces_gui_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\tpaused = !1;\r\n\tsprites = {};\r\n\tspriteSheet = {\r\n\t\ttimer: [2, 2, 58, 58],\r\n\t\ttimer_paused: [2, 62, 116, 118],\r\n\t\ttarget: [2, 2, 58, 58]\r\n\t}\r\n\ttime = new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n\t\ttext: '0:00.00',\r\n\t\tfont: { size: 16 },\r\n\t\tx: 23,\r\n\t\ty: 7\r\n\t}, this.container);\r\n\ttime_title = new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n\t\ttext: 'TIME:',\r\n\t\tcolor: '#999',\r\n\t\tx: 24,\r\n\t\ty: 2\r\n\t}, this.container);\r\n\ttimer_sprite = new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n\t\tcached: true,\r\n\t\timage: {\r\n\t\t\tx: 2,\r\n\t\t\ty: 2,\r\n\t\t\twidth: 58,\r\n\t\t\theight: 58\r\n\t\t},\r\n\t\twidth: 24,\r\n\t\theight: 24\r\n\t}, this.container);\r\n\tbest_time = new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n\t\ttext: '-- : --.--',\r\n\t\tcolor: '#999',\r\n\t\tfont: { size: 14 },\r\n\t\tx: 95,\r\n\t\ty: 8\r\n\t}, this.container);\r\n\tbest_time_title = new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n\t\ttext: 'BEST:',\r\n\t\tcolor: '#999',\r\n\t\tx: 96,\r\n\t\ty: 2\r\n\t}, this.container);\r\n\tgoals = new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n\t\ttext: '0/0',\r\n\t\tfont: { size: 16 },\r\n\t\tx: 185,\r\n\t\ty: 6\r\n\t}, this.container);\r\n\ttarget_sprite = new _interfaces_component_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n\t\tcached: true,\r\n\t\timage: {\r\n\t\t\tx: 2,\r\n\t\t\ty: 2,\r\n\t\t\twidth: 58,\r\n\t\t\theight: 58\r\n\t\t},\r\n\t\tx: 160,\r\n\t\twidth: 24,\r\n\t\theight: 24\r\n\t}, this.container);\r\n\tconstructor(t) {\r\n\t\tsuper(t, {\r\n\t\t\tfont: { size: 8 },\r\n\t\t\tx: 6,\r\n\t\t\ty: 4\r\n\t\t}),\r\n\t\tthis.sprites.timer = t.assets.getResult(\"time_icon\"),\r\n\t\tthis.sprites.target = t.assets.getResult(\"targets_icon\"),\r\n\t\tthis.timer_sprite.image.canvas = this.sprites.timer,\r\n\t\tthis.target_sprite.image.canvas = this.sprites.target\r\n\t}\r\n\tdraw(t) {\r\n\t\tsuper.draw(t);\r\n\t\tif (window.hasOwnProperty('lite') && lite.storage.get('raceProgress')) {\r\n\t\t\tlet e = this.scene.camera.playerFocus;\r\n\t\t\tif (e && this.scene.state.inFocus) {\r\n\t\t\t\tt.beginPath();\r\n\t\t\t\tlet i = t.canvas.width / 3\r\n\t\t\t\t, s = t.canvas.width / 2 - i / 2\r\n\t\t\t\t, n = t.canvas.height - 16\r\n\t\t\t\t, r = Math.min(6, t.canvas.height / 12)\r\n\t\t\t\t, o = r / 2;\r\n\t\t\t\tt.roundRect(s, n, i, r, o),\r\n\t\t\t\tt.fillStyle = 'hsl(0deg, 0%, 50%)',\r\n\t\t\t\tt.fill(),\r\n\t\t\t\tt.lineWidth = 2,\r\n\t\t\t\tt.strokeStyle = t.fillStyle,\r\n\t\t\t\tt.stroke(),\r\n\t\t\t\tt.beginPath();\r\n\t\t\t\tlet a = e._powerupsConsumed.targets\r\n\t\t\t\t, h = this.scene.track\r\n\t\t\t\t, u = a.length / h.targetCount\r\n\t\t\t\t, l = h.targets.find(t => t.id == (typeof a.at == 'function' ? a.at(-1) : a[a.length - 1])) || { x: 0, y: 0 }\r\n\t\t\t\t, p = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](l.x, l.y) // anchor point A\r\n\t\t\t\t, q = h.targets.filter(t => !a.includes(t.id)).sort((a, b) => p.sub(new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](a.x, a.y)).len() - p.sub(new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](b.x, b.y)).len())[0] // next target\r\n\t\t\t\t, v = q && new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](q.x, q.y)\r\n\t\t\t\t, w = (q && p.sub(v).len()) ?? 0 // len from previous target\r\n\t\t\t\t, y = (q && Math.min(...(e._tempVehicle || e._baseVehicle).masses.map(t => v.sub(t.pos).len() /* - ~~t.radius / 2*/).sort((a, b) => a - b))) ?? 0 // distance to next target\r\n\t\t\t\t, d = Math.min(1, Math.max(0, (w - y) / w)) * 100 / h.targetCount;\r\n\t\t\t\tu += d / 100;\r\n\t\t\t\tt.roundRect(s, n, Math.max(0, Math.min(i, i * u)), r, o),\r\n\t\t\t\tt.fillStyle = '#FAE335',\r\n\t\t\t\tt.fill()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tupdate() {\r\n\t\tlet t = this.scene\r\n\t\t  , e = t.state.paused\r\n\t\t  , i = (0,_formatnumber_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(1e3 * ((null !== t.camera.playerFocus && t.camera.playerFocus._gamepad.playbackTicks || null) ?? t.ticks) / t.settings.drawFPS)\r\n\t\t  , s = t.playerManager.firstPlayer.getTargetsHit() + '/' + t.track.targetCount\r\n\t\t  , n = t.settings.isCampaign && t.settings.campaignData.user.best_time || t.settings.userTrackStats && t.settings.userTrackStats.best_time;\r\n\t\tthis.paused !== e && (this.timer_sprite.image.y = e ? 62 : 2,\r\n\t\tthis.container.cached = !1,\r\n\t\tthis.paused = e);\r\n\t\tthis.time.text !== i && (this.time.text = i,\r\n\t\tthis.time.setDirty());\r\n\t\tthis.goals.text !== s && (this.goals.text = s,\r\n\t\tthis.goals.setDirty());\r\n\t\tn && this.best_time.text !== n && (this.best_time.text = n,\r\n\t\tthis.best_time.setDirty());\r\n\t\tt.settings.mobile && this.centerContainer()\r\n\t}\r\n\tcenterContainer() {\r\n\t\tlet t = this.container\r\n\t\t  , e = t.width\r\n\t\t  , i = this.scene.screen;\r\n\t\tt.x = i.width / 2 / window.devicePixelRatio - e / 2,\r\n\t\tt.y = 10\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/score.js?");

/***/ }),

/***/ "./src/game/class/utils/soundmanager.js":
/*!**********************************************!*\
  !*** ./src/game/class/utils/soundmanager.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tmuted = !1;\r\n\tsounds = new Map();\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'scene', { value: t || null, writable: true })\r\n\t}\r\n\tupdate() {\r\n\t\tlet e = this.scene;\r\n\t\tthis.muted = e.state.paused || e.settings.soundsEnabled === !1;\r\n\t\tfor (let i of this.sounds.values()) {\r\n\t\t\ti.muted = this.muted;\r\n\t\t\tif (i.paused && !e.state.paused) {\r\n\t\t\t\ti.play()\r\n\t\t\t\t.then(() => window.hasOwnProperty('lite') && lite._updateMediaSessionPosition());\r\n\t\t\t} else if (!i.paused && e.state.paused) {\r\n\t\t\t\ti.pause();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tsetVolume(t, e) {\r\n\t\tthis.sounds.has(t) && (this.sounds.get(t).volume = this.muted ? 0 : e ?? 1)\r\n\t}\r\n\tmute_all() {\r\n\t\tlet t = this.sounds;\r\n\t\tfor (let e in t)\r\n\t\t\tt[e].muted = true,\r\n\t\t\tt[e].volume = 0;\r\n\t\tthis.muted = !0\r\n\t}\r\n\tstop_all() {\r\n\t\tfor (let e in this.sounds)\r\n\t\t\tthis.stop(e)\r\n\t}\r\n\tplay(t, e) {\r\n\t\tif (!this.sounds.has(t) && this.scene.settings.soundsEnabled) {\r\n\t\t\tlet o = this.scene.assets.getItem(t)\r\n\t\t\t  , i = o && new Audio(o.src);\r\n\t\t\ti && (this.sounds.set(t, i),\r\n\t\t\t'mediaSession' in navigator && (i.addEventListener('play', () => {\r\n\t\t\t\tnavigator.mediaSession.playbackState = 'playing'\r\n\t\t\t}, { passive: true }),\r\n\t\t\ti.addEventListener('pause', () => {\r\n\t\t\t\tnavigator.mediaSession.playbackState = 'paused'\r\n\t\t\t}, { passive: true })),\r\n\t\t\ti.addEventListener('ended', () => {\r\n\t\t\t\tthis.sounds.delete(t)\r\n\t\t\t}, { passive: true }))\r\n\t\t}\r\n\r\n\t\tthis.setVolume(t, e)\r\n\t}\r\n\tstop(t) {\r\n\t\tthis.sounds.has(t) && (this.sounds.get(t).pause(),\r\n\t\tthis.sounds.delete(t))\r\n\t}\r\n\tclose() {\r\n\t\tthis.sounds = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/soundmanager.js?");

/***/ }),

/***/ "./src/game/class/utils/vehicletimer.js":
/*!**********************************************!*\
  !*** ./src/game/class/utils/vehicletimer.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tsettings = null;\r\n\tcontainer = {\r\n\t\tborderRadius: 25,\r\n\t\tfont: 17.5,\r\n\t\ttext: \"00:00\",\r\n\t\tscaleX: window.devicePixelRatio / 2,\r\n\t\tscaleY: window.devicePixelRatio / 2,\r\n\t\twidth: 200,\r\n\t\theight: 60,\r\n\t\tx: 100,\r\n\t\ty: 30\r\n\t}\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'scene', { value: t, writable: true }),\r\n\t\tthis.settings = t.settings,\r\n\t\tthis.removePlayer(),\r\n\t\tthis.createPulseTween()\r\n\t}\r\n\tsetPlayer(t) {\r\n\t\tthis.player = t\r\n\t}\r\n\tremovePlayer() {\r\n\t\tthis.player = !1\r\n\t}\r\n\tplayerAddedTime(t) {\r\n\t\tthis.player === t && this.createPulseTween()\r\n\t}\r\n\tcreatePulseTween() {\r\n\t\tlet i = this.scene.game.pixelRatio / 2\r\n\t\tthis.tweenRemaining = 200\r\n\t\tthis.tweenStart = i\r\n\t\tthis.tweenScale = 1.2 * i\r\n\t}\r\n\tcenter_container() {\r\n\t\tlet t = this.scene.screen\r\n\t\t  , e = this.container;\r\n\t\te.x = t.width / 2 - 100 * e.scaleX,\r\n\t\te.y = t.height - 100 * e.scaleY\r\n\t}\r\n\tdraw(t) {\r\n\t\tt.save();\r\n\t\tt.fillStyle = \"rgba(242,144,66,0.5)\";\r\n\t\tt.strokeStyle = \"rgba(242,144,66,1)\";\r\n\t\tt.lineWidth = 5 * window.devicePixelRatio / 2;\r\n\t\tt.beginPath();\r\n\t\tt.roundRect(this.container.x, this.container.y, this.container.width * this.container.scaleX, this.container.height * this.container.scaleY, this.container.borderRadius * this.container.scaleY);\r\n\t\tt.fill();\r\n\t\tt.stroke();\r\n\t\tt.font = this.container.font * window.devicePixelRatio + \"px helsinki\";\r\n\t\tt.fillStyle = \"#000\";\r\n\t\tt.textAlign = \"center\";\r\n\t\tt.textBaseline = \"middle\";\r\n\t\tt.fillText(this.container.text, this.container.x + this.container.width / 2 * this.container.scaleX, this.container.y + this.container.height / 2 * this.container.scaleY);\r\n\t\tt.restore()\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tif (this.tweenRemaining > 0) {\r\n\t\t\tthis.tweenRemaining = Math.max(this.tweenRemaining - 1000 / this.scene.game.settings.drawFPS)\r\n\t\t\tlet t = this.container\r\n\t\t\tt.scaleX = t.scaleY = t.scaleX * (1 - this.tweenRemaining / 100) + this.tweenScale * (this.tweenRemaining / 100)\r\n\t\t\tt.scaleX == this.tweenScale && (this.tweenScale = this.tweenStart)\r\n\t\t}\r\n\r\n\t\tthis.player && this.player._tempVehicleTicks > 0 ? (this.center_container(),\r\n\t\tthis.updateTime()) : this.container.visible = !1\r\n\t}\r\n\tupdateTime() {\r\n\t\tlet e = this.player._tempVehicleTicks\r\n\t\t  , i = this.scene.settings.drawFPS\r\n\t\t  , s = (e / i).toFixed(2)\r\n\t\t  , n = \"\";\r\n\t\t10 > s && (n = \"0\"),\r\n\t\tn += s,\r\n\t\tthis.container.text = n,\r\n\t\tthis.container.visible = true\r\n\t}\r\n\tclose() {\r\n\t\tthis.container = null,\r\n\t\tthis.player = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.settings = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/utils/vehicletimer.js?");

/***/ }),

/***/ "./src/game/class/vehicles/balloon.js":
/*!********************************************!*\
  !*** ./src/game/class/vehicles/balloon.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _canopy_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./canopy.js */ \"./src/game/class/vehicles/canopy.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _spring_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./spring.js */ \"./src/game/class/vehicles/spring.js\");\n/* harmony import */ var _vehicle_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./vehicle.js */ \"./src/game/class/vehicles/vehicle.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nlet h = {\r\n\tBALLOON_ON: \"balloon_on\"\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehicle_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"] {\r\n\tbasket = null;\r\n\thead = null;\r\n\toutline = \"#999\";\r\n\tvehicleName = \"BALLOON\";\r\n\tconstructor(t, e) {\r\n\t\tsuper(t),\r\n\t\tthis.createMasses(e),\r\n\t\tthis.createSprings(),\r\n\t\tthis.stopSounds(),\r\n\t\tthis.focalPoint = this.head\r\n\t}\r\n\tcreateMasses(t) {\r\n\t\tthis.masses = [];\r\n\t\tlet e = new _canopy_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t.x, t.y - 10, this);\r\n\t\te.radius = 30;\r\n\t\tlet i = new _mass_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x,t.y + 35), this);\r\n\t\ti.friction = .1,\r\n\t\tthis.masses.push(e),\r\n\t\tthis.masses.push(i),\r\n\t\tthis.head = this.masses[0],\r\n\t\tthis.basket = this.masses[1];\r\n\t\tlet r = this;\r\n\t\tthis.head.drive = function() {\r\n\t\t\tr.explode()\r\n\t\t}\r\n\t}\r\n\tupdateCameraFocalPoint() {}\r\n\tcreateSprings() {\r\n\t\tthis.springs = [];\r\n\t\tvar t = new _spring_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this.head,this.basket,this);\r\n\t\tt.springConstant = .2,\r\n\t\tt.dampConstant = .2,\r\n\t\tt.lrest = t.leff = 45,\r\n\t\tthis.springs.push(t)\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tif (this.crashed === !1 && this.updateSound(),\r\n\t\tthis.explosion)\r\n\t\t\tthis.explosion.fixedUpdate();\r\n\t\telse {\r\n\t\t\tthis.head.wind = !this.basket.contact,\r\n\t\t\tthis.slow = !1;\r\n\t\t\tfor (var t = this.springs, e = t.length, i = e - 1; i >= 0; i--)\r\n\t\t\t\tt[i].fixedUpdate();\r\n\t\t\tfor (var s = this.masses, n = s.length, r = n - 1; r >= 0; r--)\r\n\t\t\t\ts[r].fixedUpdate();\r\n\t\t\tfor (var i = e - 1; i >= 0; i--)\r\n\t\t\t\tt[i].fixedUpdate();\r\n\t\t\tfor (var r = n - 1; r >= 0; r--)\r\n\t\t\t\ts[r].fixedUpdate()\r\n\t\t}\r\n\t}\r\n\tupdate(progress) {\r\n\t\tfor (var t = this.masses, e = t.length, m = e - 1; m >= 0; m--)\r\n\t\t\tt[m].update(progress);\r\n\t}\r\n\tupdateSound() {\r\n\t\tif (this.player.isInFocus()) {\r\n\t\t\tvar t = this.scene.sound\r\n\t\t\t\t, e = this.gamepad;\r\n\t\t\te.isButtonDown(\"up\") ? t.play(h.BALLOON_ON, .6) : e.isButtonDown(\"up\") || t.stop(h.BALLOON_ON)\r\n\t\t}\r\n\t}\r\n\tstopSounds() {\r\n\t\tvar t = this.scene.sound;\r\n\t\tt.stop(h.BALLOON_ON)\r\n\t}\r\n\tdraw(t) {\r\n\t\tif (this.explosion)\r\n\t\t\tthis.explosion.draw(t, 1);\r\n\t\telse {\r\n\t\t\tif (this.scene.ticks > 0 && !this.player.isGhost()) {\r\n\t\t\t\tif (!this.scene.state.playing) {\r\n\t\t\t\t\tlet e = window.lite && parseInt(lite.storage.get(\"snapshots\"));\r\n\t\t\t\t\tif (e > 0) {\r\n\t\t\t\t\t\tfor (let i of this.player._checkpoints.filter((i, s, n) => s > n.length - (e + 1) && i._tempVehicle)) {\r\n\t\t\t\t\t\t\tt.globalAlpha = e / 3e2 * this.player._checkpoints.indexOf(i) % 1,\r\n\t\t\t\t\t\t\tthis.drawBalloon.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(i._tempVehicle)), t)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (let i of this.player._cache.filter((i, s, n) => s > n.length - (e + 1) && i._tempVehicle)) {\r\n\t\t\t\t\t\t\tt.globalAlpha = t / 3e2 * this.player._cache.indexOf(i) % 1,\r\n\t\t\t\t\t\t\tthis.drawBalloon.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(i._tempVehicle)), t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (window.lite && lite.storage.get(\"playerTrail\"))\r\n\t\t\t\t\tfor (let e of lite.snapshots.filter(t => t._tempVehicle)) {\r\n\t\t\t\t\t\tt.globalAlpha = lite.snapshots.length / (lite.snapshots.length * 200) * lite.snapshots.indexOf(e) % 1,\r\n\t\t\t\t\t\tthis.drawBalloon.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle)), t)\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.settings.developerMode)\r\n\t\t\t\tfor (var e = this.masses, i = e.length, s = i - 1; s >= 0; s--)\r\n\t\t\t\t\te[s].draw();\r\n\t\t\tt.globalAlpha = this.player._opacity,\r\n\t\t\tthis.drawBalloon(t),\r\n\t\t\tt.globalAlpha = 1\r\n\t\t}\r\n\t}\r\n\tdrawBalloon(t) {\r\n\t\tvar e = this.scene\r\n\t\t\t, i = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.basket.pos.x, this.basket.pos.y).toScreen(e)\r\n\t\t\t, m = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.head.pos.x, this.head.pos.y).toScreen(e)\r\n\t\t\t, n = e.camera.zoom\r\n\t\t\t, r = m.x - i.x\r\n\t\t\t, o = m.y - i.y\r\n\t\t\t, l = -o;\r\n\t\tt.save(),\r\n\t\tt.strokeStyle = window.lite.storage.get(\"theme\") === \"dark\" ? \"#666\" : this.outline,\r\n\t\tt.lineWidth = 1,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(i.x + .1 * l, i.y + .1 * r),\r\n\t\tt.lineTo(i.x + .5 * r + .39 * l, i.y + .5 * o + .39 * r),\r\n\t\tt.moveTo(i.x - .1 * l, i.y - .1 * r),\r\n\t\tt.lineTo(i.x + .5 * r - .39 * l, i.y + .5 * o - .39 * r),\r\n\t\tt.moveTo(i.x + .1 * l, i.y + .1 * r),\r\n\t\tt.lineTo(i.x + .4 * r + .21 * l, i.y + .4 * o + .21 * r),\r\n\t\tt.moveTo(i.x - .1 * l, i.y - .1 * r),\r\n\t\tt.lineTo(i.x + .4 * r - .21 * l, i.y + .4 * o - .21 * r),\r\n\t\tt.closePath(),\r\n\t\tt.stroke();\r\n\t\tlet head = new _canopy_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.head.pos.x, this.head.pos.y, this);\r\n\t\thead.radius = 30,\r\n\t\thead.draw(t),\r\n\t\tthis.gamepad.isButtonDown(\"up\") && (t.beginPath(),\r\n\t\tt.strokeStyle = \"#FFFF00\",\r\n\t\tt.lineWidth = 8 * n,\r\n\t\tt.moveTo(i.x, i.y),\r\n\t\tt.lineTo(i.x + .1 * r, i.y + .1 * o),\r\n\t\tt.closePath(),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.strokeStyle = \"#FFAA00\",\r\n\t\tt.lineWidth = 3 * n,\r\n\t\tt.moveTo(i.x, i.y),\r\n\t\tt.lineTo(i.x + .1 * r, i.y + .1 * o),\r\n\t\tt.closePath(),\r\n\t\tt.stroke()),\r\n\t\tt.beginPath(),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.moveTo(i.x + .1 * l, i.y + .1 * r),\r\n\t\tt.lineTo(i.x - .1 * l, i.y - .1 * r),\r\n\t\tt.lineTo(i.x - .22 * r - .1 * l, i.y - .22 * o - .1 * r),\r\n\t\tt.lineTo(i.x - .22 * r + .1 * l, i.y - .22 * o + .1 * r),\r\n\t\tt.lineTo(i.x + .1 * l, i.y + .1 * r),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.restore()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/balloon.js?");

/***/ }),

/***/ "./src/game/class/vehicles/bike.js":
/*!*****************************************!*\
  !*** ./src/game/class/vehicles/bike.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _ragdoll_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ragdoll.js */ \"./src/game/class/vehicles/ragdoll.js\");\n/* harmony import */ var _spring_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./spring.js */ \"./src/game/class/vehicles/spring.js\");\n/* harmony import */ var _vehicle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./vehicle.js */ \"./src/game/class/vehicles/vehicle.js\");\n\r\n\r\n\r\n\r\n\r\nlet d = {\r\n\tBIKE_GROUND: \"bike_ground\",\r\n\tBIKE_AIR: \"bike_air\",\r\n\tBIKE_FALL_1: \"bike_fall_1\",\r\n\tBIKE_FALL_2: \"bike_fall_2\",\r\n\tBIKE_FALL_3: \"bike_fall_3\"\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehicle_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n\tcosmeticHead = null;\r\n\tcosmeticRearWheel = null;\r\n\tcosmeticFrontWheel = null;\r\n\tpedala = 0;\r\n\tswapped = !1;\r\n\tragdoll = null;\r\n\tcreateSprings() {\r\n\t\tthis.springs = [];\r\n\t\tlet t = new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.head,this.rearWheel,this)\r\n\t\t  , e = new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.rearWheel,this.frontWheel,this)\r\n\t\t  , i = new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.frontWheel,this.head,this);\r\n\t\tthis.springs.push(t),\r\n\t\tthis.springs.push(e),\r\n\t\tthis.springs.push(i),\r\n\t\tthis.rearSpring = t,\r\n\t\tthis.chasse = e,\r\n\t\tthis.frontSpring = i\r\n\t}\r\n\tcreateRagdoll() {\r\n\t\tthis.ragdoll = new _ragdoll_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.getStickMan(),this),\r\n\t\tthis.ragdoll.zero(this.head.vel, this.rearWheel.vel),\r\n\t\tthis.ragdoll.dir = this.dir,\r\n\t\tthis.rearWheel.motor = 0,\r\n\t\tthis.rearWheel.brake = !1,\r\n\t\tthis.frontWheel.brake = !1,\r\n\t\tthis.head.collide = !1,\r\n\t\tthis.updateCameraFocalPoint(),\r\n\t\tthis.player.isInFocus() && this.playBailSound(),\r\n\t\tthis.dead()\r\n\t}\r\n\tplayBailSound() {\r\n\t\tlet t = this.scene.sound\r\n\t\t  , e = Math.min(this.speed / 50, 1)\r\n\t\t  , i = Math.floor(3 * Math.random()) + 1;\r\n\t\tswitch (i) {\r\n\t\tcase 1:\r\n\t\t\tt.play(d.BIKE_FALL_1, e);\r\n\t\t\tbreak;\r\n\t\tcase 2:\r\n\t\t\tt.play(d.BIKE_FALL_2, e);\r\n\t\t\tbreak;\r\n\t\tcase 3:\r\n\t\t\tt.play(d.BIKE_FALL_3, e)\r\n\t\t}\r\n\t}\r\n\tupdateCameraFocalPoint() {\r\n\t\tthis.focalPoint = this.ragdoll ? this.ragdoll.head : this.head\r\n\t}\r\n\tgetStickMan() {\r\n\t\tlet t = this.dir\r\n\t\t  , e = this.head\r\n\t\t  , i = this.frontWheel\r\n\t\t  , n = this.rearWheel\r\n\t\t  , r = this.pedala\r\n\t\t  , o = i.pos.sub(n.pos)\r\n\t\t  , a = e.pos.sub(i.pos.add(n.pos).factor(.5))\r\n\t\t  , h = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](o.y * t,-o.x * t)\r\n\t\t  , l = {};\r\n\t\tl.head = n.pos.add(o.factor(.35)).add(a.factor(1.2)),\r\n\t\tl.lHand = l.rHand = n.pos.add(o.factor(.8)).add(h.factor(.68));\r\n\t\tvar c = l.head.sub(l.lHand);\r\n\t\tc = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](c.y * t,-c.x * t),\r\n\t\tl.lElbow = l.rElbow = l.head.add(l.lHand).factor(.5).add(c.factor(130 / c.lenSqr())),\r\n\t\tl.waist = n.pos.add(o.factor(.2)).add(h.factor(.5));\r\n\t\tvar u = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](6 * Math.cos(r),6 * Math.sin(r));\r\n\t\treturn l.lFoot = n.pos.add(o.factor(.4)).add(h.factor(.05)).add(u),\r\n\t\tc = l.waist.sub(l.lFoot),\r\n\t\tc = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](-c.y * t,c.x * t),\r\n\t\tl.lKnee = l.waist.add(l.lFoot).factor(.5).add(c.factor(160 / c.lenSqr())),\r\n\t\tl.rFoot = n.pos.add(o.factor(.4)).add(h.factor(.05)).sub(u),\r\n\t\tc = l.waist.sub(l.rFoot),\r\n\t\tc = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](-c.y * t,c.x * t),\r\n\t\tl.rKnee = l.waist.add(l.rFoot).factor(.5).add(c.factor(160 / c.lenSqr())),\r\n\t\tl\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tif (this.crashed === !1 && (this.updateSound(),\r\n\t\tthis.control()),\r\n\t\tthis.explosion)\r\n\t\t\tthis.explosion.fixedUpdate();\r\n\t\telse {\r\n\t\t\tfor (let t = this.springs, e = t.length, i = e - 1; i >= 0; i--)\r\n\t\t\t\tt[i].fixedUpdate();\r\n\t\t\tfor (let s = this.masses, n = s.length, r = n - 1; r >= 0; r--)\r\n\t\t\t\ts[r].fixedUpdate()\r\n\t\t\tif (this.rearWheel.contact && this.frontWheel.contact && (this.slow = !1),\r\n\t\t\tthis.slow === !1) {\r\n\t\t\t\tthis.crashed === !1 && this.control()\r\n\t\t\t\tfor (let t = this.springs, e = t.length, i = e - 1; i >= 0; i--)\r\n\t\t\t\t\tt[i].fixedUpdate();\r\n\t\t\t\tfor (let s = this.masses, n = s.length, r = n - 1; r >= 0; r--)\r\n\t\t\t\t\ts[r].fixedUpdate()\r\n\t\t\t}\r\n\t\t\tthis.ragdoll ? this.ragdoll.fixedUpdate() : this.updateDrawHeadAngle()\r\n\t\t}\r\n\t\tthis.updateCameraFocalPoint()\r\n\t}\r\n\tupdateSound() {\r\n\t\tif (this.player.isInFocus()) {\r\n\t\t\tthis.updateSpeed();\r\n\t\t\tlet t = Math.min(this.speed / 50, 1)\r\n\t\t\t  , e = this.scene.sound;\r\n\t\t\tthis.rearWheel.contact || this.frontWheel.contact ? (e.play(d.BIKE_GROUND, t),\r\n\t\t\te.stop(d.BIKE_AIR)) : (e.play(d.BIKE_AIR, t),\r\n\t\t\te.stop(d.BIKE_GROUND))\r\n\t\t}\r\n\t}\r\n\tstopSounds() {\r\n\t\tlet t = this.scene.sound;\r\n\t\tt.stop(d.BIKE_AIR),\r\n\t\tt.stop(d.BIKE_GROUND)\r\n\t}\r\n\tswap() {\r\n\t\tthis.dir = -1 * this.dir,\r\n\t\tthis.chasse.swap();\r\n\t\tlet t = this.rearSpring.leff;\r\n\t\tthis.rearSpring.leff = this.frontSpring.leff,\r\n\t\tthis.frontSpring.leff = t\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tif (this.explosion) {\r\n\t\t\tthis.explosion.draw(ctx, 1);\r\n\t\t\treturn;\r\n\t\t} else if (this.scene.ticks > 0 && !this.player.isGhost()) {\r\n\t\t\tif (!this.scene.state.playing) {\r\n\t\t\t\tlet t = window.lite && parseInt(lite.storage.get(\"snapshots\"));\r\n\t\t\t\tif (t > 0) {\r\n\t\t\t\t\tfor (let e of this.player._checkpoints.filter((e, i, s) => i > s.length - (t + 1) && e._baseVehicle))\r\n\t\t\t\t\t\tthis.drawBikeFrame.call(Object.assign({}, this, { scene: this.scene }, JSON.parse(e._baseVehicle)), ctx, t / 3e2 * this.player._checkpoints.indexOf(e) % 1);\r\n\t\t\t\t\tfor (let e of this.player._cache.filter((e, i, s) => i > s.length - (t + 1) && e._baseVehicle))\r\n\t\t\t\t\t\tthis.drawBikeFrame.call(Object.assign({}, this, { scene: this.scene }, JSON.parse(e._baseVehicle)), ctx, t / 3e2 * this.player._cache.indexOf(e) % 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (window.lite && lite.storage.get(\"playerTrail\")) {\r\n\t\t\t\tfor (let e of lite.snapshots.filter(t => t._baseVehicle))\r\n\t\t\t\t\tthis.drawBikeFrame.call(Object.assign({}, this, { scene: this.scene }, JSON.parse(e._baseVehicle)), ctx, lite.snapshots.length / (lite.snapshots.length * 200) * lite.snapshots.indexOf(e) % 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (ctx.imageSmoothingEnabled = !0,\r\n\t\tctx.mozImageSmoothingEnabled = !0,\r\n\t\tctx.webkitImageSmoothingEnabled = !0,\r\n\t\tthis.settings.developerMode)\r\n\t\t\tfor (var e = this.masses, i = e.length, s = i - 1; s >= 0; s--)\r\n\t\t\t\te[s].draw(ctx);\r\n\t\tthis.drawBikeFrame(ctx)\r\n\t}\r\n\tupdateDrawHeadAngle() {\r\n\t\tlet t = this.frontWheel.pos\r\n\t\t  , e = this.rearWheel.pos\r\n\t\t  , i = t.x\r\n\t\t  , s = t.y\r\n\t\t  , n = e.x\r\n\t\t  , r = e.y\r\n\t\t  , o = i - n\r\n\t\t  , a = s - r;\r\n\t\tthis.drawHeadAngle = -(Math.atan2(o, a) - Math.PI / 2)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/bike.js?");

/***/ }),

/***/ "./src/game/class/vehicles/blob.js":
/*!*****************************************!*\
  !*** ./src/game/class/vehicles/blob.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _wheel_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./wheel.js */ \"./src/game/class/vehicles/wheel.js\");\n/* harmony import */ var _spring_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./spring.js */ \"./src/game/class/vehicles/spring.js\");\n/* harmony import */ var _vehicle_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./vehicle.js */ \"./src/game/class/vehicles/vehicle.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nlet l = {\r\n\tBLOB: \"blob_sound\"\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehicle_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"] {\r\n\tvehicleName = \"Blob\";\r\n\tconstructor(t, e) {\r\n\t\tsuper(t),\r\n\t\tthis.createMasses(e),\r\n\t\tthis.createSprings(),\r\n\t\tthis.stopSounds()\r\n\t}\r\n\tcreateMasses(t) {\r\n\t\tlet e = [];\r\n\t\te.push(new _wheel_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 15,t.y + 40),this)),\r\n\t\te.push(new _wheel_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + -15,t.y + 40),this)),\r\n\t\te.push(new _wheel_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + -15,t.y + 10),this)),\r\n\t\te.push(new _wheel_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 15,t.y + 10),this));\r\n\t\tlet i = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0), this);\r\n\t\ti.vel = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0),\r\n\t\tthis.m0 = e[0],\r\n\t\tthis.m1 = e[1],\r\n\t\tthis.m2 = e[2],\r\n\t\tthis.m3 = e[3],\r\n\t\tthis.head = i,\r\n\t\tthis.masses = e,\r\n\t\tthis.focalPoint = this.head\r\n\t}\r\n\tcreateSprings() {\r\n\t\tlet t = this.masses\r\n\t\t  , e = []\r\n\t\t  , i = this.spring0 = new _spring_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](t[0],t[1],this)\r\n\t\t  , s = this.spring1 = new _spring_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](t[1],t[2],this)\r\n\t\t  , n = this.spring2 = new _spring_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](t[2],t[3],this)\r\n\t\t  , r = this.spring3 = new _spring_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](t[3],t[0],this)\r\n\t\t  , o = this.spring4 = new _spring_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](t[0],t[2],this)\r\n\t\t  , h = this.spring5 = new _spring_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](t[1],t[3],this);\r\n\t\te.push(i),\r\n\t\te.push(s),\r\n\t\te.push(n),\r\n\t\te.push(r),\r\n\t\te.push(o),\r\n\t\te.push(h);\r\n\t\tfor (let l in e)\r\n\t\t\te[l].springConstant = .2,\r\n\t\t\te[l].dampConstant = .2;\r\n\t\tthis.springs = e\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tif (this.crashed === !1 && (this.updateSound(),\r\n\t\tthis.control()),\r\n\t\tthis.explosion)\r\n\t\t\tthis.explosion.fixedUpdate();\r\n\t\telse {\r\n\t\t\tlet t = this.masses\r\n\t\t\t  , e = t.length\r\n\t\t\t  , i = this.springs\r\n\t\t\t  , n = i.length;\r\n\t\t\tfor (var s = n - 1; s >= 0; s--)\r\n\t\t\t\ti[s].fixedUpdate();\r\n\t\t\tfor (var m = e - 1; m >= 0; m--)\r\n\t\t\t\tt[m].fixedUpdate();\r\n\t\t\tif ((t[0].contact || t[1].contact || t[2].contact || t[3].contact) && (this.slow = !1),\r\n\t\t\t!this.slow) {\r\n\t\t\t\tfor (this.control(),\r\n\t\t\t\ts = n - 1; s >= 0; s--)\r\n\t\t\t\t\ti[s].fixedUpdate();\r\n\t\t\t\tfor (m = e - 1; m >= 0; m--)\r\n\t\t\t\t\tt[m].fixedUpdate()\r\n\t\t\t}\r\n\t\t\tlet r = 0,\r\n\t\t\t\to = 0;\r\n\t\t\tfor (let t of this.masses)\r\n\t\t\t\tr += t.pos.x,\r\n\t\t\t\to += t.pos.y;\r\n\t\t\tlet a = this.head;\r\n\t\t\ta.pos.x = .25 * r,\r\n\t\t\ta.pos.y = .25 * o,\r\n\t\t\ta.vel = t[0].vel\r\n\t\t}\r\n\t}\r\n\tupdate(progress) {\r\n\t\tfor (let t = this.masses, e = t.length, m = e - 1; m >= 0; m--)\r\n\t\t\tt[m].update(progress);\r\n\t}\r\n\tupdateSound() {\r\n\t\tif (this.player.isInFocus()) {\r\n\t\t\tlet t = this.scene.sound;\r\n\t\t\tt.play(l.BLOB, .4)\r\n\t\t}\r\n\t}\r\n\tstopSounds() {\r\n\t\tlet t = this.scene.sound;\r\n\t\tt.stop(l.BLOB)\r\n\t}\r\n\tupdateCameraFocalPoint() {}\r\n\tcontrol() {\r\n\t\tlet t, e, i = this.player.getGamepad(), s = i.isButtonDown(\"up\"), n = i.isButtonDown(\"down\"), r = i.isButtonDown(\"left\"), o = i.isButtonDown(\"right\"), a = i.isButtonDown(\"z\"), h = this.masses, l = this.springs, c = h.length, u = l.length, p = this.dir;\r\n\t\tp = o ? 1 : -1;\r\n\t\tlet d = o || r ? 1 : 0;\r\n\t\tfor (n && (d = 0),\r\n\t\tt = c - 1; t >= 0; t--)\r\n\t\t\th[t].motor += (d * p * 1 - h[t].motor) / 10,\r\n\t\t\t0 == d && (h[t].motor = 0),\r\n\t\t\th[t].brake = n;\r\n\t\tlet f = r ? 1 : 0;\r\n\t\tif (f += o ? -1 : 0,\r\n\t\tl[4].rotate(f / 9),\r\n\t\tl[5].rotate(f / 9),\r\n\t\ta || s)\r\n\t\t\tfor (e = u - 1; e >= 0; e--)\r\n\t\t\t\tl[e].contract(30, 10);\r\n\t\telse\r\n\t\t\tfor (e = u - 1; e >= 0; e--)\r\n\t\t\t\tl[e].contract(0, 1.5)\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tif (this.explosion)\r\n\t\t\tthis.explosion.draw(ctx, 1);\r\n\t\telse {\r\n\t\t\tif (this.scene.ticks > 0 && !this.player.isGhost()) {\r\n\t\t\t\tif (!this.scene.state.playing) {\r\n\t\t\t\t\tlet t = window.lite && lite.storage.get(\"snapshots\");\r\n\t\t\t\t\tif (t > 0) {\r\n\t\t\t\t\t\tfor (let e of this.player._checkpoints.filter((e, i, s) => i > s.length - (t + 1) && e._tempVehicle))\r\n\t\t\t\t\t\t\tthis.drawBlob.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle)), ctx, t / 3e2 * this.player._checkpoints.indexOf(e) % 1);\r\n\t\t\t\t\t\tfor (let e of this.player._cache.filter((e, i, s) => i > s.length - (t + 1) && e._tempVehicle))\r\n\t\t\t\t\t\t\tthis.drawBlob.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle)), ctx, t / 3e2 * this.player._cache.indexOf(e) % 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (window.lite && lite.storage.get(\"playerTrail\")) {\r\n\t\t\t\t\tfor (let e of lite.snapshots.filter(t => t._tempVehicle))\r\n\t\t\t\t\t\tthis.drawBlob.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle)), ctx, lite.snapshots.length / (lite.snapshots.length * 200) * lite.snapshots.indexOf(e) % 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.drawBlob(ctx);\r\n\t\t}\r\n\t}\r\n\r\n\tdrawBlob(t, alpha = this.player._opacity) {\r\n\t\tlet i = this.scene\r\n\t\t  , s = i.camera.zoom\r\n\t\t  , m = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.m0.pos.x, this.m0.pos.y).toScreen(i)\r\n\t\t  , r = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.m1.pos.x, this.m1.pos.y).toScreen(i)\r\n\t\t  , o = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.m2.pos.x, this.m2.pos.y).toScreen(i)\r\n\t\t  , a = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.m3.pos.x, this.m3.pos.y).toScreen(i);\r\n\t\tt.globalAlpha = alpha,\r\n\t\tt.beginPath(),\r\n\t\tt.fillStyle = this.color,\r\n\t\tt.lineWidth = 20 * s,\r\n\t\tt.lineCap = \"round\",\r\n\t\tt.moveTo(m.x, m.y),\r\n\t\tt.lineTo(r.x, r.y),\r\n\t\tt.lineTo(o.x, o.y),\r\n\t\tt.lineTo(a.x, a.y),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.stroke(),\r\n\t\tt.globalAlpha = 1\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/blob.js?");

/***/ }),

/***/ "./src/game/class/vehicles/bmx.js":
/*!****************************************!*\
  !*** ./src/game/class/vehicles/bmx.js ***!
  \****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _bike_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./bike.js */ \"./src/game/class/vehicles/bike.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _wheel_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./wheel.js */ \"./src/game/class/vehicles/wheel.js\");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _bike_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\tvehicleName = \"BMX\";\r\n\tconstructor(t, e, i, s) {\r\n\t\tsuper(t);\r\n\t\tthis.createMasses(e, s);\r\n\t\tthis.createSprings();\r\n\t\tthis.updateCameraFocalPoint();\r\n\t\tthis.stopSounds();\r\n\t\t-1 === i && this.swap();\r\n\t}\r\n\tcreateMasses(t, e) {\r\n\t\tthis.masses = [];\r\n\t\tvar i = new _mass_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x,t.y - 36), this)\r\n\t\t  , r = new _wheel_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 21,t.y + 3), this)\r\n\t\t  , o = new _wheel_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + -21,t.y + 3), this);\r\n\t\ti.drive = this.createRagdoll.bind(this),\r\n\t\to.radius = 11.7,\r\n\t\tr.radius = 11.7,\r\n\t\ti.radius = 14,\r\n\t\ti.vel.equ(e),\r\n\t\to.vel.equ(e),\r\n\t\tr.vel.equ(e),\r\n\t\tthis.masses.push(i),\r\n\t\tthis.masses.push(o),\r\n\t\tthis.masses.push(r),\r\n\t\tthis.head = i,\r\n\t\tthis.frontWheel = r,\r\n\t\tthis.rearWheel = o\r\n\t}\r\n\tcreateSprings() {\r\n\t\tsuper.createSprings(),\r\n\t\tthis.chasse.lrest = 42,\r\n\t\tthis.chasse.leff = 42,\r\n\t\tthis.chasse.springConstant = .35,\r\n\t\tthis.chasse.dampConstant = .3,\r\n\t\tthis.rearSpring.lrest = 45,\r\n\t\tthis.rearSpring.leff = 45,\r\n\t\tthis.rearSpring.springConstant = .35,\r\n\t\tthis.rearSpring.dampConstant = .3,\r\n\t\tthis.frontSpring.lrest = 45,\r\n\t\tthis.frontSpring.leff = 45,\r\n\t\tthis.frontSpring.springConstant = .35,\r\n\t\tthis.frontSpring.dampConstant = .3\r\n\t}\r\n\tcontrol() {\r\n\t\tlet t = this.gamepad\r\n\t\t  , e = t.isButtonDown(\"up\")\r\n\t\t  , i = t.isButtonDown(\"down\")\r\n\t\t  , s = t.isButtonDown(\"left\")\r\n\t\t  , n = t.isButtonDown(\"right\")\r\n\t\t  , r = t.isButtonDown(\"z\")\r\n\t\t  , a = this.rearWheel;\r\n\t\ta.motor += (e - a.motor) / 10,\r\n\t\tr && !this.swapped && (this.swap(),\r\n\t\tthis.swapped = !0),\r\n\t\tr || (this.swapped = !1),\r\n\t\te && (this.pedala += this.rearWheel.speed / 5),\r\n\t\ta.brake = i,\r\n\t\ti && this.frontSpring.contract(-10, 10),\r\n\t\tthis.frontWheel.brake = this.dir > 0 && n && i ? !0 : this.dir < 0 && s && i ? !0 : !1;\r\n\t\tlet h = s - n;\r\n\t\tthis.rearSpring.contract(5 * h * this.dir, 5),\r\n\t\tthis.frontSpring.contract(5 * -h * this.dir, 5),\r\n\t\tthis.chasse.rotate(h / 6),\r\n\t\t!h && e && (this.rearSpring.contract(-7, 5),\r\n\t\tthis.frontSpring.contract(7, 5))\r\n\t}\r\n\tdrawBikeFrame(u, r = this.player._opacity) {\r\n\t\tlet t = this.scene\r\n\t\t  , rearWheel = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.rearWheel.pos.x, this.rearWheel.pos.y)\r\n\t\t  , frontWheel = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.frontWheel.pos.x, this.frontWheel.pos.y)\r\n\t\t  , head = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.head.pos.x, this.head.pos.y)\r\n\t\t  , e = rearWheel.toScreen(t)\r\n\t\t  , i = frontWheel.toScreen(t)\r\n\t\t  , n = head.toScreen(t)\r\n\t\t  , o = i.sub(e)\r\n\t\t  , l = this.dir\r\n\t\t  , a = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]((i.y - e.y) * l, (e.x - i.x) * l)\r\n\t\t  , h = this.pedala\r\n\t\t  , c = t.camera.zoom\r\n\t\t  , q = t.settings.physicsLineColor;\r\n\t\tu.globalAlpha = r,\r\n\t\tu.strokeStyle = this.frontWheel.color || q,\r\n\t\tu.lineWidth = 3 * c,\r\n\t\tu.beginPath(),\r\n\t\tu.fillStyle = t.settings.sceneryLineColor.padEnd(7, t.settings.sceneryLineColor.slice(1, 4)) + '33', // \"rgba(200,200,200,0.2)\",\r\n\t\tu.arc(i.x, i.y, 10.5 * c, 0, 2 * Math.PI, !1),\r\n\t\tu.fill(),\r\n\t\tu.stroke(),\r\n\t\tthis.rearWheel.color && (u.strokeStyle = this.rearWheel.color),\r\n\t\tu.beginPath(),\r\n\t\tu.arc(e.x, e.y, 10.5 * c, 0, 2 * Math.PI, !1),\r\n\t\tu.fill(),\r\n\t\tu.stroke();\r\n\t\tlet p = e.add(o.factor(.3)).add(a.factor(.25))\r\n\t\t  , d = e.add(o.factor(.4)).add(a.factor(.05))\r\n\t\t  , f = e.add(o.factor(.84)).add(a.factor(.42))\r\n\t\t  , v = e.add(o.factor(.84)).add(a.factor(.37));\r\n\t\tu.beginPath(),\r\n\t\tu.strokeStyle = this.color,\r\n\t\tu.moveTo(e.x, e.y),\r\n\t\tu.lineTo(p.x, p.y),\r\n\t\tu.lineTo(f.x, f.y),\r\n\t\tu.moveTo(v.x, v.y),\r\n\t\tu.lineTo(d.x, d.y),\r\n\t\tu.lineTo(e.x, e.y),\r\n\t\tu.stroke(),\r\n\t\tu.beginPath(),\r\n\t\tu.strokeStyle = this.color,\r\n\t\tu.lineWidth = Math.max(1 * c, .5),\r\n\t\tu.arc(d.x, d.y, 3 * c, 0, 2 * Math.PI, !1),\r\n\t\tu.stroke();\r\n\t\tlet g = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](6 * Math.cos(h) * c,6 * Math.sin(h) * c)\r\n\t\t  , m = d.add(g)\r\n\t\t  , y = d.sub(g);\r\n\t\tu.beginPath(),\r\n\t\tu.moveTo(m.x, m.y),\r\n\t\tu.lineTo(y.x, y.y),\r\n\t\tu.stroke();\r\n\t\tlet w = e.add(o.factor(.25)).add(a.factor(.4))\r\n\t\t  , x = e.add(o.factor(.17)).add(a.factor(.38))\r\n\t\t  , _ = e.add(o.factor(.3)).add(a.factor(.45));\r\n\t\tu.beginPath(),\r\n\t\tu.strokeStyle = this.color,\r\n\t\tu.lineWidth = 3 * c,\r\n\t\tu.moveTo(x.x, x.y),\r\n\t\tu.lineTo(_.x, _.y),\r\n\t\tu.moveTo(d.x, d.y),\r\n\t\tu.lineTo(w.x, w.y);\r\n\t\tlet b = e.add(o.factor(1)).add(a.factor(0))\r\n\t\t  , T = e.add(o.factor(.97)).add(a.factor(0))\r\n\t\t  , C = e.add(o.factor(.8)).add(a.factor(.48));\r\n\t\tu.moveTo(b.x, b.y),\r\n\t\tu.lineTo(T.x, T.y),\r\n\t\tu.lineTo(C.x, C.y);\r\n\t\tlet k = e.add(o.factor(.86)).add(a.factor(.5))\r\n\t\t  , S = e.add(o.factor(.82)).add(a.factor(.65))\r\n\t\t  , P = e.add(o.factor(.78)).add(a.factor(.67));\r\n\t\tu.lineTo(k.x, k.y),\r\n\t\tu.lineTo(S.x, S.y),\r\n\t\tu.lineTo(P.x, P.y),\r\n\t\tu.stroke();\r\n\t\tif (this.crashed) {\r\n\t\t\tthis.ragdoll && this.ragdoll.draw(u);\r\n\t\t} else {\r\n\t\t\ta = n.sub(e.add(o.factor(.5)));\r\n\t\t\tlet M = p.add(o.factor(-.1)).add(a.factor(.3))\r\n\t\t\t  , A = m.sub(M)\r\n\t\t\t  , D = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](A.y * l,-A.x * l);\r\n\t\t\tD = D.factor(c * c);\r\n\t\t\tlet I = M.add(A.factor(.5)).add(D.factor(200 / A.lenSqr()))\r\n\t\t\t  , E = m.add(A.factor(.12)).add(D.factor(50 / A.lenSqr()));\r\n\t\t\tA = y.sub(M),\r\n\t\t\tD = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](A.y * l,-A.x * l),\r\n\t\t\tD = D.factor(c * c);\r\n\t\t\tlet O = M.add(A.factor(.5)).add(D.factor(200 / A.lenSqr()))\r\n\t\t\t  , z = y.add(A.factor(.12)).add(D.factor(50 / A.lenSqr()));\r\n\t\t\tu.strokeStyle = q.padEnd(7, q.slice(1, 4)) + Math.min(255, Math.round(255 * .5 * r)).toString(16)\r\n\t\t\tu.lineWidth = 6 * c,\r\n\t\t\tu.beginPath(),\r\n\t\t\tu.moveTo(y.x, y.y),\r\n\t\t\tu.lineTo(O.x, O.y),\r\n\t\t\tu.lineTo(M.x, M.y),\r\n\t\t\tu.stroke(),\r\n\t\t\tu.lineWidth = 4 * c,\r\n\t\t\tu.beginPath(),\r\n\t\t\tu.moveTo(y.x, y.y),\r\n\t\t\tu.lineTo(z.x, z.y),\r\n\t\t\tu.stroke(),\r\n\t\t\tu.lineWidth = 6 * c,\r\n\t\t\tu.strokeStyle = q,\r\n\t\t\tu.beginPath(),\r\n\t\t\tu.moveTo(M.x, M.y),\r\n\t\t\tu.lineTo(I.x, I.y),\r\n\t\t\tu.lineTo(m.x, m.y),\r\n\t\t\tu.lineTo(E.x, E.y),\r\n\t\t\tu.stroke();\r\n\t\t\tlet j = p.add(o.factor(.05)).add(a.factor(.9));\r\n\t\t\tu.lineWidth = 8 * c,\r\n\t\t\tu.beginPath(),\r\n\t\t\tu.moveTo(M.x, M.y),\r\n\t\t\tu.lineTo(j.x, j.y),\r\n\t\t\tu.stroke();\r\n\t\t\tlet L = p.add(o.factor(.15)).add(a.factor(1.05));\r\n\t\t\to = j.sub(P),\r\n\t\t\ta = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](o.y * l,-o.x * l),\r\n\t\t\ta = a.factor(c * c);\r\n\t\t\tlet B = P.add(o.factor(.4)).add(a.factor(130 / o.lenSqr()));\r\n\t\t\tu.lineWidth = 5 * c,\r\n\t\t\tu.beginPath(),\r\n\t\t\tu.moveTo(j.x, j.y),\r\n\t\t\tu.lineTo(B.x, B.y),\r\n\t\t\tu.lineTo(P.x, P.y),\r\n\t\t\tu.stroke();\r\n\t\t\tlet R = GameInventoryManager.getItem(this.cosmetics.head);\r\n\t\t\tR.draw(u, L.x, L.y, this.drawHeadAngle, c, this.dir),\r\n\t\t\tu.globalAlpha = 1\r\n\t\t}\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/bmx.js?");

/***/ }),

/***/ "./src/game/class/vehicles/canopy.js":
/*!*******************************************!*\
  !*** ./src/game/class/vehicles/canopy.js ***!
  \*******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _mass_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\twind = !0;\r\n\tconstructor(t, e, i) {\r\n\t\tsuper(new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, e), i);\r\n\t}\r\n\tdrive(t, e) {\r\n\t\tthis.pos.x += .05 * t * -t * (t * this.vel.x + e * this.vel.y),\r\n\t\tthis.contact = !0\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tlet t = this.vel\r\n\t\t  , e = this.pos\r\n\t\t  , i = this.old\r\n\t\t  , s = this.parent.gravity\r\n\t\t  , n = this.parent.gamepad\r\n\t\t  , r = n.isButtonDown(\"up\")\r\n\t\t  , o = n.isButtonDown(\"left\")\r\n\t\t  , a = n.isButtonDown(\"right\");\r\n\t\t(0 !== s.x || 0 !== s.y) && (t.x = .9 * t.x,\r\n\t\tt.y = .99 * t.y),\r\n\t\to && (e.x += -.05),\r\n\t\ta && (e.x += .05),\r\n\t\t(0 !== s.x || 0 !== s.y) && (e.y += -.1),\r\n\t\tr && (e.y += -.5),\r\n\t\tthis.wind && (e.x += .3),\r\n\t\te.x += t.x,\r\n\t\te.y += t.y,\r\n\t\tthis.contact = !1,\r\n\t\tthis.collide && this.scene.track.collide(this),\r\n\t\t(0 !== s.x || 0 !== s.y) && (t.x = e.x - i.x,\r\n\t\tt.y = e.y - i.y),\r\n\t\ti.x = e.x,\r\n\t\ti.y = e.y\r\n\t}\r\n\tdraw(t) {\r\n\t\tlet e = this.scene\r\n\t\t  , i = this.pos.toScreen(e)\r\n\t\t  , s = this.radius * e.camera.zoom;\r\n\t\tt.beginPath(),\r\n\t\tt.fillStyle = this.scene.settings.physicsLineColor,\r\n\t\tt.arc(i.x, i.y, s, 0, 2 * Math.PI, !1),\r\n\t\tt.closePath(),\r\n\t\tt.fill()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/canopy.js?");

/***/ }),

/***/ "./src/game/class/vehicles/debris.js":
/*!*******************************************!*\
  !*** ./src/game/class/vehicles/debris.js ***!
  \*******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n\r\n\r\nlet l = [1, .7, .8, .9, .5, 1, .7, 1];\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _mass_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tangle = 6.2 * Math.random();\r\n\tcolor = \"black\";\r\n\tfriction = .05;\r\n\tradius = 2 * Math.random() * 5;\r\n\tspeed = 1 * Math.random() - 1 * Math.random();\r\n\tconstructor(t, e, i) {\r\n\t\tsuper(t, e);\r\n\t\tthis.color = i;\r\n\t\tthis.pos.x = t.x + 5 * (Math.random() - Math.random());\r\n\t\tthis.pos.y = t.y + 5 * (Math.random() - Math.random());\r\n\t\tthis.old.x = this.pos.x;\r\n\t\tthis.old.y = this.pos.y;\r\n\t\tthis.vel.y = 11 * (Math.random() - Math.random());\r\n\t\tthis.vel.x = 11 * (Math.random() - Math.random());\r\n\t}\r\n\tdrive(t, e) {\r\n\t\tlet i = this.vel\r\n\t\t  , s = this.pos;\r\n\t\tthis.speed = (t * i.x + e * i.y) / this.radius,\r\n\t\tthis.angle += this.speed;\r\n\t\tlet n = -(t * i.x + e * i.y) * this.friction;\r\n\t\ts.x += t * n,\r\n\t\ts.y += e * n;\r\n\t\tlet a = Math.sqrt(Math.pow(t, 2) + Math.pow(e, 2));\r\n\t\tif (a > 0) {\r\n\t\t\tlet h = -e / a\r\n\t\t\t  , l = t / a\r\n\t\t\t  , c = .8 * (h * i.x + l * i.y);\r\n\t\t\tthis.old.x += h * c,\r\n\t\t\tthis.old.y += l * c\r\n\t\t}\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tthis.angle += this.speed,\r\n\t\tsuper.fixedUpdate()\r\n\t}\r\n\tdraw(d) {\r\n\t\tlet t = this.scene.screen\r\n\t\t  , e = this.scene.camera\r\n\t\t  , i = t.realToScreen(this.pos.x, \"x\")\r\n\t\t  , s = t.realToScreen(this.pos.y, \"y\")\r\n\t\t  , n = 0\r\n\t\t  , r = e.zoom\r\n\t\t  , o = this.angle\r\n\t\t  , c = l[0] * r * this.radius\r\n\t\t  , u = i + c * Math.cos(o)\r\n\t\t  , p = s + c * Math.sin(o)\r\n\t\t  , a = 2 * Math.PI;\r\n\t\td.lineWidth = 1 * r,\r\n\t\td.strokeStyle = this.color,\r\n\t\td.beginPath(),\r\n\t\td.moveTo(u, p),\r\n\t\td.fillStyle = this.color;\r\n\t\twhile (n++ < 8)\r\n\t\t\tc = l[n - 1] * r * this.radius,\r\n\t\t\tu = i + c * Math.cos(o + a * n / 8),\r\n\t\t\tp = s + c * Math.sin(o + a * n / 8),\r\n\t\t\td.lineTo(u, p);\r\n\t\td.fill(),\r\n\t\td.stroke()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/debris.js?");

/***/ }),

/***/ "./src/game/class/vehicles/explosion.js":
/*!**********************************************!*\
  !*** ./src/game/class/vehicles/explosion.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _debris_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./debris.js */ \"./src/game/class/vehicles/debris.js\");\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tcomplete = !1;\r\n\tgravity = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, .3)\r\n\tpowerupsEnabled = !1;\r\n\ttime = 20;\r\n\tconstructor(t, e) {\r\n\t\tObject.defineProperty(this, 'scene', { value: e, writable: true }),\r\n\t\tthis.positionX = t.x,\r\n\t\tthis.positionY = t.y,\r\n\t\tthis.createMasses(t)\r\n\t}\r\n\tdraw(l, t) {\r\n\t\tlet e = this.time\r\n\t\t  , i = this.positionX\r\n\t\t  , s = this.positionY\r\n\t\t  , n = this.scene.camera.zoom\r\n\t\t  , h = this.scene.screen;\r\n\t\tif (l.globalAlpha = t,\r\n\t\te > 0) {\r\n\t\t\te -= 10;\r\n\t\t\tlet c = h.realToScreen(i, \"x\")\r\n\t\t\t  , u = h.realToScreen(s, \"y\")\r\n\t\t\t  , p = 0\r\n\t\t\t  , d = 6.2 * Math.random()\r\n\t\t\t  , f = e * n\r\n\t\t\t  , v = c + f * Math.cos(d)\r\n\t\t\t  , g = u + f * Math.sin(d);\r\n\t\t\tl.beginPath(),\r\n\t\t\tl.moveTo(v, g),\r\n\t\t\tl.fillStyle = this.scene.settings.physicsLineColor;\r\n\t\t\twhile (p++ < 16)\r\n\t\t\t\tf = (e + 30 * Math.random()) * n,\r\n\t\t\t\tv = c + f * Math.cos(d + 6.283 * p / 16),\r\n\t\t\t\tg = u + f * Math.sin(d + 6.283 * p / 16),\r\n\t\t\t\tl.lineTo(v, g);\r\n\t\t\tl.fill()\r\n\t\t}\r\n\t\tlet m = this.masses;\r\n\t\tfor (let y in m)\r\n\t\t\tm[y].draw(l);\r\n\t\tl.globalAlpha = 1,\r\n\t\tthis.time = e\r\n\t}\r\n\tcreateMasses(t) {\r\n\t\tthis.masses = [],\r\n\t\tthis.masses.push(new _debris_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, this, this.scene.settings.physicsLineColor)),\r\n\t\tthis.masses.push(new _debris_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, this, this.scene.settings.physicsLineColor)),\r\n\t\tthis.masses.push(new _debris_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, this, this.scene.settings.physicsLineColor)),\r\n\t\tthis.masses.push(new _debris_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, this, this.scene.settings.physicsLineColor)),\r\n\t\tthis.masses.push(new _debris_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, this, this.scene.settings.physicsLineColor)),\r\n\t\tthis.masses.push(new _debris_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, this, this.scene.settings.physicsLineColor)),\r\n\t\tthis.masses.push(new _debris_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t, this, this.scene.settings.physicsLineColor))\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tfor (let t of this.masses)\r\n\t\t\tt.fixedUpdate()\r\n\t}\r\n\tupdate(progress, delta) {\r\n\t\tfor (let t of this.masses)\r\n\t\t\tt.update(progress, delta)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/explosion.js?");

/***/ }),

/***/ "./src/game/class/vehicles/helicopter.js":
/*!***********************************************!*\
  !*** ./src/game/class/vehicles/helicopter.js ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _spring_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./spring.js */ \"./src/game/class/vehicles/spring.js\");\n/* harmony import */ var _vehicle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./vehicle.js */ \"./src/game/class/vehicles/vehicle.js\");\n/* harmony import */ var _prop_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./prop.js */ \"./src/game/class/vehicles/prop.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nlet c = {\r\n\tHELICOPTER: \"helicopter\"\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehicle_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n\tswapped = !1;\r\n\tvehicleName = \"Helicopter\";\r\n\tconstructor(t, e, i) {\r\n\t\tsuper(t);\r\n\t\tthis.createMasses(e);\r\n\t\tthis.createSprings();\r\n\t\tthis.createCockpit();\r\n\t\tthis.updateCameraFocalPoint();\r\n\t\tthis.stopSounds();\r\n\t\t-1 === i && this.swap()\r\n\t}\r\n\tcreateCockpit() {\r\n\t\tlet t = document.createElement('canvas');\r\n\t\tObject.defineProperty(this, 'canvasCockpit', { value: t }),\r\n\t\tObject.defineProperty(this, 'ctx', { value: t.getContext('2d') }),\r\n\t\tthis.ctx.fillStyle = this.color,\r\n\t\tthis.ctx.strokeStyle = this.color\r\n\t}\r\n\tcreateMasses(t) {\r\n\t\tvar e = [];\r\n\t\te.push(new _prop_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 0,t.y + 18),this));\r\n\t\tvar i = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + -17,t.y + 42), this)\r\n\t\t, r = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 17,t.y + 42), this)\r\n\t\t, o = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + -40,t.y + 15), this)\r\n\t\t, h = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 40,t.y + 15), this);\r\n\t\te.push(i),\r\n\t\te.push(r),\r\n\t\te.push(o),\r\n\t\te.push(h),\r\n\t\te[0].radius = 18,\r\n\t\te[1].radius = 8,\r\n\t\te[2].radius = 8,\r\n\t\te[3].grav = !1,\r\n\t\te[4].grav = e[4].collide = !1,\r\n\t\te[1].friction = .2,\r\n\t\te[2].friction = .2,\r\n\t\tthis.head = e[0],\r\n\t\tthis.mass2 = e[1],\r\n\t\tthis.mass3 = e[2],\r\n\t\tthis.mass4 = e[3],\r\n\t\tthis.rotor = 0,\r\n\t\tthis.rotor2 = 0,\r\n\t\tthis.dir = 1;\r\n\t\tlet l = this;\r\n\t\te[3].drive = this.head.drive = function() {\r\n\t\t\tl.explode()\r\n\t\t}\r\n\t\tthis.focalPoint = e[0],\r\n\t\tthis.masses = e\r\n\t}\r\n\tcreateSprings() {\r\n\t\tlet t = this.masses\r\n\t\t  , e = [];\r\n\t\te.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[0],t[1],this)),\r\n\t\te.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[2],t[0],this)),\r\n\t\te.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[2],t[1],this)),\r\n\t\te.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[0],t[3],this)),\r\n\t\te.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[1],t[3],this)),\r\n\t\te.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[0],t[4],this)),\r\n\t\te.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[2],t[4],this)),\r\n\t\tthis.spring1 = e[0],\r\n\t\tthis.spring2 = e[1],\r\n\t\tthis.spring3 = e[2],\r\n\t\tthis.spring4 = e[3],\r\n\t\tthis.spring5 = e[4],\r\n\t\tthis.spring6 = e[5],\r\n\t\tthis.spring7 = e[6],\r\n\t\te[0].leff = e[4].lrest = 30,\r\n\t\te[1].leff = e[4].lrest = 30,\r\n\t\te[2].leff = e[4].lrest = 35,\r\n\t\te[4].leff = e[4].lrest = 35,\r\n\t\te[6].leff = e[4].lrest = 35;\r\n\t\tfor (let i of e)\r\n\t\t\ti.dampConstant = .4,\r\n\t\t\ti.springConstant = .5;\r\n\t\tthis.springs = e\r\n\t}\r\n\tdrawCockpit() {\r\n\t\tlet t = this.canvasCockpit\r\n\t\t  , i = this.scene\r\n\t\t  , s = i.camera.zoom\r\n\t\t  , r = 50 * s\r\n\t\t  , o = 50 * s\r\n\t\t  , l = Math.max(2 * s, 1)\r\n\t\t  , c = this.ctx;\r\n\t\tif (r !== t.width || o !== t.height ||\r\n\t\tc.fillStyle !== this.color ||\r\n\t\tc.strokeStyle !== this.color ||\r\n\t\tc.lineWidth !== l) {\r\n\t\t\tt.width = r,\r\n\t\t\tt.height = o;\r\n\t\t\tvar e = this.masses\r\n\t\t\t  , n = e[0].radius * s * .9;\r\n\t\t\tc.save(),\r\n\t\t\tc.translate(r / 2, o / 2),\r\n\t\t\tc.scale(1.3, 1),\r\n\t\t\tc.beginPath(),\r\n\t\t\tc.arc(0, 0, n, 0, 1.5 * Math.PI, !1),\r\n\t\t\tc.lineTo(0, 0),\r\n\t\t\tc.lineTo(n, 0),\r\n\t\t\tc.closePath(),\r\n\t\t\tc.restore(),\r\n\t\t\tc.fillStyle = this.color,\r\n\t\t\tc.fill(),\r\n\t\t\tc.lineWidth = l,\r\n\t\t\tc.strokeStyle = this.color,\r\n\t\t\tc.stroke(),\r\n\t\t\tc.save(),\r\n\t\t\tc.translate(r / 2, o / 2),\r\n\t\t\tc.scale(1.3, 1),\r\n\t\t\tc.beginPath(),\r\n\t\t\tc.arc(0, 0, n, 0, 1.5 * Math.PI, !0),\r\n\t\t\tc.restore(),\r\n\t\t\tc.stroke()\r\n\t\t}\r\n\r\n\t\treturn t\r\n\t}\r\n\tupdateCameraFocalPoint() {}\r\n\tfixedUpdate() {\r\n\t\tif (this.crashed === !1 && (this.updateSound(),\r\n\t\tthis.control()),\r\n\t\tthis.explosion)\r\n\t\t\tthis.explosion.fixedUpdate();\r\n\t\telse {\r\n\t\t\tfor (var t = this.springs, e = t.length, i = e - 1; i >= 0; i--)\r\n\t\t\t\tt[i].fixedUpdate();\r\n\t\t\tfor (var s = this.masses, n = s.length, r = n - 1; r >= 0; r--)\r\n\t\t\t\ts[r].fixedUpdate();\r\n\t\t\tif ((this.masses[1].contact || this.masses[2].contact) && (this.slow = !1),\r\n\t\t\tthis.slow === !1) {\r\n\t\t\t\tthis.crashed === !1 && this.control();\r\n\t\t\t\tfor (var i = e - 1; i >= 0; i--)\r\n\t\t\t\t\tt[i].fixedUpdate();\r\n\t\t\t\tfor (var r = n - 1; r >= 0; r--)\r\n\t\t\t\t\ts[r].fixedUpdate()\r\n\t\t\t}\r\n\t\t\tthis.updateCockpitAngle()\r\n\t\t}\r\n\t}\r\n\tupdate(progress) {\r\n\t\tfor (let s = this.masses, n = s.length, r = n - 1; r >= 0; r--)\r\n\t\t\ts[r].update(progress)\r\n\t}\r\n\tupdateSound() {\r\n\t\tif (this.player.isInFocus()) {\r\n\t\t\tlet t = this.scene.sound\r\n\t\t\t  , e = Math.min(this.head.motor, 1);\r\n\t\t\tt.play(c.HELICOPTER, e)\r\n\t\t}\r\n\t}\r\n\tstopSounds() {\r\n\t\tlet t = this.scene.sound;\r\n\t\tt.stop(c.HELICOPTER)\r\n\t}\r\n\tswap() {\r\n\t\tlet t = this.dir\r\n\t\t  , e = this.springs\r\n\t\t  , i = this.masses;\r\n\t\tt = -1 * t,\r\n\t\te[2].swap();\r\n\t\tlet n = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0)\r\n\t\t  , r = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0)\r\n\t\t  , o = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0);\r\n\t\tn.equ(i[3].pos),\r\n\t\tr.equ(i[3].old),\r\n\t\to.equ(i[3].vel),\r\n\t\ti[3].pos.equ(i[4].pos),\r\n\t\ti[3].old.equ(i[4].old),\r\n\t\ti[3].vel.equ(i[4].vel),\r\n\t\ti[4].pos.equ(n),\r\n\t\ti[4].old.equ(r),\r\n\t\ti[4].vel.equ(o),\r\n\t\tthis.dir = t\r\n\t}\r\n\tcontrol() {\r\n\t\tlet t = this.player.getGamepad()\r\n\t\t  , e = t.isButtonDown(\"up\")\r\n\t\t  , i = t.isButtonDown(\"back\")\r\n\t\t  , s = t.isButtonDown(\"left\")\r\n\t\t  , n = t.isButtonDown(\"right\")\r\n\t\t  , r = t.isButtonDown(\"z\")\r\n\t\t  , o = this.masses\r\n\t\t  , a = this.springs;\r\n\t\tr && !this.swapped && (this.swap(),\r\n\t\tthis.swapped = !0),\r\n\t\tr || (this.swapped = !1);\r\n\t\tlet h = o[1].pos.add(o[2].pos).factor(.5);\r\n\t\th = o[0].pos.sub(h),\r\n\t\th = h.factor(1 / h.len()),\r\n\t\to[0].angle.equ(h);\r\n\t\tlet l = e ? 1 : 0;\r\n\t\to[0].motor += (l - o[0].motor) / 10;\r\n\t\tlet c = s ? 1 : 0;\r\n\t\tc += n ? -1 : 0,\r\n\t\ta[2].rotate(c / 6),\r\n\t\ti && (this.scene.restartTrack = !0)\r\n\t}\r\n\tupdateCockpitAngle() {\r\n\t\tlet t = this.masses\r\n\t\t  , e = t[0].pos\r\n\t\t  , i = t[3].pos\r\n\t\t  , s = e.x\r\n\t\t  , n = e.y\r\n\t\t  , r = i.x\r\n\t\t  , o = i.y\r\n\t\t  , a = s - r\r\n\t\t  , l = n - o;\r\n\t\tthis.cockpitAngle = -(Math.atan2(a, l) - Math.PI / 2)\r\n\t\tthis.rotor += .5 * this.head.motor + .05,\r\n\t\tthis.rotor > 6.2831 && (this.rotor -= 6.2831),\r\n\t\tthis.rotor2 += .5,\r\n\t\tthis.rotor2 > 6.2831 && (this.rotor2 -= 6.2831)\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tif (this.explosion)\r\n\t\t\tthis.explosion.draw(ctx, 1);\r\n\t\telse {\r\n\t\t\tctx.imageSmoothingEnabled = !0,\r\n\t\t\tctx.webkitImageSmoothingEnabled = !0,\r\n\t\t\tctx.mozImageSmoothingEnabled = !0;\r\n\t\t\tif (this.scene.ticks > 0 && !this.player.isGhost()) {\r\n\t\t\t\tif (!this.scene.state.playing) {\r\n\t\t\t\t\tlet t = window.lite && parseInt(lite.storage.get(\"snapshots\"));\r\n\t\t\t\t\tif (t > 0) {\r\n\t\t\t\t\t\tfor (let e of this.player._checkpoints.filter((e, i, s) => i > s.length - (t + 1) && e._tempVehicle)) {\r\n\t\t\t\t\t\t\tlet i = document.createElement('canvas');\r\n\t\t\t\t\t\t\tthis.drawHelicopter.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle), {canvasCockpit: i, ctx: i.getContext('2d'), drawCockpit: this.drawCockpit}), ctx, t / 3e2 * this.player._checkpoints.indexOf(e) % 1);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (let e of this.player._cache.filter((e, i, s) => i > s.length - (t + 1) && e._tempVehicle)) {\r\n\t\t\t\t\t\t\tlet i = document.createElement('canvas');\r\n\t\t\t\t\t\t\tthis.drawHelicopter.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle), {canvasCockpit: i, ctx: i.getContext('2d'), drawCockpit: this.drawCockpit}), ctx, t / 3e2 * this.player._cache.indexOf(e) % 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (window.lite && lite.storage.get(\"playerTrail\")) {\r\n\t\t\t\t\tfor (let e of lite.snapshots.filter(t => t._tempVehicle)) {\r\n\t\t\t\t\t\tlet i = document.createElement('canvas');\r\n\t\t\t\t\t\tthis.drawHelicopter.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle), {canvasCockpit: i, ctx: i.getContext('2d'), drawCockpit: this.drawCockpit}), ctx, lite.snapshots.length / (lite.snapshots.length * 200) * parseInt(lite.snapshots.indexOf(e)) % 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.drawHelicopter(ctx);\r\n\t\t}\r\n\t}\r\n\tdrawHelicopter(t, alpha = this.player._opacity) {\r\n\t\tt.globalAlpha = alpha;\r\n\t\tlet i = this.dir\r\n\t\t  , n = this.rotor\r\n\t\t  , r = this.rotor2\r\n\t\t  , o = this.scene\r\n\t\t  , a = o.camera.zoom\r\n\t\t  , q = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.head.pos.x, this.head.pos.y)\r\n\t\t  , m = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.mass2.pos.x, this.mass2.pos.y).add(this.mass3.pos).factor(.5)\r\n\t\t  , h = q.sub(m).factor(a)\r\n\t\t  , l = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](-h.y * i,h.x * i)\r\n\t\t  , c = q.toScreen(o);\r\n\t\tt.strokeStyle = this.color,\r\n\t\tt.lineWidth = 5 * a,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(c.x + .5 * h.x, c.y + .5 * h.y),\r\n\t\tt.lineTo(c.x + .8 * h.x, c.y + .8 * h.y),\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = 3 * a,\r\n\t\tt.beginPath();\r\n\t\tvar u = .9 * Math.cos(n);\r\n\t\tt.moveTo(c.x + .9 * h.x + l.x * u, c.y + .8 * h.y + l.y * u),\r\n\t\tt.lineTo(c.x + .9 * h.x - l.x * u, c.y + .8 * h.y - l.y * u),\r\n\t\tt.stroke();\r\n\t\tvar p = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.mass2.pos.x, this.mass2.pos.y).toScreen(o)\r\n\t\t  , d = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.mass3.pos.x, this.mass3.pos.y).toScreen(o);\r\n\t\tt.lineWidth = 3 * a,\r\n\t\tt.strokeStyle = '#'.padEnd(7, /^(darker|midnight)$/.test(window.lite.storage.get('theme')) ? '8' : window.lite.storage.get('theme') === 'dark' ? '9' : '6'),\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(p.x - .2 * h.x, p.y - .2 * h.y),\r\n\t\tt.lineTo(c.x, c.y),\r\n\t\tt.lineTo(d.x - .2 * h.x, d.y - .2 * h.y),\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = 4 * a,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(p.x - .2 * l.x - .1 * h.x, p.y - .2 * l.y - .1 * h.y),\r\n\t\tt.lineTo(p.x - .25 * h.x, p.y - .25 * h.y),\r\n\t\tt.lineTo(d.x - .25 * h.x, d.y - .25 * h.y),\r\n\t\tt.lineTo(d.x + .2 * l.x - .1 * h.x, d.y + .2 * l.y - .1 * h.y),\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = 6 * a,\r\n\t\tt.strokeStyle = this.color,\r\n\t\tt.beginPath();\r\n\t\tvar f = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.mass4.pos.x, this.mass4.pos.y).toScreen(o);\r\n\t\tt.moveTo(c.x, c.y),\r\n\t\tt.lineTo(f.x, f.y),\r\n\t\tt.lineTo(c.x - .1 * h.x, c.y - .3 * h.y),\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = 2 * a,\r\n\t\tt.strokeStyle = this.color,\r\n\t\tt.beginPath();\r\n\t\tvar v = 7 * a\r\n\t\t  , g = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](v * Math.sin(-r),v * Math.cos(-r));\r\n\t\tt.moveTo(f.x + g.x, f.y + g.y),\r\n\t\tt.lineTo(f.x - g.x, f.y - g.y),\r\n\t\tt.moveTo(f.x - g.y, f.y + g.x),\r\n\t\tt.lineTo(f.x + g.y, f.y - g.x),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.lineWidth = 2 * a,\r\n\t\tt.arc(f.x, f.y, this.mass4.radius * a, 0, 2 * Math.PI, !1),\r\n\t\tt.stroke();\r\n\t\tm = this.drawCockpit()\r\n\t\tvar y = m.width\r\n\t\t  , w = m.height\r\n\t\t  , x = c.x + 5 * a * this.dir\r\n\t\t  , _ = c.y + 2 * a\r\n\t\t  , S = -y / 2\r\n\t\t  , P = -w / 2\r\n\t\t  , M = this.cockpitAngle\r\n\t\t  , A = -1 === i\r\n\t\t  , D = this.cosmetics\r\n\t\t  , I = GameInventoryManager.getItem(D.head)\r\n\t\t  , E = this.cockpitAngle;\r\n\t\tI.draw(t, x + 5 * a * i, _ - 5 * a, E, .7 * a, i),\r\n\t\tt.translate(x, _),\r\n\t\tt.rotate(M),\r\n\t\tA && t.scale(1, -1),\r\n\t\tt.drawImage(m, S, P, y, w),\r\n\t\tA && t.scale(1, -1),\r\n\t\tt.rotate(-M),\r\n\t\tt.translate(-x, -_),\r\n\t\tt.globalAlpha = 1\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/helicopter.js?");

/***/ }),

/***/ "./src/game/class/vehicles/mass.js":
/*!*****************************************!*\
  !*** ./src/game/class/vehicles/mass.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tpos = null;\r\n\told = null;\r\n\tvel = null;\r\n\tradius = 0;\r\n\tfriction = 0;\r\n\tcollide = !0;\r\n\tcontact = !1;\r\n\tconstructor(t, e) {\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tparent: { value: e, writable: true },\r\n\t\t\tscene: { value: e.scene, writable: true }\r\n\t\t});\r\n\t\tthis.pos = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\r\n\t\tthis.old = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\r\n\t\tthis.vel = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0),\r\n\t\tthis.radius = 10,\r\n\t\tthis.pos.equ(t),\r\n\t\tthis.old.equ(t)\r\n\t}\r\n\tdrive(t, e) {\r\n\t\tlet i = this.friction\r\n\t\t  , s = -(t * this.vel.x + e * this.vel.y) * i;\r\n\t\tt *= s,\r\n\t\te *= s,\r\n\t\tthis.pos.x += t,\r\n\t\tthis.pos.y += e,\r\n\t\tthis.contact = !0\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tlet e = this.parent.gravity;\r\n\t\tthis.vel.inc(e);\r\n\t\t(0 != e.x || 0 != e.y) && this.vel.factorSelf(.99),\r\n\t\tthis.pos.inc(this.vel),\r\n\t\tthis.contact = !1,\r\n\t\tthis.collide && this.scene.track.collide(this),\r\n\t\tthis.vel.equ(this.pos.sub(this.old)),\r\n\t\tthis.old.equ(this.pos)\r\n\t}\r\n\tdraw(e) {\r\n\t\tlet t = this.pos.toScreen(this.scene)\r\n\t\t  , i = this.scene.camera.zoom;\r\n\t\te.beginPath(),\r\n\t\te.fillStyle = \"rgba(0,0,0,1)\",\r\n\t\te.arc(t.x, t.y, this.radius * i, 0, 2 * Math.PI, !1),\r\n\t\te.fill()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/mass.js?");

/***/ }),

/***/ "./src/game/class/vehicles/mtb.js":
/*!****************************************!*\
  !*** ./src/game/class/vehicles/mtb.js ***!
  \****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _cosmetics_heads_head_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../cosmetics/heads/head.js */ \"./src/game/class/cosmetics/heads/head.js\");\n/* harmony import */ var _cosmetics_heads_forward_cap_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../cosmetics/heads/forward_cap.js */ \"./src/game/class/cosmetics/heads/forward_cap.js\");\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _bike_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./bike.js */ \"./src/game/class/vehicles/bike.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _wheel_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./wheel.js */ \"./src/game/class/vehicles/wheel.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _bike_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n\tvehicleName = \"MTB\";\r\n\tconstructor(t, e, i, s) {\r\n\t\tsuper(t);\r\n\t\tthis.createMasses(e, s);\r\n\t\tthis.createSprings();\r\n\t\tthis.updateCameraFocalPoint();\r\n\t\tthis.stopSounds();\r\n\t\t-1 === i && this.swap();\r\n\t}\r\n\tcreateMasses(t, e) {\r\n\t\tthis.masses = [];\r\n\t\tvar i = new _mass_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t.x + 2, t.y + -38), this)\r\n\t\t, r = new _wheel_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t.x + 23, t.y), this)\r\n\t\t, o = new _wheel_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t.x + -23, t.y), this);\r\n\t\ti.drive = this.createRagdoll.bind(this),\r\n\t\to.radius = 14,\r\n\t\tr.radius = 14,\r\n\t\ti.radius = 14,\r\n\t\ti.vel.equ(e),\r\n\t\to.vel.equ(e),\r\n\t\tr.vel.equ(e),\r\n\t\tthis.masses.push(i),\r\n\t\tthis.masses.push(o),\r\n\t\tthis.masses.push(r),\r\n\t\tthis.head = i,\r\n\t\tthis.frontWheel = r,\r\n\t\tthis.rearWheel = o\r\n\t}\r\n\tcreateSprings() {\r\n\t\tsuper.createSprings(),\r\n\t\tthis.chasse.lrest = 45,\r\n\t\tthis.chasse.leff = 45,\r\n\t\tthis.chasse.springConstant = .2,\r\n\t\tthis.chasse.dampConstant = .3,\r\n\t\tthis.rearSpring.lrest = 47,\r\n\t\tthis.rearSpring.leff = 47,\r\n\t\tthis.rearSpring.springConstant = .2,\r\n\t\tthis.rearSpring.dampConstant = .3,\r\n\t\tthis.frontSpring.lrest = 45,\r\n\t\tthis.frontSpring.leff = 45,\r\n\t\tthis.frontSpring.springConstant = .2,\r\n\t\tthis.frontSpring.dampConstant = .3\r\n\t}\r\n\tcontrol() {\r\n\t\tlet t = this.gamepad\r\n\t\t  , e = t.isButtonDown(\"up\")\r\n\t\t  , i = t.isButtonDown(\"down\")\r\n\t\t  , s = t.isButtonDown(\"left\")\r\n\t\t  , n = t.isButtonDown(\"right\")\r\n\t\t  , r = t.isButtonDown(\"z\")\r\n\t\t  , a = this.rearWheel;\r\n\t\ta.motor += (e - a.motor) / 10,\r\n\t\tr && !this.swapped && (this.swap(),\r\n\t\tthis.swapped = !0),\r\n\t\tr || (this.swapped = !1),\r\n\t\te && (this.pedala += this.rearWheel.speed / 5),\r\n\t\ta.brake = i,\r\n\t\tthis.frontWheel.brake = this.dir > 0 && n && i ? !0 : this.dir < 0 && s && i ? !0 : !1;\r\n\t\tlet h = s - n;\r\n\t\tthis.rearSpring.contract(5 * h * this.dir, 5),\r\n\t\tthis.frontSpring.contract(5 * -h * this.dir, 5),\r\n\t\tthis.chasse.rotate(h / 8),\r\n\t\t!h && e && (this.rearSpring.contract(-7, 5),\r\n\t\tthis.frontSpring.contract(7, 5))\r\n\t}\r\n\tdrawBikeFrame(o, a = this.player._opacity) {\r\n\t\tlet t = this.scene\r\n\t\t  , frontWheel = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.frontWheel.pos.x, this.frontWheel.pos.y)\r\n\t\t  , rearWheel = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.rearWheel.pos.x, this.rearWheel.pos.y)\r\n\t\t  , head = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this.head.pos.x, this.head.pos.y)\r\n\t\t  , e = frontWheel.toScreen(t)\r\n\t\t  , i = rearWheel.toScreen(t)\r\n\t\t  , n = head.toScreen(t)\r\n\t\t  , r = t.camera.zoom\r\n\t\t  , h = e.sub(i)\r\n\t\t  , l = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](e.y - i.y, i.x - e.x)\r\n\t\t  , c = h.factor(.5)\r\n\t\t  , q = t.settings.physicsLineColor\r\n\t\t  , y = t.settings.sceneryLineColor\r\n\t\t  , z = y.padEnd(7, y.slice(1, 4));\r\n\t\tl.factorSelf(this.dir),\r\n\t\ti.addOut(c, c),\r\n\t\tn.subOut(c, c),\r\n\t\to.globalAlpha = a,\r\n\t\to.strokeStyle = this.frontWheel.color || q,\r\n\t\to.lineWidth = 3 * r,\r\n\t\to.beginPath(),\r\n\t\to.fillStyle = z + '33', // \"rgba(200,200,200,0.2)\",\r\n\t\to.arc(e.x, e.y, 12.5 * r, 0, 2 * Math.PI, !1),\r\n\t\to.fill(),\r\n\t\to.stroke(),\r\n\t\tthis.rearWheel.color && (o.strokeStyle = this.rearWheel.color),\r\n\t\to.beginPath(),\r\n\t\to.arc(i.x, i.y, 12.5 * r, 0, 2 * Math.PI, !1),\r\n\t\to.fill(),\r\n\t\to.stroke(),\r\n\t\to.strokeStyle = \"rgba(128,128,128,0.8)\", // \"rgba(153, 153, 153,1)\",\r\n\t\to.fillStyle = y, // \"rgba(204, 204, 204,1)\",\r\n\t\to.lineWidth = 1,\r\n\t\to.beginPath(),\r\n\t\to.arc(e.x, e.y, 6 * r, 0, 2 * Math.PI, !1),\r\n\t\to.fill(),\r\n\t\to.stroke(),\r\n\t\to.beginPath(),\r\n\t\to.arc(i.x, i.y, 6 * r, 0, 2 * Math.PI, !1),\r\n\t\to.fill(),\r\n\t\to.stroke(),\r\n\t\to.beginPath(),\r\n\t\to.strokeStyle = this.color,\r\n\t\to.lineWidth = 5 * r,\r\n\t\to.moveTo(i.x, i.y),\r\n\t\to.lineTo(i.x + .4 * h.x + .05 * l.x, i.y + .4 * h.y + .05 * l.y),\r\n\t\to.moveTo(i.x + .72 * h.x + .64 * c.x, i.y + .72 * h.y + .64 * c.y),\r\n\t\to.lineTo(i.x + .46 * h.x + .4 * c.x, i.y + .46 * h.y + .4 * c.y),\r\n\t\to.lineTo(i.x + .4 * h.x + .05 * l.x, i.y + .4 * h.y + .05 * l.y),\r\n\t\to.stroke(),\r\n\t\to.beginPath(),\r\n\t\to.lineWidth = 2 * r,\r\n\t\to.moveTo(i.x + .72 * h.x + .64 * c.x, i.y + .72 * h.y + .64 * c.y),\r\n\t\to.lineTo(i.x + .43 * h.x + .05 * l.x, i.y + .43 * h.y + .05 * l.y),\r\n\t\to.stroke(),\r\n\t\to.beginPath(),\r\n\t\to.lineWidth = 1 * r,\r\n\t\to.moveTo(i.x + .46 * h.x + .4 * c.x, i.y + .46 * h.y + .4 * c.y),\r\n\t\to.lineTo(i.x + .28 * h.x + .5 * c.x, i.y + .28 * h.y + .5 * c.y),\r\n\t\to.stroke(),\r\n\t\to.beginPath(),\r\n\t\to.lineWidth = 2 * r,\r\n\t\to.moveTo(i.x + .45 * h.x + .3 * c.x, i.y + .45 * h.y + .3 * c.y),\r\n\t\to.lineTo(i.x + .3 * h.x + .4 * c.x, i.y + .3 * h.y + .4 * c.y),\r\n\t\to.lineTo(i.x + .25 * h.x + .6 * c.x, i.y + .25 * h.y + .6 * c.y),\r\n\t\to.moveTo(i.x + .17 * h.x + .6 * c.x, i.y + .17 * h.y + .6 * c.y),\r\n\t\to.lineTo(i.x + .3 * h.x + .6 * c.x, i.y + .3 * h.y + .6 * c.y),\r\n\t\to.stroke(),\r\n\t\to.beginPath(),\r\n\t\to.lineWidth = 3 * r,\r\n\t\to.moveTo(e.x, e.y),\r\n\t\to.lineTo(i.x + .71 * h.x + .73 * c.x, i.y + .71 * h.y + .73 * c.y),\r\n\t\to.lineTo(i.x + .73 * h.x + .77 * c.x, i.y + .73 * h.y + .77 * c.y),\r\n\t\to.lineTo(i.x + .7 * h.x + .8 * c.x, i.y + .7 * h.y + .8 * c.y),\r\n\t\to.stroke(),\r\n\t\to.beginPath(),\r\n\t\to.lineWidth = 1 * r;\r\n\t\tlet u = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](6 * Math.cos(this.pedala) * r,6 * Math.sin(this.pedala) * r);\r\n\t\to.moveTo(i.x + .43 * h.x + .05 * l.x + u.x, i.y + .43 * h.y + .05 * l.y + u.y),\r\n\t\to.lineTo(i.x + .43 * h.x + .05 * l.x - u.x, i.y + .43 * h.y + .05 * l.y - u.y),\r\n\t\to.stroke();\r\n\t\tif (this.crashed)\r\n\t\t\tthis.ragdoll && this.ragdoll.draw && this.ragdoll.draw(o);\r\n\t\telse {\r\n\t\t\th.factorOut(.5, l),\r\n\t\t\ti.addOut(l, l),\r\n\t\t\tn.subOut(l, l);\r\n\t\t\tlet p = h.factor(.3);\r\n\t\t\tp.x = i.x + p.x + .25 * l.x,\r\n\t\t\tp.y = i.y + p.y + .25 * l.y;\r\n\t\t\tlet d = h.factor(.4);\r\n\t\t\td.x = i.x + d.x + .05 * l.x,\r\n\t\t\td.y = i.y + d.y + .05 * l.y;\r\n\t\t\tlet f = d.add(u)\r\n\t\t\t, v = d.sub(u)\r\n\t\t\t, g = h.factor(.67);\r\n\t\t\tg.x = i.x + g.x + .8 * l.x,\r\n\t\t\tg.y = i.y + g.y + .8 * l.y;\r\n\t\t\tlet m = h.factor(-.05);\r\n\t\t\tm.x = p.x + m.x + .42 * l.x,\r\n\t\t\tm.y = p.y + m.y + .42 * l.y;\r\n\t\t\tlet y = f.sub(m)\r\n\t\t\t, w = y.lenSqr();\r\n\t\t\tc.x = y.y * this.dir,\r\n\t\t\tc.y = -y.x * this.dir,\r\n\t\t\tc.factorSelf(r ** 2);\r\n\t\t\tlet x = y.factor(.5);\r\n\t\t\tx.x = m.x + x.x + c.x * (200 / y.lenSqr()),\r\n\t\t\tx.y = m.y + x.y + c.y * (200 / y.lenSqr());\r\n\t\t\tlet _ = y.factor(.12);\r\n\t\t\t_.x = f.x + _.x + c.x * (50 / w),\r\n\t\t\t_.y = f.y + _.y + c.y * (50 / w),\r\n\t\t\tv.subOut(m, y),\r\n\t\t\tw = y.lenSqr(),\r\n\t\t\tc.x = y.y * this.dir,\r\n\t\t\tc.y = -y.x * this.dir,\r\n\t\t\tc.factorSelf(r * r);\r\n\t\t\tlet b = y.factor(.5);\r\n\t\t\tb.x = m.x + b.x + c.x * (200 / w),\r\n\t\t\tb.y = m.y + b.y + c.y * (200 / w);\r\n\t\t\tlet T = y.factor(.12);\r\n\t\t\tT.x = v.x + T.x + c.x * (50 / w),\r\n\t\t\tT.y = v.y + T.y + c.y * (50 / w);\r\n\t\t\tz = q.padEnd(7, q.slice(1, 4));\r\n\t\t\to.strokeStyle = z + Math.min(255, Math.round(255 * .5 * a)).toString(16),\r\n\t\t\to.lineWidth = 6 * r,\r\n\t\t\to.beginPath(),\r\n\t\t\to.moveTo(v.x, v.y),\r\n\t\t\to.lineTo(b.x, b.y),\r\n\t\t\to.lineTo(m.x, m.y),\r\n\t\t\to.stroke(),\r\n\t\t\to.lineWidth = 4 * r,\r\n\t\t\to.beginPath(),\r\n\t\t\to.moveTo(v.x, v.y),\r\n\t\t\to.lineTo(T.x, T.y),\r\n\t\t\to.stroke(),\r\n\t\t\to.lineWidth = 6 * r,\r\n\t\t\to.strokeStyle = q,\r\n\t\t\to.beginPath(),\r\n\t\t\to.moveTo(f.x, f.y),\r\n\t\t\to.lineTo(x.x, x.y),\r\n\t\t\to.lineTo(m.x, m.y),\r\n\t\t\to.stroke(),\r\n\t\t\to.lineWidth = 4 * r,\r\n\t\t\to.beginPath(),\r\n\t\t\to.moveTo(f.x, f.y),\r\n\t\t\to.lineTo(_.x, _.y),\r\n\t\t\to.stroke();\r\n\t\t\tlet C = h.factor(.1);\r\n\t\t\tC.x = p.x + C.x + .95 * l.x,\r\n\t\t\tC.y = p.y + C.y + .95 * l.y,\r\n\t\t\to.lineWidth = 8 * r,\r\n\t\t\to.beginPath(),\r\n\t\t\to.moveTo(m.x, m.y),\r\n\t\t\to.lineTo(C.x, C.y),\r\n\t\t\to.stroke();\r\n\t\t\tlet k = h.factor(.2);\r\n\t\t\tk.x = p.x + k.x + 1.09 * l.x,\r\n\t\t\tk.y = p.y + k.y + 1.09 * l.y,\r\n\t\t\to.beginPath(),\r\n\t\t\to.lineWidth = 2 * r,\r\n\t\t\tC.subOut(g, h);\r\n\t\t\tlet S = h.lenSqr();\r\n\t\t\tl.x = h.y * this.dir,\r\n\t\t\tl.y = -h.x * this.dir,\r\n\t\t\tl.factorSelf(r * r);\r\n\t\t\tlet P = h.factor(.3);\r\n\t\t\tP.x = g.x + P.x + l.x * (80 / S),\r\n\t\t\tP.y = g.y + P.y + l.y * (80 / S),\r\n\t\t\to.lineWidth = 5 * r,\r\n\t\t\to.beginPath(),\r\n\t\t\to.moveTo(C.x, C.y),\r\n\t\t\to.lineTo(P.x, P.y),\r\n\t\t\to.lineTo(g.x, g.y),\r\n\t\t\to.stroke();\r\n\t\t\tlet A = GameInventoryManager.getItem(this.cosmetics.head);\r\n\t\t\tA.draw(o, k.x, k.y, this.drawHeadAngle, r, this.dir),\r\n\t\t\to.globalAlpha = 1\r\n\t\t}\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/mtb.js?");

/***/ }),

/***/ "./src/game/class/vehicles/player.js":
/*!*******************************************!*\
  !*** ./src/game/class/vehicles/player.js ***!
  \*******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _utils_gamepad_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/gamepad.js */ \"./src/game/class/utils/gamepad.js\");\n/* harmony import */ var _balloon_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./balloon.js */ \"./src/game/class/vehicles/balloon.js\");\n/* harmony import */ var _blob_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./blob.js */ \"./src/game/class/vehicles/blob.js\");\n/* harmony import */ var _bmx_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./bmx.js */ \"./src/game/class/vehicles/bmx.js\");\n/* harmony import */ var _explosion_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./explosion.js */ \"./src/game/class/vehicles/explosion.js\");\n/* harmony import */ var _helicopter_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./helicopter.js */ \"./src/game/class/vehicles/helicopter.js\");\n/* harmony import */ var _mtb_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./mtb.js */ \"./src/game/class/vehicles/mtb.js\");\n/* harmony import */ var _truck_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./truck.js */ \"./src/game/class/vehicles/truck.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet g = 0;\r\nlet v = {\r\n\tBMX: _bmx_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"],\r\n\tMTB: _mtb_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"],\r\n\tHELI: _helicopter_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"],\r\n\tTRUCK: _truck_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"],\r\n\tBALLOON: _balloon_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\r\n\tBLOB: _blob_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"]\r\n}\r\n\r\nfunction m(t, e) {\r\n\tfor (var i in e)\r\n\t\ttry {\r\n\t\t\tt[i] = e[i].constructor == Object ? m(t[i], e[i]) : e[i]\r\n\t\t} catch (s) {\r\n\t\t\tt[i] = e[i]\r\n\t\t}\r\n\treturn t\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tconstructor(t, e) {\r\n\t\tthis.id = g++;\r\n\t\tthis._scene = t;\r\n\t\tthis._game = t.game;\r\n\t\tObject.defineProperties(this, {\r\n\t\t\t_scene: { enumerable: false },\r\n\t\t\t_game: { enumerable: false }\r\n\t\t});\r\n\t\tthis._user = e;\r\n\t\tthis._settings = t.settings;\r\n\t\tlet i = t.settings.startVehicle;\r\n\t\tt.settings.track && (i = t.settings.track.vehicle);\r\n\t\tthis._baseVehicleType = i;\r\n\t\tthis._gamepad = new _utils_gamepad_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](t);\r\n\t\tthis._ghost = !1;\r\n\t\tthis._color = e.color || \"#000000\";\r\n\t\tthis.setDefaults();\r\n\t\tthis.createBaseVehicle(new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 35), 1, new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0));\r\n\t}\r\n\tgetCheckpointCount() {\r\n\t\treturn this._checkpoints.length\r\n\t}\r\n\tsetDefaults() {\r\n\t\tthis._baseVehicle = !1;\r\n\t\tthis._tempVehicleType = null;\r\n\t\tthis._tempVehicle = !1;\r\n\t\tthis._tempVehicleTicks = 0;\r\n\t\tthis._temp_vehicle_options = null;\r\n\t\tthis._addCheckpoint = !1;\r\n\t\tthis._checkpoints = [];\r\n\t\tthis._cache = [];\r\n\t\tthis._crashed = !1;\r\n\t\tthis._effect = !1;\r\n\t\tthis._effectTicks = 0;\r\n\t\tthis._opacity = 1;\r\n\t\tthis.complete = !1;\r\n\t\tthis._powerupsConsumed = {\r\n\t\t\tcheckpoints: [],\r\n\t\t\ttargets: [],\r\n\t\t\tmisc: []\r\n\t\t}\r\n\t}\r\n\thasCheckpoints() {\r\n\t\treturn this._checkpoints.length > 0\r\n\t}\r\n\tsetColor(t) {\r\n\t\tthis._color = t\r\n\t}\r\n\tdead() {\r\n\t\tif (this._crashed = !0,\r\n\t\t\tthis._ghost === !1) {\r\n\t\t\tlet t = this._scene\r\n\t\t\t  , i = t.message;\r\n\t\t\tt.state.playerAlive = this.isAlive(),\r\n\t\t\ti.show(this._checkpoints.length > 0 ? \"Press Enter For Checkpoint\" : \"Press Enter To Restart!\", !1, \"#000\", \"#FFF\")\r\n\t\t}\r\n\t}\r\n\tsetAsGhost() {\r\n\t\tthis._ghost = !0\r\n\t\tthis._replayIterator = this.createReplayIterator()\r\n\t}\r\n\tisGhost() {\r\n\t\treturn this._ghost\r\n\t}\r\n\tisAlive() {\r\n\t\treturn !this._crashed\r\n\t}\r\n\tgetTargetsHit() {\r\n\t\treturn this._scene.track.targets.filter(t => this._powerupsConsumed.targets.includes(t.id)).reduce((sum, t) => sum += t.multiplier, 0)\r\n\t\t// return this._powerupsConsumed.targets.length\r\n\t}\r\n\tgetGamepad() {\r\n\t\treturn this._gamepad\r\n\t}\r\n\tsetBaseVehicle(t) {\r\n\t\tthis._baseVehicleType !== t && (this._baseVehicleType = t,\r\n\t\tthis.reset())\r\n\t}\r\n\tcreateBaseVehicle(t, e, i) {\r\n\t\tthis._tempVehicle && this._tempVehicle.stopSounds(),\r\n\t\tthis._baseVehicle = new v[this._baseVehicleType](this, t, e, i);\r\n\t\tthis._game.emit('baseVehicleCreate', this._baseVehicle),\r\n\t\tthis._tempVehicle = !1,\r\n\t\tthis._tempVehicleType = !1,\r\n\t\tthis._tempVehicleTicks = 0\r\n\t}\r\n\tsetTempVehicle(t, e, i, s) {\r\n\t\tthis._temp_vehicle_options && this._temp_vehicle_options.type === t && (e = this._temp_vehicle_options.ticks + e),\r\n\t\tthis._temp_vehicle_options = {\r\n\t\t\ttype: t,\r\n\t\t\tticks: e,\r\n\t\t\tposition: i,\r\n\t\t\tdirection: s\r\n\t\t}\r\n\t}\r\n\tcreateTempVehicle(t, e, i, s) {\r\n\t\tif (this._temp_vehicle_options) {\r\n\t\t\tlet n = this._temp_vehicle_options;\r\n\t\t\tt = n.type,\r\n\t\t\te = n.ticks,\r\n\t\t\ti = n.position,\r\n\t\t\ts = n.direction,\r\n\t\t\tthis._temp_vehicle_options = null\r\n\t\t}\r\n\t\tthis._tempVehicleType === t ? this._tempVehicleTicks += e : (this.getActiveVehicle().stopSounds(),\r\n\t\tthis._effect = new _explosion_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](i, this._scene),\r\n\t\tthis._effectTicks = 45,\r\n\t\tthis._tempVehicleType = t,\r\n\t\tthis._tempVehicle = new v[t](this, i, s),\r\n\t\tthis._game.emit('tempVehicleCreate', this._tempVehicle),\r\n\t\tthis._tempVehicleTicks = e)\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tlet t = this._baseVehicle;\r\n\t\tthis._temp_vehicle_options && this.createTempVehicle(),\r\n\t\tthis._tempVehicleTicks > 0 && (t = this._tempVehicle,\r\n\t\tthis._crashed === !1 && this._tempVehicleTicks--,\r\n\t\tthis._tempVehicleTicks <= 0 && this._crashed === !1 && (this._effectTicks = 45,\r\n\t\tthis._effect = new _explosion_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"](this._tempVehicle.focalPoint.pos, this._scene),\r\n\t\tthis.createBaseVehicle(this._tempVehicle.focalPoint.pos, this._tempVehicle.dir, this._tempVehicle.masses[0].vel),\r\n\t\tt = this._baseVehicle)),\r\n\t\tthis._effectTicks > 0 && (this._effectTicks--,\r\n\t\tthis._effect.fixedUpdate()),\r\n\t\tlite.storage.get(\"playerTrail\") && this.isGhost() || this.isAlive() && lite.snapshots.push(this._createSnapshot()),\r\n\t\tt.fixedUpdate(),\r\n\t\tthis._addCheckpoint && (this.isAlive() && this._createCheckpoint(),\r\n\t\tthis._addCheckpoint = !1)\r\n\t}\r\n\t*createReplayIterator(nextTick = 0) {\r\n\t\tconst snapshots = new Map();\r\n\t\tthis._gamepad.playbackTicks = 0;\r\n\t\twhile (this.complete === !1) {\r\n\t\t\tsnapshots.has(this._gamepad.playbackTicks) || this.isAlive() && snapshots.set(this._gamepad.playbackTicks, {\r\n\t\t\t\tdownButtons: Object.assign({}, this._gamepad.downButtons),\r\n\t\t\t\tsnapshot: this._createSnapshot()\r\n\t\t\t});\r\n\t\t\tif (this._gamepad.playbackTicks >= nextTick) {\r\n\t\t\t\tconst value = yield this._gamepad.playbackTicks;\r\n\t\t\t\tif (isFinite(value)) {\r\n\t\t\t\t\tif (snapshots.has(value)) {\r\n\t\t\t\t\t\tlet { downButtons, snapshot } = snapshots.get(value);\r\n\t\t\t\t\t\tthis._checkpoints.push(snapshot);\r\n\t\t\t\t\t\tthis.gotoCheckpoint();\r\n\t\t\t\t\t\tthis._checkpoints.pop();\r\n\t\t\t\t\t\tthis._gamepad.playbackTicks = value;\r\n\t\t\t\t\t\tthis._gamepad.downButtons = Object.assign({}, downButtons);\r\n\t\t\t\t\t} else if (value < nextTick) {\r\n\t\t\t\t\t\tthis.reset();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._scene.camera.focusIndex = this._scene.playerManager._players.indexOf(this);\r\n\t\t\t\t\tthis._scene.camera.focusOnPlayer();\r\n\t\t\t\t\tnextTick = value;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnextTick = this._gamepad.playbackTicks + 1 / (this._game.ups / 30) // this._gamepad.playbackTicks + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._gamepad.update(),\r\n\t\t\tthis.checkKeys(),\r\n\t\t\tthis.fixedUpdate(),\r\n\t\t\t!this.complete && (this._gamepad.playbackTicks += 1 / (this._game.ups / 30)), /* this._gamepad.playbackTicks++; */\r\n\t\t\tthis.isInFocus() && this._game.emit('replayTick', this._gamepad.playbackTicks)\r\n\t\t}\r\n\r\n\t\t// this.loop = true;\r\n\t\tthis.loop && (this.reset(),\r\n\t\tthis._replayIterator = this.createReplayIterator())\r\n\t\treturn snapshots;\r\n\t}\r\n\tisInFocus() {\r\n\t\treturn this._scene.camera.playerFocus && this._scene.camera.playerFocus === this\r\n\t}\r\n\tupdateOpacity() {\r\n\t\tlet t = 1;\r\n\t\tif (this._scene.camera.playerFocus && this._scene.camera.playerFocus !== this) {\r\n\t\t\tvar i = this.getDistanceBetweenPlayers(this._scene.camera.playerFocus);\r\n\t\t\t1200 > i && (t = Math.min(i / 500, 1))\r\n\t\t}\r\n\t\tthis._opacity = t\r\n\t}\r\n\tdrawName(ctx) {\r\n\t\tlet l = this.getActiveVehicle()\r\n\t\t  , c = l.focalPoint.pos.toScreen(this._scene);\r\n\t\tctx.globalAlpha = this._opacity,\r\n\t\tctx.beginPath(),\r\n\t\tctx.fillStyle = this._color,\r\n\t\tctx.moveTo(c.x, c.y - 40 * this._scene.camera.zoom),\r\n\t\tctx.lineTo(c.x - 5 * this._scene.camera.zoom, c.y - 50 * this._scene.camera.zoom),\r\n\t\tctx.lineTo(c.x + 5 * this._scene.camera.zoom, c.y - 50 * this._scene.camera.zoom),\r\n\t\tctx.lineTo(c.x, c.y - 40 * this._scene.camera.zoom),\r\n\t\tctx.fill();\r\n\t\tctx.font = (9 * this._scene.game.pixelRatio * Math.max(this._scene.camera.zoom, 1)) + \"pt helsinki\",\r\n\t\tctx.textAlign = \"center\",\r\n\t\tctx.fillStyle = this._color,\r\n\t\tctx.fillText(this._user.d_name, c.x, c.y - 60 * this._scene.camera.zoom),\r\n\t\tctx.globalAlpha = 1\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tthis.updateOpacity();\r\n\t\tlet t = this._baseVehicle;\r\n\t\tthis._tempVehicleTicks > 0 && (t = this._tempVehicle),\r\n\t\tthis._effectTicks > 0 && this._effect.draw(ctx, this._effectTicks / 100),\r\n\t\tt.draw(ctx),\r\n\t\tthis.isGhost() && this.drawName(ctx)\r\n\t}\r\n\tcheckKeys() {\r\n\t\tvar t = this._gamepad\r\n\t\t  , e = this._ghost\r\n\t\t  , i = this._scene\r\n\t\t  , s;\r\n\t\t!t.isButtonDown(\"enter\") && !t.isButtonDown(\"backspace\") && t.areKeysDown() && this._cache.length > 0 && (this._cache = []);\r\n\t\tif (t.isButtonDown(\"shift\") && t.isButtonDown(\"enter\")) {\r\n\t\t\tvar s = t.getButtonDownOccurances(\"enter\");\r\n\t\t\tthis.returnToCheckpoint(s),\r\n\t\t\tt.setButtonUp(\"enter\")\r\n\t\t}\r\n\t\tif (e === !1 && (t.areKeysDown() && !this._crashed && i.play(),\r\n\t\tt.isButtonDown(\"restart\") && (i.restartTrack = !0,\r\n\t\tt.setButtonUp(\"restart\")),\r\n\t\t(t.isButtonDown(\"up\") || t.isButtonDown(\"down\") || (!i.camera.focusIndex || ((s = i.playerManager.getPlayerByIndex(i.camera.focusIndex)) && s._gamepad.playbackTicks < 1)) && (t.isButtonDown(\"left\") || t.isButtonDown(\"right\"))) && i.camera.focusOnMainPlayer()),\r\n\t\tt.isButtonDown(\"enter\") && (this.gotoCheckpoint(),\r\n\t\tt.setButtonUp(\"enter\")),\r\n\t\tt.isButtonDown(\"backspace\")) {\r\n\t\t\tvar s = t.getButtonDownOccurances(\"backspace\");\r\n\t\t\tthis.removeCheckpoint(s),\r\n\t\t\tt.setButtonUp(\"backspace\")\r\n\t\t}\r\n\t}\r\n\tgetDistanceBetweenPlayers(t) {\r\n\t\tlet e = t.getActiveVehicle()\r\n\t\t  , i = this.getActiveVehicle();\r\n\t\treturn e.focalPoint.pos.sub(i.focalPoint.pos).len()\r\n\t}\r\n\tgetActiveVehicle() {\r\n\t\treturn this._tempVehicleTicks > 0 ? this._tempVehicle : this._baseVehicle\r\n\t}\r\n\t_createCheckpoint() {\r\n\t\tthis._checkpoints.push(this._createSnapshot())\r\n\t}\r\n\t_createSnapshot() {\r\n\t\tlet t = {};\r\n\t\tthis._tempVehicleTicks > 0 ? (t._tempVehicleType = this._tempVehicleType,\r\n\t\tt._tempVehicle = JSON.stringify(this._tempVehicle, this._snapshotFilter),\r\n\t\tt._tempVehicleTicks = this._tempVehicleTicks) : (t._baseVehicleType = this._baseVehicleType,\r\n\t\tt._baseVehicle = JSON.stringify(this._baseVehicle, this._snapshotFilter)),\r\n\t\tt._powerupsConsumed = JSON.stringify(this._powerupsConsumed),\r\n\t\tt._crashed = this._crashed;\r\n\t\treturn t;\r\n\t}\r\n\t_snapshotFilter(t, e) {\r\n\t\tswitch (t) {\r\n\t\tcase \"parent\":\r\n\t\tcase \"player\":\r\n\t\tcase \"scene\":\r\n\t\tcase \"settings\":\r\n\t\tcase \"masses\":\r\n\t\tcase \"springs\":\r\n\t\tcase \"focalPoint\":\r\n\t\tcase \"gamepad\":\r\n\t\t\treturn void 0;\r\n\t\tcase \"explosion\":\r\n\t\t\treturn !1;\r\n\t\tdefault:\r\n\t\t\treturn e\r\n\t\t}\r\n\t}\r\n\tsetCheckpointOnUpdate() {\r\n\t\tthis._addCheckpoint = !0\r\n\t}\r\n\tcrashed() {\r\n\t\tthis._crashed = !0\r\n\t}\r\n\tgotoCheckpoint() {\r\n\t\tlet t = this._gamepad\r\n\t\t  , e = t.replaying\r\n\t\t  , i = this._scene;\r\n\t\tif (this._checkpoints.length > 0) {\r\n\t\t\tlet s = this._checkpoints[this._checkpoints.length - 1];\r\n\t\t\tif (s._tempVehicle) {\r\n\t\t\t\tthis._baseVehicle.stopSounds();\r\n\t\t\t\tlet n = this._tempVehicle;\r\n\t\t\t\tthis._tempVehicleType !== s._tempVehicleType && (n = new v[s._tempVehicleType](this, {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0\r\n\t\t\t\t}));\r\n\t\t\t\tlet r = JSON.parse(s._tempVehicle);\r\n\t\t\t\tm(n, r),\r\n\t\t\t\tthis._tempVehicle = n,\r\n\t\t\t\tthis._tempVehicleType = s._tempVehicleType,\r\n\t\t\t\tthis._tempVehicleTicks = s._tempVehicleTicks,\r\n\t\t\t\tn.updateCameraFocalPoint()\r\n\t\t\t} else {\r\n\t\t\t\tlet n = this._baseVehicle\r\n\t\t\t\t  , r = JSON.parse(s._baseVehicle);\r\n\t\t\t\tm(n, r),\r\n\t\t\t\tthis._tempVehicle && this._tempVehicle.stopSounds(),\r\n\t\t\t\tthis._baseVehicle = n,\r\n\t\t\t\tthis._tempVehicleTicks = 0,\r\n\t\t\t\tthis._tempVehicleType = !1,\r\n\t\t\t\tn.updateCameraFocalPoint()\r\n\t\t\t}\r\n\t\t\tif (this._powerupsConsumed = JSON.parse(s._powerupsConsumed),\r\n\t\t\t\tthis._crashed = s._crashed,\r\n\t\t\t\te === !1) {\r\n\t\t\t\tlet o = i.settings;\r\n\t\t\t\ti.state.playerAlive = this.isAlive(),\r\n\t\t\t\ti.message.show(\"Press Backspace To Go Back Further\", 5, \"#826cdc\", \"#FFFFFF\"),\r\n\t\t\t\ti.track.updatePowerupState(this),\r\n\t\t\t\to.waitAtCheckpoints && (i.state.playing = !1),\r\n\t\t\t\ti.camera.focusOnMainPlayer()\r\n\t\t\t}\r\n\t\t\ti.camera.playerFocus === this && i.camera.fastforward()\r\n\t\t} else\r\n\t\t\te === !1 && this.restartScene()\r\n\t}\r\n\trestartScene() {\r\n\t\tlet t = this._gamepad\r\n\t\t  , e = t.replaying;\r\n\t\te === !1 && (this._scene.restartTrack = !0)\r\n\t}\r\n\tremoveCheckpoint(t) {\r\n\t\tif (this._checkpoints.length > 1) {\r\n\t\t\tfor (let e = 0; t > e; e++)\r\n\t\t\t\tthis._cache.push(this._checkpoints.pop());\r\n\t\t\tthis.gotoCheckpoint()\r\n\t\t} else\r\n\t\t\tthis.restartScene()\r\n\t}\r\n\treturnToCheckpoint(t) {\r\n\t\tif (this._cache.length > 0) {\r\n\t\t\tfor (var e = 0; t > e; e++)\r\n\t\t\t\tthis._checkpoints.push(this._cache.pop());\r\n\t\t\tthis.gotoCheckpoint()\r\n\t\t}\r\n\t}\r\n\tclose() {\r\n\t\tthis.id = null;\r\n\t\tthis._scene = null;\r\n\t\tthis._game = null;\r\n\t\tthis._user = null;\r\n\t\tthis._settings = null;\r\n\t\tthis._baseVehicleType = null;\r\n\t\tthis._gamepad.close();\r\n\t\tthis._gamepad = null;\r\n\t\tthis._baseVehicle = null;\r\n\t\tthis._tempVehicleType = null;\r\n\t\tthis._tempVehicle = null;\r\n\t\tthis._tempVehicleTicks = null;\r\n\t\tthis._addCheckpoint = null;\r\n\t\tthis._checkpoints = null;\r\n\t\tthis._cache = null;\r\n\t\tthis._crashed = null;\r\n\t\tthis._effect = null;\r\n\t\tthis._effectTicks = null;\r\n\t\tthis._powerupsConsumed = null;\r\n\t}\r\n\treset() {\r\n\t\tthis._tempVehicle && this._tempVehicle.stopSounds(),\r\n\t\tthis._baseVehicle.stopSounds(),\r\n\t\tthis.setDefaults(),\r\n\t\tthis.createBaseVehicle(new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 35), 1, new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0)),\r\n\t\tthis._gamepad.reset(),\r\n\t\tthis._scene.state.playerAlive = this.isAlive(),\r\n\t\twindow.hasOwnProperty('lite') && (window.lite.snapshots.splice(0),\r\n\t\twindow.lite.replayGui && (window.lite.replayGui.progress.value = 0))\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/player.js?");

/***/ }),

/***/ "./src/game/class/vehicles/player_manager.js":
/*!***************************************************!*\
  !*** ./src/game/class/vehicles/player_manager.js ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _player_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./player.js */ \"./src/game/class/vehicles/player.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\t_players = [];\r\n\t_playerLookup = {};\r\n\tfirstPlayer = null;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'scene', { value: t, writable: true }),\r\n\t\tObject.defineProperty(this, 'game', { value: t.game, writable: true }),\r\n\t\tthis.settings = t.settings\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tif (!this.scene.camera.focusIndex)\r\n\t\t\tfor (let t = this._players.filter(player => !player.complete && !player.isGhost()), e = t.length, i = 0; e > i; i++)\r\n\t\t\t\tt[i].fixedUpdate()\r\n\t\tfor (let t = this._players.filter(player => !player.complete && player.isGhost()), e = t.length, i = 0; e > i; i++)\r\n\t\t\tt[i]._replayIterator.next()\r\n\t}\r\n\tmutePlayers() {\r\n\t\tfor (let t = this._players, e = t.length, i = 0; e > i; i++) {\r\n\t\t\tlet s = t[i].getActiveVehicle();\r\n\t\t\ts.stopSounds()\r\n\t\t}\r\n\t}\r\n\tupdateGamepads() {\r\n\t\tfor (let t = this._players.filter(player => !player.isGhost()), e = t.length, i = 0; e > i; i++)\r\n\t\t\tt[i]._gamepad.update()\r\n\t}\r\n\tcreatePlayer(t, e) {\r\n\t\treturn new _player_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.scene,e)\r\n\t}\r\n\taddPlayer(t) {\r\n\t\tthis._players.push(t),\r\n\t\tthis._playerLookup[t.id] = t,\r\n\t\tthis.game.emit('playerAdd', t)\r\n\t}\r\n\tcheckKeys() {\r\n\t\tfor (let t = this._players.filter(player => !player.isGhost()), e = t.length, i = 0; e > i; i++)\r\n\t\t\tt[i].checkKeys()\r\n\t}\r\n\tdraw(ctx) {\r\n\t\tfor (let t of this._players)\r\n\t\t\tt.draw(ctx)\r\n\t}\r\n\tgetPlayerByIndex(t) {\r\n\t\treturn this._players[t]\r\n\t}\r\n\tgetPlayerById(t) {\r\n\t\treturn this._playerLookup[t]\r\n\t}\r\n\tgetPlayerCount() {\r\n\t\treturn this._players.length\r\n\t}\r\n\tremovePlayer(t) {\r\n\t\tlet e = this._players\r\n\t\t  , i = this._playerLookup\r\n\t\t  , s = e.find(s => t == s._user.u_id && s.isGhost());\r\n\t\te.splice(e.indexOf(s), 1);\r\n\t\tdelete i[s.id],\r\n\t\tthis.game.emit('playerRemove', s)\r\n\t}\r\n\treset() {\r\n\t\tfor (let t = this._players, e = t.length, i = 0; e > i; i++)\r\n\t\t\tt[i].reset()\r\n\t\tfor (let t = this._players.filter(player => player.isGhost()), e = t.length, i = 0; e > i; i++)\r\n\t\t\tt[i]._replayIterator = t[i].createReplayIterator();\r\n\t}\r\n\tclear() {\r\n\t\tthis._players.splice(1),\r\n\t\tthis._playerLookup = {},\r\n\t\tthis._playerLookup[this.firstPlayer.id] = this.firstPlayer,\r\n\t\tthis.scene.camera.focusIndex > 0 && this.scene.camera.unfocus()\r\n\t}\r\n\t_closePlayers() {\r\n\t\tfor (let t = this._players, e = t.length, i = 0; e > i; i++)\r\n\t\t\tt[i].close()\r\n\t}\r\n\tclose() {\r\n\t\tthis._closePlayers(),\r\n\t\tthis._players = null,\r\n\t\tthis._playerLookup = null,\r\n\t\tthis.firstPlayer = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.game = null,\r\n\t\tthis.settings = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/player_manager.js?");

/***/ }),

/***/ "./src/game/class/vehicles/prop.js":
/*!*****************************************!*\
  !*** ./src/game/class/vehicles/prop.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\r\n\tmotor = 0;\r\n\tangle = null;\r\n\tspeed = 0;\r\n\tconstructor(t, e) {\r\n\t\tsuper(t, e);\r\n\t\tthis.angle = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0);\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tlet t = this.vel\r\n\t\t  , e = this.angle\r\n\t\t  , i = this.pos\r\n\t\t  , s = this.old\r\n\t\t  , n = this.motor;\r\n\t\tt.inc(e.factor(2 * n)),\r\n\t\ti.inc(t.factor(.99)),\r\n\t\tthis.contact = !1,\r\n\t\tthis.collide && this.scene.track.collide(this),\r\n\t\tthis.vel = i.sub(s),\r\n\t\ts.equ(i)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/prop.js?");

/***/ }),

/***/ "./src/game/class/vehicles/ragdoll.js":
/*!********************************************!*\
  !*** ./src/game/class/vehicles/ragdoll.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _spring_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./spring.js */ \"./src/game/class/vehicles/spring.js\");\n\r\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tconstructor(t, e) {\r\n\t\tObject.defineProperty(this, 'parent', { value: e });\r\n\t\tlet i, o, a, h, l, c, u, p, d, f, v = [], g = [], m = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,0);\r\n\t\ti = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\to = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\ta = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\th = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\tc = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\tl = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\tu = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\tp = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\td = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\tf = new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](m, e),\r\n\t\tv.push(i),\r\n\t\tv.push(o),\r\n\t\tv.push(a),\r\n\t\tv.push(h),\r\n\t\tv.push(c),\r\n\t\tv.push(l),\r\n\t\tv.push(u),\r\n\t\tv.push(p),\r\n\t\tv.push(d),\r\n\t\tv.push(f),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](i,o,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](i,a,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](a,c,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](i,h,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](h,l,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](o,u,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](u,d,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](o,p,this)),\r\n\t\tg.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](p,f,this));\r\n\t\tfor (let y in v)\r\n\t\t\tv[y].friction = .05,\r\n\t\t\tv[y].radius = 3;\r\n\t\ti.radius = o.radius = 8;\r\n\t\tfor (var y in g)\r\n\t\t\tg[y].dampConstant = .7,\r\n\t\t\tg[y].springConstant = .4;\r\n\t\tthis.masses = v,\r\n\t\tthis.springs = g,\r\n\t\tthis.head = i,\r\n\t\tthis.waist = o,\r\n\t\tthis.lElbow = a,\r\n\t\tthis.rElbow = h,\r\n\t\tthis.rHand = l,\r\n\t\tthis.lHand = c,\r\n\t\tthis.lKnee = u,\r\n\t\tthis.rKnee = p,\r\n\t\tthis.lFoot = d,\r\n\t\tthis.rFoot = f;\r\n\t\tfor (var y in t)\r\n\t\t\tthis[y].pos.equ(t[y])\r\n\t}\r\n\tzero(t, e) {\r\n\t\tt = t.factor(.7),\r\n\t\te = e.factor(.7);\r\n\t\tlet i = this.springs\r\n\t\t  , s = this.masses;\r\n\t\tfor (let n in i) {\r\n\t\t\tlet r = i[n].m2.pos.sub(i[n].m1.pos).len();\r\n\t\t\ti[n].lrest = r,\r\n\t\t\ti[n].leff = r\r\n\t\t}\r\n\t\tfor (let n = 1; 4 >= n; n++)\r\n\t\t\ti[n].lrest = 13,\r\n\t\t\ti[n].leff = 13;\r\n\t\tfor (let n in i.filter(t => t.leff > 20))\r\n\t\t\ti[n].lrest = 20,\r\n\t\t\ti[n].leff = 20;\r\n\t\tlet o = [this.head, this.lElbow, this.rElbow, this.lHand, this.rHand]\r\n\t\t  , a = [this.waist, this.lKnee, this.rKnee, this.lFoot, this.rFoot];\r\n\t\tfor (let n in o)\r\n\t\t\to[n].old = o[n].pos.sub(t);\r\n\t\tfor (let n in a)\r\n\t\t\ta[n].old = a[n].pos.sub(e);\r\n\t\tfor (let n in s)\r\n\t\t\ts[n].vel.equ(s[n].pos.sub(s[n].old)),\r\n\t\t\ts[n].vel.x += 1 * (Math.random() - Math.random()),\r\n\t\t\ts[n].vel.y += 1 * (Math.random() - Math.random())\r\n\t}\r\n\tdraw(d) {\r\n\t\tlet t = this.head\r\n\t\t  , e = this.waist\r\n\t\t  , i = this.lElbow\r\n\t\t  , s = this.rElbow\r\n\t\t  , n = this.rHand\r\n\t\t  , r = this.lHand\r\n\t\t  , o = this.lKnee\r\n\t\t  , a = this.rKnee\r\n\t\t  , h = this.lFoot\r\n\t\t  , l = this.rFoot\r\n\t\t  , c = this.parent.scene\r\n\t\t  , u = c.camera\r\n\t\t  , p = u.zoom\r\n\t\t  , f = this.parent.alpha ?? 1\r\n\t\t  , q = c.settings.physicsLineColor\r\n\t\t  , j = q.padEnd(7, q.slice(1, 4));\r\n\t\td.strokeStyle = j + Math.min(255, Math.round(255 * .5 * f)).toString(16),\r\n\t\td.lineWidth = 5 * p;\r\n\t\tlet v = t.pos.toScreen(c)\r\n\t\td.beginPath(),\r\n\t\td.moveTo(v.x, v.y);\r\n\t\tlet g = i.pos.toScreen(c)\r\n\t\td.lineTo(g.x, g.y);\r\n\t\tlet m = r.pos.toScreen(c)\r\n\t\td.lineTo(m.x, m.y),\r\n\t\td.stroke(),\r\n\t\td.strokeStyle = j + Math.min(255, Math.round(255 * f)).toString(16),\r\n\t\td.beginPath(),\r\n\t\td.moveTo(v.x, v.y);\r\n\t\tlet y = s.pos.toScreen(c)\r\n\t\td.lineTo(y.x, y.y);\r\n\t\tlet w = n.pos.toScreen(c)\r\n\t\td.lineTo(w.x, w.y),\r\n\t\td.stroke(),\r\n\t\td.lineWidth = 8 * p,\r\n\t\td.beginPath(),\r\n\t\td.moveTo(v.x, v.y);\r\n\t\tlet x = e.pos.toScreen(c)\r\n\t\td.lineTo(x.x, x.y),\r\n\t\td.stroke(),\r\n\t\td.lineWidth = 5 * p,\r\n\t\td.beginPath(),\r\n\t\td.moveTo(x.x, x.y);\r\n\t\tlet _ = o.pos.toScreen(c)\r\n\t\td.lineTo(_.x, _.y);\r\n\t\tlet b = h.pos.toScreen(c)\r\n\t\td.lineTo(b.x, b.y);\r\n\t\tlet T = o.pos.sub(e.pos).normalize();\r\n\t\tT.factorSelf(4),\r\n\t\tT.inc(h.pos);\r\n\t\tlet C = T.toScreen(c);\r\n\t\td.lineTo(C.x, C.y),\r\n\t\td.stroke(),\r\n\t\td.strokeStyle = j + Math.min(255, Math.round(255 * .5 * f)).toString(16),\r\n\t\td.lineWidth = 5 * p,\r\n\t\td.beginPath(),\r\n\t\td.moveTo(x.x, x.y);\r\n\t\tlet k = a.pos.toScreen(c)\r\n\t\td.lineTo(k.x, k.y);\r\n\t\tlet S = a.pos.sub(e.pos).normalize();\r\n\t\tS = S.factor(4).add(l.pos);\r\n\t\tlet P = l.pos.toScreen(c)\r\n\t\td.lineTo(P.x, P.y);\r\n\t\tlet M = S.toScreen(c);\r\n\t\td.lineTo(M.x, M.y),\r\n\t\td.stroke(),\r\n\t\tv.inc(v.sub(x).factor(.25));\r\n\t\tlet D = GameInventoryManager.getItem(this.parent.cosmetics.head)\r\n\t\t  , I = this.drawHeadAngle;\r\n\t\tD.draw(d, v.x, v.y, I, p, this.dir, 1)\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tfor (let t of this.springs)\r\n\t\t\tt.fixedUpdate();\r\n\t\tfor (let t of this.masses)\r\n\t\t\tt.fixedUpdate();\r\n\t\tthis.updateDrawHeadAngle()\r\n\t}\r\n\tupdate(progress) {\r\n\t\tfor (let t of this.masses)\r\n\t\t\tt.update(progress);\r\n\t}\r\n\tupdateDrawHeadAngle() {\r\n\t\tlet t = this.head.pos\r\n\t\t  , e = this.waist.pos;\r\n\t\tthis.dir < 0 && ([t, e] = [e, t]);\r\n\t\tlet i = t.x\r\n\t\t  , s = t.y\r\n\t\t  , n = e.x\r\n\t\t  , r = e.y\r\n\t\t  , o = i - n\r\n\t\t  , h = s - r;\r\n\t\tthis.drawHeadAngle = -(Math.atan2(o, h) + Math.PI)\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/ragdoll.js?");

/***/ }),

/***/ "./src/game/class/vehicles/spring.js":
/*!*******************************************!*\
  !*** ./src/game/class/vehicles/spring.js ***!
  \*******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tm1 = null;\r\n\tm2 = null;\r\n\tlrest = 40;\r\n\tleff = 40;\r\n\tdampConstant = 0;\r\n\tspringConstant = 0;\r\n\tconstructor(t, e, i) {\r\n\t\tObject.defineProperty(this, 'parent', { value: i });\r\n\t\tthis.m1 = t;\r\n\t\tthis.m2 = e;\r\n\t\tthis.lrest = 40;\r\n\t\tthis.leff = 40;\r\n\t\tthis.dampConstant = .5;\r\n\t\tthis.springConstant = .7;\r\n\t}\r\n\tswap() {\r\n\t\tlet t = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n\t\t  , e = this.m1\r\n\t\t  , s = this.m2;\r\n\t\tt.equ(e.pos),\r\n\t\te.pos.equ(s.pos),\r\n\t\ts.pos.equ(t),\r\n\t\tt.equ(e.old),\r\n\t\te.old.equ(s.old),\r\n\t\ts.old.equ(t),\r\n\t\tt.equ(e.vel),\r\n\t\te.vel.equ(s.vel),\r\n\t\ts.vel.equ(t),\r\n\t\tt = e.angle,\r\n\t\te.angle = s.angle,\r\n\t\ts.angle = t\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tlet e = this.m1\r\n\t\t  , s = this.m2\r\n\t\t  , n = e.pos\r\n\t\t  , r = s.pos\r\n\t\t  , o = e.vel\r\n\t\t  , a = s.vel\r\n\t\t  , t = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](r.x - n.x, r.y - n.y);\r\n\t\tlet h = t.len();\r\n\t\tif (!(1 > h)) {\r\n\t\t\tlet l = 1 / h;\r\n\t\t\tt.x *= l,\r\n\t\t\tt.y *= l;\r\n\t\t\tlet c = (h - this.leff) * this.springConstant\r\n\t\t\t  , u = {\r\n\t\t\t\t  x: t.x * c,\r\n\t\t\t\t  y: t.y * c\r\n\t\t\t  }\r\n\t\t\t  , p = a.x - o.x\r\n\t\t\t  , d = a.y - o.y\r\n\t\t\t  , f = p * t.x + d * t.y\r\n\t\t\t  , v = f * this.dampConstant\r\n\t\t\t  , g = t.x * v\r\n\t\t\t  , m = t.y * v;\r\n\t\t\tu.x += g,\r\n\t\t\tu.y += m,\r\n\t\t\ta.x += -u.x,\r\n\t\t\ta.y += -u.y,\r\n\t\t\to.x += u.x,\r\n\t\t\to.y += u.y\r\n\t\t}\r\n\t}\r\n\trotate(t) {\r\n\t\tlet e = this.m1\r\n\t\t  , i = this.m2\r\n\t\t  , s = i.pos.x - e.pos.x\r\n\t\t  , n = i.pos.y - e.pos.y\r\n\t\t  , r = -n / this.leff\r\n\t\t  , o = s / this.leff;\r\n\t\te.pos.x += r * t,\r\n\t\te.pos.y += o * t,\r\n\t\ti.pos.x += r * -t,\r\n\t\ti.pos.y += o * -t\r\n\t}\r\n\tcontract(t, e) {\r\n\t\tthis.leff += (this.lrest - t - this.leff) / e\r\n\t}\r\n\tsetMasses(t, e) {\r\n\t\tthis.m1 = t,\r\n\t\tthis.m2 = e\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/spring.js?");

/***/ }),

/***/ "./src/game/class/vehicles/truck.js":
/*!******************************************!*\
  !*** ./src/game/class/vehicles/truck.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n/* harmony import */ var _spring_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./spring.js */ \"./src/game/class/vehicles/spring.js\");\n/* harmony import */ var _vehicle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./vehicle.js */ \"./src/game/class/vehicles/vehicle.js\");\n/* harmony import */ var _wheel_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./wheel.js */ \"./src/game/class/vehicles/wheel.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nlet d = {\r\n\tTRUCK_GROUND: \"truck_idle\"\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _vehicle_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"] {\r\n\tcolor = \"#444\";\r\n\tpedala = 0;\r\n\tswapped = !1;\r\n\tvehicleName = \"TRUCK\";\r\n\tconstructor(t, e, i) {\r\n\t\tsuper(t);\r\n\t\tthis.createMasses(e);\r\n\t\tthis.createSprings();\r\n\t\tthis.stopSounds();\r\n\t\tthis.updateCameraFocalPoint();\r\n\t\t-1 === i && this.swap();\r\n\t}\r\n\tcreateMasses(t) {\r\n\t\tthis.masses = [],\r\n\t\tthis.masses.push(new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x - 15,t.y + 7), this)),\r\n\t\tthis.masses.push(new _mass_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 15,t.y + 7), this)),\r\n\t\tthis.masses[0].friction = .1,\r\n\t\tthis.masses[1].friction = .1,\r\n\t\tthis.masses.push(new _wheel_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x - 20,t.y + 35),this)),\r\n\t\tthis.masses.push(new _wheel_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"](new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](t.x + 20,t.y + 35),this)),\r\n\t\tthis.masses[2].radius = this.masses[3].radius = 14,\r\n\t\tthis.masses[0].radius = this.masses[1].radius = 7,\r\n\t\tthis.head = this.masses[0],\r\n\t\tthis.backMass = this.masses[1],\r\n\t\tthis.rearWheel = this.masses[2],\r\n\t\tthis.frontWheel = this.masses[3]\r\n\t}\r\n\tcreateSprings() {\r\n\t\tthis.springs = [];\r\n\t\tlet t = this.masses;\r\n\t\tthis.springs.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[0],t[1],this)),\r\n\t\tthis.springs.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[0],t[2],this)),\r\n\t\tthis.springs.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[1],t[3],this)),\r\n\t\tthis.springs.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[0],t[3],this)),\r\n\t\tthis.springs.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[1],t[2],this)),\r\n\t\tthis.springs.push(new _spring_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](t[2],t[3],this)),\r\n\t\tthis.springs[0].leff = this.springs[0].lrest = 30,\r\n\t\tthis.springs[1].leff = this.springs[1].lrest = 30,\r\n\t\tthis.springs[2].leff = this.springs[2].lrest = 30,\r\n\t\tthis.springs[3].leff = this.springs[3].lrest = 45,\r\n\t\tthis.springs[4].leff = this.springs[4].lrest = 45;\r\n\t\tfor (let e in this.springs)\r\n\t\t\tthis.springs[e].springConstant = .3\r\n\t}\r\n\tupdateCameraFocalPoint() {}\r\n\tfixedUpdate() {\r\n\t\tif (this.crashed === !1 && (this.updateSound(),\r\n\t\tthis.control()),\r\n\t\tthis.explosion)\r\n\t\t\tthis.explosion.fixedUpdate();\r\n\t\telse {\r\n\t\t\tfor (var t = this.springs, e = t.length, i = e - 1; i >= 0; i--)\r\n\t\t\t\tt[i].fixedUpdate();\r\n\t\t\tfor (var s = this.masses, n = s.length, r = n - 1; r >= 0; r--)\r\n\t\t\t\ts[r].fixedUpdate();\r\n\t\t\tif (this.rearWheel.contact && this.frontWheel.contact && (this.slow = !1),\r\n\t\t\tthis.slow === !1) {\r\n\t\t\t\tthis.crashed === !1 && this.control();\r\n\t\t\t\tfor (var i = e - 1; i >= 0; i--)\r\n\t\t\t\t\tt[i].fixedUpdate();\r\n\t\t\t\tfor (var r = n - 1; r >= 0; r--)\r\n\t\t\t\t\ts[r].fixedUpdate()\r\n\t\t\t}\r\n\t\t\tthis.updateDrawHeadAngle(),\r\n\t\t\tthis.updateCameraFocalPoint()\r\n\t\t}\r\n\t}\r\n\tupdate(progress) {\r\n\t\tfor (var s = this.masses, n = s.length, r = n - 1; r >= 0; r--)\r\n\t\t\ts[r].fixedUpdate();\r\n\t}\r\n\tupdateSound() {\r\n\t\tif (this.player.isInFocus()) {\r\n\t\t\tlet t = this.scene.sound;\r\n\t\t\tif (this.rearWheel.contact) {\r\n\t\t\t\tlet e = Math.min(this.rearWheel.motor, 1);\r\n\t\t\t\tt.play(d.TRUCK_GROUND, e)\r\n\t\t\t} else if (this.frontWheel.contact) {\r\n\t\t\t\tlet e = Math.min(this.frontWheel.motor, 1);\r\n\t\t\t\tt.play(d.TRUCK_GROUND, e)\r\n\t\t\t} else\r\n\t\t\t\tt.stop(d.TRUCK_GROUND)\r\n\t\t}\r\n\t}\r\n\tupdateCameraFocalPoint() {\r\n\t\tthis.focalPoint = 1 === this.dir ? this.head : this.backMass\r\n\t}\r\n\tstopSounds() {\r\n\t\tlet t = this.scene.sound;\r\n\t\tt.stop(d.TRUCK_GROUND)\r\n\t}\r\n\tupdateDrawHeadAngle() {\r\n\t\tlet t = this.frontWheel.pos\r\n\t\t  , e = this.rearWheel.pos\r\n\t\t  , i = t.x\r\n\t\t  , s = t.y\r\n\t\t  , n = e.x\r\n\t\t  , r = e.y\r\n\t\t  , o = i - n\r\n\t\t  , a = s - r;\r\n\t\tthis.drawHeadAngle = -(Math.atan2(o, a) - Math.PI / 2)\r\n\t}\r\n\tswap() {\r\n\t\tthis.dir = -1 * this.dir,\r\n\t\tthis.springs[0].swap(),\r\n\t\tthis.springs[5].swap()\r\n\t}\r\n\tcontrol() {\r\n\t\tlet t = this.gamepad\r\n\t\t  , e = t.isButtonDown(\"up\")\r\n\t\t  , i = t.isButtonDown(\"down\")\r\n\t\t  , s = t.isButtonDown(\"left\")\r\n\t\t  , n = t.isButtonDown(\"right\")\r\n\t\t  , r = t.isButtonDown(\"z\");\r\n\t\tr && !this.swapped && (this.swap(),\r\n\t\tthis.swapped = !0),\r\n\t\tr || (this.swapped = !1);\r\n\t\tlet o = e ? 1 : 0\r\n\t\t  , a = this.rearWheel\r\n\t\t  , h = this.frontWheel;\r\n\t\ta.motor += (.8 * o - a.motor) / 10,\r\n\t\th.motor += (.8 * o - h.motor) / 10,\r\n\t\ta.brake = i,\r\n\t\th.brake = i;\r\n\t\tlet l = s ? 1 : 0;\r\n\t\tl += n ? -1 : 0;\r\n\t\tlet c = this.springs;\r\n\t\tc[0].rotate(l / 8),\r\n\t\tc[5].rotate(l / 8)\r\n\t}\r\n\tdraw(t) {\r\n\t\tif (this.explosion)\r\n\t\t\tthis.explosion.draw(t, 1);\r\n\t\telse {\r\n\t\t\tif (this.scene.ticks > 0 && !this.player.isGhost()) {\r\n\t\t\t\tif (!this.scene.state.playing) {\r\n\t\t\t\t\tlet e = window.lite.storage.get(\"snapshots\");\r\n\t\t\t\t\tif (e > 0) {\r\n\t\t\t\t\t\tfor (let i of this.player._checkpoints.filter((i, s, n) => s > n.length - (e + 1) && i._tempVehicle)) {\r\n\t\t\t\t\t\t\tt.globalAlpha = e / 3e2 * this.player._checkpoints.indexOf(i) % 1,\r\n\t\t\t\t\t\t\tthis.drawTruck.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(i._tempVehicle), {tire: this.tire}), t)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (let i of this.player._cache.filter((i, s, n) => s > n.length - (e + 1) && i._tempVehicle)) {\r\n\t\t\t\t\t\t\tt.globalAlpha = e / 3e2 * this.player._cache.indexOf(i) % 1,\r\n\t\t\t\t\t\t\tthis.drawTruck.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(i._tempVehicle), {tire: this.tire}), t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (window.lite && lite.storage.get(\"playerTrail\"))\r\n\t\t\t\t\tfor (let e of lite.snapshots.filter(t => t._tempVehicle)) {\r\n\t\t\t\t\t\tt.globalAlpha = lite.snapshots.length / (lite.snapshots.length * 200) * lite.snapshots.indexOf(e) % 1,\r\n\t\t\t\t\t\tthis.drawTruck.call(Object.assign({}, this, { player: this.player, scene: this.scene }, JSON.parse(e._tempVehicle), {tire: this.tire}), t)\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (t.imageSmoothingEnabled = !0,\r\n\t\t\tt.mozImageSmoothingEnabled = !0,\r\n\t\t\tt.webkitImageSmoothingEnabled = !0,\r\n\t\t\tthis.settings.developerMode)\r\n\t\t\t\tfor (let e = this.masses, i = e.length, s = i - 1; s >= 0; s--)\r\n\t\t\t\t\te[s].draw();\r\n\t\t\tt.globalAlpha = this.player._opacity,\r\n\t\t\tthis.drawTruck(t),\r\n\t\t\tt.globalAlpha = 1\r\n\t\t}\r\n\t}\r\n\tdrawTruck(t) {\r\n\t\tlet e = this.scene\r\n\t\t  , i = e.camera.zoom\r\n\t\t  , n = GameInventoryManager.getItem(this.cosmetics.head)\r\n\t\t  , r = this.drawHeadAngle\r\n\t\t  , o = this.dir\r\n\t\t  , a = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.frontWheel.pos.x, this.frontWheel.pos.y).toScreen(e)\r\n\t\t  , h = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.rearWheel.pos.x, this.rearWheel.pos.y).toScreen(e)\r\n\t\t  , l = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.head.pos.x, this.head.pos.y).toScreen(e)\r\n\t\t  , c = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.backMass.pos.x, this.backMass.pos.y).toScreen(e)\r\n\t\t  , d = (this.backMass.pos.x - this.head.pos.x) * i\r\n\t\t  , f = (this.backMass.pos.y - this.head.pos.y) * i\r\n\t\t  , v = (.5 * (this.head.pos.x + this.backMass.pos.x) - .5 * (this.rearWheel.pos.x + this.frontWheel.pos.x)) * i\r\n\t\t  , g = (.5 * (this.head.pos.y + this.backMass.pos.y) - .5 * (this.rearWheel.pos.y + this.frontWheel.pos.y)) * i\r\n\t\t  , q = '#'.padEnd(7, /^(darker|midnight)$/.test(window.lite.storage.get('theme')) ? 'a' : lite.storage.get('theme') === 'dark' ? 'b' : '4');\r\n\t\tt.lineWidth = 3 * i;\r\n\t\tlet m = c.x - l.x\r\n\t\t  , y = c.y - l.y\r\n\t\t  , w = Math.sqrt(m ** 2 + y ** 2)\r\n\t\t  , x = m / w\r\n\t\t  , _ = y / w;\r\n\t\tn.draw(t, c.x - .5 * x * i * 20, c.y - _ * i * 20 * .5, r, .45 * i, o),\r\n\t\tt.strokeStyle = q,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(l.x - .4 * d - .9 * v, l.y - .4 * f - .9 * g),\r\n\t\tt.lineTo(l.x + .8 * d - .9 * v, l.y + .8 * f - .9 * g),\r\n\t\tt.stroke(),\r\n\t\tt.closePath(),\r\n\t\tt.save(),\r\n\t\tt.fillStyle = \"#808080\",\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(l.x - .4 * d - .7 * v, l.y - .4 * f - .7 * g),\r\n\t\tt.lineTo(l.x - .4 * d - .7 * v, l.y - .4 * f - .7 * g),\r\n\t\tt.lineTo(l.x + 1.4 * d - .7 * v, l.y + 1.4 * f - .7 * g),\r\n\t\tt.lineTo(l.x + 1.35 * d - .2 * v, l.y + 1.35 * f - .2 * g),\r\n\t\tt.lineTo(l.x + .9 * d - .1 * v, l.y + .9 * f - .1 * g),\r\n\t\tt.lineTo(l.x + .5 * d - .1 * v, l.y + .5 * f - .1 * g),\r\n\t\tt.lineTo(l.x + .5 * d + .2 * v, l.y + .5 * f + .2 * g),\r\n\t\tt.lineTo(l.x - .35 * d + .2 * v, l.y - .35 * f + .2 * g),\r\n\t\tt.closePath(),\r\n\t\tt.fill(),\r\n\t\tt.save(),\r\n\t\tt.lineWidth = 2 * i,\r\n\t\tt.strokeStyle = q,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(l.x - .4 * d - .7 * v, l.y - .4 * f - .7 * g),\r\n\t\tt.lineTo(l.x - .35 * d + .2 * v, l.y - .35 * f + .2 * g),\r\n\t\tt.lineTo(l.x + .8 * d + .2 * v, l.y + .8 * f + .2 * g),\r\n\t\tt.lineTo(l.x + .9 * d - .1 * v, l.y + .9 * f - .1 * g),\r\n\t\tt.lineTo(l.x + 1.35 * d - .2 * v, l.y + 1.35 * f - .2 * g),\r\n\t\tt.lineTo(l.x + 1.4 * d - .7 * v, l.y + 1.4 * f - .7 * g),\r\n\t\tt.lineTo(l.x - .4 * d - .7 * v, l.y - .4 * f - .7 * g),\r\n\t\tt.closePath(),\r\n\t\tt.stroke(),\r\n\t\tt.lineWidth = i,\r\n\t\tt.beginPath(),\r\n\t\tt.moveTo(l.x + .5 * d - .1 * v, l.y + .5 * f - .1 * g),\r\n\t\tt.lineTo(l.x + .9 * d - .1 * v, l.y + .9 * f - .1 * g),\r\n\t\tt.lineTo(l.x + .8 * d + .2 * v, l.y + .8 * f + .2 * g),\r\n\t\tt.lineTo(l.x + .5 * d + .2 * v, l.y + .5 * f + .2 * g),\r\n\t\tt.lineTo(l.x + .5 * d - .1 * v, l.y + .5 * f - .1 * g),\r\n\t\tt.closePath(),\r\n\t\tt.stroke(),\r\n\t\tt.strokeStyle = e.settings.physicsLineColor,\r\n\t\tthis.tire(t, h.x, h.y, 10 * i, i, this.rearWheel.angle),\r\n\t\tthis.tire(t, a.x, a.y, 10 * i, i, this.frontWheel.angle),\r\n\t\tt.restore()\r\n\t}\r\n\ttire(t, e, i, s, n, r) {\r\n\t\tt.beginPath(),\r\n\t\tt.arc(e, i, 10 * n, 0, 2 * Math.PI, !1),\r\n\t\tt.fillStyle = \"#888888\",\r\n\t\tt.fill(),\r\n\t\tt.lineWidth = 5.9 * n,\r\n\t\tt.closePath(),\r\n\t\tt.stroke(),\r\n\t\tt.beginPath(),\r\n\t\tt.lineWidth = 2 * n,\r\n\t\ts += 3 * n;\r\n\t\tlet a = 0\r\n\t\t  , p = 2 * Math.PI;\r\n\t\twhile (a++ < 8)\r\n\t\t\tt.moveTo(e + s * Math.cos(r + p * a / 8), i + s * Math.sin(r + p * a / 8)),\r\n\t\t\tt.lineTo(e + s * Math.cos(r + p * (a + .5) / 8), i + s * Math.sin(r + p * (a + .5) / 8));\r\n\t\tt.stroke(),\r\n\t\tt.closePath(),\r\n\t\tt.beginPath(),\r\n\t\ta = 0;\r\n\t\ts += -9 * n;\r\n\t\twhile (a++ < 5)\r\n\t\t\tt.moveTo(e + s * Math.cos(r + p * a / 5), i + s * Math.sin(r + p * a / 5)),\r\n\t\t\tt.lineTo(e + s * Math.cos(r + p * (a + .2) / 5), i + s * Math.sin(r + p * (a + .2) / 5));\r\n\t\tt.closePath(),\r\n\t\tt.stroke()\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/truck.js?");

/***/ }),

/***/ "./src/game/class/vehicles/vehicle.js":
/*!********************************************!*\
  !*** ./src/game/class/vehicles/vehicle.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n/* harmony import */ var _explosion_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./explosion.js */ \"./src/game/class/vehicles/explosion.js\");\n\r\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tcolor = '#'.padEnd(7, lite.storage.get('theme') == 'midnight' ? 'C' : /^dark(?:er)?$/.test(lite.storage.get('theme')) ? 'FB' : '0');\r\n\tmasses = null;\r\n\tsprings = null;\r\n\tslow = !1;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'player', { value: t, writable: true }),\r\n\t\tObject.defineProperty(this, 'scene', { value: t._scene, writable: true }),\r\n\t\tthis.gamepad = t._gamepad,\r\n\t\tthis.settings = t._settings,\r\n\t\tthis.gravity = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0,.3),\r\n\t\tthis.complete = !1,\r\n\t\tthis.alive = !0,\r\n\t\tthis.crashed = !1,\r\n\t\tthis.dir = 1,\r\n\t\tthis.ghost = !1,\r\n\t\tthis.ragdoll = !1,\r\n\t\tthis.explosion = !1,\r\n\t\tthis.speed = 0,\r\n\t\tthis.powerupsEnabled = !0,\r\n\t\tthis.createCosmetics()\r\n\t}\r\n\texplode() {\r\n\t\tthis.scene.sound.play(\"bomb_sound\", 1),\r\n\t\tthis.explosion = new _explosion_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.masses[0].pos,this.scene),\r\n\t\tthis.dead()\r\n\t}\r\n\tcreateCosmetics() {\r\n\t\tthis.cosmetics = this.player._user.cosmetics;\r\n\t}\r\n\tupdateSpeed() {\r\n\t\tthis.speed = Math.abs(Math.round(this.focalPoint.vel.x + this.focalPoint.vel.y))\r\n\t}\r\n\tclose() {\r\n\t\tthis.scene = null,\r\n\t\tthis.settings = null,\r\n\t\tthis.gravity = null,\r\n\t\tthis.speed = null,\r\n\t\tthis.cosmetics = null,\r\n\t\tthis.explosion = null,\r\n\t\tthis.ragdoll = null,\r\n\t\tthis.ghost = null,\r\n\t\tthis.crashed = null,\r\n\t\tthis.alive = null,\r\n\t\tthis.gamepad = null\r\n\t}\r\n\tdead() {\r\n\t\tthis.stopSounds(),\r\n\t\tthis.player.dead(),\r\n\t\tthis.crashed = !0,\r\n\t\tthis.alive = !1\r\n\t}\r\n\tmoveVehicle(t, e) {\r\n\t\tfor (var i = this.masses, s = i.length, n = s - 1; n >= 0; n--)\r\n\t\t\ti[n].pos.x += t,\r\n\t\t\ti[n].pos.y += e,\r\n\t\t\ti[n].old.x += t,\r\n\t\t\ti[n].old.y += e\r\n\t}\r\n\tstopSounds() {}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/vehicle.js?");

/***/ }),

/***/ "./src/game/class/vehicles/wheel.js":
/*!******************************************!*\
  !*** ./src/game/class/vehicles/wheel.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _mass_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mass.js */ \"./src/game/class/vehicles/mass.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class extends _mass_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n\tangle = 0;\r\n\tbrake = !1;\r\n\tmotor = 0;\r\n\trotationSpeed = 0;\r\n\tspeed = 0;\r\n\tdrive(t, e) {\r\n\t\tlet i = this.pos\r\n\t\t  , s = this.motor * this.parent.dir\r\n\t\t  , n = s * t\r\n\t\t  , r = s * e;\r\n\t\tif (i.x += n,\r\n\t\ti.y += r,\r\n\t\tthis.brake) {\r\n\t\t\tlet o = .3 * -(t * this.vel.x + e * this.vel.y)\r\n\t\t\t  , a = t * o\r\n\t\t\t  , h = e * o;\r\n\t\t\ti.x += a,\r\n\t\t\ti.y += h\r\n\t\t}\r\n\t\tthis.speed = (t * this.vel.x + e * this.vel.y) / this.radius,\r\n\t\tthis.rotationSpeed = this.speed,\r\n\t\tthis.angle += this.speed,\r\n\t\tthis.contact = !0\r\n\t}\r\n\tfixedUpdate() {\r\n\t\tsuper.fixedUpdate(),\r\n\t\tthis.rotationSpeed = .999 * this.rotationSpeed\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/vehicles/wheel.js?");

/***/ }),

/***/ "./src/game/class/view/camera.js":
/*!***************************************!*\
  !*** ./src/game/class/view/camera.js ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tsettings = null;\r\n\tzoom = 1;\r\n\tposition = null;\r\n\tdesiredZoom = 1;\r\n\tzoomPercentage = 0;\r\n\tfocusIndex = 0;\r\n\tplayerFocus = null;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperty(this, 'scene', { value: t, writable: true });\r\n\t\tthis.settings = t.settings;\r\n\t\tthis.zoom = t.settings.cameraStartZoom * t.game.pixelRatio;\r\n\t\tthis.desiredZoom = t.settings.cameraStartZoom * t.game.pixelRatio;\r\n\t\tthis.zooming = !1;\r\n\t\tthis.position = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0);\r\n\t\tthis.zoomPercentage = this.getZoomAsPercentage();\r\n\t\tthis.zoomPoint = !1;\r\n\t}\r\n\tfocusOnNextPlayer() {\r\n\t\tthis.focusIndex = (this.focusIndex + 1) % this.scene.playerManager.getPlayerCount(),\r\n\t\tthis.focusOnPlayer()\r\n\t}\r\n\tfocusOnPlayer() {\r\n\t\tthis.scene.playerManager.getPlayerCount() <= this.focusIndex && (this.focusIndex = 0);\r\n\t\tlet s = this.scene.playerManager.getPlayerByIndex(this.focusIndex);\r\n\t\tif (this.playerFocus !== s) {\r\n\t\t\tthis.focusIndex === 0 && (this.scene.playerManager._players.filter(player => player.isGhost()).forEach(player => player._replayIterator.next(this.scene.ticks)),\r\n\t\t\tthis.focusIndex = 0)\r\n\t\t\tif (this.playerFocus = s, this.scene.vehicleTimer.setPlayer(s), this.playerFocus) {\r\n\t\t\t\ts.getDistanceBetweenPlayers(this.playerFocus) > 1500 && this.fastforward()\r\n\t\t\t} else\r\n\t\t\t\tthis.fastforward()\r\n\t\t\tthis.scene.game.emit('cameraFocus', s)\r\n\t\t}\r\n\t}\r\n\tfocusOnMainPlayer() {\r\n\t\tthis.focusIndex === 0 && this.playerFocus || (this.focusIndex = 0, this.focusOnPlayer())\r\n\t}\r\n\tupdate() {\r\n\t\tif (this.playerFocus) {\r\n\t\t\tlet t = this.playerFocus.getActiveVehicle(), s = 3\r\n\t\t\t  , e = t.focalPoint.pos.sub(this.position);\r\n\t\t\te.len() > 1500 && (s = 1);\r\n\t\t\tthis.position.x += e.x / s,\r\n\t\t\tthis.position.y += e.y / s // manually call scene.draw?\r\n\t\t}\r\n\t}\r\n\tupdateZoom() {\r\n\t\tthis.desiredZoom !== this.zoom && (this.scene.loading = !0, this._performZoom(), this.zoom === this.desiredZoom && this.zoomComplete())\r\n\t}\r\n\tzoomToPoint(t) {\r\n\t\tthis.position.x = this.scene.screen.toReal(this.zoomPoint.x, \"x\") - this.scene.screen.width / t * this.zoomPoint.x / this.scene.screen.width + this.scene.screen.width / t / 2,\r\n\t\tthis.position.y = this.scene.screen.toReal(this.zoomPoint.y, \"y\") - this.scene.screen.height / t * this.zoomPoint.y / this.scene.screen.height + this.scene.screen.height / t / 2\r\n\t}\r\n\t_performZoom() {\r\n\t\tlet e = this.zoom + (this.desiredZoom - this.zoom) / 3;\r\n\t\tMath.abs(this.desiredZoom - this.zoom) < .05 && (e = this.desiredZoom),\r\n\t\tthis.zoomPoint && this.zoomToPoint(e),\r\n\t\tthis.zoom = e;\r\n\t}\r\n\tzoomComplete() {\r\n\t\tthis.scene.redraw(),\r\n\t\tthis.zooming = !1,\r\n\t\tthis.scene.loading = !1\r\n\t}\r\n\tsetZoom(t, e) {\r\n\t\tthis.desiredZoom = Math.round(t * window.devicePixelRatio * 10) / 10,\r\n\t\tthis.zooming = !0,\r\n\t\tthis.desiredZoom === this.zoom && (this.zooming = !1, this.scene.state.loading = !1),\r\n\t\tthis.zoomPoint = !1,\r\n\t\tnull === this.playerFocus && e && (this.zoomPoint = e),\r\n\t\tthis.zoomPercentage = this.getZoomAsPercentage(),\r\n\t\tthis.scene.updateState()\r\n\t}\r\n\tresetZoom() {\r\n\t\tthis.setZoom(this.settings.cameraStartZoom)\r\n\t}\r\n\tgetZoomAsPercentage() {\r\n\t\treturn this.desiredZoom / window.devicePixelRatio / this.scene.settings.cameraStartZoom * 100 | 0\r\n\t}\r\n\tincreaseZoom() {\r\n\t\tthis.setZoom((this.desiredZoom + 2 * this.scene.settings.cameraSensitivity) / window.devicePixelRatio),\r\n\t\tthis.desiredZoom > this.scene.settings.cameraZoomMax * window.devicePixelRatio && this.setZoom(this.scene.settings.cameraZoomMax)\r\n\t}\r\n\tdecreaseZoom() {\r\n\t\tthis.setZoom((this.desiredZoom - 2 * this.scene.settings.cameraSensitivity) / window.devicePixelRatio),\r\n\t\tthis.desiredZoom < this.scene.settings.cameraZoomMin * window.devicePixelRatio && this.setZoom(this.scene.settings.cameraZoomMin)\r\n\t}\r\n\tunfocus() {\r\n\t\tthis.focusIndex = 0,\r\n\t\tthis.playerFocus = null,\r\n\t\tthis.scene.vehicleTimer.removePlayer()\r\n\t}\r\n\tfastforward() {\r\n\t\tif (this.playerFocus) {\r\n\t\t\tlet t = this.playerFocus.getActiveVehicle();\r\n\t\t\tthis.position.x = t.focalPoint.pos.x,\r\n\t\t\tthis.position.y = t.focalPoint.pos.y\r\n\t\t}\r\n\t}\r\n\tclose() {\r\n\t\tthis.zoom = null,\r\n\t\tthis.scene = null,\r\n\t\tthis.position = null,\r\n\t\tthis.playerFocus = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/view/camera.js?");

/***/ }),

/***/ "./src/game/class/view/screen.js":
/*!***************************************!*\
  !*** ./src/game/class/view/screen.js ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../math/cartesian.js */ \"./src/game/class/math/cartesian.js\");\n\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {\r\n\tsize = null;\r\n\tcenter = null;\r\n\twidth = 0;\r\n\theight = 0;\r\n\tconstructor(t) {\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tscene: { value: t, writable: true },\r\n\t\t\tgame: { value: t.game, writable: true }\r\n\t\t});\r\n\t\tthis.size = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0);\r\n\t\tthis.center = new _math_cartesian_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0, 0);\r\n\t\tthis.setScreen()\r\n\t}\r\n\tsetScreen() {\r\n\t\tthis.width = this.game.width,\r\n\t\tthis.height = this.game.height,\r\n\t\tthis.size.x = this.game.width,\r\n\t\tthis.size.y = this.game.height,\r\n\t\tthis.center.x = this.game.width / 2,\r\n\t\tthis.center.y = this.game.height / 2\r\n\t}\r\n\tupdate() {\r\n\t\t(this.game.width !== this.width || this.game.height !== this.height) && this.setScreen()\r\n\t}\r\n\trealToScreen(t, e) {\r\n\t\treturn (t - this.scene.camera.position[e]) * this.scene.camera.zoom + this.scene.screen.center[e]\r\n\t}\r\n\ttoReal(t, e) {\r\n\t\treturn (t - this.scene.screen.center[e]) / this.scene.camera.zoom + this.scene.camera.position[e]\r\n\t}\r\n\tclose() {\r\n\t\tthis.width = null,\r\n\t\tthis.height = null,\r\n\t\tthis.center = null,\r\n\t\tthis.size = null,\r\n\t\tthis.game = null,\r\n\t\tthis.scene = null\r\n\t}\r\n});\n\n//# sourceURL=webpack://frhd-lite/./src/game/class/view/screen.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/game/class/Game.js");
/******/ 	
/******/ })()
;